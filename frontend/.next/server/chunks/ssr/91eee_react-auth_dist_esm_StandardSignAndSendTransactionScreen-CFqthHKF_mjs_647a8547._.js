module.exports=[674404,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(596758),e=a.i(248191),f=a.i(267954),g=a.i(360228),h=a.i(930329),i=a.i(856399),j=a.i(324633),k=a.i(775716),l=a.i(919544),m=a.i(529408),n=a.i(769745),o=a.i(602420),p=a.i(427437),q=a.i(299389),r=a.i(264796),s=a.i(16486),t=a.i(9314),u=a.i(765520),v=a.i(476553),w=a.i(29943),x=a.i(587437),y=a.i(168617),z=a.i(527394),A=a.i(847675);async function B(a,b,c){if(0===a.length)return{};let d=await (0,A.fetchJsonParsedAccounts)(b,a,c);return(0,A.assertAccountsDecoded)(d),(0,A.assertAccountsExist)(d),d.reduce((a,b)=>({...a,[b.address]:b.data.addresses}),{})}a.i(849470),a.i(626961),a.i(427699),a.i(963001);var C=a.i(213264),D=a.i(970601);a.i(366962),a.i(562724),a.i(906301),a.i(505434),a.i(781034);let E=k.styled.span.withConfig({displayName:"CircleBackground",componentId:"sc-c9f33cd-0"})(["&&{width:82px;height:82px;border-width:4px;border-style:solid;border-color:",";background-color:",";border-radius:50%;display:inline-block;box-sizing:border-box;}"],a=>a.color??"var(--privy-color-accent)",a=>a.color??"var(--privy-color-accent)"),F=({instruction:a,fees:c,transactionInfo:d,solPrice:e,chain:f})=>(0,b.jsxs)(p.a,{children:[d?.action&&(0,b.jsxs)(p.R,{children:[(0,b.jsx)(q.L,{children:"Action"}),(0,b.jsx)(q.V,{children:d.action})]}),null!=a?.total&&(0,b.jsxs)(p.R,{children:[(0,b.jsx)(q.L,{children:"Total"}),(0,b.jsx)(q.V,{children:a.total})]}),!a?.total&&null!=a?.amount&&(0,b.jsxs)(p.R,{children:[(0,b.jsx)(q.L,{children:"Total"}),(0,b.jsx)(q.V,{children:(0,b.jsx)(r.S,{quantities:[a.amount,c],tokenPrice:e})})]}),(0,b.jsxs)(p.R,{children:[(0,b.jsx)(q.L,{children:"Fees"}),(0,b.jsx)(q.V,{children:(0,b.jsx)(r.S,{quantities:[c],tokenPrice:e})})]}),a?.to&&(0,b.jsxs)(p.R,{children:[(0,b.jsx)(q.L,{children:"To"}),(0,b.jsx)(q.V,{children:(0,b.jsx)(r.W,{walletAddress:a.to,chainId:f,chainType:"solana"})})]})]}),G=({fees:a,onClose:c,receiptHeader:d,receiptDescription:e,transactionInfo:f,solPrice:g,signOnly:h,instruction:i,chain:k})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.M,{onClose:c}),(0,b.jsx)(s.e,{style:{marginBottom:"16px"},children:(0,b.jsxs)("div",{children:[(0,b.jsx)(E,{color:"var(--privy-color-success-light)"}),(0,b.jsx)(j.default,{height:38,width:38,strokeWidth:2,stroke:"var(--privy-color-success)"})]})}),(0,b.jsx)(o.C,{title:d??`Transaction ${h?"signed":"complete"}!`,description:e??"You're all set."}),(0,b.jsx)(F,{solPrice:g,instruction:i,fees:a,transactionInfo:f,chain:k}),(0,b.jsx)(t.Y,{}),(0,b.jsx)(H,{loading:!1,onClick:c,children:"Close"}),(0,b.jsx)(m.R,{}),(0,b.jsx)(n.B,{})]}),H=(0,k.styled)(l.P).withConfig({displayName:"SubmitButton",componentId:"sc-3cb7ee42-0"})(["&&{margin-top:24px;}transition:color 350ms ease,background-color 350ms ease;"]);async function I(a,b){try{return await a}catch{return b}}async function J({privyClient:a,chain:b,mint:c}){let d=D.D[b];if(!d[c]){let e=await a.getSplTokenMetadata({mintAddress:c,cluster:function(a){switch(a){case"solana:mainnet":return"mainnet-beta";case"solana:devnet":return"devnet";case"solana:testnet":return"testnet"}}(b)});e&&(d[c]={address:c,symbol:e.symbol,decimals:e.decimals})}return d[c]}async function K({tx:a,solanaClient:b,privyClient:c,checkFunds:d}){let e=(0,x.getCompiledTransactionMessageDecoder)().decode((0,C.a)(a)),f=e.staticAccounts[0]??"",g=await (0,C.f)({solanaClient:b,tx:a}),h=d?await I((0,C.s)({solanaClient:b,tx:a})):void 0,i=h?.hasFunds??!0,j={},k=[],l=await async function({solanaClient:a,message:b}){if(!("addressTableLookups"in b)||!b.addressTableLookups)return[...b.staticAccounts];let c=b.addressTableLookups.map(a=>a.lookupTableAddress),d=await B(c,a.rpc),e=c.map((a,c)=>[...b.addressTableLookups[c]?.writableIndexes.map(b=>{let e=d[a]?.[b];if(e)return{key:e,isWritable:!0,altIdx:c}})??[],...b.addressTableLookups[c]?.readonlyIndexes.map(b=>{let e=d[a]?.[b];if(e)return{key:e,isWritable:!1,altIdx:c}})??[]]).flat().filter(a=>!!a).sort((a,b)=>a.isWritable!==b.isWritable?a.isWritable?-1:1:a.altIdx-b.altIdx).map(({key:a})=>a);return[...b.staticAccounts,...e]}({solanaClient:b,message:e});for(let a of e.instructions){let d=e.staticAccounts[a.programAddressIndex]||"";if(d!==D.T&&d!==D.a)if(d!==D.S){if(d===D.A){let b=await I(function(a,b,c){let[d,e,f,g]=a.accountIndices?.map(a=>b[a])??[];return{type:"ata-creation",program:c,payer:d,ata:e,owner:f,mint:g}}(a,l,d));if(!b){k.push({type:"unknown",program:d,discriminator:a.data?.[0]});continue}if(k.push(b),b.ata&&b.owner&&b.mint){j[b.ata]={owner:b.owner,mint:b.mint};continue}}if(D.R.includes(d)){let e=await I(O(a,l,b,c,d));if(!e){k.push({type:"unknown",program:d,discriminator:a.data?.[0]});continue}k.push(e)}else if(D.J.includes(d)){let e=await I(P(a,l,b,c,d));if(!e){k.push({type:"unknown",program:d,discriminator:a.data?.[0]});continue}k.push(e)}else k.push({type:"unknown",program:d,discriminator:a.data?.[0]})}else{let b=await I(N(a,l));if(!b){k.push({type:"unknown",program:d,discriminator:a.data?.[0]});continue}k.push(b)}else{let e=await I(M(a,l,b,c,j,d));if(!e){k.push({type:"unknown",program:d,discriminator:a.data?.[0]});continue}k.push(e),"spl-transfer"===e.type&&(e.fromAta&&e.fromAccount&&e.token.address&&(j[e.fromAta]??={owner:e.fromAccount,mint:e.token.address}),e.toAta&&e.toAccount&&e.token.address&&(j[e.toAta]??={owner:e.toAccount,mint:e.token.address}))}}return{spender:f,fee:g,instructions:k,hasFunds:!!i}}function L(a,b=0){try{return function(a,b=0){let c=0n;for(let d=0;d<8;d++)c|=BigInt(a[b+d])<<BigInt(8*d);return c}(a,b)}catch{}try{return a.readBigInt64LE(b)}catch{}let c=(0,C.b)(a);try{return((a,b=0)=>{let c=a[b],d=a[b+7];if(!c||!d)throw Error(`Buffer offset out of range: first: ${c}, last: ${d}.`);return(BigInt(a[b+4]+256*a[b+5]+65536*a[b+6]+(d<<24))<<32n)+BigInt(c+256*a[++b]+65536*a[++b]+0x1000000*a[++b])})(c)}catch{}try{return c.subarray(b).readBigInt64LE()}catch{}try{return c.readBigInt64LE(b)}catch{}return 0n}async function M(a,b,c,d,e,f){let g=a.data?.[0],h=a.accountIndices?.map(a=>b[a])??[];if(1===g){let[a,b,c]=h;return{type:"spl-init-account",program:f,account:a,mint:b,owner:c}}if(3===g){let b,g,[i,j,k]=h,l="",m=j?e[j]:void 0;if(m)b=m.owner,l=m.mint;else if(j){let a=await c.rpc.getAccountInfo(j,{commitment:"confirmed",encoding:"jsonParsed"}).send(),d=a.value?.data;b=d?.parsed?.info?.owner,l=d?.parsed?.info?.mint??"",g=d?.parsed?.info?.tokenAmount?.decimals}if(!l&&i){let a=await c.rpc.getAccountInfo(i,{commitment:"confirmed",encoding:"jsonParsed"}).send(),b=a.value?.data;l=b?.parsed?.info?.mint??""}let n=await J({privyClient:d,chain:c.chain,mint:l}),o=n?.symbol??"";return g??=n?.decimals??9,{type:"spl-transfer",program:f,fromAta:i,fromAccount:k,toAta:j,toAccount:b,value:L(a.data,1),token:{symbol:o,decimals:g,address:l}}}if(9===g){let[a,b,c]=h;return{type:"spl-close-account",program:f,source:a,destination:b,owner:c}}if(17===g)return{type:"spl-sync-native",program:f};throw Error(`Token program instruction type ${g} not supported`)}async function N(a,b){let c=a.data?.[0],d=a.accountIndices?.map(a=>b[a])??[];if(0===c){let[,b]=d;return{type:"create-account",program:D.S,account:b?.toString(),value:L(a.data,4),withSeed:!1}}if(2===c){let[b,c]=d;return{type:"sol-transfer",program:D.S,fromAccount:b,toAccount:c,token:{symbol:"SOL",decimals:9},value:L(a.data,4),withSeed:!1}}if(3===c){let[,b]=d;return{type:"create-account",program:D.S,account:b,withSeed:!0,value:L(a.data.slice(a.data.length-32-8-8))}}if(11===c){let[b,c]=d;return{type:"sol-transfer",program:D.S,fromAccount:b,toAccount:c,value:L(a.data,4),token:{symbol:"SOL",decimals:9},withSeed:!0}}throw Error(`System program instruction type ${c} not supported`)}async function O(a,b,c,d,e){let f=a.accountIndices?.map(a=>b[a])??[],g=a.data?.[0];if(143===g){let b=f[10],g=f[11];return{type:"raydium-swap-base-input",program:e,mintIn:b,mintOut:g,tokenIn:b?await J({privyClient:d,chain:c.chain,mint:b}):void 0,tokenOut:g?await J({privyClient:d,chain:c.chain,mint:g}):void 0,amountIn:L(a.data,8),minimumAmountOut:L(a.data,16)}}if(55===g){let b=f[10],g=f[11];return{type:"raydium-swap-base-output",program:e,mintIn:b,mintOut:g,tokenIn:b?await J({privyClient:d,chain:c.chain,mint:b}):void 0,tokenOut:g?await J({privyClient:d,chain:c.chain,mint:g}):void 0,maxAmountIn:L(a.data,8),amountOut:L(a.data,16)}}throw Error(`Raydium swap program instruction type ${g} not supported`)}async function P(a,b,c,d,e){let f=a.data?.[0],g=a.accountIndices?.map(a=>b[a])??[];if([208,51,239,151,123,43,237,92].includes(f)){let b=g[5],f=g[6];return{type:"jupiter-swap-exact-out-route",program:e,mintIn:b,mintOut:f,tokenIn:b?await J({privyClient:d,chain:c.chain,mint:b}):void 0,tokenOut:f?await J({privyClient:d,chain:c.chain,mint:f}):void 0,outAmount:L(a.data,a.data.length-1-2-8-8),quotedInAmount:L(a.data,a.data.length-1-2-8)}}if([176,209,105,168,154,125,69,62].includes(f)){let b=g[7],f=g[8];return{type:"jupiter-swap-exact-out-route",program:e,mintIn:b,mintOut:f,tokenIn:b?await J({privyClient:d,chain:c.chain,mint:b}):void 0,tokenOut:f?await J({privyClient:d,chain:c.chain,mint:f}):void 0,outAmount:L(a.data,a.data.length-1-2-8-8),quotedInAmount:L(a.data,a.data.length-1-2-8)}}if([193,32,155,51,65,214,156,129].includes(f)){let b=g[7],f=g[8];return{type:"jupiter-swap-shared-accounts-route",program:e,mintIn:b,mintOut:f,tokenIn:b?await J({privyClient:d,chain:c.chain,mint:b}):void 0,tokenOut:f?await J({privyClient:d,chain:c.chain,mint:f}):void 0,inAmount:L(a.data,a.data.length-1-2-8-8),quotedOutAmount:L(a.data,a.data.length-1-2-8)}}throw[62,198,214,193,213,159,108,210].includes(f)&&console.warn("Jupiter swap program instruction 'claim' not implemented"),[116,206,27,191,166,19,0,73].includes(f)&&console.warn("Jupiter swap program instruction 'claim_token' not implemented"),[26,74,236,151,104,64,183,249].includes(f)&&console.warn("Jupiter swap program instruction 'close_token' not implemented"),[229,194,212,172,8,10,134,147].includes(f)&&console.warn("Jupiter swap program instruction 'create_open_orders' not implemented"),[28,226,32,148,188,136,113,171].includes(f)&&console.warn("Jupiter swap program instruction 'create_program_open_orders' not implemented"),[232,242,197,253,240,143,129,52].includes(f)&&console.warn("Jupiter swap program instruction 'create_token_ledger' not implemented"),[147,241,123,100,244,132,174,118].includes(f)&&console.warn("Jupiter swap program instruction 'create_token_account' not implemented"),[229,23,203,151,122,227,173,42].includes(f)&&console.warn("Jupiter swap program instruction 'route' not implemented"),[150,86,71,116,167,93,14,104].includes(f)&&console.warn("Jupiter swap program instruction 'route_with_token_ledger' not implemented"),[228,85,185,112,78,79,77,2].includes(f)&&console.warn("Jupiter swap program instruction 'set_token_ledger' not implemented"),[230,121,143,80,119,159,106,170].includes(f)&&console.warn("Jupiter swap program instruction 'shared_accounts_route_with_token_ledger' not implemented"),Error(`Jupiter swap program instruction type ${f} not supported`)}let Q={component:()=>{let{data:a,onUserCloseViaDialogOrKeybindRef:j,setModalData:k,navigate:l}=(0,e.a)(),{client:m,closePrivyModal:n,walletProxy:o,showFiatPrices:p}=(0,g.u)(),q=(0,f.u)(),{user:r}=(0,e.u)(),s=(0,C.u)()(a?.standardSignAndSendTransaction?.chain??"solana:mainnet"),[t,A]=(0,c.useState)(a?.standardSignAndSendTransaction?.transaction),[B,E]=(0,c.useState)(),[F,H]=(0,c.useState)(),[I,J]=(0,c.useState)({value:0n,isLoading:!1}),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)({}),[P,Q]=(0,c.useState)(),R=a?.standardSignAndSendTransaction?.account,S=!!a?.standardSignAndSendTransaction?.signOnly,T=R?.imported?(0,e.j)(r).find(a=>a.address===R.address):(0,e.g)(r),{solPrice:U,isSolPriceLoading:V}=(0,h.u)({enabled:p}),W=(0,c.useMemo)(()=>{if(!B)return;let a=B.spender,b=(0,v.g)(B.fee),c=(0,v.g)(I.value,3,!0),e=B.instructions.filter(a=>["sol-transfer","spl-transfer","raydium-swap-base-input","raydium-swap-base-output","jupiter-swap-shared-accounts-route","jupiter-swap-exact-out-route"].includes(a.type)),f=e.at(0);return!f||e.length>1?{fee:b,spender:a,balance:c}:"sol-transfer"===f.type?{fee:b,spender:a,balance:c,total:(0,v.g)(f.value)}:"spl-transfer"===f.type?{fee:b,spender:a,balance:c,total:`${(0,d.formatTokenAmount)({amount:f.value,decimals:f.token.decimals})} ${f.token.symbol}`}:"raydium-swap-base-input"===f.type&&f.tokenIn&&f.tokenOut?{fee:b,spender:a,balance:c,swap:`${(0,d.formatTokenAmount)({amount:f.amountIn,decimals:f.tokenIn.decimals})} ${f.tokenIn.symbol} → ${(0,d.formatTokenAmount)({amount:f.minimumAmountOut,decimals:f.tokenOut.decimals})} ${f.tokenOut.symbol}`}:"raydium-swap-base-output"===f.type&&f.tokenIn&&f.tokenOut?{fee:b,spender:a,balance:c,swap:`${(0,d.formatTokenAmount)({amount:f.maxAmountIn,decimals:f.tokenIn.decimals})} ${f.tokenIn.symbol} → ${(0,d.formatTokenAmount)({amount:f.amountOut,decimals:f.tokenOut.decimals})} ${f.tokenOut.symbol}`}:"jupiter-swap-shared-accounts-route"===f.type&&f.tokenIn&&f.tokenOut?{fee:b,spender:a,balance:c,swap:`${(0,d.formatTokenAmount)({amount:f.inAmount,decimals:f.tokenIn.decimals})} ${f.tokenIn.symbol} → ${(0,d.formatTokenAmount)({amount:f.quotedOutAmount,decimals:f.tokenOut.decimals})} ${f.tokenOut.symbol}`}:"jupiter-swap-exact-out-route"===f.type&&f.tokenIn&&f.tokenOut?{fee:b,spender:a,balance:c,swap:`${(0,d.formatTokenAmount)({amount:f.quotedInAmount,decimals:f.tokenIn.decimals})} ${f.tokenIn.symbol} → ${(0,d.formatTokenAmount)({amount:f.outAmount,decimals:f.tokenOut.decimals})} ${f.tokenOut.symbol}`}:{fee:b,spender:a,balance:c}},[B,R?.address,I]),X=(0,c.useMemo)(()=>{let a;if(!B||!p||!U||V)return;function b(...a){return(0,D.g)(a.reduce((a,b)=>a+b,0n),U??0)}R?.address===B.spender&&(a=b(B.fee));let c=b(I.value),e=B.instructions.filter(a=>"sol-transfer"===a.type||"spl-transfer"===a.type).at(0);return!e||B.instructions.length>1?{fee:a,balance:c}:"sol-transfer"===e.type?{fee:a,balance:c,total:b(e.value,R?.address===B.spender?B.fee:0n)}:"spl-transfer"===e.type?{fee:a,balance:c,total:`${(0,d.formatTokenAmount)({amount:e.value,decimals:e.token.decimals})} ${e.token.symbol}`}:{fee:a,balance:c}},[B,p,U,V,R?.address,I]);if((0,c.useEffect)(()=>{!async function(){if(t&&m)try{H(void 0);let a=await K({tx:t,solanaClient:s,privyClient:m,checkFunds:!S});E(a)}catch(a){console.error("Failed to prepare transaction",a),H(a)}}()},[t,s,m,S]),(0,c.useEffect)(()=>{(async function(){if(!R)return;J({value:I.value,isLoading:!0});let{value:a}=await s.rpc.getBalance(R.address,{commitment:"confirmed"}).send();J({value:a??0n,isLoading:!1})})().catch(console.error)},[B]),!t||!a?.standardSignAndSendTransaction||!R){let c=Error("Invalid transaction request");return(0,b.jsx)(i.ErrorScreenView,{error:c,allowlistConfig:q.allowlistConfig,onRetry:()=>{a?.standardSignAndSendTransaction?.onFailure(c),n({shouldCallAuthOnSuccess:!1})}})}let Y=()=>{if(!L)return N.signature||N.signedTransaction?a?.standardSignAndSendTransaction?.onSuccess({signature:N.signature,signedTransaction:N.signedTransaction}):a?.standardSignAndSendTransaction?.onFailure(P??F??Error("User exited the modal before submitting the transaction")),n({shouldCallAuthOnSuccess:!1})};j.current=Y;let Z=a.standardSignAndSendTransaction?.uiOptions?.transactionInfo?.contractInfo?.imgUrl?(0,b.jsx)("img",{src:a.standardSignAndSendTransaction.uiOptions.transactionInfo.contractInfo.imgUrl,alt:a.standardSignAndSendTransaction.uiOptions.transactionInfo.contractInfo.imgAltText}):null,$=!!(a.funding&&a.funding.supportedOptions.length>0),_=!B?.hasFunds&&$;if(N.signature||N.signedTransaction){let c=B?.instructions.filter(a=>"sol-transfer"===a.type||"spl-transfer"===a.type),d=1===c?.length?c?.at(0):void 0;return(0,b.jsx)(G,{fees:N.fees??0n,onClose:Y,transactionInfo:a.standardSignAndSendTransaction?.uiOptions.transactionInfo,solPrice:U,receiptHeader:a.standardSignAndSendTransaction?.uiOptions.successHeader,receiptDescription:a.standardSignAndSendTransaction?.uiOptions.successDescription,chain:s.chain,signOnly:S,instruction:"sol-transfer"===d?.type?{to:d.toAccount,amount:d.value}:{to:d?.toAccount||d?.toAta,total:W?.total}})}return P?(0,b.jsx)(u.T,{transactionError:P,chainId:s.chain,onClose:Y,chainType:"solana",onRetry:async()=>{Q(void 0);let{value:a}=await s.rpc.getLatestBlockhash().send();A((0,w.pipe)((0,x.getCompiledTransactionMessageDecoder)().decode((0,C.a)(t)),a=>(0,x.decompileTransactionMessage)(a),b=>(0,x.setTransactionMessageLifetimeUsingBlockhash)(a,b),a=>(0,y.compileTransaction)(a),a=>new Uint8Array((0,y.getTransactionEncoder)().encode(a))))}}):(0,b.jsx)(u.a,{img:Z,title:a.standardSignAndSendTransaction?.uiOptions?.transactionInfo?.title||"Confirm transaction",subtitle:a.standardSignAndSendTransaction?.uiOptions?.description||`${q.name} wants your permission to approve the following transaction.`,cta:_?"Add funds":a.standardSignAndSendTransaction?.uiOptions?.buttonText||"Approve",instructions:B?.instructions??[],network:"solana:mainnet"==s.chain?"Solana":s.chain.replace("solana:",""),blockExplorerUrl:s.blockExplorerUrl,total:p?X?.total:W?.total,fee:p?X?.fee:W?.fee,balance:p?X?.balance:W?.balance,swap:W?.swap,transactingWalletAddress:R.address,disabled:!B?.hasFunds&&!$,isSubmitting:L,isPreparing:!B||I.isLoading,isTokenPriceLoading:p&&V,isMissingFunds:!B?.hasFunds,submitError:P??void 0,isSponsored:!!a.standardSignAndSendTransaction?.isSponsored,parseError:F,onClick:_?async()=>{if(!R)return;if(!$)throw Error("Funding wallet is not enabled");let b="FundingMethodSelectionScreen";k({...a,funding:{...a.funding,methodScreen:b},solanaFundingData:a?.solanaFundingData}),l(b)}:async()=>{try{if(M(!0),L||!R||!o||!r||!T)return;let b=await a.standardSignAndSendTransaction.onConfirm(t);if("signature"in b){let a=await async function({solanaClient:a,signature:b}){let c=(0,z.getBase58Decoder)().decode(b),d=await a.rpc.getTransaction(c,{maxSupportedTransactionVersion:0,commitment:"confirmed",encoding:"base64"}).send().catch(()=>null);return d?{fee:d.meta?.fee??0n}:null}({solanaClient:s,signature:b.signature});return void O({...b,fees:a?.fee})}O(b)}catch(a){console.warn({transaction:t,error:a}),Q(a)}finally{M(!1)}},onClose:Y})}};a.s(["StandardSignAndSendTransactionScreen",()=>Q,"default",()=>Q],674404)}];

//# sourceMappingURL=91eee_react-auth_dist_esm_StandardSignAndSendTransactionScreen-CFqthHKF_mjs_647a8547._.js.map
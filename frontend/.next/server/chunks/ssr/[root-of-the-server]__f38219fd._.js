module.exports=[356905,(a,b,c)=>{"use strict";function d(a){if(!Number.isSafeInteger(a)||a<0)throw Error(`positive integer expected, not ${a}`)}function e(a){if("boolean"!=typeof a)throw Error(`boolean expected, not ${a}`)}function f(a){return a instanceof Uint8Array||null!=a&&"object"==typeof a&&"Uint8Array"===a.constructor.name}function g(a,...b){if(!f(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error(`Uint8Array expected of length ${b}, not of length=${a.length}`)}function h(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.wrapConstructor");d(a.outputLen),d(a.blockLen)}function i(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function j(a,b){g(a);let c=b.outputLen;if(a.length<c)throw Error(`digestInto() expects output buffer of length at least ${c}`)}Object.defineProperty(c,"__esModule",{value:!0}),c.output=c.exists=c.hash=c.bytes=c.bool=c.number=c.isBytes=void 0,c.number=d,c.bool=e,c.isBytes=f,c.bytes=g,c.hash=h,c.exists=i,c.output=j,c.default={number:d,bool:e,bytes:g,hash:h,exists:i,output:j}},226021,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.add5L=c.add5H=c.add4H=c.add4L=c.add3H=c.add3L=c.add=c.rotlBL=c.rotlBH=c.rotlSL=c.rotlSH=c.rotr32L=c.rotr32H=c.rotrBL=c.rotrBH=c.rotrSL=c.rotrSH=c.shrSL=c.shrSH=c.toBig=c.split=c.fromBig=void 0;let d=BigInt(0x100000000-1),e=BigInt(32);function f(a,b=!1){return b?{h:Number(a&d),l:Number(a>>e&d)}:{h:0|Number(a>>e&d),l:0|Number(a&d)}}function g(a,b=!1){let c=new Uint32Array(a.length),d=new Uint32Array(a.length);for(let e=0;e<a.length;e++){let{h:g,l:h}=f(a[e],b);[c[e],d[e]]=[g,h]}return[c,d]}c.fromBig=f,c.split=g;let h=(a,b)=>BigInt(a>>>0)<<e|BigInt(b>>>0);c.toBig=h;let i=(a,b,c)=>a>>>c;c.shrSH=i;let j=(a,b,c)=>a<<32-c|b>>>c;c.shrSL=j;let k=(a,b,c)=>a>>>c|b<<32-c;c.rotrSH=k;let l=(a,b,c)=>a<<32-c|b>>>c;c.rotrSL=l;let m=(a,b,c)=>a<<64-c|b>>>c-32;c.rotrBH=m;let o=(a,b,c)=>a>>>c-32|b<<64-c;c.rotrBL=o;let p=(a,b)=>b;c.rotr32H=p;let q=(a,b)=>a;c.rotr32L=q;let r=(a,b,c)=>a<<c|b>>>32-c;c.rotlSH=r;let s=(a,b,c)=>b<<c|a>>>32-c;c.rotlSL=s;let t=(a,b,c)=>b<<c-32|a>>>64-c;c.rotlBH=t;let u=(a,b,c)=>a<<c-32|b>>>64-c;function v(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}c.rotlBL=u,c.add=v;let w=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0);c.add3L=w;let x=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0;c.add3H=x;let y=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0);c.add4L=y;let z=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0;c.add4H=z;let A=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0);c.add5L=A;let B=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0;c.add5H=B,c.default={fromBig:f,split:g,toBig:h,shrSH:i,shrSL:j,rotrSH:k,rotrSL:l,rotrBH:m,rotrBL:o,rotr32H:p,rotr32L:q,rotlSH:r,rotlSL:s,rotlBH:t,rotlBL:u,add:v,add3L:w,add3H:x,add4L:y,add4H:z,add5H:B,add5L:A}},903542,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.crypto=void 0;let d=a.r(666680);c.crypto=d&&"object"==typeof d&&"webcrypto"in d?d.webcrypto:void 0},571420,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.randomBytes=c.wrapXOFConstructorWithOpts=c.wrapConstructorWithOpts=c.wrapConstructor=c.checkOpts=c.Hash=c.concatBytes=c.toBytes=c.utf8ToBytes=c.asyncLoop=c.nextTick=c.hexToBytes=c.bytesToHex=c.byteSwap32=c.byteSwapIfBE=c.byteSwap=c.isLE=c.rotl=c.rotr=c.createView=c.u32=c.u8=c.isBytes=void 0;let d=a.r(903542),e=a.r(356905);c.isBytes=function(a){return a instanceof Uint8Array||null!=a&&"object"==typeof a&&"Uint8Array"===a.constructor.name},c.u8=a=>new Uint8Array(a.buffer,a.byteOffset,a.byteLength),c.u32=a=>new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)),c.createView=a=>new DataView(a.buffer,a.byteOffset,a.byteLength),c.rotr=(a,b)=>a<<32-b|a>>>b,c.rotl=(a,b)=>a<<b|a>>>32-b>>>0,c.isLE=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0],c.byteSwap=a=>a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255,c.byteSwapIfBE=c.isLE?a=>a:a=>(0,c.byteSwap)(a),c.byteSwap32=function(a){for(let b=0;b<a.length;b++)a[b]=(0,c.byteSwap)(a[b])};let f=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));c.bytesToHex=function(a){(0,e.bytes)(a);let b="";for(let c=0;c<a.length;c++)b+=f[a[c]];return b};function g(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}async function h(a,b,d){let e=Date.now();for(let f=0;f<a;f++){d(f);let a=Date.now()-e;a>=0&&a<b||(await (0,c.nextTick)(),e+=a)}}function i(a){if("string"!=typeof a)throw Error(`utf8ToBytes expected string, got ${typeof a}`);return new Uint8Array(new TextEncoder().encode(a))}function j(a){return"string"==typeof a&&(a=i(a)),(0,e.bytes)(a),a}c.hexToBytes=function(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);let b=a.length,c=b/2;if(b%2)throw Error("padded hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=g(a.charCodeAt(e)),f=g(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d},c.nextTick=async()=>{},c.asyncLoop=h,c.utf8ToBytes=i,c.toBytes=j,c.concatBytes=function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];(0,e.bytes)(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c},c.Hash=class{clone(){return this._cloneInto()}};let k={}.toString;c.checkOpts=function(a,b){if(void 0!==b&&"[object Object]"!==k.call(b))throw Error("Options should be object or undefined");return Object.assign(a,b)},c.wrapConstructor=function(a){let b=b=>a().update(j(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b},c.wrapConstructorWithOpts=function(a){let b=(b,c)=>a(c).update(j(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b},c.wrapXOFConstructorWithOpts=function(a){let b=(b,c)=>a(c).update(j(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b},c.randomBytes=function(a=32){if(d.crypto&&"function"==typeof d.crypto.getRandomValues)return d.crypto.getRandomValues(new Uint8Array(a));throw Error("crypto.getRandomValues must be defined")}},21968,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.shake256=c.shake128=c.keccak_512=c.keccak_384=c.keccak_256=c.keccak_224=c.sha3_512=c.sha3_384=c.sha3_256=c.sha3_224=c.Keccak=c.keccakP=void 0;let d=a.r(356905),e=a.r(226021),f=a.r(571420),g=[],h=[],i=[],j=BigInt(0),k=BigInt(1),l=BigInt(2),m=BigInt(7),o=BigInt(256),p=BigInt(113);for(let a=0,b=k,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],g.push(2*(5*d+c)),h.push((a+1)*(a+2)/2%64);let e=j;for(let a=0;a<7;a++)(b=(b<<k^(b>>m)*p)%o)&l&&(e^=k<<(k<<BigInt(a))-k);i.push(e)}let[q,r]=(0,e.split)(i,!0),s=(a,b,c)=>c>32?(0,e.rotlBH)(a,b,c):(0,e.rotlSH)(a,b,c),t=(a,b,c)=>c>32?(0,e.rotlBL)(a,b,c):(0,e.rotlSL)(a,b,c);function u(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=s(f,g,1)^c[d],i=t(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=h[c],f=s(b,e,d),i=t(b,e,d),j=g[c];b=a[j],e=a[j+1],a[j]=f,a[j+1]=i}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=q[d],a[1]^=r[d]}c.fill(0)}c.keccakP=u;class v extends f.Hash{constructor(a,b,c,e=!1,g=24){if(super(),this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=e,this.rounds=g,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,d.number)(c),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,f.u32)(this.state)}keccak(){f.isLE||(0,f.byteSwap32)(this.state32),u(this.state32,this.rounds),f.isLE||(0,f.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(a){(0,d.exists)(this);let{blockLen:b,state:c}=this,e=(a=(0,f.toBytes)(a)).length;for(let d=0;d<e;){let f=Math.min(b-this.pos,e-d);for(let b=0;b<f;b++)c[this.pos++]^=a[d++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){(0,d.exists)(this,!1),(0,d.bytes)(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return(0,d.number)(a),this.xofInto(new Uint8Array(a))}digestInto(a){if((0,d.output)(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new v(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}c.Keccak=v;let w=(a,b,c)=>(0,f.wrapConstructor)(()=>new v(b,a,c));c.sha3_224=w(6,144,28),c.sha3_256=w(6,136,32),c.sha3_384=w(6,104,48),c.sha3_512=w(6,72,64),c.keccak_224=w(1,144,28),c.keccak_256=w(1,136,32),c.keccak_384=w(1,104,48),c.keccak_512=w(1,72,64);let x=(a,b,c)=>(0,f.wrapXOFConstructorWithOpts)((d={})=>new v(b,a,void 0===d.dkLen?c:d.dkLen,!0));c.shake128=x(31,168,16),c.shake256=x(31,136,32)},779220,(a,b,c)=>{let{keccak_256:d}=a.r(21968);function e(a){return Buffer.allocUnsafe(a).fill(0)}function f(a,b){let c=a.toString(16);c.length%2!=0&&(c="0"+c);let d=c.match(/.{1,2}/g).map(a=>parseInt(a,16));for(;d.length<b;)d.unshift(0);return Buffer.from(d)}function g(a,b,c){let d=e(b);return(a=h(a),c)?a.length<b?(a.copy(d),d):a.slice(0,b):a.length<b?(a.copy(d,b-a.length),d):a.slice(-b)}function h(a){if(!Buffer.isBuffer(a))if(Array.isArray(a))a=Buffer.from(a);else if("string"==typeof a){var b;a=i(a)?Buffer.from((b=j(a)).length%2?"0"+b:b,"hex"):Buffer.from(a)}else if("number"==typeof a)a=intToBuffer(a);else if(null==a)a=Buffer.allocUnsafe(0);else if("bigint"==typeof a)a=f(a);else if(a.toArray)a=Buffer.from(a.toArray());else throw Error("invalid type");return a}function i(a){return"string"==typeof a&&a.match(/^0x[0-9A-Fa-f]*$/)}function j(a){return"string"==typeof a&&a.startsWith("0x")?a.slice(2):a}b.exports={zeros:e,setLength:g,setLengthRight:function(a,b){return g(a,b,!0)},isHexString:i,stripHexPrefix:j,toBuffer:h,bufferToHex:function(a){return"0x"+(a=h(a)).toString("hex")},keccak:function(a,b){if(a=h(a),b||(b=256),256!==b)throw Error("unsupported");return Buffer.from(d(new Uint8Array(a)))},bitLengthFromBigInt:function(a){return a.toString(2).length},bufferBEFromBigInt:f,twosFromBigInt:function(a,b){return(a<0n?(~a&(1n<<BigInt(b))-1n)+1n:a)&(1n<<BigInt(b))-1n}}},525799,(a,b,c)=>{let d=a.r(779220);function e(a){if(a.startsWith("int["))return"int256"+a.slice(3);if("int"===a)return"int256";if(a.startsWith("uint["))return"uint256"+a.slice(4);if("uint"===a)return"uint256";if(a.startsWith("fixed["))return"fixed128x128"+a.slice(5);else if("fixed"===a)return"fixed128x128";else if(a.startsWith("ufixed["))return"ufixed128x128"+a.slice(6);else if("ufixed"===a)return"ufixed128x128";return a}function f(a){return Number.parseInt(/^\D+(\d+)$/.exec(a)[1],10)}function g(a){var b=/^\D+(\d+)x(\d+)$/.exec(a);return[Number.parseInt(b[1],10),Number.parseInt(b[2],10)]}function h(a){var b=a.match(/(.*)\[(.*?)\]$/);return b?""===b[2]?"dynamic":Number.parseInt(b[2],10):null}function i(a){var b=typeof a;if("string"===b||"number"===b)return BigInt(a);if("bigint"===b)return a;throw Error("Argument is not a number")}function j(a,b){if("address"===a)return j("uint160",i(b));if("bool"===a)return j("uint8",+!!b);if("string"===a)return j("bytes",new Buffer(b,"utf8"));if((m=a).lastIndexOf("]")===m.length-1){if(void 0===b.length)throw Error("Not an array?");if("dynamic"!==(c=h(a))&&0!==c&&b.length>c)throw Error("Elements exceed array size: "+c);for(l in k=[],a=a.slice(0,a.lastIndexOf("[")),"string"==typeof b&&(b=JSON.parse(b)),b)k.push(j(a,b[l]));if("dynamic"===c){var c,e,k,l,m,o=j("uint256",b.length);k.unshift(o)}return Buffer.concat(k)}else if("bytes"===a)return b=new Buffer(b),k=Buffer.concat([j("uint256",b.length),b]),b.length%32!=0&&(k=Buffer.concat([k,d.zeros(32-b.length%32)])),k;else if(a.startsWith("bytes")){if((c=f(a))<1||c>32)throw Error("Invalid bytes<N> width: "+c);return d.setLengthRight(b,32)}else if(a.startsWith("uint")){if((c=f(a))%8||c<8||c>256)throw Error("Invalid uint<N> width: "+c);e=i(b);let g=d.bitLengthFromBigInt(e);if(g>c)throw Error("Supplied uint exceeds width: "+c+" vs "+g);if(e<0)throw Error("Supplied uint is negative");return d.bufferBEFromBigInt(e,32)}else if(a.startsWith("int")){if((c=f(a))%8||c<8||c>256)throw Error("Invalid int<N> width: "+c);e=i(b);let g=d.bitLengthFromBigInt(e);if(g>c)throw Error("Supplied int exceeds width: "+c+" vs "+g);let h=d.twosFromBigInt(e,256);return d.bufferBEFromBigInt(h,32)}else if(a.startsWith("ufixed")){if(c=g(a),(e=i(b))<0)throw Error("Supplied ufixed is negative");return j("uint256",e*BigInt(2)**BigInt(c[1]))}else if(a.startsWith("fixed"))return c=g(a),j("int256",i(b)*BigInt(2)**BigInt(c[1]));throw Error("Unsupported or invalid type: "+a)}function k(a,b){if(a.length!==b.length)throw Error("Number of types are not matching the values");for(var c,g,h=[],j=0;j<a.length;j++){var k=e(a[j]),l=b[j];if("bytes"===k)h.push(l);else if("string"===k)h.push(new Buffer(l,"utf8"));else if("bool"===k)h.push(new Buffer(l?"01":"00","hex"));else if("address"===k)h.push(d.setLength(l,20));else if(k.startsWith("bytes")){if((c=f(k))<1||c>32)throw Error("Invalid bytes<N> width: "+c);h.push(d.setLengthRight(l,c))}else if(k.startsWith("uint")){if((c=f(k))%8||c<8||c>256)throw Error("Invalid uint<N> width: "+c);g=i(l);let a=d.bitLengthFromBigInt(g);if(a>c)throw Error("Supplied uint exceeds width: "+c+" vs "+a);h.push(d.bufferBEFromBigInt(g,c/8))}else if(k.startsWith("int")){if((c=f(k))%8||c<8||c>256)throw Error("Invalid int<N> width: "+c);g=i(l);let a=d.bitLengthFromBigInt(g);if(a>c)throw Error("Supplied int exceeds width: "+c+" vs "+a);let b=d.twosFromBigInt(g,c);h.push(d.bufferBEFromBigInt(b,c/8))}else throw Error("Unsupported or invalid type: "+k)}return Buffer.concat(h)}b.exports={rawEncode:function(a,b){var c=[],d=[],f=32*a.length;for(var g in a){var i=e(a[g]),k=j(i,b[g]);"string"===i||"bytes"===i||"dynamic"===h(i)?(c.push(j("uint256",f)),d.push(k),f+=k.length):c.push(k)}return Buffer.concat(c.concat(d))},solidityPack:k,soliditySHA3:function(a,b){return d.keccak(k(a,b))}}},449105,(a,b,c)=>{let d=a.r(779220),e=a.r(525799),f={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},g={encodeData(a,b,c,f=!0){let g=["bytes32"],h=[this.hashType(a,c)];if(f){let i=(a,b,g)=>{if(void 0!==c[b])return["bytes32",null==g?"0x0000000000000000000000000000000000000000000000000000000000000000":d.keccak(this.encodeData(b,g,c,f))];if(void 0===g)throw Error(`missing value for field ${a} of type ${b}`);if("bytes"===b)return["bytes32",d.keccak(g)];if("string"===b)return"string"==typeof g&&(g=Buffer.from(g,"utf8")),["bytes32",d.keccak(g)];if(b.lastIndexOf("]")===b.length-1){let c=b.slice(0,b.lastIndexOf("[")),f=g.map(b=>i(a,c,b));return["bytes32",d.keccak(e.rawEncode(f.map(([a])=>a),f.map(([,a])=>a)))]}return[b,g]};for(let d of c[a]){let[a,c]=i(d.name,d.type,b[d.name]);g.push(a),h.push(c)}}else for(let e of c[a]){let a=b[e.name];if(void 0!==a)if("bytes"===e.type)g.push("bytes32"),a=d.keccak(a),h.push(a);else if("string"===e.type)g.push("bytes32"),"string"==typeof a&&(a=Buffer.from(a,"utf8")),a=d.keccak(a),h.push(a);else if(void 0!==c[e.type])g.push("bytes32"),a=d.keccak(this.encodeData(e.type,a,c,f)),h.push(a);else if(e.type.lastIndexOf("]")===e.type.length-1)throw Error("Arrays currently unimplemented in encodeData");else g.push(e.type),h.push(a)}return e.rawEncode(g,h)},encodeType(a,b){let c="",d=this.findTypeDependencies(a,b).filter(b=>b!==a);for(let e of d=[a].concat(d.sort())){if(!b[e])throw Error("No type definition specified: "+e);c+=e+"("+b[e].map(({name:a,type:b})=>b+" "+a).join(",")+")"}return c},findTypeDependencies(a,b,c=[]){if(a=a.match(/^\w*/)[0],c.includes(a)||void 0===b[a])return c;for(let d of(c.push(a),b[a]))for(let a of this.findTypeDependencies(d.type,b,c))c.includes(a)||c.push(a);return c},hashStruct(a,b,c,e=!0){return d.keccak(this.encodeData(a,b,c,e))},hashType(a,b){return d.keccak(this.encodeType(a,b))},sanitizeData(a){let b={};for(let c in f.properties)a[c]&&(b[c]=a[c]);return b.types&&(b.types=Object.assign({EIP712Domain:[]},b.types)),b},hash(a,b=!0){let c=this.sanitizeData(a),e=[Buffer.from("1901","hex")];return e.push(this.hashStruct("EIP712Domain",c.domain,c.types,b)),"EIP712Domain"!==c.primaryType&&e.push(this.hashStruct(c.primaryType,c.message,c.types,b)),d.keccak(Buffer.concat(e))}};b.exports={TYPED_MESSAGE_SCHEMA:f,TypedDataUtils:g,hashForSignTypedDataLegacy:function(a){return function(a){let b=Error("Expect argument to be non-empty array");if("object"!=typeof a||!a.length)throw b;let c=a.map(function(a){return"bytes"===a.type?d.toBuffer(a.value):a.value}),f=a.map(function(a){return a.type}),g=a.map(function(a){if(!a.name)throw b;return a.type+" "+a.name});return e.soliditySHA3(["bytes32","bytes32"],[e.soliditySHA3(Array(a.length).fill("string"),g),e.soliditySHA3(f,c)])}(a.data)},hashForSignTypedData_v3:function(a){return g.hash(a.data,!1)},hashForSignTypedData_v4:function(a){return g.hash(a.data)}}},879425,(a,b,c)=>{"use strict";var d=Object.prototype.hasOwnProperty,e="~";function f(){}function g(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function h(a,b,c,d,f){if("function"!=typeof c)throw TypeError("The listener must be a function");var h=new g(c,d||a,f),i=e?e+b:b;return a._events[i]?a._events[i].fn?a._events[i]=[a._events[i],h]:a._events[i].push(h):(a._events[i]=h,a._eventsCount++),a}function i(a,b){0==--a._eventsCount?a._events=new f:delete a._events[b]}function j(){this._events=new f,this._eventsCount=0}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(e=!1)),j.prototype.eventNames=function(){var a,b,c=[];if(0===this._eventsCount)return c;for(b in a=this._events)d.call(a,b)&&c.push(e?b.slice(1):b);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(a)):c},j.prototype.listeners=function(a){var b=e?e+a:a,c=this._events[b];if(!c)return[];if(c.fn)return[c.fn];for(var d=0,f=c.length,g=Array(f);d<f;d++)g[d]=c[d].fn;return g},j.prototype.listenerCount=function(a){var b=e?e+a:a,c=this._events[b];return c?c.fn?1:c.length:0},j.prototype.emit=function(a,b,c,d,f,g){var h=e?e+a:a;if(!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if(k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,c),!0;case 4:return k.fn.call(k.context,b,c,d),!0;case 5:return k.fn.call(k.context,b,c,d,f),!0;case 6:return k.fn.call(k.context,b,c,d,f,g),!0}for(j=1,i=Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,o=k.length;for(j=0;j<o;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,c);break;case 4:k[j].fn.call(k[j].context,b,c,d);break;default:if(!i)for(m=1,i=Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},j.prototype.on=function(a,b,c){return h(this,a,b,c,!1)},j.prototype.once=function(a,b,c){return h(this,a,b,c,!0)},j.prototype.removeListener=function(a,b,c,d){var f=e?e+a:a;if(!this._events[f])return this;if(!b)return i(this,f),this;var g=this._events[f];if(g.fn)g.fn!==b||d&&!g.once||c&&g.context!==c||i(this,f);else{for(var h=0,j=[],k=g.length;h<k;h++)(g[h].fn!==b||d&&!g[h].once||c&&g[h].context!==c)&&j.push(g[h]);j.length?this._events[f]=1===j.length?j[0]:j:i(this,f)}return this},j.prototype.removeAllListeners=function(a){var b;return a?(b=e?e+a:a,this._events[b]&&i(this,b)):(this._events=new f,this._eventsCount=0),this},j.prototype.off=j.prototype.removeListener,j.prototype.addListener=j.prototype.on,j.prefixed=e,j.EventEmitter=j,b.exports=j},467658,(a,b,c)=>{"use strict";var d=a.r(572131),e="function"==typeof Object.is?Object.is:function(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},f=d.useSyncExternalStore,g=d.useRef,h=d.useEffect,i=d.useMemo,j=d.useDebugValue;c.useSyncExternalStoreWithSelector=function(a,b,c,d,k){var l=g(null);if(null===l.current){var m={hasValue:!1,value:null};l.current=m}else m=l.current;var o=f(a,(l=i(function(){function a(a){if(!h){if(h=!0,f=a,a=d(a),void 0!==k&&m.hasValue){var b=m.value;if(k(b,a))return g=b}return g=a}if(b=g,e(f,a))return b;var c=d(a);return void 0!==k&&k(b,c)?(f=a,b):(f=a,g=c)}var f,g,h=!1,i=void 0===c?null:c;return[function(){return a(b())},null===i?void 0:function(){return a(i())}]},[b,c,d,k]))[0],l[1]);return h(function(){m.hasValue=!0,m.value=o},[o]),j(o),o}},332473,(a,b,c)=>{"use strict";b.exports=a.r(467658)},903874,(a,b,c)=>{"use strict";function d(a,b){return b}b.exports=function(){let a=Error.prepareStackTrace;Error.prepareStackTrace=d;let b=Error().stack;if(Error.prepareStackTrace=a,!Array.isArray(b))return;let c=b.slice(2),e=[];for(let a of c)a&&e.push(a.getFileName());return e}},194346,a=>{a.v({name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"})},261044,(a,b,c)=>{"use strict";b.exports={wait:function(a,b,c,d,e){let f=Date.now()+d,g=Atomics.load(a,b);if(g===c)return void e(null,"ok");let h=g,i=d=>{Date.now()>f?e(null,"timed-out"):setTimeout(()=>{h=g,(g=Atomics.load(a,b))===h?i(d>=1e3?1e3:2*d):g===c?e(null,"ok"):e(null,"not-equal")},d)};i(1)},waitDiff:function(a,b,c,d,e){let f=Date.now()+d,g=Atomics.load(a,b);if(g!==c)return void e(null,"ok");let h=d=>{Date.now()>f?e(null,"timed-out"):setTimeout(()=>{(g=Atomics.load(a,b))!==c?e(null,"ok"):h(d>=1e3?1e3:2*d)},d)};h(1)}}},475067,(a,b,c)=>{"use strict";b.exports={WRITE_INDEX:4,READ_INDEX:8}},505222,(a,b,c)=>{"use strict";let{version:d}=a.r(194346),{EventEmitter:e}=a.r(427699),{Worker:f}=a.r(37702),{join:g}=a.r(814747),{pathToFileURL:h}=a.r(792509),{wait:i}=a.r(261044),{WRITE_INDEX:j,READ_INDEX:k}=a.r(475067),l=a.r(500874),m=a.r(449719),o=Symbol("kImpl"),p=l.constants.MAX_STRING_LENGTH;class q{constructor(a){this._value=a}deref(){return this._value}}class r{register(){}unregister(){}}let s=process.env.NODE_V8_COVERAGE?r:a.g.FinalizationRegistry||r,t=process.env.NODE_V8_COVERAGE?q:a.g.WeakRef||q,u=new s(a=>{a.exited||a.terminate()});function v(a){m(!a[o].sync),a[o].needDrain&&(a[o].needDrain=!1,a.emit("drain"))}function w(a){let b=Atomics.load(a[o].state,j),c=a[o].data.length-b;if(c>0){if(0===a[o].buf.length){a[o].flushing=!1,a[o].ending?C(a):a[o].needDrain&&process.nextTick(v,a);return}let b=a[o].buf.slice(0,c),d=Buffer.byteLength(b);d<=c?(a[o].buf=a[o].buf.slice(c),B(a,b,w.bind(null,a))):a.flush(()=>{if(!a.destroyed){for(Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0);d>a[o].data.length;)c/=2,b=a[o].buf.slice(0,c),d=Buffer.byteLength(b);a[o].buf=a[o].buf.slice(c),B(a,b,w.bind(null,a))}})}else if(0===c){if(0===b&&0===a[o].buf.length)return;a.flush(()=>{Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0),w(a)})}else A(a,Error("overwritten"))}function x(a){let b=this.stream.deref();if(void 0===b){this.exited=!0,this.terminate();return}switch(a.code){case"READY":this.stream=new t(b),b.flush(()=>{b[o].ready=!0,b.emit("ready")});break;case"ERROR":A(b,a.err);break;case"EVENT":Array.isArray(a.args)?b.emit(a.name,...a.args):b.emit(a.name,a.args);break;case"WARNING":process.emitWarning(a.err);break;default:A(b,Error("this should not happen: "+a.code))}}function y(a){let b=this.stream.deref();void 0!==b&&(u.unregister(b),b.worker.exited=!0,b.worker.off("exit",y),A(b,0!==a?Error("the worker thread exited"):null))}function z(a,b){setImmediate(()=>{a.emit("error",b)})}function A(a,b){a[o].destroyed||(a[o].destroyed=!0,b&&(a[o].errored=b,z(a,b)),a.worker.exited?setImmediate(()=>{a[o].closed=!0,a.emit("close")}):a.worker.terminate().catch(()=>{}).then(()=>{a[o].closed=!0,a.emit("close")}))}function B(a,b,c){let d=Atomics.load(a[o].state,j),e=Buffer.byteLength(b);return a[o].data.write(b,d),Atomics.store(a[o].state,j,d+e),Atomics.notify(a[o].state,j),c(),!0}function C(a){if(!a[o].ended&&a[o].ending&&!a[o].flushing){a[o].ended=!0;try{a.flushSync();let b=Atomics.load(a[o].state,k);Atomics.store(a[o].state,j,-1),Atomics.notify(a[o].state,j);let c=0;for(;-1!==b;){if(Atomics.wait(a[o].state,k,b,1e3),b=Atomics.load(a[o].state,k),-2===b)return void A(a,Error("end() failed"));if(10==++c)return void A(a,Error("end() took too long (10s)"))}process.nextTick(()=>{a[o].finished=!0,a.emit("finish")})}catch(b){A(a,b)}}}function D(a){let b=()=>{a[o].ending?C(a):a[o].needDrain&&process.nextTick(v,a)};for(a[o].flushing=!1;0!==a[o].buf.length;){let c=Atomics.load(a[o].state,j),d=a[o].data.length-c;if(0===d){E(a),Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0);continue}if(d<0)throw Error("overwritten");let e=a[o].buf.slice(0,d),f=Buffer.byteLength(e);if(f<=d)a[o].buf=a[o].buf.slice(d),B(a,e,b);else{for(E(a),Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0);f>a[o].buf.length;)d/=2,e=a[o].buf.slice(0,d),f=Buffer.byteLength(e);a[o].buf=a[o].buf.slice(d),B(a,e,b)}}}function E(a){if(a[o].flushing)throw Error("unable to flush while flushing");let b=Atomics.load(a[o].state,j),c=0;for(;;){let d=Atomics.load(a[o].state,k);if(-2===d)throw Error("_flushSync failed");if(d!==b)Atomics.wait(a[o].state,k,d,1e3);else break;if(10==++c)throw Error("_flushSync took too long (10s)")}}b.exports=class extends e{constructor(a={}){if(super(),a.bufferSize<4)throw Error("bufferSize must at least fit a 4-byte utf-8 char");this[o]={},this[o].stateBuf=new SharedArrayBuffer(128),this[o].state=new Int32Array(this[o].stateBuf),this[o].dataBuf=new SharedArrayBuffer(a.bufferSize||4194304),this[o].data=Buffer.from(this[o].dataBuf),this[o].sync=a.sync||!1,this[o].ending=!1,this[o].ended=!1,this[o].needDrain=!1,this[o].destroyed=!1,this[o].flushing=!1,this[o].ready=!1,this[o].finished=!1,this[o].errored=null,this[o].closed=!1,this[o].buf="",this.worker=function(a,b){let{filename:c,workerData:e}=b,i=new f(("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||g("/ROOT/node_modules/thread-stream","lib","worker.js"),{...b.workerOpts,trackUnmanagedFds:!1,workerData:{filename:0===c.indexOf("file://")?c:h(c).href,dataBuf:a[o].dataBuf,stateBuf:a[o].stateBuf,workerData:{$context:{threadStreamVersion:d},...e}}});return i.stream=new q(a),i.on("message",x),i.on("exit",y),u.register(a,i),i}(this,a),this.on("message",(a,b)=>{this.worker.postMessage(a,b)})}write(a){if(this[o].destroyed)return z(this,Error("the worker has exited")),!1;if(this[o].ending)return z(this,Error("the worker is ending")),!1;if(this[o].flushing&&this[o].buf.length+a.length>=p)try{D(this),this[o].flushing=!0}catch(a){return A(this,a),!1}if(this[o].buf+=a,this[o].sync)try{return D(this),!0}catch(a){return A(this,a),!1}return this[o].flushing||(this[o].flushing=!0,setImmediate(w,this)),this[o].needDrain=this[o].data.length-this[o].buf.length-Atomics.load(this[o].state,j)<=0,!this[o].needDrain}end(){this[o].destroyed||(this[o].ending=!0,C(this))}flush(a){if(this[o].destroyed){"function"==typeof a&&process.nextTick(a,Error("the worker has exited"));return}let b=Atomics.load(this[o].state,j);i(this[o].state,k,b,1/0,(b,c)=>{if(b){A(this,b),process.nextTick(a,b);return}"not-equal"===c?this.flush(a):process.nextTick(a)})}flushSync(){this[o].destroyed||(D(this),E(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[o].ready}get destroyed(){return this[o].destroyed}get closed(){return this[o].closed}get writable(){return!this[o].destroyed&&!this[o].ending}get writableEnded(){return this[o].ending}get writableFinished(){return this[o].finished}get writableNeedDrain(){return this[o].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[o].errored}}},47325,(a,b,c)=>{"use strict";let{createRequire:d}=a.r(362562),e=a.r(903874),{join:f,isAbsolute:g,sep:h}=a.r(750227),i=a.r(327959),j=a.r(360012),k=a.r(505222);function l(a){a.ref(),a.flushSync(),a.end(),a.once("close",function(){a.unref()})}function m(a){a.flushSync()}b.exports=function(a){let{pipeline:b,targets:c,levels:o,dedupe:p,worker:q={},caller:r=e(),sync:s=!1}=a,t={...a.options},u="string"==typeof r?[r]:r,v="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},w=a.target;if(w&&c)throw Error("only one of target or targets can be specified");c?(w=v["pino-worker"]||f("/ROOT/node_modules/pino/lib","worker.js"),t.targets=c.filter(a=>a.target).map(a=>({...a,target:z(a.target)})),t.pipelines=c.filter(a=>a.pipeline).map(a=>a.pipeline.map(b=>({...b,level:a.level,target:z(b.target)})))):b&&(w=v["pino-worker"]||f("/ROOT/node_modules/pino/lib","worker.js"),t.pipelines=[b.map(a=>({...a,target:z(a.target)}))]),o&&(t.levels=o),p&&(t.dedupe=p),t.pinoWillSendConfig=!0;let x=new k({filename:z(w),workerData:t,workerOpts:q,sync:s});function y(){x.closed||(x.flushSync(),i(100),x.end())}return x.on("ready",function(){process.removeListener("exit",y),x.unref(),!1!==q.autoEnd&&(j.register(x,l),j.registerBeforeExit(x,m),x.on("close",function(){j.unregister(x)}))}),x.on("close",function(){process.removeListener("exit",y)}),process.on("exit",y),x;function z(a){let b;if(g(a=v[a]||a)||0===a.indexOf("file://"))return a;if("pino/file"===a)return f("/ROOT/node_modules/pino/lib","..","file.js");for(let c of u)try{let e="node:repl"===c?process.cwd()+h:c;b=d(e).resolve(a);break}catch(a){continue}if(!b)throw Error(`unable to determine transport target for "${a}"`);return b}}},311500,(a,b,c)=>{b.exports={DEFAULT_LEVELS:{trace:10,debug:20,info:30,warn:40,error:50,fatal:60},SORTING_ORDER:{ASC:"ASC",DESC:"DESC"}}},688454,(a,b,c)=>{"use strict";let d=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:e}=a.r(311500),f=e.info;function g(a,b){return a.level-b.level}b.exports=function(a,b){a=a||[],b=b||{dedupe:!1};let c=Object.create(e);c.silent=1/0,b.levels&&"object"==typeof b.levels&&Object.keys(b.levels).forEach(a=>{c[a]=b.levels[a]});let h={write:i,add:l,remove:m,emit:j,flushSync:k,end:function(){for(let{stream:a}of this.streams)"function"==typeof a.flushSync&&a.flushSync(),a.end()},minLevel:0,lastId:0,streams:[],clone:function a(b){let c=Array(this.streams.length);for(let a=0;a<c.length;a++)c[a]={level:b,stream:this.streams[a].stream};return{write:i,add:l,remove:m,minLevel:b,streams:c,clone:a,emit:j,flushSync:k,[d]:!0}},[d]:!0,streamLevels:c};return Array.isArray(a)?a.forEach(l,h):l.call(h,a),a=null,h;function i(a){var c,e,f,g;let h,i,j=this.lastLevel,{streams:k}=this,l=0;for(let m=(c=k.length,b.dedupe?c-1:0);e=m,f=k.length,b.dedupe?e>=0:e<f;g=m,m=b.dedupe?g-1:g+1)if((h=k[m]).level<=j){if(0!==l&&l!==h.level)break;if((i=h.stream)[d]){let{lastTime:a,lastMsg:b,lastObj:c,lastLogger:d}=this;i.lastLevel=j,i.lastTime=a,i.lastMsg=b,i.lastObj=c,i.lastLogger=d}i.write(a),b.dedupe&&(l=h.level)}else if(!b.dedupe)break}function j(...a){for(let{stream:b}of this.streams)"function"==typeof b.emit&&b.emit(...a)}function k(){for(let{stream:a}of this.streams)"function"==typeof a.flushSync&&a.flushSync()}function l(a){if(!a)return h;let b="function"==typeof a.write||a.stream,c=a.write?a:a.stream;if(!b)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:d,streamLevels:e}=this,i={stream:c,level:"number"==typeof a.levelVal?a.levelVal:"string"==typeof a.level?e[a.level]:"number"==typeof a.level?a.level:f,levelVal:void 0,id:++h.lastId};return d.unshift(i),d.sort(g),this.minLevel=d[0].level,h}function m(a){let{streams:b}=this,c=b.findIndex(b=>b.id===a);return c>=0&&(b.splice(c,1),b.sort(g),this.minLevel=b.length>0?b[0].level:-1),h}}},660526,(a,b,c)=>{b.exports=a.x("node:os",()=>require("node:os"))},577905,(a,b,c)=>{"use strict";let d=a=>a&&"string"==typeof a.message,e=a=>{if(!a)return;let b=a.cause;if("function"!=typeof b)return d(b)?b:void 0;{let b=a.cause();return d(b)?b:void 0}},f=(a,b)=>{if(!d(a))return"";let c=a.stack||"";if(b.has(a))return c+"\ncauses have become circular...";let g=e(a);return g?(b.add(a),c+"\ncaused by: "+f(g,b)):c},g=(a,b,c)=>{if(!d(a))return"";let f=c?"":a.message||"";if(b.has(a))return f+": ...";let h=e(a);if(!h)return f;{b.add(a);let c="function"==typeof a.cause;return f+(c?"":": ")+g(h,b,c)}};b.exports={isErrorLike:d,getErrorCause:e,stackWithCauses:a=>f(a,new Set),messageWithCauses:a=>g(a,new Set)}},445115,(a,b,c)=>{"use strict";let d=Symbol("circular-ref-tag"),e=Symbol("pino-raw-err-ref"),f=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[e]},set:function(a){this[e]=a}}});Object.defineProperty(f,e,{writable:!0,value:{}}),b.exports={pinoErrProto:f,pinoErrorSymbols:{seen:d,rawSymbol:e}}},566653,(a,b,c)=>{"use strict";b.exports=function a(b){if(!f(b))return b;b[i]=void 0;let c=Object.create(g);for(let g in c.type="[object Function]"===j.call(b.constructor)?b.constructor.name:b.name,c.message=d(b),c.stack=e(b),Array.isArray(b.errors)&&(c.aggregateErrors=b.errors.map(b=>a(b))),b)if(void 0===c[g]){let d=b[g];f(d)?"cause"===g||Object.prototype.hasOwnProperty.call(d,i)||(c[g]=a(d)):c[g]=d}return delete b[i],c.raw=b,c};let{messageWithCauses:d,stackWithCauses:e,isErrorLike:f}=a.r(577905),{pinoErrProto:g,pinoErrorSymbols:h}=a.r(445115),{seen:i}=h,{toString:j}=Object.prototype},145446,(a,b,c)=>{"use strict";b.exports=function a(b){if(!d(b))return b;b[g]=void 0;let c=Object.create(e);for(let e in c.type="[object Function]"===h.call(b.constructor)?b.constructor.name:b.name,c.message=b.message,c.stack=b.stack,Array.isArray(b.errors)&&(c.aggregateErrors=b.errors.map(b=>a(b))),d(b.cause)&&!Object.prototype.hasOwnProperty.call(b.cause,g)&&(c.cause=a(b.cause)),b)if(void 0===c[e]){let f=b[e];d(f)?Object.prototype.hasOwnProperty.call(f,g)||(c[e]=a(f)):c[e]=f}return delete b[g],c.raw=b,c};let{isErrorLike:d}=a.r(577905),{pinoErrProto:e,pinoErrorSymbols:f}=a.r(445115),{seen:g}=f,{toString:h}=Object.prototype},919067,(a,b,c)=>{"use strict";b.exports={mapHttpRequest:function(a){return{req:f(a)}},reqSerializer:f};let d=Symbol("pino-raw-req-ref"),e=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[d]},set:function(a){this[d]=a}}});function f(a){let b=a.info||a.socket,c=Object.create(e);if(c.id="function"==typeof a.id?a.id():a.id||(a.info?a.info.id:void 0),c.method=a.method,a.originalUrl)c.url=a.originalUrl;else{let b=a.path;c.url="string"==typeof b?b:a.url?a.url.path||a.url:void 0}return a.query&&(c.query=a.query),a.params&&(c.params=a.params),c.headers=a.headers,c.remoteAddress=b&&b.remoteAddress,c.remotePort=b&&b.remotePort,c.raw=a.raw||a,c}Object.defineProperty(e,d,{writable:!0,value:{}})},510139,(a,b,c)=>{"use strict";b.exports={mapHttpResponse:function(a){return{res:f(a)}},resSerializer:f};let d=Symbol("pino-raw-res-ref"),e=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[d]},set:function(a){this[d]=a}}});function f(a){let b=Object.create(e);return b.statusCode=a.headersSent?a.statusCode:null,b.headers=a.getHeaders?a.getHeaders():a._headers,b.raw=a,b}Object.defineProperty(e,d,{writable:!0,value:{}})},631046,(a,b,c)=>{"use strict";let d=a.r(566653),e=a.r(145446),f=a.r(919067),g=a.r(510139);b.exports={err:d,errWithCause:e,mapHttpRequest:f.mapHttpRequest,mapHttpResponse:g.mapHttpResponse,req:f.reqSerializer,res:g.resSerializer,wrapErrorSerializer:function(a){return a===d?a:function(b){return a(d(b))}},wrapRequestSerializer:function(a){return a===f.reqSerializer?a:function(b){return a(f.reqSerializer(b))}},wrapResponseSerializer:function(a){return a===g.resSerializer?a:function(b){return a(g.resSerializer(b))}}}},480202,(a,b,c)=>{"use strict";function d(a){let b=[],c="",d=!1,e=!1,f="";for(let g=0;g<a.length;g++){let h=a[g];d||"."!==h?"["===h?(c&&(b.push(c),c=""),d=!0):"]"===h&&d?(b.push(c),c="",d=!1,e=!1):('"'===h||"'"===h)&&d?e?h===f?(e=!1,f=""):c+=h:(e=!0,f=h):c+=h:c&&(b.push(c),c="")}return c&&b.push(c),b}function e(a,b,c){let d=a;for(let a=0;a<b.length-1;a++){let c=b[a];if("object"!=typeof d||null===d||!(c in d)||"object"!=typeof d[c]||null===d[c])return!1;d=d[c]}let e=b[b.length-1];if("*"===e){if(Array.isArray(d))for(let a=0;a<d.length;a++)d[a]=c;else if("object"==typeof d&&null!==d)for(let a in d)Object.prototype.hasOwnProperty.call(d,a)&&(d[a]=c)}else"object"==typeof d&&null!==d&&e in d&&Object.prototype.hasOwnProperty.call(d,e)&&(d[e]=c);return!0}function f(a,b){let c=a;for(let a=0;a<b.length-1;a++){let d=b[a];if("object"!=typeof c||null===c||!(d in c)||"object"!=typeof c[d]||null===c[d])return!1;c=c[d]}let d=b[b.length-1];if("*"===d){if(Array.isArray(c))for(let a=0;a<c.length;a++)c[a]=void 0;else if("object"==typeof c&&null!==c)for(let a in c)Object.prototype.hasOwnProperty.call(c,a)&&delete c[a]}else"object"==typeof c&&null!==c&&d in c&&Object.prototype.hasOwnProperty.call(c,d)&&delete c[d];return!0}let g=Symbol("PATH_NOT_FOUND");b.exports=function(a={}){let{paths:b=[],censor:c="[REDACTED]",serialize:h=JSON.stringify,strict:i=!0,remove:j=!1}=a;if(!Array.isArray(b))throw TypeError("paths must be an array");for(let a of b)!function(a){if("string"!=typeof a)throw Error("Paths must be (non-empty) strings");if(""===a)throw Error("Invalid redaction path ()");if(a.includes("..")||a.includes(","))throw Error(`Invalid redaction path (${a})`);let b=0,c=!1,d="";for(let e=0;e<a.length;e++){let f=a[e];if(('"'===f||"'"===f)&&b>0)c?f===d&&(c=!1,d=""):(c=!0,d=f);else if("["!==f||c){if("]"===f&&!c&&--b<0)throw Error(`Invalid redaction path (${a})`)}else b++}if(0!==b)throw Error(`Invalid redaction path (${a})`)}(a);let k=function(a){if(0===a.length)return null;let b=new Map;for(let c of a){let a=d(c),e=b;for(let b=0;b<a.length;b++){let c=a[b];e.has(c)||e.set(c,new Map),e=e.get(c)}}return b}(b);return function(a){if(i&&(null===a||"object"!=typeof a)&&(null==a||"object"!=typeof a))return h?h(a):a;let l=k?function a(b,c,d=0){if(!c||0===c.size||null===b||"object"!=typeof b)return b;if(b instanceof Date)return new Date(b.getTime());if(Array.isArray(b)){let d=[];for(let e=0;e<b.length;e++){let f=e.toString();c.has(f)||c.has("*")?d[e]=a(b[e],c.get(f)||c.get("*")):d[e]=b[e]}return d}let e=Object.create(Object.getPrototypeOf(b));for(let d in b)Object.prototype.hasOwnProperty.call(b,d)&&(c.has(d)||c.has("*")?e[d]=a(b[d],c.get(d)||c.get("*")):e[d]=b[d]);return e}(a,k):a,m=c;return("function"==typeof c&&(m=c),!function(a,b,c,h=!1){for(let i of b){let b=d(i);if(b.includes("*"))!function a(b,c,d,g,h=!1){let i=c.indexOf("*");if(i===c.length-1){let a=c.slice(0,-1),e=b;for(let b of a){if(null==e||"object"!=typeof e||null===e)return;e=e[b]}if(Array.isArray(e))if(h)for(let a=0;a<e.length;a++)e[a]=void 0;else for(let b=0;b<e.length;b++){let c=[...a,b.toString()],f="function"==typeof d?d(e[b],c):d;e[b]=f}else if("object"==typeof e&&null!==e)if(h){let a=[];for(let b in e)Object.prototype.hasOwnProperty.call(e,b)&&a.push(b);for(let b of a)delete e[b]}else for(let b in e){let c=[...a,b],f="function"==typeof d?d(e[b],c):d;e[b]=f}}else!function(b,c,d,g,h,i=!1){let j=c.slice(0,g),k=c.slice(g+1),l=[];function m(b,c){if(c===j.length){if(Array.isArray(b))for(let a=0;a<b.length;a++)l[c]=a.toString(),m(b[a],c+1);else if("object"==typeof b&&null!==b)for(let a in b)l[c]=a,m(b[a],c+1)}else if(c<j.length){let a=j[c];b&&"object"==typeof b&&null!==b&&a in b&&(l[c]=a,m(b[a],c+1))}else if(k.includes("*"))a(b,k,"function"==typeof d?(a,b)=>d(a,[...l.slice(0,c),...b]):d,h,i);else if(i)f(b,k);else{let a="function"==typeof d?d(function(a,b){let c=a;for(let a of b){if(null==c||"object"!=typeof c||null===c)return;c=c[a]}return c}(b,k),[...l.slice(0,c),...k]):d;e(b,k,a)}}if(0===j.length)m(b,0);else{let a=b;for(let b=0;b<j.length;b++){let c=j[b];if(null==a||"object"!=typeof a||null===a)return;a=a[c],l[b]=c}null!=a&&m(a,j.length)}}(b,c,d,i,g,h)}(a,b,c,i,h);else if(h)f(a,b);else{let d=function(a,b){let c=a;for(let a of b){if(null==c||"object"!=typeof c||null===c||!(a in c))return g;c=c[a]}return c}(a,b);if(d===g)continue;let f="function"==typeof c?c(d,b):c;e(a,b,f)}}}(l,b,m,j),!1===h)?(l.restore=function(){return function a(b){if(null===b||"object"!=typeof b)return b;if(b instanceof Date)return new Date(b.getTime());if(b instanceof Array){let c=[];for(let d=0;d<b.length;d++)c[d]=a(b[d]);return c}if("object"==typeof b){let c=Object.create(Object.getPrototypeOf(b));for(let d in b)Object.prototype.hasOwnProperty.call(b,d)&&(c[d]=a(b[d]));return c}return b}(a)},l):"function"==typeof h?h(l):JSON.stringify(l)}}},889275,(a,b,c)=>{"use strict";let d=Symbol("pino.setLevel"),e=Symbol("pino.getLevel"),f=Symbol("pino.levelVal"),g=Symbol("pino.levelComp"),h=Symbol("pino.useLevelLabels"),i=Symbol("pino.useOnlyCustomLevels"),j=Symbol("pino.mixin"),k=Symbol("pino.lsCache"),l=Symbol("pino.chindings"),m=Symbol("pino.asJson"),o=Symbol("pino.write"),p=Symbol("pino.redactFmt"),q=Symbol("pino.time"),r=Symbol("pino.timeSliceIndex"),s=Symbol("pino.stream"),t=Symbol("pino.stringify"),u=Symbol("pino.stringifySafe"),v=Symbol("pino.stringifiers"),w=Symbol("pino.end"),x=Symbol("pino.formatOpts"),y=Symbol("pino.messageKey"),z=Symbol("pino.errorKey"),A=Symbol("pino.nestedKey"),B=Symbol("pino.nestedKeyStr"),C=Symbol("pino.mixinMergeStrategy"),D=Symbol("pino.msgPrefix"),E=Symbol("pino.wildcardFirst"),F=Symbol.for("pino.serializers"),G=Symbol.for("pino.formatters"),H=Symbol.for("pino.hooks");b.exports={setLevelSym:d,getLevelSym:e,levelValSym:f,levelCompSym:g,useLevelLabelsSym:h,mixinSym:j,lsCacheSym:k,chindingsSym:l,asJsonSym:m,writeSym:o,serializersSym:F,redactFmtSym:p,timeSym:q,timeSliceIndexSym:r,streamSym:s,stringifySym:t,stringifySafeSym:u,stringifiersSym:v,endSym:w,formatOptsSym:x,messageKeySym:y,errorKeySym:z,nestedKeySym:A,wildcardFirstSym:E,needsMetadataGsym:Symbol.for("pino.metadata"),useOnlyCustomLevelsSym:i,formattersSym:G,hooksSym:H,nestedKeyStrSym:B,mixinMergeStrategySym:C,msgPrefixSym:D}},986234,(a,b,c)=>{"use strict";let d=a.r(480202),{redactFmtSym:e,wildcardFirstSym:f}=a.r(889275),g=/[^.[\]]+|\[([^[\]]*?)\]/g,h="[Redacted]";b.exports=function(a,b){let{paths:c,censor:i,remove:j}=function(a){if(Array.isArray(a))return{paths:a,censor:h};let{paths:b,censor:c=h,remove:d}=a;if(!1===Array.isArray(b))throw Error("pino â€“ redact must contain an array of strings");return!0===d&&(c=void 0),{paths:b,censor:c,remove:d}}(a),k=c.reduce((a,b)=>{g.lastIndex=0;let c=g.exec(b),d=g.exec(b),e=void 0!==c[1]?c[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):c[0];if("*"===e&&(e=f),null===d)return a[e]=null,a;if(null===a[e])return a;let{index:h}=d,i=`${b.substr(h,b.length-1)}`;return a[e]=a[e]||[],e!==f&&0===a[e].length&&a[e].push(...a[f]||[]),e===f&&Object.keys(a).forEach(function(b){a[b]&&a[b].push(i)}),a[e].push(i),a},{}),l={[e]:d({paths:c,censor:i,serialize:b,strict:!1,remove:j})};return[...Object.keys(k),...Object.getOwnPropertySymbols(k)].reduce((a,c)=>{if(null===k[c])a[c]=a=>((...a)=>"function"==typeof i?b(i(...a)):b(i))(a,[c]);else{let e="function"==typeof i?(a,b)=>i(a,[c,...b]):i;a[c]=d({paths:k[c],censor:e,serialize:b,strict:!1,remove:j})}return a},l)}},362344,(a,b,c)=>{"use strict";let d=1000000n*BigInt(Date.now()),e=process.hrtime.bigint();b.exports={nullTime:()=>"",epochTime:()=>`,"time":${Date.now()}`,unixTime:()=>`,"time":${Math.round(Date.now()/1e3)}`,isoTime:()=>`,"time":"${new Date(Date.now()).toISOString()}"`,isoTimeNano:()=>{let a=d+(process.hrtime.bigint()-e),b=a%1000000000n,c=new Date(Number(a/1000000000n*1000n+b/1000000n)),f=c.getUTCFullYear(),g=(c.getUTCMonth()+1).toString().padStart(2,"0"),h=c.getUTCDate().toString().padStart(2,"0"),i=c.getUTCHours().toString().padStart(2,"0"),j=c.getUTCMinutes().toString().padStart(2,"0"),k=c.getUTCSeconds().toString().padStart(2,"0");return`,"time":"${f}-${g}-${h}T${i}:${j}:${k}.${b.toString().padStart(9,"0")}Z"`}}},687769,(a,b,c)=>{b.exports=a.x("node:events",()=>require("node:events"))},677652,(a,b,c)=>{b.exports=a.x("node:diagnostics_channel",()=>require("node:diagnostics_channel"))},474359,(a,b,c)=>{"use strict";let d=a.r(522734),e=a.r(427699),f=a.r(224361).inherits,g=a.r(814747),h=a.r(327959),i=a.r(449719),j=Buffer.allocUnsafe(0),k="buffer",l="utf8",[m,o]=(process.versions.node||"0.0").split(".").map(Number),p=m>=22&&o>=7;function q(a,b){function c(c,d){if(c){b._reopening=!1,b._writing=!1,b._opening=!1,b.sync?process.nextTick(()=>{b.listenerCount("error")>0&&b.emit("error",c)}):b.emit("error",c);return}let e=b._reopening;b.fd=d,b.file=a,b._reopening=!1,b._opening=!1,b._writing=!1,b.sync?process.nextTick(()=>b.emit("ready")):b.emit("ready"),!b.destroyed&&(!b._writing&&b._len>b.minLength||b._flushPending?b._actualWrite():e&&process.nextTick(()=>b.emit("drain")))}b._opening=!0,b._writing=!0,b._asyncDrainScheduled=!1;let e=b.append?"a":"w",f=b.mode;if(b.sync)try{b.mkdir&&d.mkdirSync(g.dirname(a),{recursive:!0});let h=d.openSync(a,e,f);c(null,h)}catch(a){throw c(a),a}else b.mkdir?d.mkdir(g.dirname(a),{recursive:!0},b=>{if(b)return c(b);d.open(a,e,f,c)}):d.open(a,e,f,c)}function r(a){let b,c;if(!(this instanceof r))return new r(a);let{fd:e,dest:f,minLength:g,maxLength:i,maxWrite:m,periodicFlush:o,sync:p,append:u=!0,mkdir:x,retryEAGAIN:F,fsync:G,contentMode:H,mode:I}=a||{};if(e=e||f,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(g||0,16387),this.file=null,this.destroyed=!1,this.minLength=g||0,this.maxLength=i||0,this.maxWrite=m||16384,this._periodicFlush=o||0,this._periodicFlushTimer=void 0,this.sync=p||!1,this.writable=!0,this._fsync=G||!1,this.append=u||!1,this.mode=I,this.retryEAGAIN=F||(()=>!0),this.mkdir=x||!1,H===k)this._writingBuf=j,this.write=w,this.flush=z,this.flushSync=B,this._actualWrite=D,b=()=>d.writeSync(this.fd,this._writingBuf),c=()=>d.write(this.fd,this._writingBuf,this.release);else if(void 0===H||H===l)this._writingBuf="",this.write=v,this.flush=y,this.flushSync=A,this._actualWrite=C,b=()=>d.writeSync(this.fd,this._writingBuf,"utf8"),c=()=>d.write(this.fd,this._writingBuf,"utf8",this.release);else throw Error(`SonicBoom supports "${l}" and "${k}", but passed ${H}`);if("number"==typeof e)this.fd=e,process.nextTick(()=>this.emit("ready"));else if("string"==typeof e)q(e,this);else throw Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(a,e)=>{if(a){if(("EAGAIN"===a.code||"EBUSY"===a.code)&&this.retryEAGAIN(a,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{h(100),this.release(void 0,0)}catch(a){this.release(a)}else setTimeout(c,100);else this._writing=!1,this.emit("error",a);return}this.emit("write",e);let f=s(this._writingBuf,this._len,e);if(this._len=f.len,this._writingBuf=f.writingBuf,this._writingBuf.length){if(!this.sync)return void c();try{do{let a=b(),c=s(this._writingBuf,this._len,a);this._len=c.len,this._writingBuf=c.writingBuf}while(this._writingBuf.length)}catch(a){this.release(a);return}}this._fsync&&d.fsyncSync(this.fd);let g=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):g>this.minLength?this._actualWrite():this._ending?g>0?this._actualWrite():(this._writing=!1,E(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(t,this)):this.emit("drain"))},this.on("newListener",function(a){"drain"===a&&(this._asyncDrainScheduled=!1)}),0!==this._periodicFlush&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function s(a,b,c){return"string"==typeof a&&Buffer.byteLength(a)!==c&&(c=Buffer.from(a).subarray(0,c).toString().length),b=Math.max(b-c,0),{writingBuf:a=a.slice(c),len:b}}function t(a){a.listenerCount("drain")>0&&(a._asyncDrainScheduled=!1,a.emit("drain"))}function u(a,b){return 0===a.length?j:1===a.length?a[0]:Buffer.concat(a,b)}function v(a){if(this.destroyed)throw Error("SonicBoom destroyed");let b=this._len+a.length,c=this._bufs;return this.maxLength&&b>this.maxLength?this.emit("drop",a):(0===c.length||c[c.length-1].length+a.length>this.maxWrite?c.push(""+a):c[c.length-1]+=a,this._len=b,!this._writing&&this._len>=this.minLength&&this._actualWrite()),this._len<this._hwm}function w(a){if(this.destroyed)throw Error("SonicBoom destroyed");let b=this._len+a.length,c=this._bufs,d=this._lens;return this.maxLength&&b>this.maxLength?this.emit("drop",a):(0===c.length||d[d.length-1]+a.length>this.maxWrite?(c.push([a]),d.push(a.length)):(c[c.length-1].push(a),d[d.length-1]+=a.length),this._len=b,!this._writing&&this._len>=this.minLength&&this._actualWrite()),this._len<this._hwm}function x(a){this._flushPending=!0;let b=()=>{if(this._fsync)this._flushPending=!1,a();else try{d.fsync(this.fd,b=>{this._flushPending=!1,a(b)})}catch(b){a(b)}this.off("error",c)},c=c=>{this._flushPending=!1,a(c),this.off("drain",b)};this.once("drain",b),this.once("error",c)}function y(a){if(null!=a&&"function"!=typeof a)throw Error("flush cb must be a function");if(this.destroyed){let b=Error("SonicBoom destroyed");if(a)return void a(b);throw b}this.minLength<=0?a?.():(a&&x.call(this,a),this._writing||(0===this._bufs.length&&this._bufs.push(""),this._actualWrite()))}function z(a){if(null!=a&&"function"!=typeof a)throw Error("flush cb must be a function");if(this.destroyed){let b=Error("SonicBoom destroyed");if(a)return void a(b);throw b}this.minLength<=0?a?.():(a&&x.call(this,a),this._writing||(0===this._bufs.length&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite()))}function A(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this.fd<0)throw Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let a="";for(;this._bufs.length||a;){a.length<=0&&(a=this._bufs[0]);try{let b=d.writeSync(this.fd,a,"utf8"),c=s(a,this._len,b);a=c.writingBuf,this._len=c.len,a.length<=0&&this._bufs.shift()}catch(b){if(("EAGAIN"===b.code||"EBUSY"===b.code)&&!this.retryEAGAIN(b,a.length,this._len-a.length))throw b;h(100)}}try{d.fsyncSync(this.fd)}catch{}}function B(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this.fd<0)throw Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=j);let a=j;for(;this._bufs.length||a.length;){a.length<=0&&(a=u(this._bufs[0],this._lens[0]));try{let b=d.writeSync(this.fd,a);a=a.subarray(b),this._len=Math.max(this._len-b,0),a.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(b){if(("EAGAIN"===b.code||"EBUSY"===b.code)&&!this.retryEAGAIN(b,a.length,this._len-a.length))throw b;h(100)}}}function C(){let a=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let b=d.writeSync(this.fd,this._writingBuf,"utf8");a(null,b)}catch(b){a(b)}else d.write(this.fd,this._writingBuf,"utf8",a)}function D(){let a=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:u(this._bufs.shift(),this._lens.shift()),this.sync)try{let b=d.writeSync(this.fd,this._writingBuf);a(null,b)}catch(b){a(b)}else p&&(this._writingBuf=Buffer.from(this._writingBuf)),d.write(this.fd,this._writingBuf,a)}function E(a){if(-1===a.fd)return void a.once("ready",E.bind(null,a));void 0!==a._periodicFlushTimer&&clearInterval(a._periodicFlushTimer),a.destroyed=!0,a._bufs=[],a._lens=[],i("number"==typeof a.fd,`sonic.fd must be a number, got ${typeof a.fd}`);try{d.fsync(a.fd,function(){1!==a.fd&&2!==a.fd?d.close(a.fd,b):b()})}catch{}function b(b){b?a.emit("error",b):(a._ending&&!a._writing&&a.emit("finish"),a.emit("close"))}}f(r,e),r.prototype.reopen=function(a){if(this.destroyed)throw Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.reopen(a)});if(this._ending)return;if(!this.file)throw Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(a&&(this.file=a),this._reopening=!0,this._writing)return;let b=this.fd;this.once("ready",()=>{b!==this.fd&&d.close(b,a=>{if(a)return this.emit("error",a)})}),q(this.file,this)},r.prototype.end=function(){if(this.destroyed)throw Error("SonicBoom destroyed");this._opening?this.once("ready",()=>{this.end()}):this._ending||(this._ending=!0,this._writing||(this._len>0&&this.fd>=0?this._actualWrite():E(this)))},r.prototype.destroy=function(){this.destroyed||E(this)},r.SonicBoom=r,r.default=r,b.exports=r},89357,(a,b,c)=>{"use strict";let d=a.r(677652),e=a.r(250643),{mapHttpRequest:f,mapHttpResponse:g}=a.r(631046),h=a.r(474359),i=a.r(360012),{lsCacheSym:j,chindingsSym:k,writeSym:l,serializersSym:m,formatOptsSym:o,endSym:p,stringifiersSym:q,stringifySym:r,stringifySafeSym:s,wildcardFirstSym:t,nestedKeySym:u,formattersSym:v,messageKeySym:w,errorKeySym:x,nestedKeyStrSym:y,msgPrefixSym:z}=a.r(889275),{isMainThread:A}=a.r(37702),B=a.r(47325),C=d.tracingChannel("pino_asJson");function D(){}function E(a){let b="",c=0,d=!1,e=255,f=a.length;if(f>100)return JSON.stringify(a);for(var g=0;g<f&&e>=32;g++)(34===(e=a.charCodeAt(g))||92===e)&&(b+=a.slice(c,g)+"\\",c=g,d=!0);return d?b+=a.slice(c):b=a,e<32?JSON.stringify(a):'"'+b+'"'}function F(a,b,c,d){let e,f=this[r],g=this[s],h=this[q],i=this[p],l=this[k],o=this[m],z=this[v],A=this[w],B=this[x],C=this[j][c]+d;C+=l,z.log&&(a=z.log(a));let D=h[t],F="";for(let b in a)if(e=a[b],Object.prototype.hasOwnProperty.call(a,b)&&void 0!==e){o[b]?e=o[b](e):b===B&&o.err&&(e=o.err(e));let a=h[b]||D;switch(typeof e){case"undefined":case"function":continue;case"number":!1===Number.isFinite(e)&&(e=null);case"boolean":a&&(e=a(e));break;case"string":e=(a||E)(e);break;default:e=(a||f)(e,g)}if(void 0===e)continue;F+=","+E(b)+":"+e}let G="";if(void 0!==b){e=o[A]?o[A](b):b;let a=h[A]||D;switch(typeof e){case"function":break;case"number":!1===Number.isFinite(e)&&(e=null);case"boolean":a&&(e=a(e)),G=',"'+A+'":'+e;break;case"string":G=',"'+A+'":'+(e=(a||E)(e));break;default:G=',"'+A+'":'+(e=(a||f)(e,g))}}return this[u]&&F?C+this[y]+F.slice(1)+"}"+G+i:C+F+G+i}function G(a){let b=new h(a);return b.on("error",function a(c){if("EPIPE"===c.code){b.write=D,b.end=D,b.flushSync=D,b.destroy=D;return}b.removeListener("error",a),b.emit("error",c)}),!a.sync&&A&&(i.register(b,H),b.on("close",function(){i.unregister(b)})),b}function H(a,b){a.destroyed||("beforeExit"===b?(a.flush(),a.on("drain",function(){a.end()})):a.flushSync())}b.exports={noop:D,buildSafeSonicBoom:G,asChindings:function(a,b){let c,d=a[k],e=a[r],f=a[s],g=a[q],h=g[t],i=a[m];for(let j in b=(0,a[v].bindings)(b))if(c=b[j],!0===((j.length<5||"level"!==j&&"serializers"!==j&&"formatters"!==j&&"customLevels"!==j)&&b.hasOwnProperty(j)&&void 0!==c)){if(c=i[j]?i[j](c):c,void 0===(c=(g[j]||h||e)(c,f)))continue;d+=',"'+j+'":'+c}return d},asJson:function(a,b,c,d){return!1===C.hasSubscribers?F.call(this,a,b,c,d):C.traceSync(F,{instance:this,arguments},this,a,b,c,d)},genLog:function(a,b){if(!b)return c;return function(...d){b.call(this,d,c,a)};function c(b,...d){if("object"==typeof b){let c,h=b;null!==b&&(b.method&&b.headers&&b.socket?b=f(b):"function"==typeof b.setHeader&&(b=g(b))),null===h&&0===d.length?c=[null]:(h=d.shift(),c=d),"string"==typeof this[z]&&null!=h&&(h=this[z]+h),this[l](b,e(h,c,this[o]),a)}else{let c=void 0===b?d.shift():b;"string"==typeof this[z]&&null!=c&&(c=this[z]+c),this[l](null,e(c,d,this[o]),a)}}},createArgsNormalizer:function(a){return function(b,c,d={},e){if("string"==typeof d)e=G({dest:d}),d={};else if("string"==typeof e){if(d&&d.transport)throw Error("only one of option.transport or stream can be specified");e=G({dest:e})}else if(d instanceof h||d.writable||d._writableState)e=d,d={};else if(d.transport){let a;if(d.transport instanceof h||d.transport.writable||d.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(d.transport.targets&&d.transport.targets.length&&d.formatters&&"function"==typeof d.formatters.level)throw Error("option.transport.targets do not allow custom level formatters");d.customLevels&&(a=d.useOnlyCustomLevels?d.customLevels:Object.assign({},d.levels,d.customLevels)),e=B({caller:c,...d.transport,levels:a})}if((d=Object.assign({},a,d)).serializers=Object.assign({},a.serializers,d.serializers),d.formatters=Object.assign({},a.formatters,d.formatters),d.prettyPrint)throw Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:f,onChild:g}=d;if(!1===f&&(d.level="silent"),g||(d.onChild=D),!e){var i;e=(i=process.stdout).write!==i.constructor.prototype.write?process.stdout:G({fd:process.stdout.fd||1})}return{opts:d,stream:e}}},stringify:function(a,b){try{return JSON.stringify(a)}catch(c){try{return(b||this[s])(a)}catch(a){return'"[unable to serialize, circular reference is too complex to analyze]"'}}},buildFormatters:function(a,b,c){return{level:a,bindings:b,log:c}},normalizeDestFileDescriptor:function(a){let b=Number(a);return"string"==typeof a&&Number.isFinite(b)?b:void 0===a?1:a}}},292204,(a,b,c)=>{"use strict";let{lsCacheSym:d,levelValSym:e,useOnlyCustomLevelsSym:f,streamSym:g,formattersSym:h,hooksSym:i,levelCompSym:j}=a.r(889275),{noop:k,genLog:l}=a.r(89357),{DEFAULT_LEVELS:m,SORTING_ORDER:o}=a.r(311500),p={fatal:a=>{let b=l(m.fatal,a);return function(...a){let c=this[g];if(b.call(this,...a),"function"==typeof c.flushSync)try{c.flushSync()}catch(a){}}},error:a=>l(m.error,a),warn:a=>l(m.warn,a),info:a=>l(m.info,a),debug:a=>l(m.debug,a),trace:a=>l(m.trace,a)},q=Object.keys(m).reduce((a,b)=>(a[m[b]]=b,a),{});function r(a,b,c){return a===o.DESC?b<=c:b>=c}b.exports={initialLsCache:Object.keys(q).reduce((a,b)=>(a[b]='{"level":'+Number(b),a),{}),genLsCache:function(a){let b=a[h].level,{labels:c}=a.levels,e={};for(let a in c){let d=b(c[a],Number(a));e[a]=JSON.stringify(d).slice(0,-1)}return a[d]=e,a},levelMethods:p,getLevel:function(a){let{levels:b,levelVal:c}=this;return b&&b.labels?b.labels[c]:""},setLevel:function(a){let{labels:b,values:c}=this.levels;if("number"==typeof a){if(void 0===b[a])throw Error("unknown level value"+a);a=b[a]}if(void 0===c[a])throw Error("unknown level "+a);let d=this[e],g=this[e]=c[a],h=this[f],m=this[j],o=this[i].logMethod;for(let a in c){if(!1===m(c[a],g)){this[a]=k;continue}this[a]=!function(a,b){if(b)return!1;switch(a){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}(a,h)?l(c[a],o):p[a](o)}this.emit("level-change",a,g,b[d],d,this)},isLevelEnabled:function(a){let{values:b}=this.levels,c=b[a];return void 0!==c&&this[j](c,this[e])},mappings:function(a=null,b=!1){let c=a?Object.keys(a).reduce((b,c)=>(b[a[c]]=c,b),{}):null;return{labels:Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),b?null:q,c),values:Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),b?null:m,a)}},assertNoLevelCollisions:function(a,b){let{labels:c,values:d}=a;for(let a in b){if(a in d)throw Error("levels cannot be overridden");if(b[a]in c)throw Error("pre-existing level values cannot be used for new levels")}},assertDefaultLevelFound:function(a,b,c){if("number"==typeof a){if(![].concat(Object.keys(b||{}).map(a=>b[a]),c?[]:Object.keys(q).map(a=>+a),1/0).includes(a))throw Error(`default level:${a} must be included in custom levels`);return}if(!(a in Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),c?null:m,b)))throw Error(`default level:${a} must be included in custom levels`)},genLevelComparison:function(a){return"string"==typeof a?r.bind(null,a):a},assertLevelComparison:function(a){if("function"!=typeof a&&!("string"==typeof a&&Object.values(o).includes(a)))throw Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}}},349478,(a,b,c)=>{"use strict";b.exports={version:"10.0.0"}},603693,(a,b,c)=>{"use strict";let{EventEmitter:d}=a.r(687769),{lsCacheSym:e,levelValSym:f,setLevelSym:g,getLevelSym:h,chindingsSym:i,parsedChindingsSym:j,mixinSym:k,asJsonSym:l,writeSym:m,mixinMergeStrategySym:o,timeSym:p,timeSliceIndexSym:q,streamSym:r,serializersSym:s,formattersSym:t,errorKeySym:u,messageKeySym:v,useOnlyCustomLevelsSym:w,needsMetadataGsym:x,redactFmtSym:y,stringifySym:z,formatOptsSym:A,stringifiersSym:B,msgPrefixSym:C,hooksSym:D}=a.r(889275),{getLevel:E,setLevel:F,isLevelEnabled:G,mappings:H,initialLsCache:I,genLsCache:J,assertNoLevelCollisions:K}=a.r(292204),{asChindings:L,asJson:M,buildFormatters:N,stringify:O,noop:P}=a.r(89357),{version:Q}=a.r(349478),R=a.r(986234),S={constructor:class{},child:function(a,b){if(!a)throw Error("missing bindings for child Pino");let c=this[s],d=this[t],e=Object.create(this);if(null==b)return e[t].bindings!==T&&(e[t]=N(d.level,T,d.log)),e[i]=L(e,a),this.onChild!==P&&this.onChild(e),e;if(!0===b.hasOwnProperty("serializers")){for(let a in e[s]=Object.create(null),c)e[s][a]=c[a];let a=Object.getOwnPropertySymbols(c);for(var f=0;f<a.length;f++){let b=a[f];e[s][b]=c[b]}for(let a in b.serializers)e[s][a]=b.serializers[a];let d=Object.getOwnPropertySymbols(b.serializers);for(var h=0;h<d.length;h++){let a=d[h];e[s][a]=b.serializers[a]}}else e[s]=c;if(b.hasOwnProperty("formatters")){let{level:a,bindings:c,log:f}=b.formatters;e[t]=N(a||d.level,c||T,f||d.log)}else e[t]=N(d.level,T,d.log);if(!0===b.hasOwnProperty("customLevels")&&(K(this.levels,b.customLevels),e.levels=H(b.customLevels,e[w]),J(e)),"object"==typeof b.redact&&null!==b.redact||Array.isArray(b.redact)){e.redact=b.redact;let a=R(e.redact,O),c={stringify:a[y]};e[z]=O,e[B]=a,e[A]=c}if("string"==typeof b.msgPrefix&&(e[C]=(this[C]||"")+b.msgPrefix),e[i]=L(e,a),void 0!==b.level&&b.level!==this.level||b.hasOwnProperty("customLevels")){let a=b.level||this.level;e[g](a)}return this.onChild(e),e},bindings:function(){let a=this[i],b=JSON.parse(`{${a.substr(1)}}`);return delete b.pid,delete b.hostname,b},setBindings:function(a){let b=L(this,a);this[i]=b,delete this[j]},flush:function(a){if(null!=a&&"function"!=typeof a)throw Error("callback must be a function");let b=this[r];"function"==typeof b.flush?b.flush(a||P):a&&a()},isLevelEnabled:G,version:Q,get level(){return this[h]()},set level(lvl){this[g](lvl)},get levelVal(){return this[f]},set levelVal(n){throw Error("levelVal is read-only")},get msgPrefix(){return this[C]},get[Symbol.toStringTag](){return"Pino"},[e]:I,[m]:function(a,b,c){let d,e=this[p](),f=this[k],g=this[u],h=this[v],i=this[o]||U,j=this[D].streamWrite;null==a?d={}:a instanceof Error?(d={[g]:a},void 0===b&&(b=a.message)):(d=a,void 0===b&&void 0===a[h]&&a[g]&&(b=a[g].message)),f&&(d=i(d,f(d,c,this)));let m=this[l](d,b,c,e),s=this[r];!0===s[x]&&(s.lastLevel=c,s.lastObj=d,s.lastMsg=b,s.lastTime=e.slice(this[q]),s.lastLogger=this),s.write(j?j(m):m)},[l]:M,[h]:E,[g]:F};Object.setPrototypeOf(S,d.prototype),b.exports=function(){return Object.create(S)};let T=a=>a;function U(a,b){return Object.assign(b,a)}},626262,(a,b,c)=>{"use strict";let d=a.r(660526),e=a.r(631046),f=a.r(903874),g=a.r(986234),h=a.r(362344),i=a.r(603693),j=a.r(889275),{configure:k}=a.r(9839),{assertDefaultLevelFound:l,mappings:m,genLsCache:o,genLevelComparison:p,assertLevelComparison:q}=a.r(292204),{DEFAULT_LEVELS:r,SORTING_ORDER:s}=a.r(311500),{createArgsNormalizer:t,asChindings:u,buildSafeSonicBoom:v,buildFormatters:w,stringify:x,normalizeDestFileDescriptor:y,noop:z}=a.r(89357),{version:A}=a.r(349478),{chindingsSym:B,redactFmtSym:C,serializersSym:D,timeSym:E,timeSliceIndexSym:F,streamSym:G,stringifySym:H,stringifySafeSym:I,stringifiersSym:J,setLevelSym:K,endSym:L,formatOptsSym:M,messageKeySym:N,errorKeySym:O,nestedKeySym:P,mixinSym:Q,levelCompSym:R,useOnlyCustomLevelsSym:S,formattersSym:T,hooksSym:U,nestedKeyStrSym:V,mixinMergeStrategySym:W,msgPrefixSym:X}=j,{epochTime:Y,nullTime:Z}=h,{pid:$}=process,_=d.hostname(),aa=e.err,ab=t({level:"info",levelComparison:s.ASC,levels:r,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:$,hostname:_},serializers:Object.assign(Object.create(null),{err:aa}),formatters:Object.assign(Object.create(null),{bindings:a=>a,level:(a,b)=>({level:b})}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:Y,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100}),ac=Object.assign(Object.create(null),e);function ad(...a){let b={},{opts:c,stream:d}=ab(b,f(),...a);c.level&&"string"==typeof c.level&&void 0!==r[c.level.toLowerCase()]&&(c.level=c.level.toLowerCase());let{redact:e,crlf:h,serializers:j,timestamp:s,messageKey:t,errorKey:v,nestedKey:y,base:A,name:$,level:_,customLevels:aa,levelComparison:ac,mixin:ae,mixinMergeStrategy:af,useOnlyCustomLevels:ag,formatters:ah,hooks:ai,depthLimit:aj,edgeLimit:ak,onChild:al,msgPrefix:am}=c,an=k({maximumDepth:aj,maximumBreadth:ak}),ao=w(ah.level,ah.bindings,ah.log),ap=x.bind({[I]:an}),aq=e?g(e,ap):{},ar=e?{stringify:aq[C]}:{stringify:ap},as=u.bind(null,{[B]:"",[D]:j,[J]:aq,[H]:x,[I]:an,[T]:ao}),at="";null!==A&&(at=as(void 0===$?A:Object.assign({},A,{name:$})));let au=s instanceof Function?s:s?Y:Z,av=au().indexOf(":")+1;if(ag&&!aa)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(ae&&"function"!=typeof ae)throw Error(`Unknown mixin type "${typeof ae}" - expected "function"`);if(am&&"string"!=typeof am)throw Error(`Unknown msgPrefix type "${typeof am}" - expected "string"`);l(_,aa,ag);let aw=m(aa,ag);return"function"==typeof d.emit&&d.emit("message",{code:"PINO_CONFIG",config:{levels:aw,messageKey:t,errorKey:v}}),q(ac),Object.assign(b,{levels:aw,[R]:p(ac),[S]:ag,[G]:d,[E]:au,[F]:av,[H]:x,[I]:an,[J]:aq,[L]:"}"+(h?"\r\n":"\n"),[M]:ar,[N]:t,[O]:v,[P]:y,[V]:y?`,${JSON.stringify(y)}:{`:"",[D]:j,[Q]:ae,[W]:af,[B]:at,[T]:ao,[U]:ai,silent:z,onChild:al,[X]:am}),Object.setPrototypeOf(b,i()),o(b),b[K](_),b}b.exports=ad,b.exports.destination=(a=process.stdout.fd)=>"object"==typeof a?(a.dest=y(a.dest||process.stdout.fd),v(a)):v({dest:y(a),minLength:0}),b.exports.transport=a.r(47325),b.exports.multistream=a.r(688454),b.exports.levels=m(),b.exports.stdSerializers=ac,b.exports.stdTimeFunctions=Object.assign({},h),b.exports.symbols=j,b.exports.version=A,b.exports.default=ad,b.exports.pino=ad},740723,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="undefined"!=typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},418719,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(740723),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let c=a.r(202625);b.exports.mask=function(a,b,d,e,g){g<48?f(a,b,d,e,g):c.mask(a,b,d,e,g)},b.exports.unmask=function(a,b){a.length<32?g(a,b):c.unmask(a,b)}}catch(a){}},773596,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},330332,(a,b,c)=>{"use strict";let d,e=a.r(406461),f=a.r(418719),g=a.r(773596),{kStatusCode:h}=a.r(740723),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),o=Symbol("buffers"),p=Symbol("error");function q(a){this[o].push(a),this[l]+=a.length}function r(a){(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)?this[o].push(a):(this[p]=RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][h]=1009,this.removeListener("data",r),this.reset())}function s(a){(this[k]._inflate=null,this[p])?this[m](this[p]):(a[h]=1007,this[m](a))}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[o]=[],this._inflate.on("error",s),this._inflate.on("data",r)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[p];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[o],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[o]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[o]=[],this._deflate.on("data",q)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[o],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[o]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},361374,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(500874),{hasBlob:e}=a.r(740723);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let c=a.r(399873);b.exports.isValidUTF8=function(a){return a.length<32?f(a):c(a)}}catch(a){}},113058,(a,b,c)=>{"use strict";let{Writable:d}=a.r(688947),e=a.r(330332),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(740723),{concat:j,toArrayBuffer:k,unmask:l}=a.r(418719),{isValidStatusCode:m,isValidUTF8:o}=a.r(361374),p=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new p(b.buffer,b.byteOffset+a,b.length-a),new p(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new p(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);c>2097151?a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a))}haveLength(a){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!o(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new p(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!o(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},407411,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(688947),{randomFillSync:f}=a.r(254799),g=a.r(330332),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(740723),{isBlob:k,isValidStatusCode:l}=a.r(361374),{mask:m,toBuffer:o}=a.r(418719),p=Symbol("kByteLength"),q=Buffer.alloc(4),r=8192;class s{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||q,b.generateMask?b.generateMask(c):(8192===r&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),r=0),c[0]=d[r++],c[1]=d[r++],c[2]=d[r++],c[3]=d[r++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[p]?b[p]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[p]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(s.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=o(a)).length,e=o.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[p]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(s.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=o(a)).length,e=o.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[p]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(s.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=o(a)).length,e=o.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[p]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[p],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(t,this,a,d);return}this._bufferedBytes-=c[p];let e=o(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(s.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(u,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(s.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[p],this._state=1,e.compress(a,c.fin,(a,b)=>{this._socket.destroyed?t(this,Error("The socket was closed while data was being compressed"),d):(this._bufferedBytes-=c[p],this._state=0,c.readOnly=!1,this.sendFrame(s.frame(b,c),d),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][p],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][p],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function t(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function u(a,b,c){t(a,b,c),a.onerror(b)}b.exports=s},436145,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(740723),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class o{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(o.prototype,"target",{enumerable:!0}),Object.defineProperty(o.prototype,"type",{enumerable:!0});class p extends o{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(p.prototype,"code",{enumerable:!0}),Object.defineProperty(p.prototype,"reason",{enumerable:!0}),Object.defineProperty(p.prototype,"wasClean",{enumerable:!0});class q extends o{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(q.prototype,"error",{enumerable:!0}),Object.defineProperty(q.prototype,"message",{enumerable:!0});class r extends o{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function s(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(r.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:p,ErrorEvent:q,Event:o,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new r("message",{data:c?a:a.toString()});d[k]=this,s(b,this,d)};else if("close"===a)f=function(a,c){let d=new p("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,s(b,this,d)};else if("error"===a)f=function(a){let c=new q("error",{error:a,message:a.message});c[k]=this,s(b,this,c)};else{if("open"!==a)return;f=function(){let a=new o("open");a[k]=this,s(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:r}},667270,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(361374);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,o=0;for(;o<a.length;o++)if(l=a.charCodeAt(o),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=o);else if(0!==o&&(32===l||9===l))-1===m&&-1!==k&&(m=o);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${o}`);-1===m&&(m=o);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${o}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=o);else if(32===l||9===l)-1===m&&-1!==k&&(m=o);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${o}`);-1===m&&(m=o),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,o),k=m=-1;else throw SyntaxError(`Unexpected character at index ${o}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${o}`);-1===k?k=o:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=o);else if(34===l&&-1!==k)j=!1,m=o;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${o}`);else if(34===l&&61===a.charCodeAt(o-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=o);else if(-1!==k&&(32===l||9===l))-1===m&&(m=o);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${o}`);-1===m&&(m=o);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${o}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=o);let p=a.slice(k,m);return void 0===b?e(f,p,g):(void 0===c?e(g,p,!0):h?e(g,c,p.replace(/\\/g,"")):e(g,c,p),e(f,b,g)),f}}},102587,(a,b,c)=>{"use strict";let d=a.r(427699),e=a.r(524836),f=a.r(921517),g=a.r(504446),h=a.r(755004),{randomBytes:i,createHash:j}=a.r(254799),{Duplex:k,Readable:l}=a.r(688947),{URL:m}=a.r(792509),o=a.r(330332),p=a.r(113058),q=a.r(407411),{isBlob:r}=a.r(361374),{BINARY_TYPES:s,EMPTY_BUFFER:t,GUID:u,kForOnEventAttribute:v,kListener:w,kStatusCode:x,kWebSocket:y,NOOP:z}=a.r(740723),{EventTarget:{addEventListener:A,removeEventListener:B}}=a.r(436145),{format:C,parse:D}=a.r(667270),{toBuffer:E}=a.r(418719),F=Symbol("kAborted"),G=[8,13],H=["CONNECTING","OPEN","CLOSING","CLOSED"],I=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class J extends d{constructor(a,b,c){super(),this._binaryType=s[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=t,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=J.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,p,q={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:G[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=q.autoPong,!G.includes(q.protocolVersion))throw RangeError(`Unsupported protocol version: ${q.protocolVersion} (supported versions: ${G.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let r="wss:"===h.protocol,s="ws+unix:"===h.protocol;if("ws:"===h.protocol||r||s?s&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void K(b,a);throw a}let t=r?443:80,v=i(16).toString("base64"),w=r?e.request:f.request,x=new Set;if(q.createConnection=q.createConnection||(r?M:L),q.defaultPort=q.defaultPort||t,q.port=h.port||t,q.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,q.headers={...q.headers,"Sec-WebSocket-Version":q.protocolVersion,"Sec-WebSocket-Key":v,Connection:"Upgrade",Upgrade:"websocket"},q.path=h.pathname+h.search,q.timeout=q.handshakeTimeout,q.perMessageDeflate&&(l=new o(!0!==q.perMessageDeflate?q.perMessageDeflate:{},!1,q.maxPayload),q.headers["Sec-WebSocket-Extensions"]=C({[o.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!I.test(a)||x.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");x.add(a)}q.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(q.origin&&(q.protocolVersion<13?q.headers["Sec-WebSocket-Origin"]=q.origin:q.headers.Origin=q.origin),(h.username||h.password)&&(q.auth=`${h.username}:${h.password}`),s){let a=q.path.split(":");q.socketPath=a[0],q.path=a[1]}if(q.followRedirects){if(0===b._redirects){b._originalIpc=s,b._originalSecure=r,b._originalHostOrSocketPath=s?q.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=s?!!b._originalIpc&&q.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||r)||(delete q.headers.authorization,delete q.headers.cookie,a||delete q.headers.host,q.auth=void 0)}q.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(q.auth).toString("base64")),p=b._req=w(q),b._redirects&&b.emit("redirect",b.url,p)}else p=b._req=w(q);q.timeout&&p.on("timeout",()=>{N(b,p,"Opening handshake has timed out")}),p.on("error",a=>{null===p||p[F]||(p=b._req=null,K(b,a))}),p.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&q.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>q.maxRedirects)return void N(b,p,"Maximum redirects exceeded");p.abort();try{e=new m(f,c)}catch(a){K(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",p,e)||N(b,p,`Unexpected server response: ${e.statusCode}`)}),p.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==J.CONNECTING)return;p=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void N(b,c,"Invalid Upgrade header");let g=j("sha1").update(v+u).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void N(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?x.size?x.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":x.size&&(e="Server sent no subprotocol"),e)return void N(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void N(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=D(i)}catch(a){N(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==o.extensionName)return void N(b,c,"Server indicated an extension that was not requested");try{l.accept(a[o.extensionName])}catch(a){N(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[o.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:q.allowSynchronousEvents,generateMask:q.generateMask,maxPayload:q.maxPayload,skipUTF8Validation:q.skipUTF8Validation})}),q.finishRequest?q.finishRequest(p,b):p.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){s.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new p({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new q(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[y]=this,e[y]=this,a[y]=this,d.on("conclude",P),d.on("drain",Q),d.on("error",R),d.on("message",T),d.on("ping",U),d.on("pong",V),e.onerror=X,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Z),a.on("data",$),a.on("end",_),a.on("error",aa),this._readyState=J.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=J.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[o.extensionName]&&this._extensions[o.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=J.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==J.CLOSED){if(this.readyState===J.CONNECTING)return void N(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===J.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=J.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),Y(this)}}pause(){this.readyState!==J.CONNECTING&&this.readyState!==J.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)?O(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.ping(a||t,b,c))}pong(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)?O(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.pong(a||t,b,c))}resume(){this.readyState!==J.CONNECTING&&this.readyState!==J.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)return void O(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[o.extensionName]||(d.compress=!1),this._sender.send(a||t,d,c)}terminate(){if(this.readyState!==J.CLOSED){if(this.readyState===J.CONNECTING)return void N(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=J.CLOSING,this._socket.destroy())}}}function K(a,b){a._readyState=J.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function L(a){return a.path=a.socketPath,g.connect(a)}function M(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function N(a,b,c){a._readyState=J.CLOSING;let d=Error(c);Error.captureStackTrace(d,N),b.setHeader?(b[F]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(K,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function O(a,b,c){if(b){let c=r(b)?b.size:E(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${H[a.readyState]})`);process.nextTick(c,b)}}function P(a,b){let c=this[y];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[y]&&(c._socket.removeListener("data",$),process.nextTick(W,c._socket),1005===a?c.close():c.close(a,b))}function Q(){let a=this[y];a.isPaused||a._socket.resume()}function R(a){let b=this[y];void 0!==b._socket[y]&&(b._socket.removeListener("data",$),process.nextTick(W,b._socket),b.close(a[x])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function S(){this[y].emitClose()}function T(a,b){this[y].emit("message",a,b)}function U(a){let b=this[y];b._autoPong&&b.pong(a,!this._isServer,z),b.emit("ping",a)}function V(a){this[y].emit("pong",a)}function W(a){a.resume()}function X(a){let b=this[y];b.readyState!==J.CLOSED&&(b.readyState===J.OPEN&&(b._readyState=J.CLOSING,Y(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function Y(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Z(){let a,b=this[y];this.removeListener("close",Z),this.removeListener("data",$),this.removeListener("end",_),b._readyState=J.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[y]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",S),b._receiver.on("finish",S))}function $(a){this[y]._receiver.write(a)||this.pause()}function _(){let a=this[y];a._readyState=J.CLOSING,a._receiver.end(),this.end()}function aa(){let a=this[y];this.removeListener("error",aa),this.on("error",z),a&&(a._readyState=J.CLOSING,this.destroy())}Object.defineProperty(J,"CONNECTING",{enumerable:!0,value:H.indexOf("CONNECTING")}),Object.defineProperty(J.prototype,"CONNECTING",{enumerable:!0,value:H.indexOf("CONNECTING")}),Object.defineProperty(J,"OPEN",{enumerable:!0,value:H.indexOf("OPEN")}),Object.defineProperty(J.prototype,"OPEN",{enumerable:!0,value:H.indexOf("OPEN")}),Object.defineProperty(J,"CLOSING",{enumerable:!0,value:H.indexOf("CLOSING")}),Object.defineProperty(J.prototype,"CLOSING",{enumerable:!0,value:H.indexOf("CLOSING")}),Object.defineProperty(J,"CLOSED",{enumerable:!0,value:H.indexOf("CLOSED")}),Object.defineProperty(J.prototype,"CLOSED",{enumerable:!0,value:H.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(J.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(J.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[v])return b[w];return null},set(b){for(let b of this.listeners(a))if(b[v]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[v]:!0})}})}),J.prototype.addEventListener=A,J.prototype.removeEventListener=B,b.exports=J},567403,(a,b,c)=>{"use strict";a.r(102587);let{Duplex:d}=a.r(688947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){a.readyState===a.CONNECTING?a.once("open",function(){h._final(b)}):null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){a.readyState===a.CONNECTING?a.once("open",function(){h._write(b,c,d)}):a.send(b,d)},h.on("end",f),h.on("error",g),h}},873987,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(361374);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},894487,(a,b,c)=>{"use strict";let d=a.r(427699),e=a.r(921517),{Duplex:f}=a.r(688947),{createHash:g}=a.r(254799),h=a.r(667270),i=a.r(330332),j=a.r(873987),k=a.r(102587),{GUID:l,kWebSocket:m}=a.r(740723),o=/^[+/0-9A-Za-z]{22}==$/;function p(a){a._state=2,a.emit("close")}function q(){this.destroy()}function r(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function s(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,s),a.emit("wsClientError",d,c,b)}else r(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){const a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(p,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(p,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{p(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",q);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void s(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void s(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!o.test(e))return void s(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void s(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void r(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){s(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),p[i.extensionName]=c)}catch(c){s(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return r(b,g||401,h,i);this.completeUpgrade(p,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return r(b,401)}this.completeUpgrade(p,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return r(e,503);let k=g("sha1").update(b+l).digest("base64"),o=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],s=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(o.push(`Sec-WebSocket-Protocol: ${a}`),s._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});o.push(`Sec-WebSocket-Extensions: ${c}`),s._extensions=a}this.emit("headers",o,d),e.write(o.concat("\r\n").join("\r\n")),e.removeListener("error",q),s.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(s),s.on("close",()=>{this.clients.delete(s),this._shouldEmitClose&&!this.clients.size&&process.nextTick(p,this)})),j(s,d)}}},803760,425041,925479,555282,916501,249765,710912,448808,532681,218524,322870,304053,55887,175707,18264,355944,256576,859041,678418,805841,760960,489658,877511,207712,705840,354187,308735,820026,445503,781034,a=>{"use strict";let b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;var T=a.i(187924),U=a.i(572131),V=a.i(278223),W=a.i(691442),X=a.i(595549);a.i(15670),a.i(582945),a.i(179246),a.i(34180),a.i(970806),a.s([],173406),a.i(173406);var Y=a.i(19013),Z=a.i(254799),$=a.i(751092),_=Z;function aa(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new $.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}let ab=a=>(0,_.randomFillSync)(new Uint8Array(aa(a)>>3)),ac=(a,b)=>{if(b.length<<3!==aa(a))throw new $.JWEInvalid("Invalid Initialization Vector length")};var ad=a.i(224361);let ae=ad.types.isKeyObject?a=>ad.types.isKeyObject(a):a=>null!=a&&a instanceof Z.KeyObject,af=(a,b)=>{let c;switch(a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new $.JOSENotSupported(`Content Encryption Algorithm ${a} is not supported either by JOSE or your javascript runtime`)}if(b instanceof Uint8Array){let a=b.byteLength<<3;if(a!==c)throw new $.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}if(ae(b)&&"secret"===b.type){let a=b.symmetricKeySize<<3;if(a!==c)throw new $.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}throw TypeError("Invalid Content Encryption Key type")};var ag=a.i(136349);let ah=Z.timingSafeEqual;function ai(a,b,c,d,e,f){let g=(0,ag.concat)(a,b,c,(0,ag.uint64be)(a.length<<3)),h=(0,Z.createHmac)(`sha${d}`,e);return h.update(g),h.digest().slice(0,f>>3)}let aj=Z.webcrypto,ak=ad.types.isCryptoKey?a=>ad.types.isCryptoKey(a):a=>!1;function al(a,b="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`)}function am(a,b){return a.name===b}function an(a){return parseInt(a.name.slice(4),10)}function ao(a,b){if(b.length&&!b.some(b=>a.usages.includes(b))){let a="CryptoKey does not support this operation, its usages must include ";if(b.length>2){let c=b.pop();a+=`one of ${b.join(", ")}, or ${c}.`}else 2===b.length?a+=`one of ${b[0]} or ${b[1]}.`:a+=`${b[0]}.`;throw TypeError(a)}}function ap(a,b,...c){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if(!am(a.algorithm,"AES-GCM"))throw al("AES-GCM");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw al(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!am(a.algorithm,"AES-KW"))throw al("AES-KW");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw al(c,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw al("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!am(a.algorithm,"PBKDF2"))throw al("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!am(a.algorithm,"RSA-OAEP"))throw al("RSA-OAEP");let c=parseInt(b.slice(9),10)||1;if(an(a.algorithm.hash)!==c)throw al(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}ao(a,c)}function aq(a,b,...c){if(c.length>2){let b=c.pop();a+=`one of type ${c.join(", ")}, or ${b}.`}else 2===c.length?a+=`one of type ${c[0]} or ${c[1]}.`:a+=`of type ${c[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor&&b.constructor.name&&(a+=` Received an instance of ${b.constructor.name}`),a}let ar=(a,...b)=>aq("Key must be ",a,...b);function as(a,b,...c){return aq(`Key for the ${a} algorithm must be `,b,...c)}let at=a=>(b||(b=new Set((0,Z.getCiphers)())),b.has(a)),au=a=>ae(a)||ak(a),av=["KeyObject"];(globalThis.CryptoKey||(null==aj?void 0:aj.CryptoKey))&&av.push("CryptoKey");let aw=(a,b,c,d,e,f)=>{let g;if(ak(b))ap(b,a,"decrypt"),g=Z.KeyObject.from(b);else if(b instanceof Uint8Array||ae(b))g=b;else throw TypeError(ar(b,...av,"Uint8Array"));switch(af(a,g),ac(a,d),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,d,e,f){let g,h,i=parseInt(a.slice(1,4),10);ae(b)&&(b=b.export());let j=b.subarray(i>>3),k=b.subarray(0,i>>3),l=parseInt(a.slice(-3),10),m=`aes-${i}-cbc`;if(!at(m))throw new $.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let o=ai(f,d,c,l,k,i);try{g=ah(e,o)}catch{}if(!g)throw new $.JWEDecryptionFailed;try{let a=(0,Z.createDecipheriv)(m,j,d);h=(0,ag.concat)(a.update(c),a.final())}catch{}if(!h)throw new $.JWEDecryptionFailed;return h}(a,g,c,d,e,f);case"A128GCM":case"A192GCM":case"A256GCM":var h=g;let i=parseInt(a.slice(1,4),10),j=`aes-${i}-gcm`;if(!at(j))throw new $.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);try{let a=(0,Z.createDecipheriv)(j,h,d,{authTagLength:16});a.setAuthTag(e),f.byteLength&&a.setAAD(f,{plaintextLength:c.length});let b=a.update(c);return a.final(),b}catch{throw new $.JWEDecryptionFailed}default:throw new $.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}};var ax=a.i(406461);let ay=(0,ad.promisify)(ax.inflateRaw),az=(0,ad.promisify)(ax.deflateRaw),aA=(...a)=>{let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0};var aB=a.i(154051),aC=a.i(500874);function aD(a,b){if(a.symmetricKeySize<<3!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function aE(a,b,c){if(ae(a))return a;if(a instanceof Uint8Array)return(0,Z.createSecretKey)(a);if(ak(a))return ap(a,b,c),Z.KeyObject.from(a);throw TypeError(ar(a,...av,"Uint8Array"))}let aF=(a,b,c)=>{let d=parseInt(a.slice(1,4),10),e=`aes${d}-wrap`;if(!at(e))throw new $.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let f=aE(b,a,"wrapKey");aD(f,a);let g=(0,Z.createCipheriv)(e,f,aC.Buffer.alloc(8,166));return(0,ag.concat)(g.update(c),g.final())},aG=(a,b,c)=>{let d=parseInt(a.slice(1,4),10),e=`aes${d}-wrap`;if(!at(e))throw new $.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let f=aE(b,a,"unwrapKey");aD(f,a);let g=(0,Z.createDecipheriv)(e,f,aC.Buffer.alloc(8,166));return(0,ag.concat)(g.update(c),g.final())},aH=aC.Buffer.from([42,134,72,206,61,3,1,7]),aI=aC.Buffer.from([43,129,4,0,34]),aJ=aC.Buffer.from([43,129,4,0,35]),aK=aC.Buffer.from([43,129,4,0,10]),aL=new WeakMap,aM=(a,b)=>{var c;let d;if(ak(a))d=Z.KeyObject.from(a);else if(ae(a))d=a;else throw TypeError(ar(a,...av));if("secret"===d.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(d.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${d.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${d.asymmetricKeyType.slice(1)}`;case"ec":{if(aL.has(d))return aL.get(d);let a=null==(c=d.asymmetricKeyDetails)?void 0:c.namedCurve;if(a||"private"!==d.type){if(!a){let b=d.export({format:"der",type:"spki"}),c=b[1]<128?14:15,e=b[c],f=b.slice(c+1,c+1+e);if(f.equals(aH))a="prime256v1";else if(f.equals(aI))a="secp384r1";else if(f.equals(aJ))a="secp521r1";else if(f.equals(aK))a="secp256k1";else throw new $.JOSENotSupported("Unsupported key curve for this operation")}}else a=aM((0,Z.createPublicKey)(d),!0);if(b)return a;let e=(a=>{switch(a){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new $.JOSENotSupported("Unsupported key curve for this operation")}})(a);return aL.set(d,e),e}default:throw TypeError("Invalid asymmetric key type for this operation")}},aN=(0,ad.promisify)(Z.generateKeyPair);async function aO(a,b,c,d,e=new Uint8Array(0),f=new Uint8Array(0)){let g,h;if(ak(a))ap(a,"ECDH"),g=Z.KeyObject.from(a);else if(ae(a))g=a;else throw TypeError(ar(a,...av));if(ak(b))ap(b,"ECDH","deriveBits"),h=Z.KeyObject.from(b);else if(ae(b))h=b;else throw TypeError(ar(b,...av));let i=(0,ag.concat)((0,ag.lengthAndInput)(ag.encoder.encode(c)),(0,ag.lengthAndInput)(e),(0,ag.lengthAndInput)(f),(0,ag.uint32be)(d)),j=(0,Z.diffieHellman)({privateKey:h,publicKey:g});return(0,ag.concatKdf)(j,d,i)}async function aP(a){let b;if(ak(a))b=Z.KeyObject.from(a);else if(ae(a))b=a;else throw TypeError(ar(a,...av));switch(b.asymmetricKeyType){case"x25519":return aN("x25519");case"x448":return aN("x448");case"ec":return aN("ec",{namedCurve:aM(b)});default:throw new $.JOSENotSupported("Invalid or unsupported EPK")}}let aQ=a=>["P-256","P-384","P-521","X25519","X448"].includes(aM(a));var _=Z;function aR(a){if(!(a instanceof Uint8Array)||a.length<8)throw new $.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}let aS=(0,ad.promisify)(Z.pbkdf2);function aT(a,b){if(ae(a))return a.export();if(a instanceof Uint8Array)return a;if(ak(a))return ap(a,b,"deriveBits","deriveKey"),Z.KeyObject.from(a).export();throw TypeError(ar(a,...av,"Uint8Array"))}let aU=async(a,b,c,d=2048,e=(0,_.randomFillSync)(new Uint8Array(16)))=>{aR(e);let f=(0,ag.p2s)(a,e),g=parseInt(a.slice(13,16),10)>>3,h=aT(b,a),i=await aS(h,f,d,g,`sha${a.slice(8,11)}`);return{encryptedKey:await aF(a.slice(-6),i,c),p2c:d,p2s:(0,Y.encode)(e)}},aV=async(a,b,c,d,e)=>{aR(e);let f=(0,ag.p2s)(a,e),g=parseInt(a.slice(13,16),10)>>3,h=aT(b,a),i=await aS(h,f,d,g,`sha${a.slice(8,11)}`);return aG(a.slice(-6),i,c)},aW=new WeakMap,aX=(a,b)=>{let c=a.readUInt8(1);if((128&c)==0)return 0===b?c:aX(a.subarray(2+c),b-1);let d=127&c;c=0;for(let b=0;b<d;b++)c<<=8,c|=a.readUInt8(2+b);return 0===b?c:aX(a.subarray(2+c),b-1)},aY=(a,b)=>{aW.set(a,b)},aZ=(a,b)=>{if(2048>(a=>{var b,c,d,e;let f;if(aW.has(a))return aW.get(a);let g=null!=(c=null==(b=a.asymmetricKeyDetails)?void 0:b.modulusLength)?c:(d=a.export({format:"der",type:"pkcs1"}),e=+("private"===a.type),((128&(f=d.readUInt8(1)))==0?aX(d.subarray(2),e):aX(d.subarray(2+(127&f)),e))-1<<3);return aW.set(a,g),g})(a))throw TypeError(`${b} requires key modulusLength to be 2048 bits or larger`)},a$=(a,b)=>{if("rsa"!==a.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");aZ(a,b)},a_=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return Z.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return Z.constants.RSA_PKCS1_PADDING;default:return}},a0=a=>{switch(a){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function a1(a,b,...c){if(ae(a))return a;if(ak(a))return ap(a,b,...c),Z.KeyObject.from(a);throw TypeError(ar(a,...av))}var _=Z;function a2(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new $.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}let a3=a=>(0,_.randomFillSync)(new Uint8Array(a2(a)>>3)),a4=(a,b,c)=>{let d;if(ak(c)){if(!c.extractable)throw TypeError("CryptoKey is not extractable");d=Z.KeyObject.from(c)}else if(ae(c))d=c;else throw TypeError(ar(c,...av));if(d.type!==a)throw TypeError(`key is not a ${a} key`);return d.export({format:"pem",type:b})},a5=aC.Buffer.from([0]),a6=aC.Buffer.from([2]),a7=aC.Buffer.from([3]),a8=aC.Buffer.from([48]),a9=aC.Buffer.from([4]),ba=a=>{if(a<128)return aC.Buffer.from([a]);let b=aC.Buffer.alloc(5);b.writeUInt32BE(a,1);let c=1;for(;0===b[c];)c++;return b[c-1]=128|5-c,b.slice(c-1)},bb=new Map([["P-256",aC.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",aC.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",aC.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",aC.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",aC.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",aC.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",aC.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",aC.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",aC.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);class bc{constructor(){this.length=0,this.elements=[]}oidFor(a){let b=bb.get(a);if(!b)throw new $.JOSENotSupported("Invalid or unsupported OID");this.elements.push(b),this.length+=b.length}zero(){this.elements.push(a6,aC.Buffer.from([1]),a5),this.length+=3}one(){this.elements.push(a6,aC.Buffer.from([1]),aC.Buffer.from([1])),this.length+=3}unsignedInteger(a){if(128&a[0]){let b=ba(a.length+1);this.elements.push(a6,b,a5,a),this.length+=2+b.length+a.length}else{let b=0;for(;0===a[b]&&(128&a[b+1])==0;)b++;let c=ba(a.length-b);this.elements.push(a6,ba(a.length-b),a.slice(b)),this.length+=1+c.length+a.length-b}}octStr(a){let b=ba(a.length);this.elements.push(a9,ba(a.length),a),this.length+=1+b.length+a.length}bitStr(a){let b=ba(a.length+1);this.elements.push(a7,ba(a.length+1),a5,a),this.length+=1+b.length+a.length+1}add(a){this.elements.push(a),this.length+=a.length}end(a=a8){let b=ba(this.length);return aC.Buffer.concat([a,b,...this.elements],1+b.length+this.length)}}let[bd,be]=process.versions.node.split(".").map(a=>parseInt(a,10)),bf=!("electron"in process.versions)&&(bd>=17||16===bd&&be>=9),bg=bd>=16||15===bd&&be>=9,bh=bd>=16||15===bd&&be>=12,bi=a=>{if(bh&&"oct"!==a.kty)return a.d?(0,Z.createPrivateKey)({format:"jwk",key:a}):(0,Z.createPublicKey)({format:"jwk",key:a});switch(a.kty){case"oct":return(0,Z.createSecretKey)((0,Y.decode)(a.k));case"RSA":{let b=new bc,c=void 0!==a.d,d=aC.Buffer.from(a.n,"base64"),e=aC.Buffer.from(a.e,"base64");c?(b.zero(),b.unsignedInteger(d),b.unsignedInteger(e),b.unsignedInteger(aC.Buffer.from(a.d,"base64")),b.unsignedInteger(aC.Buffer.from(a.p,"base64")),b.unsignedInteger(aC.Buffer.from(a.q,"base64")),b.unsignedInteger(aC.Buffer.from(a.dp,"base64")),b.unsignedInteger(aC.Buffer.from(a.dq,"base64")),b.unsignedInteger(aC.Buffer.from(a.qi,"base64"))):(b.unsignedInteger(d),b.unsignedInteger(e));let f={key:b.end(),format:"der",type:"pkcs1"},g=c?(0,Z.createPrivateKey)(f):(0,Z.createPublicKey)(f);return aY(g,d.length<<3),g}case"EC":{var b,c;let d=new bc,e=void 0!==a.d,f=aC.Buffer.concat([aC.Buffer.alloc(1,4),aC.Buffer.from(a.x,"base64"),aC.Buffer.from(a.y,"base64")]);if(e){d.zero();let c=new bc;c.oidFor("ecPublicKey"),c.oidFor(a.crv),d.add(c.end());let e=new bc;e.one(),e.octStr(aC.Buffer.from(a.d,"base64"));let g=new bc;g.bitStr(f);let h=g.end(aC.Buffer.from([161]));e.add(h);let i=e.end(),j=new bc;j.add(i);let k=j.end(aC.Buffer.from([4]));d.add(k);let l=d.end(),m=(0,Z.createPrivateKey)({key:l,format:"der",type:"pkcs8"});return b=a.crv,aL.set(m,b),m}let g=new bc;g.oidFor("ecPublicKey"),g.oidFor(a.crv),d.add(g.end()),d.bitStr(f);let h=d.end(),i=(0,Z.createPublicKey)({key:h,format:"der",type:"spki"});return c=a.crv,aL.set(i,c),i}case"OKP":{let b=new bc;if(void 0!==a.d){b.zero();let c=new bc;c.oidFor(a.crv),b.add(c.end());let d=new bc;d.octStr(aC.Buffer.from(a.d,"base64"));let e=d.end(aC.Buffer.from([4]));b.add(e);let f=b.end();return(0,Z.createPrivateKey)({key:f,format:"der",type:"pkcs8"})}let c=new bc;c.oidFor(a.crv),b.add(c.end()),b.bitStr(aC.Buffer.from(a.x,"base64"));let d=b.end();return(0,Z.createPublicKey)({key:d,format:"der",type:"spki"})}default:throw new $.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}};async function bj(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,Z.createPublicKey)({key:aC.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"})}async function bk(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,Z.createPublicKey)({key:a,type:"spki",format:"pem"})}async function bl(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,Z.createPrivateKey)({key:aC.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"})}async function bm(a,b,c){var d;if(!(0,aB.default)(a))throw TypeError("JWK must be an object");switch(b||(b=a.alg),a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=c||(c=!0!==a.ext),c)return bi({...a,alg:b,ext:null!=(d=a.ext)&&d});return(0,Y.decode)(a.k);case"RSA":if(void 0!==a.oth)throw new $.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return bi({...a,alg:b});default:throw new $.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}let bn=(a,b,c)=>{if(a.startsWith("HS")||"dir"===a||a.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(a)){if(!(b instanceof Uint8Array)){if(!au(b))throw TypeError(as(a,b,...av,"Uint8Array"));if("secret"!==b.type)throw TypeError(`${av.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}}else{if(!au(b))throw TypeError(as(a,b,...av));if("secret"===b.type)throw TypeError(`${av.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===c&&"public"===b.type)throw TypeError(`${av.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===c&&"public"===b.type)throw TypeError(`${av.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(b.algorithm&&"verify"===c&&"private"===b.type)throw TypeError(`${av.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(b.algorithm&&"encrypt"===c&&"private"===b.type)throw TypeError(`${av.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)}},bo=(a,b,c,d,e)=>{let f;if(ak(c))ap(c,a,"encrypt"),f=Z.KeyObject.from(c);else if(c instanceof Uint8Array||ae(c))f=c;else throw TypeError(ar(c,...av,"Uint8Array"));switch(af(a,f),ac(a,d),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,d,e){let f=parseInt(a.slice(1,4),10);ae(c)&&(c=c.export());let g=c.subarray(f>>3),h=c.subarray(0,f>>3),i=`aes-${f}-cbc`;if(!at(i))throw new $.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let j=(0,Z.createCipheriv)(i,g,d),k=(0,ag.concat)(j.update(b),j.final()),l=ai(e,d,k,parseInt(a.slice(-3),10),h,f);return{ciphertext:k,tag:l}}(a,b,f,d,e);case"A128GCM":case"A192GCM":case"A256GCM":var g=f;let h=parseInt(a.slice(1,4),10),i=`aes-${h}-gcm`;if(!at(i))throw new $.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let j=(0,Z.createCipheriv)(i,g,d,{authTagLength:16});e.byteLength&&j.setAAD(e,{plaintextLength:b.length});let k=j.update(b);return j.final(),{ciphertext:k,tag:j.getAuthTag()};default:throw new $.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}};async function bp(a,b,c,d){let e=a.slice(0,7);d||(d=ab(e));let{ciphertext:f,tag:g}=await bo(e,c,b,d,new Uint8Array(0));return{encryptedKey:f,iv:(0,Y.encode)(d),tag:(0,Y.encode)(g)}}async function bq(a,b,c,d,e){return aw(a.slice(0,7),b,c,d,e,new Uint8Array(0))}async function br(a,b,c,d,e){switch(bn(a,b,"decrypt"),a){case"dir":if(void 0!==c)throw new $.JWEInvalid("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new $.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let e,f;if(!(0,aB.default)(d.epk))throw new $.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!aQ(b))throw new $.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let g=await bm(d.epk,a);if(void 0!==d.apu){if("string"!=typeof d.apu)throw new $.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{e=(0,Y.decode)(d.apu)}catch{throw new $.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==d.apv){if("string"!=typeof d.apv)throw new $.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{f=(0,Y.decode)(d.apv)}catch{throw new $.JWEInvalid("Failed to base64url decode the apv")}}let h=await aO(g,b,"ECDH-ES"===a?d.enc:a,"ECDH-ES"===a?a2(d.enc):parseInt(a.slice(-5,-2),10),e,f);if("ECDH-ES"===a)return h;if(void 0===c)throw new $.JWEInvalid("JWE Encrypted Key missing");return aG(a.slice(-6),h,c)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":let f,g,h;if(void 0===c)throw new $.JWEInvalid("JWE Encrypted Key missing");return f=a_(a),g=a0(a),a$(h=a1(b,a,"unwrapKey","decrypt"),a),(0,Z.privateDecrypt)({key:h,oaepHash:g,padding:f},c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let f;if(void 0===c)throw new $.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof d.p2c)throw new $.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let g=(null==e?void 0:e.maxPBES2Count)||1e4;if(d.p2c>g)throw new $.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof d.p2s)throw new $.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{f=(0,Y.decode)(d.p2s)}catch{throw new $.JWEInvalid("Failed to base64url decode the p2s")}return aV(a,b,c,d.p2c,f)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new $.JWEInvalid("JWE Encrypted Key missing");return aG(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let e,f;if(void 0===c)throw new $.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof d.iv)throw new $.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof d.tag)throw new $.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{e=(0,Y.decode)(d.iv)}catch{throw new $.JWEInvalid("Failed to base64url decode the iv")}try{f=(0,Y.decode)(d.tag)}catch{throw new $.JWEInvalid("Failed to base64url decode the tag")}return bq(a,b,c,e,f)}default:throw new $.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}let bs=function(a,b,c,d,e){let f;if(void 0!==e.crit&&void 0===d.crit)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!d||void 0===d.crit)return new Set;if(!Array.isArray(d.crit)||0===d.crit.length||d.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let g of(f=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,d.crit)){if(!f.has(g))throw new $.JOSENotSupported(`Extension Header Parameter "${g}" is not recognized`);if(void 0===e[g])throw new a(`Extension Header Parameter "${g}" is missing`);if(f.get(g)&&void 0===d[g])throw new a(`Extension Header Parameter "${g}" MUST be integrity protected`)}return new Set(d.crit)},bt=(a,b)=>{if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)};async function bu(a,b,c){var d;let e,f,g,h,i,j,k;if(!(0,aB.default)(a))throw new $.JWEInvalid("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new $.JWEInvalid("JOSE Header missing");if("string"!=typeof a.iv)throw new $.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof a.ciphertext)throw new $.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof a.tag)throw new $.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new $.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new $.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new $.JWEInvalid("JWE AAD incorrect type");if(void 0!==a.header&&!(0,aB.default)(a.header))throw new $.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!(0,aB.default)(a.unprotected))throw new $.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=(0,Y.decode)(a.protected);e=JSON.parse(ag.decoder.decode(b))}catch{throw new $.JWEInvalid("JWE Protected Header is invalid")}if(!aA(e,a.header,a.unprotected))throw new $.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let l={...e,...a.header,...a.unprotected};if(bs($.JWEInvalid,new Map,null==c?void 0:c.crit,e,l),void 0!==l.zip){if(!e||!e.zip)throw new $.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==l.zip)throw new $.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:m,enc:o}=l;if("string"!=typeof m||!m)throw new $.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof o||!o)throw new $.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let p=c&&bt("keyManagementAlgorithms",c.keyManagementAlgorithms),q=c&&bt("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(p&&!p.has(m))throw new $.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(q&&!q.has(o))throw new $.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==a.encrypted_key)try{f=(0,Y.decode)(a.encrypted_key)}catch{throw new $.JWEInvalid("Failed to base64url decode the encrypted_key")}let r=!1;"function"==typeof b&&(b=await b(e,a),r=!0);try{g=await br(m,b,f,l,c)}catch(a){if(a instanceof TypeError||a instanceof $.JWEInvalid||a instanceof $.JOSENotSupported)throw a;g=a3(o)}try{h=(0,Y.decode)(a.iv)}catch{throw new $.JWEInvalid("Failed to base64url decode the iv")}try{i=(0,Y.decode)(a.tag)}catch{throw new $.JWEInvalid("Failed to base64url decode the tag")}let s=ag.encoder.encode(null!=(d=a.protected)?d:"");j=void 0!==a.aad?(0,ag.concat)(s,ag.encoder.encode("."),ag.encoder.encode(a.aad)):s;try{k=(0,Y.decode)(a.ciphertext)}catch{throw new $.JWEInvalid("Failed to base64url decode the ciphertext")}let t=await aw(o,g,k,h,i,j);"DEF"===l.zip&&(t=await ((null==c?void 0:c.inflateRaw)||(a=>ay(a,{maxOutputLength:25e4}).catch(()=>{throw new $.JWEDecompressionFailed})))(t));let u={plaintext:t};if(void 0!==a.protected&&(u.protectedHeader=e),void 0!==a.aad)try{u.additionalAuthenticatedData=(0,Y.decode)(a.aad)}catch{throw new $.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(u.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(u.unprotectedHeader=a.header),r)?{...u,key:b}:u}async function bv(a,b,c){if(a instanceof Uint8Array&&(a=ag.decoder.decode(a)),"string"!=typeof a)throw new $.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:d,1:e,2:f,3:g,4:h,length:i}=a.split(".");if(5!==i)throw new $.JWEInvalid("Invalid Compact JWE");let j=await bu({ciphertext:g,iv:f||void 0,protected:d||void 0,tag:h||void 0,encrypted_key:e||void 0},b,c),k={plaintext:j.plaintext,protectedHeader:j.protectedHeader};return"function"==typeof b?{...k,key:j.key}:k}async function bw(a,b,c){if(!(0,aB.default)(a))throw new $.JWEInvalid("General JWE must be an object");if(!Array.isArray(a.recipients)||!a.recipients.every(aB.default))throw new $.JWEInvalid("JWE Recipients missing or incorrect type");if(!a.recipients.length)throw new $.JWEInvalid("JWE Recipients has no members");for(let d of a.recipients)try{return await bu({aad:a.aad,ciphertext:a.ciphertext,encrypted_key:d.encrypted_key,header:d.header,iv:a.iv,protected:a.protected,tag:a.tag,unprotected:a.unprotected},b,c)}catch{}throw new $.JWEDecryptionFailed}class bx{constructor(a){if(48!==a[0]||(this.buffer=a,this.offset=1,this.decodeLength()!==a.length-this.offset))throw TypeError()}decodeLength(){let a=this.buffer[this.offset++];if(128&a){let b=-129&a;a=0;for(let c=0;c<b;c++)a=a<<8|this.buffer[this.offset+c];this.offset+=b}return a}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let a=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,a--);let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}end(){if(this.offset!==this.buffer.length)throw TypeError()}}let by=a=>{let b;if(ak(a)){if(!a.extractable)throw TypeError("CryptoKey is not extractable");b=Z.KeyObject.from(a)}else if(ae(a))b=a;else if(a instanceof Uint8Array)return{kty:"oct",k:(0,Y.encode)(a)};else throw TypeError(ar(a,...av,"Uint8Array"));if(bg){if("secret"!==b.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(b.asymmetricKeyType))throw new $.JOSENotSupported("Unsupported key asymmetricKeyType");return b.export({format:"jwk"})}switch(b.type){case"secret":return{kty:"oct",k:(0,Y.encode)(b.export())};case"private":case"public":switch(b.asymmetricKeyType){case"rsa":{let a,c=new bx(b.export({format:"der",type:"pkcs1"}));"private"===b.type&&c.unsignedInteger();let d=(0,Y.encode)(c.unsignedInteger()),e=(0,Y.encode)(c.unsignedInteger());return"private"===b.type&&(a={d:(0,Y.encode)(c.unsignedInteger()),p:(0,Y.encode)(c.unsignedInteger()),q:(0,Y.encode)(c.unsignedInteger()),dp:(0,Y.encode)(c.unsignedInteger()),dq:(0,Y.encode)(c.unsignedInteger()),qi:(0,Y.encode)(c.unsignedInteger())}),c.end(),{kty:"RSA",n:d,e,...a}}case"ec":{let a,c,d,e=aM(b);switch(e){case"secp256k1":a=64,c=33,d=-1;break;case"P-256":a=64,c=36,d=-1;break;case"P-384":a=96,c=35,d=-3;break;case"P-521":a=132,c=35,d=-3;break;default:throw new $.JOSENotSupported("Unsupported curve")}if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"EC",crv:e,x:(0,Y.encode)(c.subarray(-a,-a/2)),y:(0,Y.encode)(c.subarray(-a/2))}}let f=b.export({type:"pkcs8",format:"der"});return f.length<100&&(c+=d),{...by((0,Z.createPublicKey)(b)),d:(0,Y.encode)(f.subarray(c,c+a/2))}}case"ed25519":case"x25519":{let a=aM(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,Y.encode)(c.subarray(-32))}}let c=b.export({type:"pkcs8",format:"der"});return{...by((0,Z.createPublicKey)(b)),d:(0,Y.encode)(c.subarray(-32))}}case"ed448":case"x448":{let a=aM(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,Y.encode)(c.subarray("Ed448"===a?-57:-56))}}let c=b.export({type:"pkcs8",format:"der"});return{...by((0,Z.createPublicKey)(b)),d:(0,Y.encode)(c.subarray("Ed448"===a?-57:-56))}}default:throw new $.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new $.JOSENotSupported("Unsupported key type")}};async function bz(a){return a4("public","spki",a)}async function bA(a){return a4("private","pkcs8",a)}async function bB(a){return by(a)}async function bC(a,b,c,d,e={}){let f,g,h;switch(bn(a,c,"encrypt"),a){case"dir":h=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!aQ(c))throw new $.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:i,apv:j}=e,{epk:k}=e;k||(k=(await aP(c)).privateKey);let{x:l,y:m,crv:o,kty:p}=await bB(k),q=await aO(c,k,"ECDH-ES"===a?b:a,"ECDH-ES"===a?a2(b):parseInt(a.slice(-5,-2),10),i,j);if(g={epk:{x:l,crv:o,kty:p}},"EC"===p&&(g.epk.y=m),i&&(g.apu=(0,Y.encode)(i)),j&&(g.apv=(0,Y.encode)(j)),"ECDH-ES"===a){h=q;break}h=d||a3(b);let r=a.slice(-6);f=await aF(r,q,h);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":var i;let j,k,l;h=d||a3(b),f=await (i=h,j=a_(a),k=a0(a),a$(l=a1(c,a,"wrapKey","encrypt"),a),(0,Z.publicEncrypt)({key:l,oaepHash:k,padding:j},i));break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{h=d||a3(b);let{p2c:i,p2s:j}=e;({encryptedKey:f,...g}=await aU(a,c,h,i,j));break}case"A128KW":case"A192KW":case"A256KW":h=d||a3(b),f=await aF(a,c,h);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{h=d||a3(b);let{iv:i}=e;({encryptedKey:f,...g}=await bp(a,c,h,i));break}default:throw new $.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:h,encryptedKey:f,parameters:g}}let bD=Symbol();class bE{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=a}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}async encrypt(a,b){let c,d,e,f,g,h,i;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new $.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!aA(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new $.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let j={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(bs($.JWEInvalid,new Map,null==b?void 0:b.crit,this._protectedHeader,j),void 0!==j.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new $.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==j.zip)throw new $.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:k,enc:l}=j;if("string"!=typeof k||!k)throw new $.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof l||!l)throw new $.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===k){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===k&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let e;({cek:d,encryptedKey:c,parameters:e}=await bC(k,l,a,this._cek,this._keyManagementParameters)),e&&(b&&bD in b?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...e}:this.setUnprotectedHeader(e):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...e}:this.setProtectedHeader(e))}if(this._iv||(this._iv=ab(l)),f=this._protectedHeader?ag.encoder.encode((0,Y.encode)(JSON.stringify(this._protectedHeader))):ag.encoder.encode(""),this._aad?(g=(0,Y.encode)(this._aad),e=(0,ag.concat)(f,ag.encoder.encode("."),ag.encoder.encode(g))):e=f,"DEF"===j.zip){let a=await ((null==b?void 0:b.deflateRaw)||(a=>az(a)))(this._plaintext);({ciphertext:h,tag:i}=await bo(l,a,d,this._iv,e))}else({ciphertext:h,tag:i}=await bo(l,this._plaintext,d,this._iv,e));let m={ciphertext:(0,Y.encode)(h),iv:(0,Y.encode)(this._iv),tag:(0,Y.encode)(i)};return c&&(m.encrypted_key=(0,Y.encode)(c)),g&&(m.aad=g),this._protectedHeader&&(m.protected=ag.decoder.decode(f)),this._sharedUnprotectedHeader&&(m.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(m.header=this._unprotectedHeader),m}}class bF{constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addRecipient(...a){return this.parent.addRecipient(...a)}encrypt(...a){return this.parent.encrypt(...a)}done(){return this.parent}}class bG{constructor(a){this._recipients=[],this._plaintext=a}addRecipient(a,b){let c=new bF(this,a,{crit:null==b?void 0:b.crit});return this._recipients.push(c),c}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}async encrypt(a){var b,c,d;let e;if(!this._recipients.length)throw new $.JWEInvalid("at least one recipient must be added");if(a={deflateRaw:null==a?void 0:a.deflateRaw},1===this._recipients.length){let[b]=this._recipients,c=await new bE(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(b.unprotectedHeader).encrypt(b.key,{...b.options,...a}),d={ciphertext:c.ciphertext,iv:c.iv,recipients:[{}],tag:c.tag};return c.aad&&(d.aad=c.aad),c.protected&&(d.protected=c.protected),c.unprotected&&(d.unprotected=c.unprotected),c.encrypted_key&&(d.recipients[0].encrypted_key=c.encrypted_key),c.header&&(d.recipients[0].header=c.header),d}for(let a=0;a<this._recipients.length;a++){let b=this._recipients[a];if(!aA(this._protectedHeader,this._unprotectedHeader,b.unprotectedHeader))throw new $.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let c={...this._protectedHeader,...this._unprotectedHeader,...b.unprotectedHeader},{alg:d}=c;if("string"!=typeof d||!d)throw new $.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===d||"ECDH-ES"===d)throw new $.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof c.enc||!c.enc)throw new $.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(e){if(e!==c.enc)throw new $.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else e=c.enc;if(bs($.JWEInvalid,new Map,b.options.crit,this._protectedHeader,c),void 0!==c.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new $.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let f=a3(e),g={ciphertext:"",iv:"",recipients:[],tag:""};for(let h=0;h<this._recipients.length;h++){let i=this._recipients[h],j={};g.recipients.push(j);let k=({...this._protectedHeader,...this._unprotectedHeader,...i.unprotectedHeader}).alg.startsWith("PBES2")?2048+h:void 0;if(0===h){let b=await new bE(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(f).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(i.unprotectedHeader).setKeyManagementParameters({p2c:k}).encrypt(i.key,{...i.options,...a,[bD]:!0});g.ciphertext=b.ciphertext,g.iv=b.iv,g.tag=b.tag,b.aad&&(g.aad=b.aad),b.protected&&(g.protected=b.protected),b.unprotected&&(g.unprotected=b.unprotected),j.encrypted_key=b.encrypted_key,b.header&&(j.header=b.header);continue}let{encryptedKey:l,parameters:m}=await bC((null==(b=i.unprotectedHeader)?void 0:b.alg)||(null==(c=this._protectedHeader)?void 0:c.alg)||(null==(d=this._unprotectedHeader)?void 0:d.alg),e,i.key,f,{p2c:k});j.encrypted_key=(0,Y.encode)(l),(i.unprotectedHeader||m)&&(j.header={...i.unprotectedHeader,...m})}return g}}function bH(a){switch(a){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new $.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}let bI={padding:Z.constants.RSA_PKCS1_PSS_PADDING,saltLength:Z.constants.RSA_PSS_SALTLEN_DIGEST},bJ=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);function bK(a,b){switch(a){case"EdDSA":if(!["ed25519","ed448"].includes(b.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return b;case"RS256":case"RS384":case"RS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return aZ(b,a),b;case bf&&"PS256":case bf&&"PS384":case bf&&"PS512":if("rsa-pss"===b.asymmetricKeyType){let{hashAlgorithm:c,mgf1HashAlgorithm:d,saltLength:e}=b.asymmetricKeyDetails,f=parseInt(a.slice(-3),10);if(void 0!==c&&(c!==`sha${f}`||d!==c))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${a}`);if(void 0!==e&&e>f>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${a}`)}else if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return aZ(b,a),{key:b,...bI};case!bf&&"PS256":case!bf&&"PS384":case!bf&&"PS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return aZ(b,a),{key:b,...bI};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let c=aM(b),d=bJ.get(a);if(c!==d)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${d}, got ${c}`);return{dsaEncoding:"ieee-p1363",key:b}}default:throw new $.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}function bL(a,b,c){if(b instanceof Uint8Array){if(!a.startsWith("HS"))throw TypeError(ar(b,...av));return(0,Z.createSecretKey)(b)}if(b instanceof Z.KeyObject)return b;if(ak(b))return!function(a,b,...c){switch(b){case"HS256":case"HS384":case"HS512":{if(!am(a.algorithm,"HMAC"))throw al("HMAC");let c=parseInt(b.slice(2),10);if(an(a.algorithm.hash)!==c)throw al(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!am(a.algorithm,"RSASSA-PKCS1-v1_5"))throw al("RSASSA-PKCS1-v1_5");let c=parseInt(b.slice(2),10);if(an(a.algorithm.hash)!==c)throw al(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!am(a.algorithm,"RSA-PSS"))throw al("RSA-PSS");let c=parseInt(b.slice(2),10);if(an(a.algorithm.hash)!==c)throw al(`SHA-${c}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==a.algorithm.name&&"Ed448"!==a.algorithm.name)throw al("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!am(a.algorithm,"ECDSA"))throw al("ECDSA");let c=function(a){switch(a){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(b);if(a.algorithm.namedCurve!==c)throw al(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}ao(a,c)}(b,a,c),Z.KeyObject.from(b);throw TypeError(ar(b,...av,"Uint8Array"))}c=Z.sign.length>3?(0,ad.promisify)(Z.sign):Z.sign;let bM=async(a,b,d)=>{let e=bL(a,b,"sign");if(a.startsWith("HS")){let b=Z.createHmac(function(a){switch(a){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new $.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}(a),e);return b.update(d),b.digest()}return c(bH(a),d,bK(a,e))};d=Z.verify.length>4&&(bd>=16||15===bd&&be>=13)?(0,ad.promisify)(Z.verify):Z.verify;let bN=async(a,b,c,e)=>{let f=bL(a,b,"verify");if(a.startsWith("HS")){let b=await bM(a,f,e);try{return Z.timingSafeEqual(c,b)}catch{return!1}}let g=bH(a),h=bK(a,f);try{return await d(g,e,h,c)}catch{return!1}};async function bO(a,b,c){var d;let e,f;if(!(0,aB.default)(a))throw new $.JWSInvalid("Flattened JWS must be an object");if(void 0===a.protected&&void 0===a.header)throw new $.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==a.protected&&"string"!=typeof a.protected)throw new $.JWSInvalid("JWS Protected Header incorrect type");if(void 0===a.payload)throw new $.JWSInvalid("JWS Payload missing");if("string"!=typeof a.signature)throw new $.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==a.header&&!(0,aB.default)(a.header))throw new $.JWSInvalid("JWS Unprotected Header incorrect type");let g={};if(a.protected)try{let b=(0,Y.decode)(a.protected);g=JSON.parse(ag.decoder.decode(b))}catch{throw new $.JWSInvalid("JWS Protected Header is invalid")}if(!aA(g,a.header))throw new $.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let h={...g,...a.header},i=bs($.JWSInvalid,new Map([["b64",!0]]),null==c?void 0:c.crit,g,h),j=!0;if(i.has("b64")&&"boolean"!=typeof(j=g.b64))throw new $.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:k}=h;if("string"!=typeof k||!k)throw new $.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let l=c&&bt("algorithms",c.algorithms);if(l&&!l.has(k))throw new $.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(j){if("string"!=typeof a.payload)throw new $.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof a.payload&&!(a.payload instanceof Uint8Array))throw new $.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let m=!1;"function"==typeof b&&(b=await b(g,a),m=!0),bn(k,b,"verify");let o=(0,ag.concat)(ag.encoder.encode(null!=(d=a.protected)?d:""),ag.encoder.encode("."),"string"==typeof a.payload?ag.encoder.encode(a.payload):a.payload);try{e=(0,Y.decode)(a.signature)}catch{throw new $.JWSInvalid("Failed to base64url decode the signature")}if(!await bN(k,b,e,o))throw new $.JWSSignatureVerificationFailed;if(j)try{f=(0,Y.decode)(a.payload)}catch{throw new $.JWSInvalid("Failed to base64url decode the payload")}else f="string"==typeof a.payload?ag.encoder.encode(a.payload):a.payload;let p={payload:f};return(void 0!==a.protected&&(p.protectedHeader=g),void 0!==a.header&&(p.unprotectedHeader=a.header),m)?{...p,key:b}:p}async function bP(a,b,c){if(a instanceof Uint8Array&&(a=ag.decoder.decode(a)),"string"!=typeof a)throw new $.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:d,1:e,2:f,length:g}=a.split(".");if(3!==g)throw new $.JWSInvalid("Invalid Compact JWS");let h=await bO({payload:e,protected:d,signature:f},b,c),i={payload:h.payload,protectedHeader:h.protectedHeader};return"function"==typeof b?{...i,key:h.key}:i}async function bQ(a,b,c){if(!(0,aB.default)(a))throw new $.JWSInvalid("General JWS must be an object");if(!Array.isArray(a.signatures)||!a.signatures.every(aB.default))throw new $.JWSInvalid("JWS Signatures missing or incorrect type");for(let d of a.signatures)try{return await bO({header:d.header,payload:a.payload,protected:d.protected,signature:d.signature},b,c)}catch{}throw new $.JWSSignatureVerificationFailed}let bR=a=>Math.floor(a.getTime()/1e3),bS=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,bT=a=>{let b=bS.exec(a);if(!b)throw TypeError("Invalid time period format");let c=parseFloat(b[1]);switch(b[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(c);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*c);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*c);case"day":case"days":case"d":return Math.round(86400*c);case"week":case"weeks":case"w":return Math.round(604800*c);default:return Math.round(0x1e187e0*c)}},bU=a=>a.toLowerCase().replace(/^application\//,""),bV=(a,b,c={})=>{var d,e;let f,g,{typ:h}=c;if(h&&("string"!=typeof a.typ||bU(a.typ)!==bU(h)))throw new $.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{f=JSON.parse(ag.decoder.decode(b))}catch{}if(!(0,aB.default)(f))throw new $.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:i=[],issuer:j,subject:k,audience:l,maxTokenAge:m}=c;for(let a of(void 0!==m&&i.push("iat"),void 0!==l&&i.push("aud"),void 0!==k&&i.push("sub"),void 0!==j&&i.push("iss"),new Set(i.reverse())))if(!(a in f))throw new $.JWTClaimValidationFailed(`missing required "${a}" claim`,a,"missing");if(j&&!(Array.isArray(j)?j:[j]).includes(f.iss))throw new $.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(k&&f.sub!==k)throw new $.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(l&&(d=f.aud,e="string"==typeof l?[l]:l,"string"==typeof d?!e.includes(d):!(Array.isArray(d)&&e.some(Set.prototype.has.bind(new Set(d))))))throw new $.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof c.clockTolerance){case"string":g=bT(c.clockTolerance);break;case"number":g=c.clockTolerance;break;case"undefined":g=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:o}=c,p=bR(o||new Date);if((void 0!==f.iat||m)&&"number"!=typeof f.iat)throw new $.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==f.nbf){if("number"!=typeof f.nbf)throw new $.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(f.nbf>p+g)throw new $.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==f.exp){if("number"!=typeof f.exp)throw new $.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(f.exp<=p-g)throw new $.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(m){let a=p-f.iat;if(a-g>("number"==typeof m?m:bT(m)))throw new $.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(a<0-g)throw new $.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return f};async function bW(a,b,c){var d;let e=await bP(a,b,c);if((null==(d=e.protectedHeader.crit)?void 0:d.includes("b64"))&&!1===e.protectedHeader.b64)throw new $.JWTInvalid("JWTs MUST NOT use unencoded payload");let f={payload:bV(e.protectedHeader,e.payload,c),protectedHeader:e.protectedHeader};return"function"==typeof b?{...f,key:e.key}:f}async function bX(a,b,c){let d=await bv(a,b,c),e=bV(d.protectedHeader,d.plaintext,c),{protectedHeader:f}=d;if(void 0!==f.iss&&f.iss!==e.iss)throw new $.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==f.sub&&f.sub!==e.sub)throw new $.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==f.aud&&JSON.stringify(f.aud)!==JSON.stringify(e.aud))throw new $.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let g={payload:e,protectedHeader:f};return"function"==typeof b?{...g,key:d.key}:g}class bY{constructor(a){this._flattened=new bE(a)}setContentEncryptionKey(a){return this._flattened.setContentEncryptionKey(a),this}setInitializationVector(a){return this._flattened.setInitializationVector(a),this}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}setKeyManagementParameters(a){return this._flattened.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this._flattened.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}class bZ{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=a}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}async sign(a,b){let c;if(!this._protectedHeader&&!this._unprotectedHeader)throw new $.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!aA(this._protectedHeader,this._unprotectedHeader))throw new $.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let d={...this._protectedHeader,...this._unprotectedHeader},e=bs($.JWSInvalid,new Map([["b64",!0]]),null==b?void 0:b.crit,this._protectedHeader,d),f=!0;if(e.has("b64")&&"boolean"!=typeof(f=this._protectedHeader.b64))throw new $.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:g}=d;if("string"!=typeof g||!g)throw new $.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');bn(g,a,"sign");let h=this._payload;f&&(h=ag.encoder.encode((0,Y.encode)(h))),c=this._protectedHeader?ag.encoder.encode((0,Y.encode)(JSON.stringify(this._protectedHeader))):ag.encoder.encode("");let i=(0,ag.concat)(c,ag.encoder.encode("."),h),j=await bM(g,a,i),k={signature:(0,Y.encode)(j),payload:""};return f&&(k.payload=ag.decoder.decode(h)),this._unprotectedHeader&&(k.header=this._unprotectedHeader),this._protectedHeader&&(k.protected=ag.decoder.decode(c)),k}}class b${constructor(a){this._flattened=new bZ(a)}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}async sign(a,b){let c=await this._flattened.sign(a,b);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}}class b_{constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setProtectedHeader(a){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=a,this}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addSignature(...a){return this.parent.addSignature(...a)}sign(...a){return this.parent.sign(...a)}done(){return this.parent}}class b0{constructor(a){this._signatures=[],this._payload=a}addSignature(a,b){let c=new b_(this,a,b);return this._signatures.push(c),c}async sign(){if(!this._signatures.length)throw new $.JWSInvalid("at least one signature must be added");let a={signatures:[],payload:""};for(let b=0;b<this._signatures.length;b++){let c=this._signatures[b],d=new bZ(this._payload);d.setProtectedHeader(c.protectedHeader),d.setUnprotectedHeader(c.unprotectedHeader);let{payload:e,...f}=await d.sign(c.key,c.options);if(0===b)a.payload=e;else if(a.payload!==e)throw new $.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");a.signatures.push(f)}return a}}class b1{constructor(a){if(!(0,aB.default)(a))throw TypeError("JWT Claims Set MUST be an object");this._payload=a}setIssuer(a){return this._payload={...this._payload,iss:a},this}setSubject(a){return this._payload={...this._payload,sub:a},this}setAudience(a){return this._payload={...this._payload,aud:a},this}setJti(a){return this._payload={...this._payload,jti:a},this}setNotBefore(a){return"number"==typeof a?this._payload={...this._payload,nbf:a}:this._payload={...this._payload,nbf:bR(new Date)+bT(a)},this}setExpirationTime(a){return"number"==typeof a?this._payload={...this._payload,exp:a}:this._payload={...this._payload,exp:bR(new Date)+bT(a)},this}setIssuedAt(a){return void 0===a?this._payload={...this._payload,iat:bR(new Date)}:this._payload={...this._payload,iat:a},this}}class b2 extends b1{setProtectedHeader(a){return this._protectedHeader=a,this}async sign(a,b){var c;let d=new b$(ag.encoder.encode(JSON.stringify(this._payload)));if(d.setProtectedHeader(this._protectedHeader),Array.isArray(null==(c=this._protectedHeader)?void 0:c.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new $.JWTInvalid("JWTs MUST NOT use unencoded payload");return d.sign(a,b)}}class b3 extends b1{setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(a,b){let c=new bY(ag.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),c.setProtectedHeader(this._protectedHeader),this._iv&&c.setInitializationVector(this._iv),this._cek&&c.setContentEncryptionKey(this._cek),this._keyManagementParameters&&c.setKeyManagementParameters(this._keyManagementParameters),c.encrypt(a,b)}}var b4=a.i(971866);let b5=(a,b)=>{if("string"!=typeof a||!a)throw new $.JWKInvalid(`${b} missing or invalid`)};async function b6(a,b){let c;if(!(0,aB.default)(a))throw TypeError("JWK must be an object");if(null!=b||(b="sha256"),"sha256"!==b&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(a.kty){case"EC":b5(a.crv,'"crv" (Curve) Parameter'),b5(a.x,'"x" (X Coordinate) Parameter'),b5(a.y,'"y" (Y Coordinate) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x,y:a.y};break;case"OKP":b5(a.crv,'"crv" (Subtype of Key Pair) Parameter'),b5(a.x,'"x" (Public Key) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x};break;case"RSA":b5(a.e,'"e" (Exponent) Parameter'),b5(a.n,'"n" (Modulus) Parameter'),c={e:a.e,kty:a.kty,n:a.n};break;case"oct":b5(a.k,'"k" (Key Value) Parameter'),c={k:a.k,kty:a.kty};break;default:throw new $.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let d=ag.encoder.encode(JSON.stringify(c));return(0,Y.encode)(await (0,b4.default)(b,d))}async function b7(a,b){null!=b||(b="sha256");let c=await b6(a,b);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${b.slice(-3)}:${c}`}async function b8(a,b){let c={...a,...null==b?void 0:b.header};if(!(0,aB.default)(c.jwk))throw new $.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let d=await bm({...c.jwk,ext:!0},c.alg,!0);if(d instanceof Uint8Array||"public"!==d.type)throw new $.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return d}function b9(a){return a&&"object"==typeof a&&Array.isArray(a.keys)&&a.keys.every(ca)}function ca(a){return(0,aB.default)(a)}class cb{constructor(a){if(this._cached=new WeakMap,!b9(a))throw new $.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(a){return"function"==typeof structuredClone?structuredClone(a):JSON.parse(JSON.stringify(a))}(a)}async getKey(a,b){let{alg:c,kid:d}={...a,...null==b?void 0:b.header},e=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new $.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(c),f=this._jwks.keys.filter(a=>{let b=e===a.kty;if(b&&"string"==typeof d&&(b=d===a.kid),b&&"string"==typeof a.alg&&(b=c===a.alg),b&&"string"==typeof a.use&&(b="sig"===a.use),b&&Array.isArray(a.key_ops)&&(b=a.key_ops.includes("verify")),b&&"EdDSA"===c&&(b="Ed25519"===a.crv||"Ed448"===a.crv),b)switch(c){case"ES256":b="P-256"===a.crv;break;case"ES256K":b="secp256k1"===a.crv;break;case"ES384":b="P-384"===a.crv;break;case"ES512":b="P-521"===a.crv}return b}),{0:g,length:h}=f;if(0===h)throw new $.JWKSNoMatchingKey;if(1!==h){let a=new $.JWKSMultipleMatchingKeys,{_cached:b}=this;throw a[Symbol.asyncIterator]=async function*(){for(let a of f)try{yield await cc(b,a,c)}catch{continue}},a}return cc(this._cached,g,c)}}async function cc(a,b,c){let d=a.get(b)||a.set(b,{}).get(b);if(void 0===d[c]){let a=await bm({...b,ext:!0},c);if(a instanceof Uint8Array||"public"!==a.type)throw new $.JWKSInvalid("JSON Web Key Set members must be public keys");d[c]=a}return d[c]}function cd(a){let b=new cb(a);return async function(a,c){return b.getKey(a,c)}}var ce=a.i(921517),cf=a.i(524836),cg=a.i(427699);let ch=async(a,b,c)=>{let d;switch(a.protocol){case"https:":d=cf.get;break;case"http:":d=ce.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:e,headers:f}=c,g=d(a.href,{agent:e,timeout:b,headers:f}),[h]=await Promise.race([(0,cg.once)(g,"response"),(0,cg.once)(g,"timeout")]);if(!h)throw g.destroy(),new $.JWKSTimeout;if(200!==h.statusCode)throw new $.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let i=[];for await(let a of h)i.push(a);try{return JSON.parse(ag.decoder.decode((0,ag.concat)(...i)))}catch{throw new $.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};class ci extends cb{constructor(a,b){if(super({keys:[]}),this._jwks=void 0,!(a instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(a.href),this._options={agent:null==b?void 0:b.agent,headers:null==b?void 0:b.headers},this._timeoutDuration="number"==typeof(null==b?void 0:b.timeoutDuration)?null==b?void 0:b.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==b?void 0:b.cooldownDuration)?null==b?void 0:b.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==b?void 0:b.cacheMaxAge)?null==b?void 0:b.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(a,b){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(a,b)}catch(c){if(c instanceof $.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(a,b);throw c}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=ch(this._url,this._timeoutDuration,this._options).then(a=>{if(!b9(a))throw new $.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:a.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(a=>{throw this._pendingFetch=void 0,a})),await this._pendingFetch}}function cj(a,b){let c=new ci(a,b);return async function(a,b){return c.getKey(a,b)}}class ck extends b1{encode(){let a=Y.encode(JSON.stringify({alg:"none"})),b=Y.encode(JSON.stringify(this._payload));return`${a}.${b}.`}static decode(a,b){let c;if("string"!=typeof a)throw new $.JWTInvalid("Unsecured JWT must be a string");let{0:d,1:e,2:f,length:g}=a.split(".");if(3!==g||""!==f)throw new $.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(ag.decoder.decode(Y.decode(d))),"none"!==c.alg)throw Error()}catch{throw new $.JWTInvalid("Invalid Unsecured JWT")}return{payload:bV(c,Y.decode(e),b),header:c}}}var cl=a.i(733865);function cm(a){let b;if("string"==typeof a){let c=a.split(".");(3===c.length||5===c.length)&&([b]=c)}else if("object"==typeof a&&a)if("protected"in a)b=a.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof b||!b)throw Error();let a=JSON.parse(ag.decoder.decode((0,cl.decode)(b)));if(!(0,aB.default)(a))throw Error();return a}catch{throw TypeError("Invalid Token or Protected Header formatting")}}var cn=a.i(629116),_=Z;let co=(0,ad.promisify)(Z.generateKeyPair);async function cp(a,b){let c;switch(a){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new $.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,Z.createSecretKey)((0,_.randomFillSync)(new Uint8Array(c>>3)))}async function cq(a,b){var c,d;switch(a){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let a=null!=(c=null==b?void 0:b.modulusLength)?c:2048;if("number"!=typeof a||a<2048)throw new $.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let d=await co("rsa",{modulusLength:a,publicExponent:65537});return aY(d.privateKey,a),aY(d.publicKey,a),d}case"ES256":return co("ec",{namedCurve:"P-256"});case"ES256K":return co("ec",{namedCurve:"secp256k1"});case"ES384":return co("ec",{namedCurve:"P-384"});case"ES512":return co("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==b?void 0:b.crv){case void 0:case"Ed25519":return co("ed25519");case"Ed448":return co("ed448");default:throw new $.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let e=null!=(d=null==b?void 0:b.crv)?d:"P-256";switch(e){case void 0:case"P-256":case"P-384":case"P-521":return co("ec",{namedCurve:e});case"X25519":return co("x25519");case"X448":return co("x448");default:throw new $.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new $.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}async function cr(a,b){return cq(a,b)}async function cs(a,b){return cp(a,b)}a.s(["CompactEncrypt",()=>bY,"CompactSign",()=>b$,"EmbeddedJWK",()=>b8,"EncryptJWT",()=>b3,"FlattenedEncrypt",()=>bE,"FlattenedSign",()=>bZ,"GeneralEncrypt",()=>bG,"GeneralSign",()=>b0,"SignJWT",()=>b2,"UnsecuredJWT",()=>ck,"base64url",0,cl,"calculateJwkThumbprint",()=>b6,"calculateJwkThumbprintUri",()=>b7,"compactDecrypt",()=>bv,"compactVerify",()=>bP,"createLocalJWKSet",()=>cd,"createRemoteJWKSet",()=>cj,"cryptoRuntime",0,"node:crypto","decodeJwt",()=>cn.decodeJwt,"decodeProtectedHeader",()=>cm,"errors",0,$,"exportJWK",()=>bB,"exportPKCS8",()=>bA,"exportSPKI",()=>bz,"flattenedDecrypt",()=>bu,"flattenedVerify",()=>bO,"generalDecrypt",()=>bw,"generalVerify",()=>bQ,"generateKeyPair",()=>cr,"generateSecret",()=>cs,"importJWK",()=>bm,"importPKCS8",()=>bl,"importSPKI",()=>bj,"importX509",()=>bk,"jwtDecrypt",()=>bX,"jwtVerify",()=>bW],812412),a.i(812412);var ct=a.i(296715),cu=a.i(248191),cv=a.i(562724),cw=a.i(9314),cx=a.i(421663),cy=a.i(360228),cz=a.i(256291);class cA{constructor(a,b){this.scope=a,this.module=b}storeObject(a,b){this.setItem(a,JSON.stringify(b))}loadObject(a){let b=this.getItem(a);return b?JSON.parse(b):void 0}setItem(a,b){localStorage.setItem(this.scopedKey(a),b)}getItem(a){return localStorage.getItem(this.scopedKey(a))}removeItem(a){localStorage.removeItem(this.scopedKey(a))}clear(){let a=this.scopedKey(""),b=[];for(let c=0;c<localStorage.length;c++){let d=localStorage.key(c);"string"==typeof d&&d.startsWith(a)&&b.push(d)}b.forEach(a=>localStorage.removeItem(a))}scopedKey(a){return`-${this.scope}${this.module?`:${this.module}`:""}:${a}`}static clearAll(){new cA("CBWSDK").clear(),new cA("walletlink").clear()}}let cB=-32602,cC=-32603,cD=4001,cE=4100,cF=4200,cG=4900,cH={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4902:{standard:"EIP-3085",message:"Unrecognized chain ID."}},cI="Unspecified error message.";function cJ(a,b=cI){if(a&&Number.isInteger(a)){var c;let b=a.toString();if(cL(cH,b))return cH[b].message;if((c=a)>=-32099&&c<=-32e3)return"Unspecified server error."}return b}function cK(a){return a&&"object"==typeof a&&!Array.isArray(a)?Object.assign({},a):a}function cL(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function cM(a,b){return"object"==typeof a&&null!==a&&b in a&&"string"==typeof a[b]}let cN=a=>cU(cB,a),cO=a=>cU(cC,a),cP=a=>cV(cD,a),cQ=a=>cV(cE,a),cR=a=>cV(cF,a),cS=a=>cV(cG,a),cT=a=>{if(!a||"object"!=typeof a||Array.isArray(a))throw Error("Ethereum Provider custom errors must provide single object argument.");let{code:b,message:c,data:d}=a;if(!c||"string"!=typeof c)throw Error('"message" must be a nonempty string');return new cY(b,c,d)};function cU(a,b){let[c,d]=cW(b);return new cX(a,c||cJ(a),d)}function cV(a,b){let[c,d]=cW(b);return new cY(a,c||cJ(a),d)}function cW(a){if(a){if("string"==typeof a)return[a];else if("object"==typeof a&&!Array.isArray(a)){let{message:b,data:c}=a;if(b&&"string"!=typeof b)throw Error("Must specify string message.");return[b||void 0,c]}}return[]}class cX extends Error{constructor(a,b,c){if(!Number.isInteger(a))throw Error('"code" must be an integer.');if(!b||"string"!=typeof b)throw Error('"message" must be a nonempty string.');super(b),this.code=a,void 0!==c&&(this.data=c)}}class cY extends cX{constructor(a,b,c){if(!function(a){return Number.isInteger(a)&&a>=1e3&&a<=4999}(a))throw Error('"code" must be an integer such that: 1000 <= code <= 4999');super(a,b,c)}}function cZ(a){return Math.floor(a)}let c$=/^[0-9]*$/,c_=/^[a-f0-9]*$/;function c0(a){return c1(crypto.getRandomValues(new Uint8Array(a)))}function c1(a){return[...a].map(a=>a.toString(16).padStart(2,"0")).join("")}function c2(a){return new Uint8Array(a.match(/.{1,2}/g).map(a=>Number.parseInt(a,16)))}function c3(a,b=!1){let c=a.toString("hex");return b?`0x${c}`:c}function c4(a){return c3(dd(a),!0)}function c5(a){return a.toString(10)}function c6(a){return`0x${BigInt(a).toString(16)}`}function c7(a){return a.startsWith("0x")||a.startsWith("0X")}function c8(a){return c7(a)?a.slice(2):a}function c9(a){return c7(a)?`0x${a.slice(2)}`:`0x${a}`}function da(a){if("string"!=typeof a)return!1;let b=c8(a).toLowerCase();return c_.test(b)}function db(a,b=!1){let c=function(a,b=!1){if("string"==typeof a){let c=c8(a).toLowerCase();if(c_.test(c))return b?`0x${c}`:c}throw cN(`"${String(a)}" is not a hexadecimal string`)}(a,!1);return c.length%2==1&&(c=`0${c}`),b?`0x${c}`:c}function dc(a){if("string"==typeof a){let b=c8(a).toLowerCase();if(da(b)&&40===b.length)return c9(b)}throw cN(`Invalid Ethereum address: ${String(a)}`)}function dd(a){if(Buffer.isBuffer(a))return a;if("string"==typeof a){if(da(a)){let b=db(a,!1);return Buffer.from(b,"hex")}return Buffer.from(a,"utf8")}throw cN(`Not binary data: ${String(a)}`)}function de(a){if("number"==typeof a&&Number.isInteger(a))return cZ(a);if("string"==typeof a){if(c$.test(a))return cZ(Number(a));if(da(a))return cZ(Number(BigInt(db(a,!0))))}throw cN(`Not an integer: ${String(a)}`)}function df(a){if(null!==a&&("bigint"==typeof a||function(a){if(null==a||"function"!=typeof a.constructor)return!1;let{constructor:b}=a;return"function"==typeof b.config&&"number"==typeof b.EUCLID}(a)))return BigInt(a.toString(10));if("number"==typeof a)return BigInt(de(a));if("string"==typeof a){if(c$.test(a))return BigInt(a);if(da(a))return BigInt(db(a,!0))}throw cN(`Not an integer: ${String(a)}`)}async function dg(){return crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"])}async function dh(a,b){return crypto.subtle.deriveKey({name:"ECDH",public:b},a,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function di(a,b){let c=crypto.getRandomValues(new Uint8Array(12)),d=await crypto.subtle.encrypt({name:"AES-GCM",iv:c},a,new TextEncoder().encode(b));return{iv:c,cipherText:d}}async function dj(a,{iv:b,cipherText:c}){let d=await crypto.subtle.decrypt({name:"AES-GCM",iv:b},a,c);return new TextDecoder().decode(d)}function dk(a){switch(a){case"public":return"spki";case"private":return"pkcs8"}}async function dl(a,b){let c=dk(a);return c1(new Uint8Array(await crypto.subtle.exportKey(c,b)))}async function dm(a,b){let c=dk(a),d=c2(b).buffer;return await crypto.subtle.importKey(c,new Uint8Array(d),{name:"ECDH",namedCurve:"P-256"},!0,"private"===a?["deriveKey"]:[])}async function dn(a,b){return di(b,JSON.stringify(a,(a,b)=>b instanceof Error?Object.assign(Object.assign({},b.code?{code:b.code}:{}),{message:b.message}):b))}async function dp(a,b){return JSON.parse(await dj(b,a))}let dq={storageKey:"ownPrivateKey",keyType:"private"},dr={storageKey:"ownPublicKey",keyType:"public"},ds={storageKey:"peerPublicKey",keyType:"public"};class dt{constructor(){this.storage=new cA("CBWSDK","SCWKeyManager"),this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null}async getOwnPublicKey(){return await this.loadKeysIfNeeded(),this.ownPublicKey}async getSharedSecret(){return await this.loadKeysIfNeeded(),this.sharedSecret}async setPeerPublicKey(a){this.sharedSecret=null,this.peerPublicKey=a,await this.storeKey(ds,a),await this.loadKeysIfNeeded()}async clear(){this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null,this.storage.removeItem(dr.storageKey),this.storage.removeItem(dq.storageKey),this.storage.removeItem(ds.storageKey)}async generateKeyPair(){let a=await dg();this.ownPrivateKey=a.privateKey,this.ownPublicKey=a.publicKey,await this.storeKey(dq,a.privateKey),await this.storeKey(dr,a.publicKey)}async loadKeysIfNeeded(){null===this.ownPrivateKey&&(this.ownPrivateKey=await this.loadKey(dq)),null===this.ownPublicKey&&(this.ownPublicKey=await this.loadKey(dr)),(null===this.ownPrivateKey||null===this.ownPublicKey)&&await this.generateKeyPair(),null===this.peerPublicKey&&(this.peerPublicKey=await this.loadKey(ds)),null===this.sharedSecret&&null!==this.ownPrivateKey&&null!==this.peerPublicKey&&(this.sharedSecret=await dh(this.ownPrivateKey,this.peerPublicKey))}async loadKey(a){let b=this.storage.getItem(a.storageKey);return b?dm(a.keyType,b):null}async storeKey(a,b){let c=await dl(a.keyType,b);this.storage.setItem(a.storageKey,c)}}let du="4.3.2",dv="@coinbase/wallet-sdk";async function dw(a,b){let c=Object.assign(Object.assign({},a),{jsonrpc:"2.0",id:crypto.randomUUID()}),d=await window.fetch(b,{method:"POST",body:JSON.stringify(c),mode:"cors",headers:{"Content-Type":"application/json","X-Cbw-Sdk-Version":du,"X-Cbw-Sdk-Platform":dv}}),{result:e,error:f}=await d.json();if(f)throw f;return e}let dx="accounts",dy="activeChain",dz="availableChains",dA="walletCapabilities";class dB{constructor(a){var b,c,d;this.metadata=a.metadata,this.communicator=a.communicator,this.callback=a.callback,this.keyManager=new dt,this.storage=new cA("CBWSDK","SCWStateManager"),this.accounts=null!=(b=this.storage.loadObject(dx))?b:[],this.chain=this.storage.loadObject(dy)||{id:null!=(d=null==(c=a.metadata.appChainIds)?void 0:c[0])?d:1},this.handshake=this.handshake.bind(this),this.request=this.request.bind(this),this.createRequestMessage=this.createRequestMessage.bind(this),this.decryptResponseMessage=this.decryptResponseMessage.bind(this)}async handshake(a){var b,c,d,e;await (null==(c=(b=this.communicator).waitForPopupLoaded)?void 0:c.call(b));let f=await this.createRequestMessage({handshake:{method:a.method,params:Object.assign({},this.metadata,null!=(d=a.params)?d:{})}}),g=await this.communicator.postRequestAndWaitForResponse(f);if("failure"in g.content)throw g.content.failure;let h=await dm("public",g.sender);await this.keyManager.setPeerPublicKey(h);let i=(await this.decryptResponseMessage(g)).result;if("error"in i)throw i.error;if("eth_requestAccounts"===a.method){let a=i.value;this.accounts=a,this.storage.storeObject(dx,a),null==(e=this.callback)||e.call(this,"accountsChanged",a)}}async request(a){var b;if(0===this.accounts.length)if("wallet_sendCalls"===a.method)return this.sendRequestToPopup(a);else throw cQ();switch(a.method){case"eth_requestAccounts":return null==(b=this.callback)||b.call(this,"connect",{chainId:c6(this.chain.id)}),this.accounts;case"eth_accounts":return this.accounts;case"eth_coinbase":return this.accounts[0];case"net_version":return this.chain.id;case"eth_chainId":return c6(this.chain.id);case"wallet_getCapabilities":return this.storage.loadObject(dA);case"wallet_switchEthereumChain":return this.handleSwitchChainRequest(a);case"eth_ecRecover":case"personal_sign":case"wallet_sign":case"personal_ecRecover":case"eth_signTransaction":case"eth_sendTransaction":case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"wallet_sendCalls":case"wallet_showCallsStatus":case"wallet_grantPermissions":return this.sendRequestToPopup(a);default:if(!this.chain.rpcUrl)throw cO("No RPC URL set for chain");return dw(a,this.chain.rpcUrl)}}async sendRequestToPopup(a){var b,c;await (null==(c=(b=this.communicator).waitForPopupLoaded)?void 0:c.call(b));let d=await this.sendEncryptedRequest(a),e=(await this.decryptResponseMessage(d)).result;if("error"in e)throw e.error;return e.value}async cleanup(){var a,b;this.storage.clear(),await this.keyManager.clear(),this.accounts=[],this.chain={id:null!=(b=null==(a=this.metadata.appChainIds)?void 0:a[0])?b:1}}async handleSwitchChainRequest(a){var b;let c=a.params;if(!c||!(null==(b=c[0])?void 0:b.chainId))throw cN();let d=de(c[0].chainId);if(this.updateChain(d))return null;let e=await this.sendRequestToPopup(a);return null===e&&this.updateChain(d),e}async sendEncryptedRequest(a){let b=await this.keyManager.getSharedSecret();if(!b)throw cQ("No valid session found, try requestAccounts before other methods");let c=await dn({action:a,chainId:this.chain.id},b),d=await this.createRequestMessage({encrypted:c});return this.communicator.postRequestAndWaitForResponse(d)}async createRequestMessage(a){let b=await dl("public",await this.keyManager.getOwnPublicKey());return{id:crypto.randomUUID(),sender:b,content:a,timestamp:new Date}}async decryptResponseMessage(a){var b,c;let d=a.content;if("failure"in d)throw d.failure;let e=await this.keyManager.getSharedSecret();if(!e)throw cQ("Invalid session");let f=await dp(d.encrypted,e),g=null==(b=f.data)?void 0:b.chains;if(g){let a=Object.entries(g).map(([a,b])=>({id:Number(a),rpcUrl:b}));this.storage.storeObject(dz,a),this.updateChain(this.chain.id,a)}let h=null==(c=f.data)?void 0:c.capabilities;return h&&this.storage.storeObject(dA,h),f}updateChain(a,b){var c;let d=null!=b?b:this.storage.loadObject(dz),e=null==d?void 0:d.find(b=>b.id===a);return!!e&&(e!==this.chain&&(this.chain=e,this.storage.storeObject(dy,e),null==(c=this.callback)||c.call(this,"chainChanged",c6(e.id))),!0)}}var dC=a.i(449105);let dD="Addresses";function dE(a){return void 0!==a.errorMessage}class dF{constructor(a){this.secret=a}async encrypt(a){let b=this.secret;if(64!==b.length)throw Error("secret must be 256 bits");let c=crypto.getRandomValues(new Uint8Array(12)),d=await crypto.subtle.importKey("raw",c2(b),{name:"aes-gcm"},!1,["encrypt","decrypt"]),e=new TextEncoder,f=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:c},d,e.encode(a)),g=f.slice(f.byteLength-16),h=f.slice(0,f.byteLength-16),i=new Uint8Array(g),j=new Uint8Array(h);return c1(new Uint8Array([...c,...i,...j]))}async decrypt(a){let b=this.secret;if(64!==b.length)throw Error("secret must be 256 bits");return new Promise((c,d)=>{!async function(){let e=await crypto.subtle.importKey("raw",c2(b),{name:"aes-gcm"},!1,["encrypt","decrypt"]),f=c2(a),g=f.slice(0,12),h=f.slice(12,28),i=new Uint8Array([...f.slice(28),...h]),j={name:"AES-GCM",iv:new Uint8Array(g)};try{let a=await window.crypto.subtle.decrypt(j,e,i),b=new TextDecoder;c(b.decode(a))}catch(a){d(a)}}()})}}class dG{constructor(a,b,c){this.linkAPIUrl=a,this.sessionId=b;const d=`${b}:${c}`;this.auth=`Basic ${btoa(d)}`}async markUnseenEventsAsSeen(a){return Promise.all(a.map(a=>fetch(`${this.linkAPIUrl}/events/${a.eventId}/seen`,{method:"POST",headers:{Authorization:this.auth}}))).catch(a=>console.error("Unabled to mark event as failed:",a))}async fetchUnseenEvents(){var a;let b=await fetch(`${this.linkAPIUrl}/events?unseen=true`,{headers:{Authorization:this.auth}});if(b.ok){let{events:c,error:d}=await b.json();if(d)throw Error(`Check unseen events failed: ${d}`);let e=null!=(a=null==c?void 0:c.filter(a=>"Web3Response"===a.event).map(a=>({type:"Event",sessionId:this.sessionId,eventId:a.id,event:a.event,data:a.data})))?a:[];return this.markUnseenEventsAsSeen(e),e}throw Error(`Check unseen events failed: ${b.status}`)}}(DY=Ed||(Ed={}))[DY.DISCONNECTED=0]="DISCONNECTED",DY[DY.CONNECTING=1]="CONNECTING",DY[DY.CONNECTED=2]="CONNECTED";class dH{setConnectionStateListener(a){this.connectionStateListener=a}setIncomingDataListener(a){this.incomingDataListener=a}constructor(a,b=WebSocket){this.WebSocketClass=b,this.webSocket=null,this.pendingData=[],this.url=a.replace(/^http/,"ws")}async connect(){if(this.webSocket)throw Error("webSocket object is not null");return new Promise((a,b)=>{var c;let d;try{this.webSocket=d=new this.WebSocketClass(this.url)}catch(a){b(a);return}null==(c=this.connectionStateListener)||c.call(this,Ed.CONNECTING),d.onclose=a=>{var c;this.clearWebSocket(),b(Error(`websocket error ${a.code}: ${a.reason}`)),null==(c=this.connectionStateListener)||c.call(this,Ed.DISCONNECTED)},d.onopen=b=>{var c;a(),null==(c=this.connectionStateListener)||c.call(this,Ed.CONNECTED),this.pendingData.length>0&&([...this.pendingData].forEach(a=>this.sendData(a)),this.pendingData=[])},d.onmessage=a=>{var b,c;if("h"===a.data)null==(b=this.incomingDataListener)||b.call(this,{type:"Heartbeat"});else try{let b=JSON.parse(a.data);null==(c=this.incomingDataListener)||c.call(this,b)}catch(a){}}})}disconnect(){var a;let{webSocket:b}=this;if(b){this.clearWebSocket(),null==(a=this.connectionStateListener)||a.call(this,Ed.DISCONNECTED),this.connectionStateListener=void 0,this.incomingDataListener=void 0;try{b.close()}catch(a){}}}sendData(a){let{webSocket:b}=this;if(!b){this.pendingData.push(a),this.connect();return}b.send(a)}clearWebSocket(){let{webSocket:a}=this;a&&(this.webSocket=null,a.onclose=null,a.onerror=null,a.onmessage=null,a.onopen=null)}}class dI{constructor({session:a,linkAPIUrl:b,listener:c}){this.destroyed=!1,this.lastHeartbeatResponse=0,this.nextReqId=cZ(1),this._connected=!1,this._linked=!1,this.shouldFetchUnseenEventsOnConnect=!1,this.requestResolutions=new Map,this.handleSessionMetadataUpdated=a=>{a&&new Map([["__destroyed",this.handleDestroyed],["EthereumAddress",this.handleAccountUpdated],["WalletUsername",this.handleWalletUsernameUpdated],["AppVersion",this.handleAppVersionUpdated],["ChainId",b=>a.JsonRpcUrl&&this.handleChainUpdated(b,a.JsonRpcUrl)]]).forEach((b,c)=>{let d=a[c];void 0!==d&&b(d)})},this.handleDestroyed=a=>{var b;"1"===a&&(null==(b=this.listener)||b.resetAndReload())},this.handleAccountUpdated=async a=>{var b;let c=await this.cipher.decrypt(a);null==(b=this.listener)||b.accountUpdated(c)},this.handleMetadataUpdated=async(a,b)=>{var c;let d=await this.cipher.decrypt(b);null==(c=this.listener)||c.metadataUpdated(a,d)},this.handleWalletUsernameUpdated=async a=>{this.handleMetadataUpdated("walletUsername",a)},this.handleAppVersionUpdated=async a=>{this.handleMetadataUpdated("AppVersion",a)},this.handleChainUpdated=async(a,b)=>{var c;let d=await this.cipher.decrypt(a),e=await this.cipher.decrypt(b);null==(c=this.listener)||c.chainUpdated(d,e)},this.session=a,this.cipher=new dF(a.secret),this.listener=c;const d=new dH(`${b}/rpc`,WebSocket);d.setConnectionStateListener(async a=>{let b=!1;switch(a){case Ed.DISCONNECTED:if(!this.destroyed){let a=async()=>{await new Promise(a=>setTimeout(a,5e3)),this.destroyed||d.connect().catch(()=>{a()})};a()}break;case Ed.CONNECTED:b=await this.handleConnected(),this.updateLastHeartbeat(),setInterval(()=>{this.heartbeat()},1e4),this.shouldFetchUnseenEventsOnConnect&&this.fetchUnseenEventsAPI();case Ed.CONNECTING:}this.connected!==b&&(this.connected=b)}),d.setIncomingDataListener(a=>{var b;switch(a.type){case"Heartbeat":this.updateLastHeartbeat();return;case"IsLinkedOK":case"Linked":{let b="IsLinkedOK"===a.type?a.linked:void 0;this.linked=b||a.onlineGuests>0;break}case"GetSessionConfigOK":case"SessionConfigUpdated":this.handleSessionMetadataUpdated(a.metadata);break;case"Event":this.handleIncomingEvent(a)}void 0!==a.id&&(null==(b=this.requestResolutions.get(a.id))||b(a))}),this.ws=d,this.http=new dG(b,a.id,a.key)}connect(){if(this.destroyed)throw Error("instance is destroyed");this.ws.connect()}async destroy(){this.destroyed||(await this.makeRequest({type:"SetSessionConfig",id:cZ(this.nextReqId++),sessionId:this.session.id,metadata:{__destroyed:"1"}},{timeout:1e3}),this.destroyed=!0,this.ws.disconnect(),this.listener=void 0)}get connected(){return this._connected}set connected(a){this._connected=a}get linked(){return this._linked}set linked(a){var b,c;this._linked=a,a&&(null==(b=this.onceLinked)||b.call(this)),null==(c=this.listener)||c.linkedUpdated(a)}setOnceLinked(a){return new Promise(b=>{this.linked?a().then(b):this.onceLinked=()=>{a().then(b),this.onceLinked=void 0}})}async handleIncomingEvent(a){var b;if("Event"!==a.type||"Web3Response"!==a.event)return;let c=JSON.parse(await this.cipher.decrypt(a.data));if("WEB3_RESPONSE"!==c.type)return;let{id:d,response:e}=c;null==(b=this.listener)||b.handleWeb3ResponseMessage(d,e)}async checkUnseenEvents(){if(!this.connected){this.shouldFetchUnseenEventsOnConnect=!0;return}await new Promise(a=>setTimeout(a,250));try{await this.fetchUnseenEventsAPI()}catch(a){console.error("Unable to check for unseen events",a)}}async fetchUnseenEventsAPI(){this.shouldFetchUnseenEventsOnConnect=!1,(await this.http.fetchUnseenEvents()).forEach(a=>this.handleIncomingEvent(a))}async publishEvent(a,b,c=!1){let d=await this.cipher.encrypt(JSON.stringify(Object.assign(Object.assign({},b),{origin:location.origin,location:location.href,relaySource:"coinbaseWalletExtension"in window&&window.coinbaseWalletExtension?"injected_sdk":"sdk"}))),e={type:"PublishEvent",id:cZ(this.nextReqId++),sessionId:this.session.id,event:a,data:d,callWebhook:c};return this.setOnceLinked(async()=>{let a=await this.makeRequest(e);if("Fail"===a.type)throw Error(a.error||"failed to publish event");return a.eventId})}sendData(a){this.ws.sendData(JSON.stringify(a))}updateLastHeartbeat(){this.lastHeartbeatResponse=Date.now()}heartbeat(){if(Date.now()-this.lastHeartbeatResponse>2e4)return void this.ws.disconnect();try{this.ws.sendData("h")}catch(a){}}async makeRequest(a,b={timeout:6e4}){let c,d=a.id;return this.sendData(a),Promise.race([new Promise((a,e)=>{c=window.setTimeout(()=>{e(Error(`request ${d} timed out`))},b.timeout)}),new Promise(a=>{this.requestResolutions.set(d,b=>{clearTimeout(c),a(b),this.requestResolutions.delete(d)})})])}async handleConnected(){return"Fail"!==(await this.makeRequest({type:"HostSession",id:cZ(this.nextReqId++),sessionId:this.session.id,sessionKey:this.session.key})).type&&(this.sendData({type:"IsLinked",id:cZ(this.nextReqId++),sessionId:this.session.id}),this.sendData({type:"GetSessionConfig",id:cZ(this.nextReqId++),sessionId:this.session.id}),!0)}}class dJ{constructor(){this._nextRequestId=0,this.callbacks=new Map}makeRequestId(){this._nextRequestId=(this._nextRequestId+1)%0x7fffffff;let a=this._nextRequestId,b=c9(a.toString(16));return this.callbacks.get(b)&&this.callbacks.delete(b),a}}function dK(a,...b){if(!(a instanceof Uint8Array||null!=a&&"object"==typeof a&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error(`Uint8Array expected of length ${b}, not of length=${a.length}`)}function dL(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}var dM=a.i(666680);dM&&"object"==typeof dM&&"webcrypto"in dM&&dM.webcrypto;let dN=a=>new DataView(a.buffer,a.byteOffset,a.byteLength),dO=(a,b)=>a<<32-b|a>>>b;new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];let dP=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function dQ(a){return"string"==typeof a&&(a=function(a){if("string"!=typeof a)throw Error(`utf8ToBytes expected string, got ${typeof a}`);return new Uint8Array(new TextEncoder().encode(a))}(a)),dK(a),a}class dR{clone(){return this._cloneInto()}}let dS=(a,b,c)=>a&b^~a&c,dT=(a,b,c)=>a&b^a&c^b&c;class dU extends dR{constructor(a,b,c,d){super(),this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(a),this.view=dN(this.buffer)}update(a){dL(this);let{view:b,buffer:c,blockLen:d}=this,e=(a=dQ(a)).length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=dN(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){dL(this);dK(a);let b=this.outputLen;if(a.length<b)throw Error(`digestInto() expects output buffer of length at least ${b}`);this.finished=!0;let{buffer:c,view:d,blockLen:e,isLE:f}=this,{pos:g}=this;c[g++]=128,this.buffer.subarray(g).fill(0),this.padOffset>e-g&&(this.process(d,0),g=0);for(let a=g;a<e;a++)c[a]=0;!function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}(d,e-8,BigInt(8*this.length),f),this.process(d,0);let h=dN(a),i=this.outputLen;if(i%4)throw Error("_sha2: outputLen should be aligned to 32bit");let j=i/4,k=this.get();if(j>k.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<j;a++)h.setUint32(4*a,k[a],f)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.length=d,a.pos=g,a.finished=e,a.destroyed=f,d%b&&a.buffer.set(c),a}}let dV=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),dW=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),dX=new Uint32Array(64);class dY extends dU{constructor(){super(64,32,8,!1),this.A=0|dW[0],this.B=0|dW[1],this.C=0|dW[2],this.D=0|dW[3],this.E=0|dW[4],this.F=0|dW[5],this.G=0|dW[6],this.H=0|dW[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)dX[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=dX[a-15],c=dX[a-2],d=dO(b,7)^dO(b,18)^b>>>3,e=dO(c,17)^dO(c,19)^c>>>10;dX[a]=e+dX[a-7]+d+dX[a-16]|0}let{A:c,B:d,C:e,D:f,E:g,F:h,G:i,H:j}=this;for(let a=0;a<64;a++){let b=j+(dO(g,6)^dO(g,11)^dO(g,25))+dS(g,h,i)+dV[a]+dX[a]|0,k=(dO(c,2)^dO(c,13)^dO(c,22))+dT(c,d,e)|0;j=i,i=h,h=g,g=f+b|0,f=e,e=d,d=c,c=b+k|0}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,h=h+this.F|0,i=i+this.G|0,j=j+this.H|0,this.set(c,d,e,f,g,h,i,j)}roundClean(){dX.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let dZ=(DZ=()=>new dY,(q=a=>DZ().update(dQ(a)).digest()).outputLen=(r=DZ()).outputLen,q.blockLen=r.blockLen,q.create=()=>DZ(),q),d$="session:id",d_="session:secret",d0="session:linked";class d1{constructor(a,b,c,d=!1){this.storage=a,this.id=b,this.secret=c,this.key=function(a){dK(a);let b="";for(let c=0;c<a.length;c++)b+=dP[a[c]];return b}(dZ(`${b}, ${c} WalletLink`)),this._linked=!!d}static create(a){return new d1(a,c0(16),c0(32)).save()}static load(a){let b=a.getItem(d$),c=a.getItem(d0),d=a.getItem(d_);return b&&d?new d1(a,b,d,"1"===c):null}get linked(){return this._linked}set linked(a){this._linked=a,this.persistLinked()}save(){return this.storage.setItem(d$,this.id),this.storage.setItem(d_,this.secret),this.persistLinked(),this}persistLinked(){this.storage.setItem(d0,this._linked?"1":"0")}}function d2(){var a,b;return null!=(b=null==(a=null==window?void 0:window.matchMedia)?void 0:a.call(window,"(prefers-color-scheme: dark)").matches)&&b}function d3(){let a=document.createElement("style");a.type="text/css",a.appendChild(document.createTextNode('@namespace svg "http://www.w3.org/2000/svg";.-cbwsdk-css-reset,.-cbwsdk-css-reset *{animation:none;animation-delay:0;animation-direction:normal;animation-duration:0;animation-fill-mode:none;animation-iteration-count:1;animation-name:none;animation-play-state:running;animation-timing-function:ease;backface-visibility:visible;background:0;background-attachment:scroll;background-clip:border-box;background-color:rgba(0,0,0,0);background-image:none;background-origin:padding-box;background-position:0 0;background-position-x:0;background-position-y:0;background-repeat:repeat;background-size:auto auto;border:0;border-style:none;border-width:medium;border-color:inherit;border-bottom:0;border-bottom-color:inherit;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-style:none;border-bottom-width:medium;border-collapse:separate;border-image:none;border-left:0;border-left-color:inherit;border-left-style:none;border-left-width:medium;border-radius:0;border-right:0;border-right-color:inherit;border-right-style:none;border-right-width:medium;border-spacing:0;border-top:0;border-top-color:inherit;border-top-left-radius:0;border-top-right-radius:0;border-top-style:none;border-top-width:medium;box-shadow:none;box-sizing:border-box;caption-side:top;clear:none;clip:auto;color:inherit;columns:auto;column-count:auto;column-fill:balance;column-gap:normal;column-rule:medium none currentColor;column-rule-color:currentColor;column-rule-style:none;column-rule-width:none;column-span:1;column-width:auto;counter-increment:none;counter-reset:none;direction:ltr;empty-cells:show;float:none;font:normal;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:normal;height:auto;hyphens:none;letter-spacing:normal;line-height:normal;list-style:none;list-style-image:none;list-style-position:outside;list-style-type:disc;margin:0;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;opacity:1;orphans:0;outline:0;outline-color:invert;outline-style:none;outline-width:medium;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;perspective:none;perspective-origin:50% 50%;pointer-events:auto;position:static;quotes:"\\201C" "\\201D" "\\2018" "\\2019";tab-size:8;table-layout:auto;text-align:inherit;text-align-last:auto;text-decoration:none;text-decoration-color:inherit;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-shadow:none;text-transform:none;transform:none;transform-style:flat;transition:none;transition-delay:0s;transition-duration:0s;transition-property:none;transition-timing-function:ease;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:0;word-spacing:normal;z-index:auto}.-cbwsdk-css-reset strong{font-weight:bold}.-cbwsdk-css-reset *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;line-height:1}.-cbwsdk-css-reset [class*=container]{margin:0;padding:0}.-cbwsdk-css-reset style{display:none}')),document.documentElement.appendChild(a)}function d4(){for(var a,b,c=0,d="";c<arguments.length;)(a=arguments[c++])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b))for(c=0;c<b.length;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d);else for(c in b)b[c]&&(e&&(e+=" "),e+=c);return e}(a))&&(d&&(d+=" "),d+=b);return d}var d5=a.i(820203),d6=a.i(396507);class d7{constructor(){this.items=new Map,this.nextItemKey=0,this.root=null,this.darkMode=d2()}attach(a){this.root=document.createElement("div"),this.root.className="-cbwsdk-snackbar-root",a.appendChild(this.root),this.render()}presentItem(a){let b=this.nextItemKey++;return this.items.set(b,a),this.render(),()=>{this.items.delete(b),this.render()}}clear(){this.items.clear(),this.render()}render(){this.root&&(0,d5.render)((0,d5.h)("div",null,(0,d5.h)(d8,{darkMode:this.darkMode},Array.from(this.items.entries()).map(([a,b])=>(0,d5.h)(d9,Object.assign({},b,{key:a}))))),this.root)}}let d8=a=>(0,d5.h)("div",{class:d4("-cbwsdk-snackbar-container")},(0,d5.h)("style",null,".-cbwsdk-css-reset .-gear-container{margin-left:16px !important;margin-right:9px !important;display:flex;align-items:center;justify-content:center;width:24px;height:24px;transition:opacity .25s}.-cbwsdk-css-reset .-gear-container *{user-select:none}.-cbwsdk-css-reset .-gear-container svg{opacity:0;position:absolute}.-cbwsdk-css-reset .-gear-icon{height:12px;width:12px;z-index:10000}.-cbwsdk-css-reset .-cbwsdk-snackbar{align-items:flex-end;display:flex;flex-direction:column;position:fixed;right:0;top:0;z-index:2147483647}.-cbwsdk-css-reset .-cbwsdk-snackbar *{user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance{display:flex;flex-direction:column;margin:8px 16px 0 16px;overflow:visible;text-align:left;transform:translateX(0);transition:opacity .25s,transform .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header:hover .-gear-container svg{opacity:1}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header{display:flex;align-items:center;background:#fff;overflow:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-cblogo{margin:8px 8px 8px 8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-message{color:#000;font-size:13px;line-height:1.5;user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu{background:#fff;transition:opacity .25s ease-in-out,transform .25s linear,visibility 0s;visibility:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;opacity:0;flex-direction:column;padding-left:8px;padding-right:8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:last-child{margin-bottom:8px !important}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover{background:#f5f7f8;border-radius:6px;transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover span{color:#050f19;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover svg path{fill:#000;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item{visibility:inherit;height:35px;margin-top:8px;margin-bottom:0;display:flex;flex-direction:row;align-items:center;padding:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item *{visibility:inherit;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover{background:rgba(223,95,103,.2);transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover svg path{fill:#df5f67;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover span{color:#df5f67;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-info{color:#aaa;font-size:13px;margin:0 8px 0 32px;position:absolute}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-hidden{opacity:0;text-align:left;transform:translateX(25%);transition:opacity .5s linear}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-expanded .-cbwsdk-snackbar-instance-menu{opacity:1;display:flex;transform:translateY(8px);visibility:visible}"),(0,d5.h)("div",{class:"-cbwsdk-snackbar"},a.children)),d9=({autoExpand:a,message:b,menuItems:c})=>{let[d,e]=(0,d6.useState)(!0),[f,g]=(0,d6.useState)(null!=a&&a);return(0,d6.useEffect)(()=>{let a=[window.setTimeout(()=>{e(!1)},1),window.setTimeout(()=>{g(!0)},1e4)];return()=>{a.forEach(window.clearTimeout)}}),(0,d5.h)("div",{class:d4("-cbwsdk-snackbar-instance",d&&"-cbwsdk-snackbar-instance-hidden",f&&"-cbwsdk-snackbar-instance-expanded")},(0,d5.h)("div",{class:"-cbwsdk-snackbar-instance-header",onClick:()=>{g(!f)}},(0,d5.h)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEuNDkyIDEwLjQxOWE4LjkzIDguOTMgMCAwMTguOTMtOC45M2gxMS4xNjNhOC45MyA4LjkzIDAgMDE4LjkzIDguOTN2MTEuMTYzYTguOTMgOC45MyAwIDAxLTguOTMgOC45M0gxMC40MjJhOC45MyA4LjkzIDAgMDEtOC45My04LjkzVjEwLjQxOXoiIGZpbGw9IiMxNjUyRjAiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwLjQxOSAwSDIxLjU4QzI3LjMzNSAwIDMyIDQuNjY1IDMyIDEwLjQxOVYyMS41OEMzMiAyNy4zMzUgMjcuMzM1IDMyIDIxLjU4MSAzMkgxMC40MkM0LjY2NSAzMiAwIDI3LjMzNSAwIDIxLjU4MVYxMC40MkMwIDQuNjY1IDQuNjY1IDAgMTAuNDE5IDB6bTAgMS40ODhhOC45MyA4LjkzIDAgMDAtOC45MyA4LjkzdjExLjE2M2E4LjkzIDguOTMgMCAwMDguOTMgOC45M0gyMS41OGE4LjkzIDguOTMgMCAwMDguOTMtOC45M1YxMC40MmE4LjkzIDguOTMgMCAwMC04LjkzLTguOTNIMTAuNDJ6IiBmaWxsPSIjZmZmIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNS45OTggMjYuMDQ5Yy01LjU0OSAwLTEwLjA0Ny00LjQ5OC0xMC4wNDctMTAuMDQ3IDAtNS41NDggNC40OTgtMTAuMDQ2IDEwLjA0Ny0xMC4wNDYgNS41NDggMCAxMC4wNDYgNC40OTggMTAuMDQ2IDEwLjA0NiAwIDUuNTQ5LTQuNDk4IDEwLjA0Ny0xMC4wNDYgMTAuMDQ3eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xMi43NjIgMTQuMjU0YzAtLjgyMi42NjctMS40ODkgMS40ODktMS40ODloMy40OTdjLjgyMiAwIDEuNDg4LjY2NiAxLjQ4OCAxLjQ4OXYzLjQ5N2MwIC44MjItLjY2NiAxLjQ4OC0xLjQ4OCAxLjQ4OGgtMy40OTdhMS40ODggMS40ODggMCAwMS0xLjQ4OS0xLjQ4OHYtMy40OTh6IiBmaWxsPSIjMTY1MkYwIi8+PC9zdmc+",class:"-cbwsdk-snackbar-instance-header-cblogo"})," ",(0,d5.h)("div",{class:"-cbwsdk-snackbar-instance-header-message"},b),(0,d5.h)("div",{class:"-gear-container"},!f&&(0,d5.h)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,d5.h)("circle",{cx:"12",cy:"12",r:"12",fill:"#F5F7F8"})),(0,d5.h)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDYuNzV2LTEuNWwtMS43Mi0uNTdjLS4wOC0uMjctLjE5LS41Mi0uMzItLjc3bC44MS0xLjYyLTEuMDYtMS4wNi0xLjYyLjgxYy0uMjQtLjEzLS41LS4yNC0uNzctLjMyTDYuNzUgMGgtMS41bC0uNTcgMS43MmMtLjI3LjA4LS41My4xOS0uNzcuMzJsLTEuNjItLjgxLTEuMDYgMS4wNi44MSAxLjYyYy0uMTMuMjQtLjI0LjUtLjMyLjc3TDAgNS4yNXYxLjVsMS43Mi41N2MuMDguMjcuMTkuNTMuMzIuNzdsLS44MSAxLjYyIDEuMDYgMS4wNiAxLjYyLS44MWMuMjQuMTMuNS4yMy43Ny4zMkw1LjI1IDEyaDEuNWwuNTctMS43MmMuMjctLjA4LjUyLS4xOS43Ny0uMzJsMS42Mi44MSAxLjA2LTEuMDYtLjgxLTEuNjJjLjEzLS4yNC4yMy0uNS4zMi0uNzdMMTIgNi43NXpNNiA4LjVhMi41IDIuNSAwIDAxMC01IDIuNSAyLjUgMCAwMTAgNXoiIGZpbGw9IiMwNTBGMTkiLz48L3N2Zz4=",class:"-gear-icon",title:"Expand"}))),c&&c.length>0&&(0,d5.h)("div",{class:"-cbwsdk-snackbar-instance-menu"},c.map((a,b)=>(0,d5.h)("div",{class:d4("-cbwsdk-snackbar-instance-menu-item",a.isRed&&"-cbwsdk-snackbar-instance-menu-item-is-red"),onClick:a.onClick,key:b},(0,d5.h)("svg",{width:a.svgWidth,height:a.svgHeight,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,d5.h)("path",{"fill-rule":a.defaultFillRule,"clip-rule":a.defaultClipRule,d:a.path,fill:"#AAAAAA"})),(0,d5.h)("span",{class:d4("-cbwsdk-snackbar-instance-menu-item-info",a.isRed&&"-cbwsdk-snackbar-instance-menu-item-info-is-red")},a.info)))))},ea="M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z";class eb{constructor(){this.attached=!1,this.snackbar=new d7}attach(){if(this.attached)throw Error("Coinbase Wallet SDK UI is already attached");let a=document.documentElement,b=document.createElement("div");b.className="-cbwsdk-css-reset",a.appendChild(b),this.snackbar.attach(b),this.attached=!0,d3()}showConnecting(a){let b;return b=a.isUnlinkedErrorState?{autoExpand:!0,message:"Connection lost",menuItems:[{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:"M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:a.onResetConnection}]}:{message:"Confirm on phone",menuItems:[{isRed:!0,info:"Cancel transaction",svgWidth:"11",svgHeight:"11",path:"M10.3711 1.52346L9.21775 0.370117L5.37109 4.21022L1.52444 0.370117L0.371094 1.52346L4.2112 5.37012L0.371094 9.21677L1.52444 10.3701L5.37109 6.53001L9.21775 10.3701L10.3711 9.21677L6.53099 5.37012L10.3711 1.52346Z",defaultFillRule:"inherit",defaultClipRule:"inherit",onClick:a.onCancel},{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:ea,defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:a.onResetConnection}]},this.snackbar.presentItem(b)}}class ec{constructor(){this.root=null,this.darkMode=d2()}attach(){let a=document.documentElement;this.root=document.createElement("div"),this.root.className="-cbwsdk-css-reset",a.appendChild(this.root),d3()}present(a){this.render(a)}clear(){this.render(null)}render(a){!this.root||((0,d5.render)(null,this.root),a&&(0,d5.render)((0,d5.h)(ed,Object.assign({},a,{onDismiss:()=>{this.clear()},darkMode:this.darkMode})),this.root))}}let ed=({title:a,buttonText:b,darkMode:c,onButtonClick:d,onDismiss:e})=>(0,d5.h)(d8,{darkMode:c},(0,d5.h)("div",{class:"-cbwsdk-redirect-dialog"},(0,d5.h)("style",null,".-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;transition:opacity .25s;background-color:rgba(10,11,13,.5)}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop-hidden{opacity:0}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box{display:block;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);padding:20px;border-radius:8px;background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box p{display:block;font-weight:400;font-size:14px;line-height:20px;padding-bottom:12px;color:#5b636e}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box button{appearance:none;border:none;background:none;color:#0052ff;padding:0;text-decoration:none;display:block;font-weight:600;font-size:16px;line-height:24px}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark{background-color:#0a0b0d;color:#fff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark button{color:#0052ff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light{background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light button{color:#0052ff}"),(0,d5.h)("div",{class:"-cbwsdk-redirect-dialog-backdrop",onClick:e}),(0,d5.h)("div",{class:d4("-cbwsdk-redirect-dialog-box",c?"dark":"light")},(0,d5.h)("p",null,a),(0,d5.h)("button",{onClick:d},b)))),ee="https://www.walletlink.org";class ef{constructor(){this.attached=!1,this.redirectDialog=new ec}attach(){if(this.attached)throw Error("Coinbase Wallet SDK UI is already attached");this.redirectDialog.attach(),this.attached=!0}redirectToCoinbaseWallet(a){let b=new URL("https://go.cb-w.com/walletlink");b.searchParams.append("redirect_url",function(){try{if(function(){try{return null!==window.frameElement}catch(a){return!1}}()&&window.top)return window.top.location;return window.location}catch(a){return window.location}}().href),a&&b.searchParams.append("wl_url",a);let c=document.createElement("a");c.target="cbw-opener",c.href=b.href,c.rel="noreferrer noopener",c.click()}openCoinbaseWalletDeeplink(a){this.redirectDialog.present({title:"Redirecting to Coinbase Wallet...",buttonText:"Open",onButtonClick:()=>{this.redirectToCoinbaseWallet(a)}}),setTimeout(()=>{this.redirectToCoinbaseWallet(a)},99)}showConnecting(a){return()=>{this.redirectDialog.clear()}}}class eg{constructor(a){this.chainCallbackParams={chainId:"",jsonRpcUrl:""},this.isMobileWeb=function(){var a;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(null==(a=null==window?void 0:window.navigator)?void 0:a.userAgent)}(),this.linkedUpdated=a=>{this.isLinked=a;let b=this.storage.getItem(dD);if(a&&(this._session.linked=a),this.isUnlinkedErrorState=!1,b){let c=b.split(" "),d="true"===this.storage.getItem("IsStandaloneSigning");""===c[0]||a||!this._session.linked||d||(this.isUnlinkedErrorState=!0)}},this.metadataUpdated=(a,b)=>{this.storage.setItem(a,b)},this.chainUpdated=(a,b)=>{(this.chainCallbackParams.chainId!==a||this.chainCallbackParams.jsonRpcUrl!==b)&&(this.chainCallbackParams={chainId:a,jsonRpcUrl:b},this.chainCallback&&this.chainCallback(b,Number.parseInt(a,10)))},this.accountUpdated=a=>{this.accountsCallback&&this.accountsCallback([a]),eg.accountRequestCallbackIds.size>0&&(Array.from(eg.accountRequestCallbackIds.values()).forEach(b=>{this.invokeCallback(b,{method:"requestEthereumAccounts",result:[a]})}),eg.accountRequestCallbackIds.clear())},this.resetAndReload=this.resetAndReload.bind(this),this.linkAPIUrl=a.linkAPIUrl,this.storage=a.storage,this.metadata=a.metadata,this.accountsCallback=a.accountsCallback,this.chainCallback=a.chainCallback;const{session:b,ui:c,connection:d}=this.subscribe();this._session=b,this.connection=d,this.relayEventManager=new dJ,this.ui=c,this.ui.attach()}subscribe(){let a=d1.load(this.storage)||d1.create(this.storage),{linkAPIUrl:b}=this,c=new dI({session:a,linkAPIUrl:b,listener:this}),d=this.isMobileWeb?new ef:new eb;return c.connect(),{session:a,ui:d,connection:c}}resetAndReload(){this.connection.destroy().then(()=>{let a=d1.load(this.storage);(null==a?void 0:a.id)===this._session.id&&cA.clearAll(),document.location.reload()}).catch(a=>{})}signEthereumTransaction(a){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:a.fromAddress,toAddress:a.toAddress,weiValue:c5(a.weiValue),data:c3(a.data,!0),nonce:a.nonce,gasPriceInWei:a.gasPriceInWei?c5(a.gasPriceInWei):null,maxFeePerGas:a.gasPriceInWei?c5(a.gasPriceInWei):null,maxPriorityFeePerGas:a.gasPriceInWei?c5(a.gasPriceInWei):null,gasLimit:a.gasLimit?c5(a.gasLimit):null,chainId:a.chainId,shouldSubmit:!1}})}signAndSubmitEthereumTransaction(a){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:a.fromAddress,toAddress:a.toAddress,weiValue:c5(a.weiValue),data:c3(a.data,!0),nonce:a.nonce,gasPriceInWei:a.gasPriceInWei?c5(a.gasPriceInWei):null,maxFeePerGas:a.maxFeePerGas?c5(a.maxFeePerGas):null,maxPriorityFeePerGas:a.maxPriorityFeePerGas?c5(a.maxPriorityFeePerGas):null,gasLimit:a.gasLimit?c5(a.gasLimit):null,chainId:a.chainId,shouldSubmit:!0}})}submitEthereumTransaction(a,b){return this.sendRequest({method:"submitEthereumTransaction",params:{signedTransaction:c3(a,!0),chainId:b}})}getWalletLinkSession(){return this._session}sendRequest(a){let b=null,c=c0(8),d=d=>{this.publishWeb3RequestCanceledEvent(c),this.handleErrorResponse(c,a.method,d),null==b||b()};return new Promise((e,f)=>{b=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:d,onResetConnection:this.resetAndReload}),this.relayEventManager.callbacks.set(c,a=>{if(null==b||b(),dE(a))return f(Error(a.errorMessage));e(a)}),this.publishWeb3RequestEvent(c,a)})}publishWeb3RequestEvent(a,b){let c={type:"WEB3_REQUEST",id:a,request:b};this.publishEvent("Web3Request",c,!0).then(a=>{}).catch(a=>{this.handleWeb3ResponseMessage(c.id,{method:b.method,errorMessage:a.message})}),this.isMobileWeb&&this.openCoinbaseWalletDeeplink(b.method)}openCoinbaseWalletDeeplink(a){if(this.ui instanceof ef)switch(a){case"requestEthereumAccounts":case"switchEthereumChain":return;default:window.addEventListener("blur",()=>{window.addEventListener("focus",()=>{this.connection.checkUnseenEvents()},{once:!0})},{once:!0}),this.ui.openCoinbaseWalletDeeplink()}}publishWeb3RequestCanceledEvent(a){this.publishEvent("Web3RequestCanceled",{type:"WEB3_REQUEST_CANCELED",id:a},!1).then()}publishEvent(a,b,c){return this.connection.publishEvent(a,b,c)}handleWeb3ResponseMessage(a,b){if("requestEthereumAccounts"===b.method){eg.accountRequestCallbackIds.forEach(a=>this.invokeCallback(a,b)),eg.accountRequestCallbackIds.clear();return}this.invokeCallback(a,b)}handleErrorResponse(a,b,c){var d;let e=null!=(d=null==c?void 0:c.message)?d:"Unspecified error message.";this.handleWeb3ResponseMessage(a,{method:b,errorMessage:e})}invokeCallback(a,b){let c=this.relayEventManager.callbacks.get(a);c&&(c(b),this.relayEventManager.callbacks.delete(a))}requestEthereumAccounts(){let{appName:a,appLogoUrl:b}=this.metadata,c={method:"requestEthereumAccounts",params:{appName:a,appLogoUrl:b}},d=c0(8);return new Promise((a,b)=>{this.relayEventManager.callbacks.set(d,c=>{if(dE(c))return b(Error(c.errorMessage));a(c)}),eg.accountRequestCallbackIds.add(d),this.publishWeb3RequestEvent(d,c)})}watchAsset(a,b,c,d,e,f){let g={method:"watchAsset",params:{type:a,options:{address:b,symbol:c,decimals:d,image:e},chainId:f}},h=null,i=c0(8),j=a=>{this.publishWeb3RequestCanceledEvent(i),this.handleErrorResponse(i,g.method,a),null==h||h()};return h=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:j,onResetConnection:this.resetAndReload}),new Promise((a,b)=>{this.relayEventManager.callbacks.set(i,c=>{if(null==h||h(),dE(c))return b(Error(c.errorMessage));a(c)}),this.publishWeb3RequestEvent(i,g)})}addEthereumChain(a,b,c,d,e,f){let g={method:"addEthereumChain",params:{chainId:a,rpcUrls:b,blockExplorerUrls:d,chainName:e,iconUrls:c,nativeCurrency:f}},h=null,i=c0(8),j=a=>{this.publishWeb3RequestCanceledEvent(i),this.handleErrorResponse(i,g.method,a),null==h||h()};return h=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:j,onResetConnection:this.resetAndReload}),new Promise((a,b)=>{this.relayEventManager.callbacks.set(i,c=>{if(null==h||h(),dE(c))return b(Error(c.errorMessage));a(c)}),this.publishWeb3RequestEvent(i,g)})}switchEthereumChain(a,b){let c={method:"switchEthereumChain",params:Object.assign({chainId:a},{address:b})},d=null,e=c0(8),f=a=>{this.publishWeb3RequestCanceledEvent(e),this.handleErrorResponse(e,c.method,a),null==d||d()};return d=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:f,onResetConnection:this.resetAndReload}),new Promise((a,b)=>{this.relayEventManager.callbacks.set(e,c=>(null==d||d(),dE(c)&&c.errorCode)?b(cT({code:c.errorCode,message:"Unrecognized chain ID. Try adding the chain using addEthereumChain first."})):dE(c)?b(Error(c.errorMessage)):void a(c)),this.publishWeb3RequestEvent(e,c)})}}eg.accountRequestCallbackIds=new Set;let eh="DefaultChainId",ei="DefaultJsonRpcUrl";class ej{constructor(a){this._relay=null,this._addresses=[],this.metadata=a.metadata,this._storage=new cA("walletlink",ee),this.callback=a.callback||null;const b=this._storage.getItem(dD);if(b){const a=b.split(" ");""!==a[0]&&(this._addresses=a.map(a=>dc(a)))}this.initializeRelay()}getSession(){let{id:a,secret:b}=this.initializeRelay().getWalletLinkSession();return{id:a,secret:b}}async handshake(){await this._eth_requestAccounts()}get selectedAddress(){return this._addresses[0]||void 0}get jsonRpcUrl(){var a;return null!=(a=this._storage.getItem(ei))?a:void 0}set jsonRpcUrl(a){this._storage.setItem(ei,a)}updateProviderInfo(a,b){var c;this.jsonRpcUrl=a;let d=this.getChainId();this._storage.setItem(eh,b.toString(10)),de(b)!==d&&(null==(c=this.callback)||c.call(this,"chainChanged",c6(b)))}async watchAsset(a){let b=Array.isArray(a)?a[0]:a;if(!b.type)throw cN("Type is required");if((null==b?void 0:b.type)!=="ERC20")throw cN(`Asset of type '${b.type}' is not supported`);if(!(null==b?void 0:b.options))throw cN("Options are required");if(!(null==b?void 0:b.options.address))throw cN("Address is required");let c=this.getChainId(),{address:d,symbol:e,image:f,decimals:g}=b.options,h=this.initializeRelay(),i=await h.watchAsset(b.type,d,e,g,f,null==c?void 0:c.toString());return!dE(i)&&!!i.result}async addEthereumChain(a){var b,c;let d=a[0];if((null==(b=d.rpcUrls)?void 0:b.length)===0)throw cN("please pass in at least 1 rpcUrl");if(!d.chainName||""===d.chainName.trim())throw cN("chainName is a required field");if(!d.nativeCurrency)throw cN("nativeCurrency is a required field");let e=Number.parseInt(d.chainId,16);if(e===this.getChainId())return!1;let f=this.initializeRelay(),{rpcUrls:g=[],blockExplorerUrls:h=[],chainName:i,iconUrls:j=[],nativeCurrency:k}=d,l=await f.addEthereumChain(e.toString(),g,j,h,i,k);if(dE(l))return!1;if((null==(c=l.result)?void 0:c.isApproved)===!0)return this.updateProviderInfo(g[0],e),null;throw cO("unable to add ethereum chain")}async switchEthereumChain(a){let b=Number.parseInt(a[0].chainId,16),c=this.initializeRelay(),d=await c.switchEthereumChain(b.toString(10),this.selectedAddress||void 0);if(dE(d))throw d;let e=d.result;return e.isApproved&&e.rpcUrl.length>0&&this.updateProviderInfo(e.rpcUrl,b),null}async cleanup(){this.callback=null,this._relay&&this._relay.resetAndReload(),this._storage.clear()}_setAddresses(a,b){var c;if(!Array.isArray(a))throw Error("addresses is not an array");let d=a.map(a=>dc(a));JSON.stringify(d)!==JSON.stringify(this._addresses)&&(this._addresses=d,null==(c=this.callback)||c.call(this,"accountsChanged",d),this._storage.setItem(dD,d.join(" ")))}async request(a){let b=a.params||[];switch(a.method){case"eth_accounts":return[...this._addresses];case"eth_coinbase":return this.selectedAddress||null;case"net_version":return this.getChainId().toString(10);case"eth_chainId":return c6(this.getChainId());case"eth_requestAccounts":return this._eth_requestAccounts();case"eth_ecRecover":case"personal_ecRecover":return this.ecRecover(a);case"personal_sign":return this.personalSign(a);case"eth_signTransaction":return this._eth_signTransaction(b);case"eth_sendRawTransaction":return this._eth_sendRawTransaction(b);case"eth_sendTransaction":return this._eth_sendTransaction(b);case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":return this.signTypedData(a);case"wallet_addEthereumChain":return this.addEthereumChain(b);case"wallet_switchEthereumChain":return this.switchEthereumChain(b);case"wallet_watchAsset":return this.watchAsset(b);default:if(!this.jsonRpcUrl)throw cO("No RPC URL set for chain");return dw(a,this.jsonRpcUrl)}}_ensureKnownAddress(a){let b=dc(a);if(!this._addresses.map(a=>dc(a)).includes(b))throw Error("Unknown Ethereum address")}_prepareTransactionParams(a){let b=a.from?dc(a.from):this.selectedAddress;if(!b)throw Error("Ethereum address is unavailable");this._ensureKnownAddress(b);let c=a.to?dc(a.to):null,d=null!=a.value?df(a.value):BigInt(0),e=a.data?dd(a.data):Buffer.alloc(0),f=null!=a.nonce?de(a.nonce):null,g=null!=a.gasPrice?df(a.gasPrice):null,h=null!=a.maxFeePerGas?df(a.maxFeePerGas):null,i=null!=a.maxPriorityFeePerGas?df(a.maxPriorityFeePerGas):null;return{fromAddress:b,toAddress:c,weiValue:d,data:e,nonce:f,gasPriceInWei:g,maxFeePerGas:h,maxPriorityFeePerGas:i,gasLimit:null!=a.gas?df(a.gas):null,chainId:a.chainId?de(a.chainId):this.getChainId()}}async ecRecover(a){let{method:b,params:c}=a;if(!Array.isArray(c))throw cN();let d=this.initializeRelay(),e=await d.sendRequest({method:"ethereumAddressFromSignedMessage",params:{message:c4(c[0]),signature:c4(c[1]),addPrefix:"personal_ecRecover"===b}});if(dE(e))throw e;return e.result}getChainId(){var a;return Number.parseInt(null!=(a=this._storage.getItem(eh))?a:"1",10)}async _eth_requestAccounts(){var a,b;if(this._addresses.length>0)return null==(a=this.callback)||a.call(this,"connect",{chainId:c6(this.getChainId())}),this._addresses;let c=this.initializeRelay(),d=await c.requestEthereumAccounts();if(dE(d))throw d;if(!d.result)throw Error("accounts received is empty");return this._setAddresses(d.result),null==(b=this.callback)||b.call(this,"connect",{chainId:c6(this.getChainId())}),this._addresses}async personalSign({params:a}){if(!Array.isArray(a))throw cN();let b=a[1],c=a[0];this._ensureKnownAddress(b);let d=this.initializeRelay(),e=await d.sendRequest({method:"signEthereumMessage",params:{address:dc(b),message:c4(c),addPrefix:!0,typedDataJson:null}});if(dE(e))throw e;return e.result}async _eth_signTransaction(a){let b=this._prepareTransactionParams(a[0]||{}),c=this.initializeRelay(),d=await c.signEthereumTransaction(b);if(dE(d))throw d;return d.result}async _eth_sendRawTransaction(a){let b=dd(a[0]),c=this.initializeRelay(),d=await c.submitEthereumTransaction(b,this.getChainId());if(dE(d))throw d;return d.result}async _eth_sendTransaction(a){let b=this._prepareTransactionParams(a[0]||{}),c=this.initializeRelay(),d=await c.signAndSubmitEthereumTransaction(b);if(dE(d))throw d;return d.result}async signTypedData(a){let{method:b,params:c}=a;if(!Array.isArray(c))throw cN();let d=c[+("eth_signTypedData_v1"===b)],e=c[+("eth_signTypedData_v1"!==b)];this._ensureKnownAddress(d);let f=this.initializeRelay(),g=await f.sendRequest({method:"signEthereumMessage",params:{address:dc(d),message:c3(({eth_signTypedData_v1:dC.default.hashForSignTypedDataLegacy,eth_signTypedData_v3:dC.default.hashForSignTypedData_v3,eth_signTypedData_v4:dC.default.hashForSignTypedData_v4,eth_signTypedData:dC.default.hashForSignTypedData_v4})[b]({data:function(a){if("string"==typeof a)return JSON.parse(a);if("object"==typeof a)return a;throw cN(`Not a JSON string or an object: ${String(a)}`)}(e)}),!0),typedDataJson:JSON.stringify(e,null,2),addPrefix:!1}});if(dE(g))throw g;return g.result}initializeRelay(){return this._relay||(this._relay=new eg({linkAPIUrl:ee,storage:this._storage,metadata:this.metadata,accountsCallback:this._setAddresses.bind(this),chainCallback:this.updateProviderInfo.bind(this)})),this._relay}}let ek="SignerType",el=new cA("CBWSDK","SignerConfigurator");async function em(a){let{communicator:b,metadata:c,handshakeRequest:d,callback:e}=a;en(b,c,e).catch(()=>{});let f={id:crypto.randomUUID(),event:"selectSignerType",data:Object.assign(Object.assign({},a.preference),{handshakeRequest:d})},{data:g}=await b.postRequestAndWaitForResponse(f);return g}async function en(a,b,c){await a.onMessage(({event:a})=>"WalletLinkSessionRequest"===a);let d=new ej({metadata:b,callback:c});a.postMessage({event:"WalletLinkUpdate",data:{session:d.getSession()}}),await d.handshake(),a.postMessage({event:"WalletLinkUpdate",data:{connected:!0}})}let{checkCrossOriginOpenerPolicy:eo,getCrossOriginOpenerPolicy:ep}={getCrossOriginOpenerPolicy:()=>void 0===s?"undefined":s,checkCrossOriginOpenerPolicy:async()=>{s="non-browser-env"}},eq={isRed:!1,info:"Retry",svgWidth:"10",svgHeight:"11",path:ea,defaultFillRule:"evenodd",defaultClipRule:"evenodd"},er=null;class es{constructor({url:a="https://keys.coinbase.com/connect",metadata:b,preference:c}){this.popup=null,this.listeners=new Map,this.postMessage=async a=>{(await this.waitForPopupLoaded()).postMessage(a,this.url.origin)},this.postRequestAndWaitForResponse=async a=>{let b=this.onMessage(({requestId:b})=>b===a.id);return this.postMessage(a),await b},this.onMessage=async a=>new Promise((b,c)=>{let d=c=>{if(c.origin!==this.url.origin)return;let e=c.data;a(e)&&(b(e),window.removeEventListener("message",d),this.listeners.delete(d))};window.addEventListener("message",d),this.listeners.set(d,{reject:c})}),this.disconnect=()=>{var a;(a=this.popup)&&!a.closed&&a.close(),this.popup=null,this.listeners.forEach(({reject:a},b)=>{a(cP("Request rejected")),window.removeEventListener("message",b)}),this.listeners.clear()},this.waitForPopupLoaded=async()=>this.popup&&!this.popup.closed?(this.popup.focus(),this.popup):(this.popup=await function(a){let b=(window.innerWidth-420)/2+window.screenX,c=(window.innerHeight-540)/2+window.screenY;function d(){let d=`wallet_${crypto.randomUUID()}`,e=window.open(a,d,`width=420, height=540, left=${b}, top=${c}`);return(null==e||e.focus(),e)?e:null}var e=a;for(let[a,b]of Object.entries({sdkName:dv,sdkVersion:du,origin:window.location.origin,coop:ep()}))e.searchParams.append(a,b.toString());let f=d();if(!f){let a=function(){if(!er){let a=document.createElement("div");a.className="-cbwsdk-css-reset",document.body.appendChild(a),(er=new d7).attach(a)}return er}();return new Promise((b,c)=>{a.presentItem({autoExpand:!0,message:"Popup was blocked. Try again.",menuItems:[Object.assign(Object.assign({},eq),{onClick:()=>{(f=d())?b(f):c(cO("Popup window was blocked")),a.clear()}})]})})}return Promise.resolve(f)}(this.url),this.onMessage(({event:a})=>"PopupUnload"===a).then(this.disconnect).catch(()=>{}),this.onMessage(({event:a})=>"PopupLoaded"===a).then(a=>{this.postMessage({requestId:a.id,data:{version:du,metadata:this.metadata,preference:this.preference,location:window.location.toString()}})}).then(()=>{if(!this.popup)throw cO();return this.popup})),this.url=new URL(a),this.metadata=b,this.preference=c}}var et=a.i(879425);et.default;var eu=et;class ev extends eu.default{}var ew=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};class ex extends ev{constructor(a){var{metadata:b}=a,c=a.preference,{keysUrl:d}=c,e=ew(c,["keysUrl"]);super(),this.signer=null,this.isCoinbaseWallet=!0,this.metadata=b,this.preference=e,this.communicator=new es({url:d,metadata:b,preference:e});const f=el.getItem(ek);f&&(this.signer=this.initSigner(f))}async request(a){try{if(!function(a){if(!a||"object"!=typeof a||Array.isArray(a))throw cN({message:"Expected a single, non-array, object argument.",data:a});let{method:b,params:c}=a;if("string"!=typeof b||0===b.length)throw cN({message:"'args.method' must be a non-empty string.",data:a});if(void 0!==c&&!Array.isArray(c)&&("object"!=typeof c||null===c))throw cN({message:"'args.params' must be an object or array if provided.",data:a});switch(b){case"eth_sign":case"eth_signTypedData_v2":case"eth_subscribe":case"eth_unsubscribe":throw cR()}}(a),!this.signer)switch(a.method){case"eth_requestAccounts":{let b=await this.requestSignerSelection(a),c=this.initSigner(b);await c.handshake(a),this.signer=c,el.setItem(ek,b);break}case"wallet_sendCalls":{let b=this.initSigner("scw");await b.handshake({method:"handshake"});let c=await b.request(a);return await b.cleanup(),c}case"wallet_getCallsStatus":return dw(a,"https://rpc.wallet.coinbase.com");case"net_version":return 1;case"eth_chainId":return c6(1);default:throw cQ("Must call 'eth_requestAccounts' before other methods")}return await this.signer.request(a)}catch(d){let a,b,{code:c}=d;return c===cE&&this.disconnect(),Promise.reject((a=function(a,{shouldIncludeStack:b=!1}={}){var c,d;let e={};if(a&&"object"==typeof a&&!Array.isArray(a)&&cL(a,"code")&&Number.isInteger(c=a.code)&&(cH[c.toString()]||(d=c)>=-32099&&d<=-32e3))e.code=a.code,a.message&&"string"==typeof a.message?(e.message=a.message,cL(a,"data")&&(e.data=a.data)):(e.message=cJ(e.code),e.data={originalError:cK(a)});else e.code=cC,e.message=cM(a,"message")?a.message:cI,e.data={originalError:cK(a)};return b&&(e.stack=cM(a,"stack")?a.stack:void 0),e}(function(a){var b;if("string"==typeof a)return{message:a,code:cC};if(dE(a)){let c=a.errorMessage,d=null!=(b=a.errorCode)?b:c.match(/(denied|rejected)/i)?cD:void 0;return Object.assign(Object.assign({},a),{message:c,code:d,data:{method:a.method}})}return a}(d),{shouldIncludeStack:!0}),(b=new URL("https://docs.cloud.coinbase.com/wallet-sdk/docs/errors")).searchParams.set("version",du),b.searchParams.set("code",a.code.toString()),b.searchParams.set("message",a.message),Object.assign(Object.assign({},a),{docUrl:b.href})))}}async enable(){return console.warn('.enable() has been deprecated. Please use .request({ method: "eth_requestAccounts" }) instead.'),await this.request({method:"eth_requestAccounts"})}async disconnect(){var a;await (null==(a=this.signer)?void 0:a.cleanup()),this.signer=null,cA.clearAll(),this.emit("disconnect",cS("User initiated disconnection"))}requestSignerSelection(a){return em({communicator:this.communicator,preference:this.preference,metadata:this.metadata,handshakeRequest:a,callback:this.emit.bind(this)})}initSigner(a){return function(a){let{signerType:b,metadata:c,communicator:d,callback:e}=a;switch(b){case"scw":return new dB({metadata:c,callback:e,communicator:d});case"walletlink":return new ej({metadata:c,callback:e})}}({signerType:a,metadata:this.metadata,communicator:this.communicator,callback:this.emit.bind(this)})}}let ey={options:"all"};function ez(a){new cA("CBWSDK").setItem("VERSION",du),eo();let b={metadata:{appName:a.appName||"Dapp",appLogoUrl:a.appLogoUrl||"",appChainIds:a.appChainIds||[]},preference:Object.assign(ey,null!=(c=a.preference)?c:{})};var c,d=b.preference;if(d){if(!["all","smartWalletOnly","eoaOnly"].includes(d.options))throw Error(`Invalid options: ${d.options}`);if(d.attribution&&void 0!==d.attribution.auto&&void 0!==d.attribution.dataSuffix)throw Error("Attribution cannot contain both auto and dataSuffix properties")}let e=null;return{getProvider:()=>{var a;let c;return e||(e=null!=(a=function({metadata:a,preference:b}){var c,d;let{appName:e,appLogoUrl:f,appChainIds:g}=a;if("smartWalletOnly"!==b.options){let a=globalThis.coinbaseWalletExtension;if(a)return null==(c=a.setAppInfo)||c.call(a,e,f,g,b),a}let h=function(){var a,b;try{let c=globalThis;return null!=(a=c.ethereum)?a:null==(b=c.top)?void 0:b.ethereum}catch(a){return}}();if(null==h?void 0:h.isCoinbaseBrowser)return null==(d=h.setAppInfo)||d.call(h,e,f,g,b),h}(c={metadata:b.metadata,preference:b.preference}))?a:new ex(c)),e}}}var eA=a.i(737018),eB=a.i(267954),eC=a.i(906301),eD=a.i(221570),eE=a.i(540302),eF=a.i(116330),eG=a.i(748894),eH=a.i(442134),eI=a.i(603455);let eJ="/api/v1/sessions",eK="/api/v1/sessions/logout",eL="/api/v1/siwe/init",eM="/api/v1/siwe/authenticate",eN="/api/v1/siwe/link",eO="/api/v1/siwe/link_smart_wallet",eP="/api/v1/siwe/unlink",eQ="/api/v1/siwe/transfer",eR="/api/v1/siws/init",eS="/api/v1/siws/authenticate",eT="/api/v1/siws/link",eU="/api/v1/siws/unlink",eV="/api/v1/siws/transfer",eW="/api/v1/farcaster/init",eX="/api/v1/farcaster/authenticate",eY="/api/v1/farcaster/link",eZ="/api/v1/farcaster/status",e$="/api/v1/farcaster/unlink",e_="/api/v1/farcaster/transfer",e0="/api/v1/passwordless/init",e1="/api/v1/passwordless/authenticate",e2="/api/v1/passwordless/link",e3="/api/v1/passwordless/unlink",e4="/api/v1/passwordless/update",e5="/api/v1/passwordless/transfer",e6="/api/v1/passwordless_sms/init",e7="/api/v1/passwordless_sms/link",e8="/api/v1/passwordless_sms/unlink",e9="/api/v1/passwordless_sms/authenticate",fa="/api/v1/passwordless_sms/update",fb="/api/v1/passwordless_sms/transfer",fc="/api/v1/oauth/init",fd="/api/v1/oauth/authenticate",fe="/api/v1/oauth/link",ff="/api/v1/oauth/unlink",fg="/api/v1/oauth/transfer",fh="/api/v1/passkeys/link/init",fi="/api/v1/passkeys/authenticate/init",fj="/api/v1/passkeys/register/init",fk="/api/v1/passkeys/link",fl="/api/v1/passkeys/authenticate",fm="/api/v1/passkeys/register",fn="/api/v1/telegram/authenticate",fo="/api/v1/telegram/link",fp="/api/v1/telegram/unlink",fq="/api/v1/telegram/transfer",fr="/api/v1/mfa/passwordless_sms/init",fs="/api/v1/mfa/passkeys/init",ft="/api/v1/users/me/accept_terms",fu="/api/v1/analytics_events",fv="/api/v1/custom_jwt_account/authenticate",fw="/api/v1/custom_jwt_account/link",fx="/api/v1/guest/authenticate",fy="/api/v1/plugins/moonpay_on_ramp/sign",fz="/api/v1/funding/coinbase_on_ramp/init",fA="/api/v1/funding/coinbase_on_ramp/status",fB="/api/v1/wallets/revoke",fC="/api/v1/users/me",fD="/api/v1/scan/transaction";a.s(["$",()=>eQ,"A",()=>eK,"B",()=>fu,"C",()=>fx,"D",()=>fr,"E",()=>fs,"F",()=>ft,"G",()=>e3,"H",()=>e8,"I",()=>eP,"J",()=>eU,"K",()=>ff,"L",()=>e$,"M",()=>fp,"N",()=>fB,"O",()=>fy,"P",()=>fz,"Q",()=>fA,"R",()=>eL,"S",()=>eM,"T",()=>eN,"U",()=>eO,"V",()=>eR,"W",()=>eS,"X",()=>fg,"Y",()=>eV,"Z",()=>fq,"_",()=>e_,"a",()=>e2,"a0",()=>fb,"a1",()=>e5,"a2",()=>eT,"a3",()=>fC,"a4",()=>fD,"a5",()=>"api/v2/farcaster/init","a6",()=>"api/v2/farcaster/authenticate","a8",()=>"/api/v1/recovery/oauth/authenticate","a9",()=>"/api/v1/recovery/oauth/init_icloud","aa",()=>"/api/v1/recovery/oauth/init","b",()=>e0,"c",()=>eY,"d",()=>eW,"e",()=>eZ,"f",()=>eX,"g",()=>fe,"h",()=>fc,"i",()=>fm,"j",()=>fl,"k",()=>fk,"l",()=>fj,"m",()=>fi,"n",()=>fh,"o",()=>fd,"p",()=>e1,"q",()=>e9,"r",()=>e7,"s",()=>e6,"t",()=>fa,"u",()=>e4,"v",()=>fn,"w",()=>fo,"x",()=>fv,"y",()=>fw,"z",()=>eJ],425041);var fE=a.i(501060),fF=a.i(575600),fG=a.i(775716),fH=a.i(610113),fI=a.i(920226);function fJ(a){"function"==typeof queueMicrotask?queueMicrotask(a):Promise.resolve().then(a).catch(a=>setTimeout(()=>{throw a}))}function fK(){let a=[],b={addEventListener:(a,c,d,e)=>(a.addEventListener(c,d,e),b.add(()=>a.removeEventListener(c,d,e))),requestAnimationFrame(...a){let c=requestAnimationFrame(...a);return b.add(()=>cancelAnimationFrame(c))},nextFrame:(...a)=>b.requestAnimationFrame(()=>b.requestAnimationFrame(...a)),setTimeout(...a){let c=setTimeout(...a);return b.add(()=>clearTimeout(c))},microTask(...a){let c={current:!0};return fJ(()=>{c.current&&a[0]()}),b.add(()=>{c.current=!1})},style(a,b,c){let d=a.style.getPropertyValue(b);return Object.assign(a.style,{[b]:c}),this.add(()=>{Object.assign(a.style,{[b]:d})})},group(a){let b=fK();return a(b),this.add(()=>b.dispose())},add:b=>(a.includes(b)||a.push(b),()=>{let c=a.indexOf(b);if(c>=0)for(let b of a.splice(c,1))b()}),dispose(){for(let b of a.splice(0))b()}};return b}function fL(){let[a]=(0,U.useState)(fK);return(0,U.useEffect)(()=>()=>a.dispose(),[a]),a}a.s(["disposables",()=>fK],925479),a.s(["useDisposables",()=>fL],555282);var fM=Object.defineProperty,fN=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?fM(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c,c};let fO=new class{constructor(){fN(this,"current",this.detect()),fN(this,"handoffState","pending"),fN(this,"currentId",0)}set(a){this.current!==a&&(this.handoffState="pending",this.currentId=0,this.current=a)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"server"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}},fP=(a,b)=>{fO.isServer?(0,U.useEffect)(a,b):(0,U.useLayoutEffect)(a,b)};function fQ(a){let b=(0,U.useRef)(a);return fP(()=>{b.current=a},[a]),b}a.s(["useIsoMorphicEffect",()=>fP],916501);let fR=function(a){let b=fQ(a);return U.default.useCallback((...a)=>b.current(...a),[b])};function fS(){let a=(0,U.useRef)(!1);return fP(()=>(a.current=!0,()=>{a.current=!1}),[]),a}function fT(){let a,b=(a="undefined"==typeof document,"useSyncExternalStore"in U&&(0,U.useSyncExternalStore)(()=>()=>{},()=>!1,()=>!a)),[c,d]=U.useState(fO.isHandoffComplete);return c&&!1===fO.isHandoffComplete&&d(!1),U.useEffect(()=>{!0!==c&&d(!0)},[c]),U.useEffect(()=>fO.handoff(),[]),!b&&c}a.s(["useEvent",()=>fR],249765);let fU=Symbol();function fV(a,b=!0){return Object.assign(a,{[fU]:b})}function fW(...a){let b=(0,U.useRef)(a);(0,U.useEffect)(()=>{b.current=a},[a]);let c=fR(a=>{for(let c of b.current)null!=c&&("function"==typeof c?c(a):c.current=a)});return a.every(a=>null==a||(null==a?void 0:a[fU]))?void 0:c}a.s(["optionalRef",()=>fV,"useSyncRefs",()=>fW],710912),"undefined"!=typeof process&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&(null==(Ee=null==process?void 0:process.env)?void 0:Ee.NODE_ENV)==="test"&&void 0===(null==(Ef=null==Element?void 0:Element.prototype)?void 0:Ef.getAnimations)&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var fX=((t=fX||{})[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t);function fY(a){let b={};for(let c in a)!0===a[c]&&(b[`data-${c}`]="");return b}function fZ(a,b,c,d){let[e,f]=(0,U.useState)(c),{hasFlag:g,addFlag:h,removeFlag:i}=function(a=0){let[b,c]=(0,U.useState)(a),d=(0,U.useCallback)(a=>c(a),[]),e=(0,U.useCallback)(a=>c(b=>b|a),[]),f=(0,U.useCallback)(a=>(b&a)===a,[b]);return{flags:b,setFlag:d,addFlag:e,hasFlag:f,removeFlag:(0,U.useCallback)(a=>c(b=>b&~a),[]),toggleFlag:(0,U.useCallback)(a=>c(b=>b^a),[])}}(a&&e?3:0),j=(0,U.useRef)(!1),k=(0,U.useRef)(!1);return fP(()=>{var e;if(a){if(c&&f(!0),!b){c&&h(3);return}return null==(e=null==d?void 0:d.start)||e.call(d,c),function(a,{prepare:b,run:c,done:d,inFlight:e}){let f=fK();return function(a,{inFlight:b,prepare:c}){if(null!=b&&b.current)return c();let d=a.style.transition;a.style.transition="none",c(),a.offsetHeight,a.style.transition=d}(a,{prepare:b,inFlight:e}),f.nextFrame(()=>{c(),f.requestAnimationFrame(()=>{f.add(function(a,b){var c,d;let e=fK();if(!a)return e.dispose;let f=!1;e.add(()=>{f=!0});let g=null!=(d=null==(c=a.getAnimations)?void 0:c.call(a).filter(a=>a instanceof CSSTransition))?d:[];return 0===g.length?b():Promise.allSettled(g.map(a=>a.finished)).then(()=>{f||b()}),e.dispose}(a,d))})}),f.dispose}(b,{inFlight:j,prepare(){k.current?k.current=!1:k.current=j.current,j.current=!0,k.current||(c?(h(3),i(4)):(h(4),i(2)))},run(){k.current?c?(i(3),h(4)):(i(4),h(3)):c?i(1):h(1)},done(){var a,e,g,h;k.current&&(null!=(h=null==(g=(e=b).getAnimations)?void 0:g.call(e))?h:[]).some(a=>a instanceof CSSTransition&&"finished"!==a.playState)||(j.current=!1,i(7),c||f(!1),null==(a=null==d?void 0:d.end)||a.call(d,c))}})}},[a,c,b,fL()]),a?[e,{closed:g(1),enter:g(2),leave:g(4),transition:g(2)||g(4)}]:[c,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}a.s(["transitionDataAttributes",()=>fY,"useTransition",()=>fZ],448808);let f$=(0,U.createContext)(null);f$.displayName="OpenClosedContext";var f_=((u=f_||{})[u.Open=1]="Open",u[u.Closed=2]="Closed",u[u.Closing=4]="Closing",u[u.Opening=8]="Opening",u);function f0(){return(0,U.useContext)(f$)}function f1({value:a,children:b}){return U.default.createElement(f$.Provider,{value:a},b)}function f2({children:a}){return U.default.createElement(f$.Provider,{value:null},a)}function f3(...a){return Array.from(new Set(a.flatMap(a=>"string"==typeof a?a.split(" "):[]))).filter(Boolean).join(" ")}function f4(a,b,...c){if(a in b){let d=b[a];return"function"==typeof d?d(...c):d}let d=Error(`Tried to handle "${a}" but there is no handler defined. Only defined handlers are: ${Object.keys(b).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(d,f4),d}a.s(["OpenClosedProvider",()=>f1,"ResetOpenClosedProvider",()=>f2,"State",()=>f_,"useOpenClosed",()=>f0],532681),a.s(["match",()=>f4],218524);var f5=((v=f5||{})[v.None=0]="None",v[v.RenderStrategy=1]="RenderStrategy",v[v.Static=2]="Static",v),f6=((w=f6||{})[w.Unmount=0]="Unmount",w[w.Hidden=1]="Hidden",w);function f7(){let a,b,c=(a=(0,U.useRef)([]),b=(0,U.useCallback)(b=>{for(let c of a.current)null!=c&&("function"==typeof c?c(b):c.current=b)},[]),(...c)=>{if(!c.every(a=>null==a))return a.current=c,b});return(0,U.useCallback)(a=>(function({ourProps:a,theirProps:b,slot:c,defaultTag:d,features:e,visible:f=!0,name:g,mergeRefs:h}){h=null!=h?h:f9;let i=ga(b,a);if(f)return f8(i,c,d,g,h);let j=null!=e?e:0;if(2&j){let{static:a=!1,...b}=i;if(a)return f8(b,c,d,g,h)}if(1&j){let{unmount:a=!0,...b}=i;return f4(+!a,{0:()=>null,1:()=>f8({...b,hidden:!0,style:{display:"none"}},c,d,g,h)})}return f8(i,c,d,g,h)})({mergeRefs:c,...a}),[c])}function f8(a,b={},c,d,e){let{as:f=c,children:g,refName:h="ref",...i}=ge(a,["unmount","static"]),j=void 0!==a.ref?{[h]:a.ref}:{},k="function"==typeof g?g(b):g;"className"in i&&i.className&&"function"==typeof i.className&&(i.className=i.className(b)),i["aria-labelledby"]&&i["aria-labelledby"]===i.id&&(i["aria-labelledby"]=void 0);let l={};if(b){let a=!1,c=[];for(let[d,e]of Object.entries(b))"boolean"==typeof e&&(a=!0),!0===e&&c.push(d.replace(/([A-Z])/g,a=>`-${a.toLowerCase()}`));if(a)for(let a of(l["data-headlessui-state"]=c.join(" "),c))l[`data-${a}`]=""}if(gf(f)&&(Object.keys(gd(i)).length>0||Object.keys(gd(l)).length>0))if(!(0,U.isValidElement)(k)||Array.isArray(k)&&k.length>1||gf(k.type)){if(Object.keys(gd(i)).length>0)throw Error(['Passing props on "Fragment"!',"",`The current component <${d} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(gd(i)).concat(Object.keys(gd(l))).map(a=>`  - ${a}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(a=>`  - ${a}`).join(`
`)].join(`
`))}else{var m;let a=k.props,b=null==a?void 0:a.className,c="function"==typeof b?(...a)=>f3(b(...a),i.className):f3(b,i.className),d=ga(k.props,gd(ge(i,["ref"])));for(let a in l)a in d&&delete l[a];return(0,U.cloneElement)(k,Object.assign({},d,l,j,{ref:e((m=k,U.default.version.split(".")[0]>="19"?m.props.ref:m.ref),j.ref)},c?{className:c}:{}))}return(0,U.createElement)(f,Object.assign({},ge(i,["ref"]),!gf(f)&&j,!gf(f)&&l),k)}function f9(...a){return a.every(a=>null==a)?void 0:b=>{for(let c of a)null!=c&&("function"==typeof c?c(b):c.current=b)}}function ga(...a){if(0===a.length)return{};if(1===a.length)return a[0];let b={},c={};for(let d of a)for(let a in d)a.startsWith("on")&&"function"==typeof d[a]?(null!=c[a]||(c[a]=[]),c[a].push(d[a])):b[a]=d[a];if(b.disabled||b["aria-disabled"])for(let a in c)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(a)&&(c[a]=[a=>{var b;return null==(b=null==a?void 0:a.preventDefault)?void 0:b.call(a)}]);for(let a in c)Object.assign(b,{[a](b,...d){for(let e of c[a]){if((b instanceof Event||(null==b?void 0:b.nativeEvent)instanceof Event)&&b.defaultPrevented)return;e(b,...d)}}});return b}function gb(...a){if(0===a.length)return{};if(1===a.length)return a[0];let b={},c={};for(let d of a)for(let a in d)a.startsWith("on")&&"function"==typeof d[a]?(null!=c[a]||(c[a]=[]),c[a].push(d[a])):b[a]=d[a];for(let a in c)Object.assign(b,{[a](...b){for(let d of c[a])null==d||d(...b)}});return b}function gc(a){var b;return Object.assign((0,U.forwardRef)(a),{displayName:null!=(b=a.displayName)?b:a.name})}function gd(a){let b=Object.assign({},a);for(let a in b)void 0===b[a]&&delete b[a];return b}function ge(a,b=[]){let c=Object.assign({},a);for(let a of b)a in c&&delete c[a];return c}function gf(a){return a===U.Fragment||a===Symbol.for("react.fragment")}function gg(a){var b;return!!(a.enter||a.enterFrom||a.enterTo||a.leave||a.leaveFrom||a.leaveTo)||!gf(null!=(b=a.as)?b:gm)||1===U.default.Children.count(a.children)}a.s(["RenderFeatures",()=>f5,"RenderStrategy",()=>f6,"compact",()=>gd,"forwardRefWithAs",()=>gc,"isFragment",()=>gf,"mergeProps",()=>gb,"useRender",()=>f7],322870);let gh=(0,U.createContext)(null);gh.displayName="TransitionContext";var gi=((x=gi||{}).Visible="visible",x.Hidden="hidden",x);let gj=(0,U.createContext)(null);function gk(a){return"children"in a?gk(a.children):a.current.filter(({el:a})=>null!==a.current).filter(({state:a})=>"visible"===a).length>0}function gl(a,b){let c=fQ(a),d=(0,U.useRef)([]),e=fS(),f=fL(),g=fR((a,b=f6.Hidden)=>{let g=d.current.findIndex(({el:b})=>b===a);-1!==g&&(f4(b,{[f6.Unmount](){d.current.splice(g,1)},[f6.Hidden](){d.current[g].state="hidden"}}),f.microTask(()=>{var a;!gk(d)&&e.current&&(null==(a=c.current)||a.call(c))}))}),h=fR(a=>{let b=d.current.find(({el:b})=>b===a);return b?"visible"!==b.state&&(b.state="visible"):d.current.push({el:a,state:"visible"}),()=>g(a,f6.Unmount)}),i=(0,U.useRef)([]),j=(0,U.useRef)(Promise.resolve()),k=(0,U.useRef)({enter:[],leave:[]}),l=fR((a,c,d)=>{i.current.splice(0),b&&(b.chains.current[c]=b.chains.current[c].filter(([b])=>b!==a)),null==b||b.chains.current[c].push([a,new Promise(a=>{i.current.push(a)})]),null==b||b.chains.current[c].push([a,new Promise(a=>{Promise.all(k.current[c].map(([a,b])=>b)).then(()=>a())})]),"enter"===c?j.current=j.current.then(()=>null==b?void 0:b.wait.current).then(()=>d(c)):d(c)}),m=fR((a,b,c)=>{Promise.all(k.current[b].splice(0).map(([a,b])=>b)).then(()=>{var a;null==(a=i.current.shift())||a()}).then(()=>c(b))});return(0,U.useMemo)(()=>({children:d,register:h,unregister:g,onStart:l,onStop:m,wait:j,chains:k}),[h,g,d,l,m,k,j])}gj.displayName="NestingContext";let gm=U.Fragment,gn=f5.RenderStrategy,go=gc(function(a,b){let{show:c,appear:d=!1,unmount:e=!0,...f}=a,g=(0,U.useRef)(null),h=fW(...gg(a)?[g,b]:null===b?[]:[b]);fT();let i=f0();if(void 0===c&&null!==i&&(c=(i&f_.Open)===f_.Open),void 0===c)throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[j,k]=(0,U.useState)(c?"visible":"hidden"),l=gl(()=>{c||k("hidden")}),[m,o]=(0,U.useState)(!0),p=(0,U.useRef)([c]);fP(()=>{!1!==m&&p.current[p.current.length-1]!==c&&(p.current.push(c),o(!1))},[p,c]);let q=(0,U.useMemo)(()=>({show:c,appear:d,initial:m}),[c,d,m]);fP(()=>{c?k("visible"):gk(l)||null===g.current||k("hidden")},[c,l]);let r={unmount:e},s=fR(()=>{var b;m&&o(!1),null==(b=a.beforeEnter)||b.call(a)}),t=fR(()=>{var b;m&&o(!1),null==(b=a.beforeLeave)||b.call(a)}),u=f7();return U.default.createElement(gj.Provider,{value:l},U.default.createElement(gh.Provider,{value:q},u({ourProps:{...r,as:U.Fragment,children:U.default.createElement(gp,{ref:h,...r,...f,beforeEnter:s,beforeLeave:t})},theirProps:{},defaultTag:U.Fragment,features:gn,visible:"visible"===j,name:"Transition"})))}),gp=gc(function(a,b){var c,d;let{transition:e=!0,beforeEnter:f,afterEnter:g,beforeLeave:h,afterLeave:i,enter:j,enterFrom:k,enterTo:l,entered:m,leave:o,leaveFrom:p,leaveTo:q,...r}=a,[s,t]=(0,U.useState)(null),u=(0,U.useRef)(null),v=gg(a),w=fW(...v?[u,b,t]:null===b?[]:[b]),x=null==(c=r.unmount)||c?f6.Unmount:f6.Hidden,{show:y,appear:z,initial:A}=function(){let a=(0,U.useContext)(gh);if(null===a)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}(),[B,C]=(0,U.useState)(y?"visible":"hidden"),D=function(){let a=(0,U.useContext)(gj);if(null===a)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}(),{register:E,unregister:F}=D;fP(()=>E(u),[E,u]),fP(()=>{if(x===f6.Hidden&&u.current)return y&&"visible"!==B?void C("visible"):f4(B,{hidden:()=>F(u),visible:()=>E(u)})},[B,u,E,F,y,x]);let G=fT();fP(()=>{if(v&&G&&"visible"===B&&null===u.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[u,B,G,v]);let H=A&&!z,I=z&&y&&A,J=(0,U.useRef)(!1),K=gl(()=>{J.current||(C("hidden"),F(u))},D),L=fR(a=>{J.current=!0,K.onStart(u,a?"enter":"leave",a=>{"enter"===a?null==f||f():"leave"===a&&(null==h||h())})}),M=fR(a=>{let b=a?"enter":"leave";J.current=!1,K.onStop(u,b,a=>{"enter"===a?null==g||g():"leave"===a&&(null==i||i())}),"leave"!==b||gk(K)||(C("hidden"),F(u))});(0,U.useEffect)(()=>{v&&e||(L(y),M(y))},[y,v,e]);let[,N]=fZ(!(!e||!v||!G||H),s,y,{start:L,end:M}),O=gd({ref:w,className:(null==(d=f3(r.className,I&&j,I&&k,N.enter&&j,N.enter&&N.closed&&k,N.enter&&!N.closed&&l,N.leave&&o,N.leave&&!N.closed&&p,N.leave&&N.closed&&q,!N.transition&&y&&m))?void 0:d.trim())||void 0,...fY(N)}),P=0;"visible"===B&&(P|=f_.Open),"hidden"===B&&(P|=f_.Closed),y&&"hidden"===B&&(P|=f_.Opening),y||"visible"!==B||(P|=f_.Closing);let Q=f7();return U.default.createElement(gj.Provider,{value:K},U.default.createElement(f1,{value:P},Q({ourProps:O,theirProps:r,defaultTag:gm,features:gn,visible:"visible"===B,name:"Transition.Child"})))}),gq=gc(function(a,b){let c=null!==(0,U.useContext)(gh),d=null!==f0();return U.default.createElement(U.default.Fragment,null,!c&&d?U.default.createElement(go,{ref:b,...a}):U.default.createElement(gp,{ref:b,...a}))}),gr=Object.assign(go,{Child:gq,Root:go});var gs=((y=gs||{}).Space=" ",y.Enter="Enter",y.Escape="Escape",y.Backspace="Backspace",y.Delete="Delete",y.ArrowLeft="ArrowLeft",y.ArrowUp="ArrowUp",y.ArrowRight="ArrowRight",y.ArrowDown="ArrowDown",y.Home="Home",y.End="End",y.PageUp="PageUp",y.PageDown="PageDown",y.Tab="Tab",y);function gt(a,b,c,d){let e=fQ(c);(0,U.useEffect)(()=>{function c(a){e.current(a)}return(a=null!=a?a:window).addEventListener(b,c,d),()=>a.removeEventListener(b,c,d)},[a,b,d])}a.s(["Keys",()=>gs],304053);class gu extends Map{constructor(a){super(),this.factory=a}get(a){let b=super.get(a);return void 0===b&&(b=this.factory(a),this.set(a,b)),b}}var gv=Object.defineProperty,gw=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot "+c)},gx=(a,b,c)=>(gw(a,b,"read from private field"),c?c.call(a):b.get(a)),gy=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},gz=(a,b,c,d)=>(gw(a,b,"write to private field"),d?d.call(a,c):b.set(a,c),c);class gA{constructor(a){gy(this,Eg,{}),gy(this,Eh,new gu(()=>new Set)),gy(this,Ei,new Set),((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?gv(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"disposables",fK()),gz(this,Eg,a),fO.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return gx(this,Eg)}subscribe(a,b){if(fO.isServer)return()=>{};let c={selector:a,callback:b,current:a(gx(this,Eg))};return gx(this,Ei).add(c),this.disposables.add(()=>{gx(this,Ei).delete(c)})}on(a,b){return fO.isServer?()=>{}:(gx(this,Eh).get(a).add(b),this.disposables.add(()=>{gx(this,Eh).get(a).delete(b)}))}send(a){let b=this.reduce(gx(this,Eg),a);if(b!==gx(this,Eg)){for(let a of(gz(this,Eg,b),gx(this,Ei))){let b=a.selector(gx(this,Eg));gB(a.current,b)||(a.current=b,a.callback(b))}for(let b of gx(this,Eh).get(a.type))b(gx(this,Eg),a)}}}function gB(a,b){return!!Object.is(a,b)||"object"==typeof a&&null!==a&&"object"==typeof b&&null!==b&&(Array.isArray(a)&&Array.isArray(b)?a.length===b.length&&gC(a[Symbol.iterator](),b[Symbol.iterator]()):a instanceof Map&&b instanceof Map||a instanceof Set&&b instanceof Set?a.size===b.size&&gC(a.entries(),b.entries()):!!(gD(a)&&gD(b))&&gC(Object.entries(a)[Symbol.iterator](),Object.entries(b)[Symbol.iterator]()))}function gC(a,b){for(;;){let c=a.next(),d=b.next();if(c.done&&d.done)return!0;if(c.done||d.done||!Object.is(c.value,d.value))return!1}}function gD(a){if("[object Object]"!==Object.prototype.toString.call(a))return!1;let b=Object.getPrototypeOf(a);return null===b||null===Object.getPrototypeOf(b)}function gE(a){let[b,c]=a(),d=fK();return(...a)=>{b(...a),d.dispose(),d.microTask(c)}}Eg=new WeakMap,Eh=new WeakMap,Ei=new WeakMap,a.s(["Machine",()=>gA,"batch",()=>gE,"shallowEqual",()=>gB],55887);var gF=Object.defineProperty,gG=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?gF(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c,c},gH=((z=gH||{})[z.Push=0]="Push",z[z.Pop=1]="Pop",z);let gI={0(a,b){let c=b.id,d=a.stack,e=a.stack.indexOf(c);if(-1!==e){let b=a.stack.slice();return b.splice(e,1),b.push(c),d=b,{...a,stack:d}}return{...a,stack:[...a.stack,c]}},1(a,b){let c=b.id,d=a.stack.indexOf(c);if(-1===d)return a;let e=a.stack.slice();return e.splice(d,1),{...a,stack:e}}};class gJ extends gA{constructor(){super(...arguments),gG(this,"actions",{push:a=>this.send({type:0,id:a}),pop:a=>this.send({type:1,id:a})}),gG(this,"selectors",{isTop:(a,b)=>a.stack[a.stack.length-1]===b,inStack:(a,b)=>a.stack.includes(b)})}static new(){return new gJ({stack:[]})}reduce(a,b){return f4(b.type,gI,a,b)}}let gK=new gu(()=>gJ.new());a.s(["ActionTypes",()=>gH,"stackMachines",()=>gK],175707);var gL=a.i(332473);function gM(a,b,c=gB){return(0,gL.useSyncExternalStoreWithSelector)(fR(b=>a.subscribe(gN,b)),fR(()=>a.state),fR(()=>a.state),fR(b),c)}function gN(a){return a}function gO(a,b){let c=(0,U.useId)(),d=gK.get(b),[e,f]=gM(d,(0,U.useCallback)(a=>[d.selectors.isTop(a,c),d.selectors.inStack(a,c)],[d,c]));return fP(()=>{if(a)return d.actions.push(c),()=>d.actions.pop(c)},[d,a,c]),!!a&&(!f||e)}function gP(a){var b;return fO.isServer?null:null==a?document:null!=(b=null==a?void 0:a.ownerDocument)?b:document}function gQ(a){var b,c;return fO.isServer?null:null==a?document:null!=(c=null==(b=null==a?void 0:a.getRootNode)?void 0:b.call(a))?c:document}function gR(a){var b,c;return null!=(c=null==(b=gQ(a))?void 0:b.activeElement)?c:null}function gS(a){return gR(a)===a}a.s(["useSlice",()=>gM],18264),a.s(["getActiveElement",()=>gR,"getOwnerDocument",()=>gP,"getRootNode",()=>gQ,"isActiveElement",()=>gS],355944);let gT=new Map,gU=new Map;function gV(a){var b;let c=null!=(b=gU.get(a))?b:0;return gU.set(a,c+1),0!==c||(gT.set(a,{"aria-hidden":a.getAttribute("aria-hidden"),inert:a.inert}),a.setAttribute("aria-hidden","true"),a.inert=!0),()=>(function(a){var b;let c=null!=(b=gU.get(a))?b:1;if(1===c?gU.delete(a):gU.set(a,c-1),1!==c)return;let d=gT.get(a);d&&(null===d["aria-hidden"]?a.removeAttribute("aria-hidden"):a.setAttribute("aria-hidden",d["aria-hidden"]),a.inert=d.inert,gT.delete(a))})(a)}function gW(a,{allowed:b,disallowed:c}={}){let d=gO(a,"inert-others");fP(()=>{var a,e;if(!d)return;let f=fK();for(let b of null!=(a=null==c?void 0:c())?a:[])b&&f.add(gV(b));let g=null!=(e=null==b?void 0:b())?e:[];for(let a of g){if(!a)continue;let b=gP(a);if(!b)continue;let c=a.parentElement;for(;c&&c!==b.body;){for(let a of c.children)g.some(b=>a.contains(b))||f.add(gV(a));c=c.parentElement}}return f.dispose},[d,b,c])}function gX(a){return"object"==typeof a&&null!==a&&"nodeType"in a}function gY(a){return gX(a)&&"tagName"in a}function gZ(a){return gY(a)&&"accessKey"in a}function g$(a){return gY(a)&&"tabIndex"in a}function g_(a){return gY(a)&&"style"in a}function g0(a){return gZ(a)&&"IFRAME"===a.nodeName}function g1(a){return gZ(a)&&"INPUT"===a.nodeName}function g2(a){return gZ(a)&&"LABEL"===a.nodeName}function g3(a){return gZ(a)&&"FIELDSET"===a.nodeName}function g4(a){return gZ(a)&&"LEGEND"===a.nodeName}function g5(a){return!!gY(a)&&a.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]')}function g6(a,b,c){let d=fQ(a=>{let b=a.getBoundingClientRect();0===b.x&&0===b.y&&0===b.width&&0===b.height&&c()});(0,U.useEffect)(()=>{if(!a)return;let c=null===b?null:gZ(b)?b:b.current;if(!c)return;let e=fK();if("undefined"!=typeof ResizeObserver){let a=new ResizeObserver(()=>d.current(c));a.observe(c),e.add(()=>a.disconnect())}if("undefined"!=typeof IntersectionObserver){let a=new IntersectionObserver(()=>d.current(c));a.observe(c),e.add(()=>a.disconnect())}return()=>e.dispose()},[b,d,a])}a.s(["useInertOthers",()=>gW],256576),a.s(["hasInlineStyle",()=>g_,"isElement",()=>gY,"isHTMLElement",()=>gZ,"isHTMLFieldSetElement",()=>g3,"isHTMLIframeElement",()=>g0,"isHTMLInputElement",()=>g1,"isHTMLLabelElement",()=>g2,"isHTMLLegendElement",()=>g4,"isHTMLorSVGElement",()=>g$,"isInteractiveElement",()=>g5,"isNode",()=>gX],859041),a.s(["useOnDisappear",()=>g6],678418);let g7=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(a=>`${a}:not([tabindex='-1'])`).join(","),g8=["[data-autofocus]"].map(a=>`${a}:not([tabindex='-1'])`).join(",");var g9=((A=g9||{})[A.First=1]="First",A[A.Previous=2]="Previous",A[A.Next=4]="Next",A[A.Last=8]="Last",A[A.WrapAround=16]="WrapAround",A[A.NoScroll=32]="NoScroll",A[A.AutoFocus=64]="AutoFocus",A),ha=((B=ha||{})[B.Error=0]="Error",B[B.Overflow=1]="Overflow",B[B.Success=2]="Success",B[B.Underflow=3]="Underflow",B),hb=((C=hb||{})[C.Previous=-1]="Previous",C[C.Next=1]="Next",C);function hc(a=document.body){return null==a?[]:Array.from(a.querySelectorAll(g7)).sort((a,b)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(b.tabIndex||Number.MAX_SAFE_INTEGER)))}var hd=((D=hd||{})[D.Strict=0]="Strict",D[D.Loose=1]="Loose",D);function he(a,b=0){var c;return a!==(null==(c=gP(a))?void 0:c.body)&&f4(b,{0:()=>a.matches(g7),1(){let b=a;for(;null!==b;){if(b.matches(g7))return!0;b=b.parentElement}return!1}})}function hf(a){fK().nextFrame(()=>{let b=gR(a);b&&g$(b)&&!he(b,0)&&hh(a)})}var hg=((E=hg||{})[E.Keyboard=0]="Keyboard",E[E.Mouse=1]="Mouse",E);function hh(a){null==a||a.focus({preventScroll:!0})}function hi(a,b=a=>a){return a.slice().sort((a,c)=>{let d=b(a),e=b(c);if(null===d||null===e)return 0;let f=d.compareDocumentPosition(e);return f&Node.DOCUMENT_POSITION_FOLLOWING?-1:f&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function hj(a,b,c=null===a?document.body:gQ(a)){return hk(hc(c),b,{relativeTo:a})}function hk(a,b,{sorted:c=!0,relativeTo:d=null,skipElements:e=[]}={}){var f,g,h;let i=Array.isArray(a)?a.length>0?gQ(a[0]):document:gQ(a),j=Array.isArray(a)?c?hi(a):a:64&b?function(a=document.body){return null==a?[]:Array.from(a.querySelectorAll(g8)).sort((a,b)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(b.tabIndex||Number.MAX_SAFE_INTEGER)))}(a):hc(a);e.length>0&&j.length>1&&(j=j.filter(a=>!e.some(b=>null!=b&&"current"in b?(null==b?void 0:b.current)===a:b===a))),d=null!=d?d:null==i?void 0:i.activeElement;let k=(()=>{if(5&b)return 1;if(10&b)return -1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(1&b)return 0;if(2&b)return Math.max(0,j.indexOf(d))-1;if(4&b)return Math.max(0,j.indexOf(d))+1;if(8&b)return j.length-1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),m=32&b?{preventScroll:!0}:{},o=0,p=j.length,q;do{if(o>=p||o+p<=0)return 0;let a=l+o;if(16&b)a=(a+p)%p;else{if(a<0)return 3;if(a>=p)return 1}null==(q=j[a])||q.focus(m),o+=k}while(q!==gR(q))return 6&b&&null!=(h=null==(g=null==(f=q)?void 0:f.matches)?void 0:g.call(f,"textarea,input"))&&h&&q.select(),2}function hl(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function hm(){return hl()||/Android/gi.test(window.navigator.userAgent)}function hn(a,b,c,d){let e=fQ(c);(0,U.useEffect)(()=>{if(a)return document.addEventListener(b,c,d),()=>document.removeEventListener(b,c,d);function c(a){e.current(a)}},[a,b,d])}function ho(a,b,c,d){let e=fQ(c);(0,U.useEffect)(()=>{if(a)return window.addEventListener(b,c,d),()=>window.removeEventListener(b,c,d);function c(a){e.current(a)}},[a,b,d])}function hp(a,b,c){let d=fQ(c),e=(0,U.useCallback)(function(a,c){if(a.defaultPrevented)return;let e=c(a);if(null!==e&&e.getRootNode().contains(e)&&e.isConnected){for(let c of function a(b){return"function"==typeof b?a(b()):Array.isArray(b)||b instanceof Set?b:[b]}(b))if(null!==c&&(c.contains(e)||a.composed&&a.composedPath().includes(c)))return;return he(e,hd.Loose)||-1===e.tabIndex||a.preventDefault(),d.current(a,e)}},[d,b]),f=(0,U.useRef)(null);hn(a,"pointerdown",a=>{var b,c;hm()||(f.current=(null==(c=null==(b=a.composedPath)?void 0:b.call(a))?void 0:c[0])||a.target)},!0),hn(a,"pointerup",a=>{if(hm()||!f.current)return;let b=f.current;return f.current=null,e(a,()=>b)},!0);let g=(0,U.useRef)({x:0,y:0});hn(a,"touchstart",a=>{g.current.x=a.touches[0].clientX,g.current.y=a.touches[0].clientY},!0),hn(a,"touchend",a=>{let b={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY};if(!(Math.abs(b.x-g.current.x)>=30||Math.abs(b.y-g.current.y)>=30))return e(a,()=>g$(a.target)?a.target:null)},!0),ho(a,"blur",a=>e(a,()=>g0(window.document.activeElement)?window.document.activeElement:null),!0)}function hq(...a){return(0,U.useMemo)(()=>gP(...a),[...a])}a.s(["Focus",()=>g9,"FocusResult",()=>ha,"FocusableMode",()=>hd,"focusElement",()=>hh,"focusFrom",()=>hj,"focusIn",()=>hk,"focusableSelector",()=>g7,"isFocusableElement",()=>he,"restoreFocusIfNecessary",()=>hf,"sortByDomNode",()=>hi],805841),a.s(["useDocumentEvent",()=>hn],760960),a.s(["useOutsideClick",()=>hp],489658),a.s(["useOwnerDocument",()=>hq],877511);var hr=((F=hr||{})[F.None=1]="None",F[F.Focusable=2]="Focusable",F[F.Hidden=4]="Hidden",F);let hs=gc(function(a,b){var c;let{features:d=1,...e}=a,f={ref:b,"aria-hidden":(2&d)==2||(null!=(c=e["aria-hidden"])?c:void 0),hidden:(4&d)==4||void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(4&d)==4&&(2&d)!=2&&{display:"none"}}};return f7()({ourProps:f,theirProps:e,slot:{},defaultTag:"span",name:"Hidden"})}),ht=(0,U.createContext)(null);function hu({children:a,node:b}){let[c,d]=(0,U.useState)(null),e=hv(null!=b?b:c);return U.default.createElement(ht.Provider,{value:e},a,null===e&&U.default.createElement(hs,{features:hr.Hidden,ref:a=>{var b,c;if(a){for(let e of null!=(c=null==(b=gP(a))?void 0:b.querySelectorAll("html > *, body > *"))?c:[])if(e!==document.body&&e!==document.head&&gY(e)&&null!=e&&e.contains(a)){d(e);break}}}}))}function hv(a=null){var b;return null!=(b=(0,U.useContext)(ht))?b:a}function hw(a){let b={};for(let c of a)Object.assign(b,c(b));return b}let hx=(D$=()=>new Map,D_={PUSH(a,b){var c;let d=null!=(c=this.get(a))?c:{doc:a,count:0,d:fK(),meta:new Set,computedMeta:{}};return d.count++,d.meta.add(b),d.computedMeta=hw(d.meta),this.set(a,d),this},POP(a,b){let c=this.get(a);return c&&(c.count--,c.meta.delete(b),c.computedMeta=hw(c.meta)),this},SCROLL_PREVENT(a){let b,c={doc:a.doc,d:a.d,meta:()=>a.computedMeta},d=[hl()?{before({doc:a,d:b,meta:c}){function d(a){for(let b of c().containers)for(let c of b())if(c.contains(a))return!0;return!1}b.microTask(()=>{var c;if("auto"!==window.getComputedStyle(a.documentElement).scrollBehavior){let c=fK();c.style(a.documentElement,"scrollBehavior","auto"),b.add(()=>b.microTask(()=>c.dispose()))}let e=null!=(c=window.scrollY)?c:window.pageYOffset,f=null;b.addEventListener(a,"click",b=>{if(g$(b.target))try{let c=b.target.closest("a");if(!c)return;let{hash:e}=new URL(c.href),g=a.querySelector(e);g$(g)&&!d(g)&&(f=g)}catch{}},!0),b.group(c=>{b.addEventListener(a,"touchstart",a=>{if(c.dispose(),g$(a.target)&&g_(a.target))if(d(a.target)){let b=a.target;for(;b.parentElement&&d(b.parentElement);)b=b.parentElement;c.style(b,"overscrollBehavior","contain")}else c.style(a.target,"touchAction","none")})}),b.addEventListener(a,"touchmove",a=>{if(g$(a.target)&&!g1(a.target))if(d(a.target)){let b=a.target;for(;b.parentElement&&""!==b.dataset.headlessuiPortal&&!(b.scrollHeight>b.clientHeight||b.scrollWidth>b.clientWidth);)b=b.parentElement;""===b.dataset.headlessuiPortal&&a.preventDefault()}else a.preventDefault()},{passive:!1}),b.add(()=>{var a;e!==(null!=(a=window.scrollY)?a:window.pageYOffset)&&window.scrollTo(0,e),f&&f.isConnected&&(f.scrollIntoView({block:"nearest"}),f=null)})})}}:{},{before({doc:a}){var c;let d=a.documentElement;b=Math.max(0,(null!=(c=a.defaultView)?c:window).innerWidth-d.clientWidth)},after({doc:a,d:c}){let d=a.documentElement,e=Math.max(0,d.clientWidth-d.offsetWidth),f=Math.max(0,b-e);c.style(d,"paddingRight",`${f}px`)}},{before({doc:a,d:b}){b.style(a.documentElement,"overflow","hidden")}}];d.forEach(({before:a})=>null==a?void 0:a(c)),d.forEach(({after:a})=>null==a?void 0:a(c))},SCROLL_ALLOW({d:a}){a.dispose()},TEARDOWN({doc:a}){this.delete(a)}},G=D$(),H=new Set,{getSnapshot:()=>G,subscribe:a=>(H.add(a),()=>H.delete(a)),dispatch(a,...b){let c=D_[a].call(G,...b);c&&(G=c,H.forEach(a=>a()))}});function hy(a,b,c=()=>[document.body]){!function(a,b,c=()=>({containers:[]})){let d=(0,U.useSyncExternalStore)(hx.subscribe,hx.getSnapshot,hx.getSnapshot),e=b?d.get(b):void 0;e&&e.count,fP(()=>{if(!(!b||!a))return hx.dispatch("PUSH",b,c),()=>hx.dispatch("POP",b,c)},[a,b])}(gO(a,"scroll-lock"),b,a=>{var b;return{containers:[...null!=(b=a.containers)?b:[],c]}})}function hz(a){return(0,U.useMemo)(()=>a,Object.values(a))}hx.subscribe(()=>{let a=hx.getSnapshot(),b=new Map;for(let[c]of a)b.set(c,c.documentElement.style.overflow);for(let c of a.values()){let a="hidden"===b.get(c.doc),d=0!==c.count;(d&&!a||!d&&a)&&hx.dispatch(c.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",c),0===c.count&&hx.dispatch("TEARDOWN",c)}}),a.s(["useScrollLock",()=>hy],207712),a.s(["useSlot",()=>hz],705840);let hA=(0,U.createContext)(()=>{});function hB({value:a,children:b}){return U.default.createElement(hA.Provider,{value:a},b)}let hC=(0,U.createContext)(!1);function hD(a){return U.default.createElement(hC.Provider,{value:a.force},a.children)}let hE=(0,U.createContext)(void 0);function hF(){return(0,U.useContext)(hE)}a.s(["useDisabled",()=>hF],354187);let hG=(0,U.createContext)(null);function hH(){let[a,b]=(0,U.useState)([]);return[a.length>0?a.join(" "):void 0,(0,U.useMemo)(()=>function(a){let c=fR(a=>(b(b=>[...b,a]),()=>b(b=>{let c=b.slice(),d=c.indexOf(a);return -1!==d&&c.splice(d,1),c}))),d=(0,U.useMemo)(()=>({register:c,slot:a.slot,name:a.name,props:a.props,value:a.value}),[c,a.slot,a.name,a.props,a.value]);return U.default.createElement(hG.Provider,{value:d},a.children)},[b])]}hG.displayName="DescriptionContext";let hI=Object.assign(gc(function(a,b){let c=(0,U.useId)(),d=hF(),{id:e=`headlessui-description-${c}`,...f}=a,g=function a(){let b=(0,U.useContext)(hG);if(null===b){let b=Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(b,a),b}return b}(),h=fW(b);fP(()=>g.register(e),[e,g.register]);let i=hz({...g.slot,disabled:d||!1}),j={ref:h,...g.props,id:e};return f7()({ourProps:j,theirProps:f,slot:i,defaultTag:"p",name:g.name||"Description"})}),{});function hJ(a){let b=fR(a),c=(0,U.useRef)(!1);(0,U.useEffect)(()=>(c.current=!1,()=>{c.current=!0,fJ(()=>{c.current&&b()})}),[b])}a.s(["Description",()=>hI,"useDescriptions",()=>hH],308735),a.s(["useOnUnmount",()=>hJ],820026);var hK=((I=hK||{})[I.Forwards=0]="Forwards",I[I.Backwards=1]="Backwards",I);function hL(a,b){let c=(0,U.useRef)([]),d=fR(a);(0,U.useEffect)(()=>{let a=[...c.current];for(let[e,f]of b.entries())if(c.current[e]!==f){let e=d(b,a);return c.current=b,e}},[d,...b])}let hM=[];function hN(a){if(!a)return new Set;if("function"==typeof a)return new Set(a());let b=new Set;for(let c of a.current)gY(c.current)&&b.add(c.current);return b}var hO=((J=hO||{})[J.None=0]="None",J[J.InitialFocus=1]="InitialFocus",J[J.TabLock=2]="TabLock",J[J.FocusLock=4]="FocusLock",J[J.RestoreFocus=8]="RestoreFocus",J[J.AutoFocus=16]="AutoFocus",J);let hP=Object.assign(gc(function(a,b){let c,d=(0,U.useRef)(null),e=fW(d,b),{initialFocus:f,initialFocusFallback:g,containers:h,features:i=15,...j}=a;fT()||(i=0);let k=hq(d.current);!function(a,{ownerDocument:b}){let c=!!(8&a),d=function(a=!0){let b=(0,U.useRef)(hM.slice());return hL(([a],[c])=>{!0===c&&!1===a&&fJ(()=>{b.current.splice(0)}),!1===c&&!0===a&&(b.current=hM.slice())},[a,hM,b]),fR(()=>{var a;return null!=(a=b.current.find(a=>null!=a&&a.isConnected))?a:null})}(c);hL(()=>{c||gS(null==b?void 0:b.body)&&hh(d())},[c]),hJ(()=>{c&&hh(d())})}(i,{ownerDocument:k});let l=function(a,{ownerDocument:b,container:c,initialFocus:d,initialFocusFallback:e}){let f=(0,U.useRef)(null),g=gO(!!(1&a),"focus-trap#initial-focus"),h=fS();return hL(()=>{if(0===a)return;if(!g){null!=e&&e.current&&hh(e.current);return}let i=c.current;i&&fJ(()=>{if(!h.current)return;let c=null==b?void 0:b.activeElement;if(null!=d&&d.current){if((null==d?void 0:d.current)===c){f.current=c;return}}else if(i.contains(c)){f.current=c;return}if(null!=d&&d.current)hh(d.current);else{if(16&a){if(hk(i,g9.First|g9.AutoFocus)!==ha.Error)return}else if(hk(i,g9.First)!==ha.Error)return;if(null!=e&&e.current&&(hh(e.current),(null==b?void 0:b.activeElement)===e.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}f.current=null==b?void 0:b.activeElement})},[e,g,a]),f}(i,{ownerDocument:k,container:d,initialFocus:f,initialFocusFallback:g});!function(a,{ownerDocument:b,container:c,containers:d,previousActiveElement:e}){let f=fS(),g=!!(4&a);gt(null==b?void 0:b.defaultView,"focus",a=>{if(!g||!f.current)return;let b=hN(d);gZ(c.current)&&b.add(c.current);let h=e.current;if(!h)return;let i=a.target;gZ(i)?hQ(b,i)?(e.current=i,hh(i)):(a.preventDefault(),a.stopPropagation(),hh(h)):hh(e.current)},!0)}(i,{ownerDocument:k,container:d,containers:h,previousActiveElement:l});let m=(c=(0,U.useRef)(0),ho(!0,"keydown",a=>{"Tab"===a.key&&(c.current=+!!a.shiftKey)},!0),c),o=fR(a=>{if(!gZ(d.current))return;let b=d.current;f4(m.current,{[hK.Forwards]:()=>{hk(b,g9.First,{skipElements:[a.relatedTarget,g]})},[hK.Backwards]:()=>{hk(b,g9.Last,{skipElements:[a.relatedTarget,g]})}})}),p=gO(!!(2&i),"focus-trap#tab-lock"),q=fL(),r=(0,U.useRef)(!1),s=f7();return U.default.createElement(U.default.Fragment,null,p&&U.default.createElement(hs,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:o,features:hr.Focusable}),s({ourProps:{ref:e,onKeyDown(a){"Tab"==a.key&&(r.current=!0,q.requestAnimationFrame(()=>{r.current=!1}))},onBlur(a){if(!(4&i))return;let b=hN(h);gZ(d.current)&&b.add(d.current);let c=a.relatedTarget;g$(c)&&"true"!==c.dataset.headlessuiFocusGuard&&(hQ(b,c)||(r.current?hk(d.current,f4(m.current,{[hK.Forwards]:()=>g9.Next,[hK.Backwards]:()=>g9.Previous})|g9.WrapAround,{relativeTo:a.target}):g$(a.target)&&hh(a.target)))}},theirProps:j,defaultTag:"div",name:"FocusTrap"}),p&&U.default.createElement(hs,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:o,features:hr.Focusable}))}),{features:hO});function hQ(a,b){for(let c of a)if(c.contains(b))return!0;return!1}var hR=a.i(935112);let hS=U.Fragment,hT=gc(function(a,b){let{ownerDocument:c=null,...d}=a,e=(0,U.useRef)(null),f=fW(fV(a=>{e.current=a}),b),g=hq(e.current),h=function(a){let b=(0,U.useContext)(hC),c=(0,U.useContext)(hV),[d,e]=(0,U.useState)(()=>{var d;if(!b&&null!==c)return null!=(d=c.current)?d:null;if(fO.isServer)return null;let e=null==a?void 0:a.getElementById("headlessui-portal-root");if(e)return e;if(null===a)return null;let f=a.createElement("div");return f.setAttribute("id","headlessui-portal-root"),a.body.appendChild(f)});return(0,U.useEffect)(()=>{null!==d&&(null!=a&&a.body.contains(d)||null==a||a.body.appendChild(d))},[d,a]),(0,U.useEffect)(()=>{b||null!==c&&e(c.current)},[c,e,b]),d}(null!=c?c:g),i=(0,U.useContext)(hW),j=fL(),k=f7();return hJ(()=>{var a;h&&h.childNodes.length<=0&&(null==(a=h.parentElement)||a.removeChild(h))}),h?(0,hR.createPortal)(U.default.createElement("div",{"data-headlessui-portal":"",ref:a=>{j.dispose(),i&&a&&j.add(i.register(a))}},k({ourProps:{ref:f},theirProps:d,slot:{},defaultTag:hS,name:"Portal"})),h):null}),hU=U.Fragment,hV=(0,U.createContext)(null),hW=(0,U.createContext)(null);function hX(){let a=(0,U.useContext)(hW),b=(0,U.useRef)([]),c=fR(c=>(b.current.push(c),a&&a.register(c),()=>d(c))),d=fR(c=>{let d=b.current.indexOf(c);-1!==d&&b.current.splice(d,1),a&&a.unregister(c)}),e=(0,U.useMemo)(()=>({register:c,unregister:d,portals:b}),[c,d,b]);return[b,(0,U.useMemo)(()=>function({children:a}){return U.default.createElement(hW.Provider,{value:e},a)},[e])]}let hY=gc(function(a,b){let c=fW(b),{enabled:d=!0,ownerDocument:e,...f}=a,g=f7();return d?U.default.createElement(hT,{...f,ownerDocument:e,ref:c}):g({ourProps:{ref:c},theirProps:f,slot:{},defaultTag:hS,name:"Portal"})}),hZ=gc(function(a,b){let{target:c,...d}=a,e={ref:fW(b)},f=f7();return U.default.createElement(hV.Provider,{value:c},f({ourProps:e,theirProps:d,defaultTag:hU,name:"Popover.Group"}))}),h$=Object.assign(hY,{Group:hZ});a.s(["Portal",()=>h$,"PortalGroup",()=>hZ,"useNestedPortals",()=>hX],445503);var h_=((K=h_||{})[K.Open=0]="Open",K[K.Closed=1]="Closed",K),h0=((L=h0||{})[L.SetTitleId=0]="SetTitleId",L);let h1={0:(a,b)=>a.titleId===b.id?a:{...a,titleId:b.id}},h2=(0,U.createContext)(null);function h3(a){let b=(0,U.useContext)(h2);if(null===b){let b=Error(`<${a} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(b,h3),b}return b}function h4(a,b){return f4(b.type,h1,a,b)}h2.displayName="DialogContext";let h5=gc(function(a,b){let c=(0,U.useId)(),{id:d=`headlessui-dialog-${c}`,open:e,onClose:f,initialFocus:g,role:h="dialog",autoFocus:i=!0,__demoMode:j=!1,unmount:k=!1,...l}=a,m=(0,U.useRef)(!1);h="dialog"===h||"alertdialog"===h?h:(m.current||(m.current=!0,console.warn(`Invalid role [${h}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog");let o=f0();void 0===e&&null!==o&&(e=(o&f_.Open)===f_.Open);let p=(0,U.useRef)(null),q=fW(p,b),r=hq(p.current),s=+!e,[t,u]=(0,U.useReducer)(h4,{titleId:null,descriptionId:null,panelRef:(0,U.createRef)()}),v=fR(()=>f(!1)),w=fR(a=>u({type:0,id:a})),x=!!fT()&&0===s,[y,z]=hX(),A=hv(),{resolveContainers:B}=function({defaultContainers:a=[],portals:b,mainTreeNode:c}={}){let d=fR(()=>{var d,e;let f=gP(c),g=[];for(let b of a)null!==b&&(gY(b)?g.push(b):"current"in b&&gY(b.current)&&g.push(b.current));if(null!=b&&b.current)for(let a of b.current)g.push(a);for(let a of null!=(d=null==f?void 0:f.querySelectorAll("html > *, body > *"))?d:[])a!==document.body&&a!==document.head&&gY(a)&&"headlessui-portal-root"!==a.id&&(c&&(a.contains(c)||a.contains(null==(e=null==c?void 0:c.getRootNode())?void 0:e.host))||g.some(b=>a.contains(b))||g.push(a));return g});return{resolveContainers:d,contains:fR(a=>d().some(b=>b.contains(a)))}}({mainTreeNode:A,portals:y,defaultContainers:[{get current(){var C;return null!=(C=t.panelRef.current)?C:p.current}}]}),D=null!==o&&(o&f_.Closing)===f_.Closing;gW(!j&&!D&&x,{allowed:fR(()=>{var a,b;return[null!=(b=null==(a=p.current)?void 0:a.closest("[data-headlessui-portal]"))?b:null]}),disallowed:fR(()=>{var a;return[null!=(a=null==A?void 0:A.closest("body > *:not(#headlessui-portal-root)"))?a:null]})});let E=gK.get(null);fP(()=>{if(x)return E.actions.push(d),()=>E.actions.pop(d)},[E,d,x]);let F=gM(E,(0,U.useCallback)(a=>E.selectors.isTop(a,d),[E,d]));hp(F,B,a=>{a.preventDefault(),v()}),function(a,b="undefined"!=typeof document?document.defaultView:null,c){let d=gO(a,"escape");gt(b,"keydown",a=>{d&&(a.defaultPrevented||a.key===gs.Escape&&c(a))})}(F,null==r?void 0:r.defaultView,a=>{a.preventDefault(),a.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),v()}),hy(!j&&!D&&x,r,B),g6(x,p,v);let[G,H]=hH(),I=(0,U.useMemo)(()=>[{dialogState:s,close:v,setTitleId:w,unmount:k},t],[s,v,w,k,t]),J=hz({open:0===s}),K={ref:q,id:d,role:h,tabIndex:-1,"aria-modal":j?void 0:0===s||void 0,"aria-labelledby":t.titleId,"aria-describedby":G,unmount:k},L=!function(){var a;let[b]=(0,U.useState)(()=>null),[c,d]=(0,U.useState)(null!=(a=null==b?void 0:b.matches)&&a);return fP(()=>{if(b)return b.addEventListener("change",a),()=>b.removeEventListener("change",a);function a(a){d(a.matches)}},[b]),c}(),M=hO.None;x&&!j&&(M|=hO.RestoreFocus,M|=hO.TabLock,i&&(M|=hO.AutoFocus),L&&(M|=hO.InitialFocus));let N=f7();return U.default.createElement(f2,null,U.default.createElement(hD,{force:!0},U.default.createElement(h$,null,U.default.createElement(h2.Provider,{value:I},U.default.createElement(hZ,{target:p},U.default.createElement(hD,{force:!1},U.default.createElement(H,{slot:J},U.default.createElement(z,null,U.default.createElement(hP,{initialFocus:g,initialFocusFallback:p,containers:B,features:M},U.default.createElement(hB,{value:v},N({ourProps:K,theirProps:l,slot:J,defaultTag:h6,features:h7,visible:0===s,name:"Dialog"})))))))))))}),h6="div",h7=f5.RenderStrategy|f5.Static,h8=gc(function(a,b){let{transition:c=!1,open:d,...e}=a,f=f0(),g=a.hasOwnProperty("open")||null!==f,h=a.hasOwnProperty("onClose");if(!g&&!h)throw Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!g)throw Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!h)throw Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!f&&"boolean"!=typeof a.open)throw Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${a.open}`);if("function"!=typeof a.onClose)throw Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${a.onClose}`);return(void 0!==d||c)&&!e.static?U.default.createElement(hu,null,U.default.createElement(gr,{show:d,transition:c,unmount:e.unmount},U.default.createElement(h5,{ref:b,...e}))):U.default.createElement(hu,null,U.default.createElement(h5,{ref:b,open:d,...e}))}),h9=gc(function(a,b){let c=(0,U.useId)(),{id:d=`headlessui-dialog-panel-${c}`,transition:e=!1,...f}=a,[{dialogState:g,unmount:h},i]=h3("Dialog.Panel"),j=fW(b,i.panelRef),k=hz({open:0===g}),l=fR(a=>{a.stopPropagation()}),m=e?gq:U.Fragment,o=f7();return U.default.createElement(m,{...e?{unmount:h}:{}},o({ourProps:{ref:j,id:d,onClick:l},theirProps:f,slot:k,defaultTag:"div",name:"Dialog.Panel"}))}),ia=Object.assign(h8,{Panel:h9,Title:(gc(function(a,b){let{transition:c=!1,...d}=a,[{dialogState:e,unmount:f}]=h3("Dialog.Backdrop"),g=hz({open:0===e}),h=c?gq:U.Fragment,i=f7();return U.default.createElement(h,{...c?{unmount:f}:{}},i({ourProps:{ref:b,"aria-hidden":!0},theirProps:d,slot:g,defaultTag:"div",name:"Dialog.Backdrop"}))}),gc(function(a,b){let c=(0,U.useId)(),{id:d=`headlessui-dialog-title-${c}`,...e}=a,[{dialogState:f,setTitleId:g}]=h3("Dialog.Title"),h=fW(b);(0,U.useEffect)(()=>(g(d),()=>g(null)),[d,g]);let i=hz({open:0===f});return f7()({ourProps:{ref:h,id:d},theirProps:e,slot:i,defaultTag:"h2",name:"Dialog.Title"})})),Description:hI});var ib=a.i(15388),ic=a.i(673620),id=a.i(679628),ie=a.i(741721);let ig=dM&&"object"==typeof dM&&"webcrypto"in dM?dM.webcrypto:dM&&"object"==typeof dM&&"randomBytes"in dM?dM:void 0;function ih(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function ii(a,...b){if(!(a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function ij(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function ik(a,b){ii(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}function il(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}function im(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function io(a,b){return a<<32-b|a>>>b}let ip=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0]?a=>a:function(a){for(let c=0;c<a.length;c++){var b;a[c]=(b=a[c])<<24&0xff000000|b<<8&0xff0000|b>>>8&65280|b>>>24&255}return a};function iq(a){return"string"==typeof a&&(a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a)),ii(a),a}class ir{}function is(a){let b=b=>a().update(iq(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function it(a=32){if(ig&&"function"==typeof ig.getRandomValues)return ig.getRandomValues(new Uint8Array(a));if(ig&&"function"==typeof ig.randomBytes)return Uint8Array.from(ig.randomBytes(a));throw Error("crypto.getRandomValues must be defined")}class iu extends ir{constructor(a,b,c,d){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.buffer=new Uint8Array(a),this.view=im(this.buffer)}update(a){ij(this),ii(a=iq(a));let{view:b,buffer:c,blockLen:d}=this,e=a.length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=im(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){ij(this),ik(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:d,isLE:e}=this,{pos:f}=this;b[f++]=128,il(this.buffer.subarray(f)),this.padOffset>d-f&&(this.process(c,0),f=0);for(let a=f;a<d;a++)b[a]=0;!function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}(c,d-8,BigInt(8*this.length),e),this.process(c,0);let g=im(a),h=this.outputLen;if(h%4)throw Error("_sha2: outputLen should be aligned to 32bit");let i=h/4,j=this.get();if(i>j.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<i;a++)g.setUint32(4*a,j[a],e)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.destroyed=f,a.finished=e,a.length=d,a.pos=g,d%b&&a.buffer.set(c),a}clone(){return this._cloneInto()}}let iv=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),iw=Uint32Array.from([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]),ix=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),iy=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),iz=BigInt(0x100000000-1),iA=BigInt(32);function iB(a,b=!1){let c=a.length,d=new Uint32Array(c),e=new Uint32Array(c);for(let f=0;f<c;f++){let{h:c,l:g}=function(a,b=!1){return b?{h:Number(a&iz),l:Number(a>>iA&iz)}:{h:0|Number(a>>iA&iz),l:0|Number(a&iz)}}(a[f],b);[d[f],e[f]]=[c,g]}return[d,e]}let iC=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),iD=new Uint32Array(64);class iE extends iu{constructor(a=32){super(64,a,8,!1),this.A=0|iv[0],this.B=0|iv[1],this.C=0|iv[2],this.D=0|iv[3],this.E=0|iv[4],this.F=0|iv[5],this.G=0|iv[6],this.H=0|iv[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)iD[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=iD[a-15],c=iD[a-2],d=io(b,7)^io(b,18)^b>>>3,e=io(c,17)^io(c,19)^c>>>10;iD[a]=e+iD[a-7]+d+iD[a-16]|0}let{A:c,B:d,C:e,D:f,E:g,F:h,G:i,H:j}=this;for(let a=0;a<64;a++){var k,l,m,o;let b=j+(io(g,6)^io(g,11)^io(g,25))+((k=g)&h^~k&i)+iC[a]+iD[a]|0,p=(io(c,2)^io(c,13)^io(c,22))+((l=c)&(m=d)^l&(o=e)^m&o)|0;j=i,i=h,h=g,g=f+b|0,f=e,e=d,d=c,c=b+p|0}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,h=h+this.F|0,i=i+this.G|0,j=j+this.H|0,this.set(c,d,e,f,g,h,i,j)}roundClean(){il(iD)}destroy(){this.set(0,0,0,0,0,0,0,0),il(this.buffer)}}let iF=iB(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(a=>BigInt(a))),iG=iF[0],iH=iF[1],iI=new Uint32Array(80),iJ=new Uint32Array(80),iK=is(()=>new iE);class iL extends ir{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,function(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.createHasher");ih(a.outputLen),ih(a.blockLen)}(a);const c=iq(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const d=this.blockLen,e=new Uint8Array(d);e.set(c.length>d?a.create().update(c).digest():c);for(let a=0;a<e.length;a++)e[a]^=54;this.iHash.update(e),this.oHash=a.create();for(let a=0;a<e.length;a++)e[a]^=106;this.oHash.update(e),il(e)}update(a){return ij(this),this.iHash.update(a),this}digestInto(a){ij(this),ii(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let iM=(a,b,c)=>new iL(a,b).update(c).digest();iM.create=(a,b)=>new iL(a,b);let iN=BigInt(0),iO=BigInt(1);function iP(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function iQ(a){if(!iP(a))throw Error("Uint8Array expected")}function iR(a,b){if("boolean"!=typeof b)throw Error(a+" boolean expected, got "+b)}function iS(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function iT(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?iN:BigInt("0x"+a)}let iU="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,iV=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function iW(a){if(iQ(a),iU)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=iV[a[c]];return b}function iX(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}function iY(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(iU)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=iX(a.charCodeAt(e)),f=iX(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function iZ(a){return iT(iW(a))}function i$(a){return iQ(a),iT(iW(Uint8Array.from(a).reverse()))}function i_(a,b){return iY(a.toString(16).padStart(2*b,"0"))}function i0(a,b){return i_(a,b).reverse()}function i1(a,b,c){let d;if("string"==typeof b)try{d=iY(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(iP(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}function i2(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];iQ(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}let i3=a=>"bigint"==typeof a&&iN<=a;function i4(a,b,c){return i3(a)&&i3(b)&&i3(c)&&b<=a&&a<c}function i5(a,b,c,d){if(!i4(b,c,d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}let i6=a=>(iO<<BigInt(a))-iO,i7=a=>new Uint8Array(a),i8={bigint:a=>"bigint"==typeof a,function:a=>"function"==typeof a,boolean:a=>"boolean"==typeof a,string:a=>"string"==typeof a,stringOrUint8Array:a=>"string"==typeof a||iP(a),isSafeInteger:a=>Number.isSafeInteger(a),array:a=>Array.isArray(a),field:(a,b)=>b.Fp.isValid(a),hash:a=>"function"==typeof a&&Number.isSafeInteger(a.outputLen)};function i9(a,b,c={}){let d=(b,c,d)=>{let e=i8[c];if("function"!=typeof e)throw Error("invalid validator function");let f=a[b];if((!d||void 0!==f)&&!e(f,a))throw Error("param "+String(b)+" is invalid. Expected "+c+", got "+f)};for(let[a,c]of Object.entries(b))d(a,c,!1);for(let[a,b]of Object.entries(c))d(a,b,!0);return a}function ja(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}let jb=BigInt(0),jc=BigInt(1),jd=BigInt(2),je=BigInt(3),jf=BigInt(4),jg=BigInt(5),jh=BigInt(8);function ji(a,b){let c=a%b;return c>=jb?c:b+c}function jj(a,b,c){let d=a;for(;b-- >jb;)d*=d,d%=c;return d}function jk(a,b){if(a===jb)throw Error("invert: expected non-zero number");if(b<=jb)throw Error("invert: expected positive modulus, got "+b);let c=ji(a,b),d=b,e=jb,f=jc,g=jc,h=jb;for(;c!==jb;){let a=d/c,b=d%c,i=e-g*a,j=f-h*a;d=c,c=b,e=g,f=h,g=i,h=j}if(d!==jc)throw Error("invert: does not exist");return ji(e,b)}function jl(a,b){let c=(a.ORDER+jc)/jf,d=a.pow(b,c);if(!a.eql(a.sqr(d),b))throw Error("Cannot find square root");return d}function jm(a,b){let c=(a.ORDER-jg)/jh,d=a.mul(b,jd),e=a.pow(d,c),f=a.mul(b,e),g=a.mul(a.mul(f,jd),e),h=a.mul(f,a.sub(g,a.ONE));if(!a.eql(a.sqr(h),b))throw Error("Cannot find square root");return h}let jn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function jo(a){return i9(a,jn.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function jp(a,b,c=!1){let d=Array(b.length).fill(c?a.ZERO:void 0),e=b.reduce((b,c,e)=>a.is0(c)?b:(d[e]=b,a.mul(b,c)),a.ONE),f=a.inv(e);return b.reduceRight((b,c,e)=>a.is0(c)?b:(d[e]=a.mul(b,d[e]),a.mul(b,c)),f),d}function jq(a,b){let c=(a.ORDER-jc)/jd,d=a.pow(b,c),e=a.eql(d,a.ONE),f=a.eql(d,a.ZERO),g=a.eql(d,a.neg(a.ONE));if(!e&&!f&&!g)throw Error("invalid Legendre symbol result");return e?1:f?0:-1}function jr(a,b){void 0!==b&&ih(b);let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function js(a,b,c=!1,d={}){let e;if(a<=jb)throw Error("invalid field: expected ORDER > 0, got "+a);let{nBitLength:f,nByteLength:g}=jr(a,b);if(g>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h=Object.freeze({ORDER:a,isLE:c,BITS:f,BYTES:g,MASK:i6(f),ZERO:jb,ONE:jc,create:b=>ji(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return jb<=b&&b<a},is0:a=>a===jb,isOdd:a=>(a&jc)===jc,neg:b=>ji(-b,a),eql:(a,b)=>a===b,sqr:b=>ji(b*b,a),add:(b,c)=>ji(b+c,a),sub:(b,c)=>ji(b-c,a),mul:(b,c)=>ji(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<jb)throw Error("invalid exponent, negatives unsupported");if(c===jb)return a.ONE;if(c===jc)return b;let d=a.ONE,e=b;for(;c>jb;)c&jc&&(d=a.mul(d,e)),e=a.sqr(e),c>>=jc;return d})(h,a,b),div:(b,c)=>ji(b*jk(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>jk(b,a),sqrt:d.sqrt||(b=>(e||(e=a%jf===je?jl:a%jh===jg?jm:function(a){if(a<BigInt(3))throw Error("sqrt is not defined for small field");let b=a-jc,c=0;for(;b%jd===jb;)b/=jd,c++;let d=jd,e=js(a);for(;1===jq(e,d);)if(d++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===c)return jl;let f=e.pow(d,b),g=(b+jc)/jd;return function(a,d){if(a.is0(d))return d;if(1!==jq(a,d))throw Error("Cannot find square root");let e=c,h=a.mul(a.ONE,f),i=a.pow(d,b),j=a.pow(d,g);for(;!a.eql(i,a.ONE);){if(a.is0(i))return a.ZERO;let b=1,c=a.sqr(i);for(;!a.eql(c,a.ONE);)if(b++,c=a.sqr(c),b===e)throw Error("Cannot find square root");let d=jc<<BigInt(e-b-1),f=a.pow(h,d);e=b,h=a.sqr(f),i=a.mul(i,h),j=a.mul(j,f)}return j}}(a)),e(h,b))),toBytes:a=>c?i0(a,g):i_(a,g),fromBytes:a=>{if(a.length!==g)throw Error("Field.fromBytes: expected "+g+" bytes, got "+a.length);return c?i$(a):iZ(a)},invertBatch:a=>jp(h,a),cmov:(a,b,c)=>c?b:a});return Object.freeze(h)}function jt(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function ju(a){let b=jt(a);return b+Math.ceil(b/2)}let jv=BigInt(0),jw=BigInt(1);function jx(a,b){let c=b.negate();return a?c:b}function jy(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function jz(a,b){jy(a,b);let c=Math.ceil(b/a)+1,d=2**(a-1),e=2**a;return{windows:c,windowSize:d,mask:i6(a),maxNumber:e,shiftBy:BigInt(a)}}function jA(a,b,c){let{windowSize:d,mask:e,maxNumber:f,shiftBy:g}=c,h=Number(a&e),i=a>>g;h>d&&(h-=f,i+=jw);let j=b*d,k=j+Math.abs(h)-1,l=0===h;return{nextN:i,offset:k,isZero:l,isNeg:h<0,isNegF:b%2!=0,offsetF:j}}let jB=new WeakMap,jC=new WeakMap;function jD(a){return jC.get(a)||1}function jE(a){return jo(a.Fp),i9(a,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...jr(a.n,a.nBitLength),...a,...{p:a.Fp.ORDER}})}function jF(a){void 0!==a.lowS&&iR("lowS",a.lowS),void 0!==a.prehash&&iR("prehash",a.prehash)}let jG={Err:class extends Error{constructor(a=""){super(a)}},_tlv:{encode:(a,b)=>{let{Err:c}=jG;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(1&b.length)throw new c("tlv.encode: unpadded data");let d=b.length/2,e=iS(d);if(e.length/2&128)throw new c("tlv.encode: long form length too big");let f=d>127?iS(e.length/2|128):"";return iS(a)+f+e+b},decode(a,b){let{Err:c}=jG,d=0;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(b.length<2||b[d++]!==a)throw new c("tlv.decode: wrong tlv");let e=b[d++],f=0;if(128&e){let a=127&e;if(!a)throw new c("tlv.decode(long): indefinite length not supported");if(a>4)throw new c("tlv.decode(long): byte length is too big");let g=b.subarray(d,d+a);if(g.length!==a)throw new c("tlv.decode: length bytes not complete");if(0===g[0])throw new c("tlv.decode(long): zero leftmost byte");for(let a of g)f=f<<8|a;if(d+=a,f<128)throw new c("tlv.decode(long): not minimal encoding")}else f=e;let g=b.subarray(d,d+f);if(g.length!==f)throw new c("tlv.decode: wrong value length");return{v:g,l:b.subarray(d+f)}}},_int:{encode(a){let{Err:b}=jG;if(a<jH)throw new b("integer: negative integers are not allowed");let c=iS(a);if(8&Number.parseInt(c[0],16)&&(c="00"+c),1&c.length)throw new b("unexpected DER parsing assertion: unpadded hex");return c},decode(a){let{Err:b}=jG;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return iZ(a)}},toSig(a){let{Err:b,_int:c,_tlv:d}=jG,e=i1("signature",a),{v:f,l:g}=d.decode(48,e);if(g.length)throw new b("invalid signature: left bytes after parsing");let{v:h,l:i}=d.decode(2,f),{v:j,l:k}=d.decode(2,i);if(k.length)throw new b("invalid signature: left bytes after parsing");return{r:c.decode(h),s:c.decode(j)}},hexFromSig(a){let{_tlv:b,_int:c}=jG,d=b.encode(2,c.encode(a.r)),e=b.encode(2,c.encode(a.s));return b.encode(48,d+e)}},jH=BigInt(0),jI=BigInt(1),jJ=BigInt(2),jK=BigInt(3),jL=BigInt(4),jM=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),jN=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),jO=BigInt(0),jP=BigInt(1),jQ=BigInt(2),jR=(a,b)=>(a+b/jQ)/b,jS=js(jM,void 0,void 0,{sqrt:function(a){let b=BigInt(3),c=BigInt(6),d=BigInt(11),e=BigInt(22),f=BigInt(23),g=BigInt(44),h=BigInt(88),i=a*a*a%jM,j=i*i*a%jM,k=jj(j,b,jM)*j%jM,l=jj(k,b,jM)*j%jM,m=jj(l,jQ,jM)*i%jM,o=jj(m,d,jM)*m%jM,p=jj(o,e,jM)*o%jM,q=jj(p,g,jM)*p%jM,r=jj(q,h,jM)*q%jM,s=jj(r,g,jM)*p%jM,t=jj(s,b,jM)*j%jM,u=jj(t,f,jM)*o%jM,v=jj(u,c,jM)*i%jM,w=jj(v,jQ,jM);if(!jS.eql(jS.sqr(w),a))throw Error("Cannot find square root");return w}}),jT=(D0={a:jO,b:BigInt(7),Fp:jS,n:jN,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:a=>{let b=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),c=-jP*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),d=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),e=BigInt("0x100000000000000000000000000000000"),f=jR(b*a,jN),g=jR(-c*a,jN),h=ji(a-f*b-g*d,jN),i=ji(-f*c-g*b,jN),j=h>e,k=i>e;if(j&&(h=jN-h),k&&(i=jN-i),h>e||i>e)throw Error("splitScalar: Endomorphism failed, k="+a);return{k1neg:j,k1:h,k2neg:k,k2:i}}}},{...(M=a=>(function(a){let b,c=(i9(b=jE(a),{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...b})),{Fp:d,n:e,nByteLength:f,nBitLength:g}=c,h=d.BYTES+1,i=2*d.BYTES+1;function j(a){return ji(a,e)}let{ProjectivePoint:k,normPrivateKeyToScalar:l,weierstrassEquation:m,isWithinCurveOrder:o}=function(a){var b;let c=function(a){let b=jE(a);i9(b,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});let{endo:c,Fp:d,a:e}=b;if(c){if(!d.eql(e,d.ZERO))throw Error("invalid endo: CURVE.a must be 0");if("object"!=typeof c||"bigint"!=typeof c.beta||"function"!=typeof c.splitScalar)throw Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...b})}(a),{Fp:d}=c,e=js(c.n,c.nBitLength),f=c.toBytes||((a,b,c)=>{let e=b.toAffine();return i2(Uint8Array.from([4]),d.toBytes(e.x),d.toBytes(e.y))}),g=c.fromBytes||(a=>{let b=a.subarray(1);return{x:d.fromBytes(b.subarray(0,d.BYTES)),y:d.fromBytes(b.subarray(d.BYTES,2*d.BYTES))}});function h(a){let{a:b,b:e}=c,f=d.sqr(a),g=d.mul(f,a);return d.add(d.add(g,d.mul(a,b)),e)}function i(a,b){let c=d.sqr(b),e=h(a);return d.eql(c,e)}if(!i(c.Gx,c.Gy))throw Error("bad curve params: generator point");let j=d.mul(d.pow(c.a,jK),jL),k=d.mul(d.sqr(c.b),BigInt(27));if(d.is0(d.add(j,k)))throw Error("bad curve params: a or b");function l(a){let b,{allowedPrivateKeyLengths:d,nByteLength:e,wrapPrivateKey:f,n:g}=c;if(d&&"bigint"!=typeof a){if(iP(a)&&(a=iW(a)),"string"!=typeof a||!d.includes(a.length))throw Error("invalid private key");a=a.padStart(2*e,"0")}try{b="bigint"==typeof a?a:iZ(i1("private key",a,e))}catch(b){throw Error("invalid private key, expected hex or "+e+" bytes, got "+typeof a)}return f&&(b=ji(b,g)),i5("private key",b,jI,g),b}function m(a){if(!(a instanceof q))throw Error("ProjectivePoint expected")}let o=ja((a,b)=>{let{px:c,py:e,pz:f}=a;if(d.eql(f,d.ONE))return{x:c,y:e};let g=a.is0();null==b&&(b=g?d.ONE:d.inv(f));let h=d.mul(c,b),i=d.mul(e,b),j=d.mul(f,b);if(g)return{x:d.ZERO,y:d.ZERO};if(!d.eql(j,d.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),p=ja(a=>{if(a.is0()){if(c.allowInfinityPoint&&!d.is0(a.py))return;throw Error("bad point: ZERO")}let{x:b,y:e}=a.toAffine();if(!d.isValid(b)||!d.isValid(e))throw Error("bad point: x or y not FE");if(!i(b,e))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class q{constructor(a,b,c){if(null==a||!d.isValid(a))throw Error("x required");if(null==b||!d.isValid(b)||d.is0(b))throw Error("y required");if(null==c||!d.isValid(c))throw Error("z required");this.px=a,this.py=b,this.pz=c,Object.freeze(this)}static fromAffine(a){let{x:b,y:c}=a||{};if(!a||!d.isValid(b)||!d.isValid(c))throw Error("invalid affine point");if(a instanceof q)throw Error("projective point not allowed");let e=a=>d.eql(a,d.ZERO);return e(b)&&e(c)?q.ZERO:new q(b,c,d.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let b=jp(d,a.map(a=>a.pz));return a.map((a,c)=>a.toAffine(b[c])).map(q.fromAffine)}static fromHex(a){let b=q.fromAffine(g(i1("pointHex",a)));return b.assertValidity(),b}static fromPrivateKey(a){return q.BASE.multiply(l(a))}static msm(a,b){return function(a,b,c,d){if(!Array.isArray(c))throw Error("array expected");c.forEach((b,c)=>{if(!(b instanceof a))throw Error("invalid point at index "+c)});if(!Array.isArray(d))throw Error("array of scalars expected");d.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)});let e=c.length,f=d.length;if(e!==f)throw Error("arrays of points and scalars must have equal length");let g=a.ZERO,h=function(a){let b;for(b=0;a>iN;a>>=iO,b+=1);return b}(BigInt(e)),i=1;h>12?i=h-3:h>4?i=h-2:h>0&&(i=2);let j=i6(i),k=Array(Number(j)+1).fill(g),l=Math.floor((b.BITS-1)/i)*i,m=g;for(let a=l;a>=0;a-=i){k.fill(g);for(let b=0;b<f;b++){let e=Number(d[b]>>BigInt(a)&j);k[e]=k[e].add(c[b])}let b=g;for(let a=k.length-1,c=g;a>0;a--)c=c.add(k[a]),b=b.add(c);if(m=m.add(b),0!==a)for(let a=0;a<i;a++)m=m.double()}return m}(q,e,a,b)}_setWindowSize(a){t.setWindowSize(this,a)}assertValidity(){p(this)}hasEvenY(){let{y:a}=this.toAffine();if(d.isOdd)return!d.isOdd(a);throw Error("Field doesn't support isOdd")}equals(a){m(a);let{px:b,py:c,pz:e}=this,{px:f,py:g,pz:h}=a,i=d.eql(d.mul(b,h),d.mul(f,e)),j=d.eql(d.mul(c,h),d.mul(g,e));return i&&j}negate(){return new q(this.px,d.neg(this.py),this.pz)}double(){let{a,b}=c,e=d.mul(b,jK),{px:f,py:g,pz:h}=this,i=d.ZERO,j=d.ZERO,k=d.ZERO,l=d.mul(f,f),m=d.mul(g,g),o=d.mul(h,h),p=d.mul(f,g);return p=d.add(p,p),k=d.mul(f,h),k=d.add(k,k),i=d.mul(a,k),j=d.mul(e,o),j=d.add(i,j),i=d.sub(m,j),j=d.add(m,j),j=d.mul(i,j),i=d.mul(p,i),k=d.mul(e,k),o=d.mul(a,o),p=d.sub(l,o),p=d.mul(a,p),p=d.add(p,k),k=d.add(l,l),l=d.add(k,l),l=d.add(l,o),l=d.mul(l,p),j=d.add(j,l),o=d.mul(g,h),o=d.add(o,o),l=d.mul(o,p),i=d.sub(i,l),k=d.mul(o,m),k=d.add(k,k),new q(i,j,k=d.add(k,k))}add(a){m(a);let{px:b,py:e,pz:f}=this,{px:g,py:h,pz:i}=a,j=d.ZERO,k=d.ZERO,l=d.ZERO,o=c.a,p=d.mul(c.b,jK),r=d.mul(b,g),s=d.mul(e,h),t=d.mul(f,i),u=d.add(b,e),v=d.add(g,h);u=d.mul(u,v),v=d.add(r,s),u=d.sub(u,v),v=d.add(b,f);let w=d.add(g,i);return v=d.mul(v,w),w=d.add(r,t),v=d.sub(v,w),w=d.add(e,f),j=d.add(h,i),w=d.mul(w,j),j=d.add(s,t),w=d.sub(w,j),l=d.mul(o,v),j=d.mul(p,t),l=d.add(j,l),j=d.sub(s,l),l=d.add(s,l),k=d.mul(j,l),s=d.add(r,r),s=d.add(s,r),t=d.mul(o,t),v=d.mul(p,v),s=d.add(s,t),t=d.sub(r,t),t=d.mul(o,t),v=d.add(v,t),r=d.mul(s,v),k=d.add(k,r),r=d.mul(w,v),j=d.mul(u,j),j=d.sub(j,r),r=d.mul(u,s),l=d.mul(w,l),new q(j,k,l=d.add(l,r))}subtract(a){return this.add(a.negate())}is0(){return this.equals(q.ZERO)}wNAF(a){return t.wNAFCached(this,a,q.normalizeZ)}multiplyUnsafe(a){let{endo:b,n:e}=c;i5("scalar",a,jH,e);let f=q.ZERO;if(a===jH)return f;if(this.is0()||a===jI)return this;if(!b||t.hasPrecomputes(this))return t.wNAFCachedUnsafe(this,a,q.normalizeZ);let{k1neg:g,k1:h,k2neg:i,k2:j}=b.splitScalar(a),k=f,l=f,m=this;for(;h>jH||j>jH;)h&jI&&(k=k.add(m)),j&jI&&(l=l.add(m)),m=m.double(),h>>=jI,j>>=jI;return g&&(k=k.negate()),i&&(l=l.negate()),l=new q(d.mul(l.px,b.beta),l.py,l.pz),k.add(l)}multiply(a){let b,e,{endo:f,n:g}=c;if(i5("scalar",a,jI,g),f){let{k1neg:c,k1:g,k2neg:h,k2:i}=f.splitScalar(a),{p:j,f:k}=this.wNAF(g),{p:l,f:m}=this.wNAF(i);j=t.constTimeNegate(c,j),l=t.constTimeNegate(h,l),l=new q(d.mul(l.px,f.beta),l.py,l.pz),b=j.add(l),e=k.add(m)}else{let{p:c,f:d}=this.wNAF(a);b=c,e=d}return q.normalizeZ([b,e])[0]}multiplyAndAddUnsafe(a,b,c){let d=q.BASE,e=(a,b)=>b!==jH&&b!==jI&&a.equals(d)?a.multiply(b):a.multiplyUnsafe(b),f=e(this,b).add(e(a,c));return f.is0()?void 0:f}toAffine(a){return o(this,a)}isTorsionFree(){let{h:a,isTorsionFree:b}=c;if(a===jI)return!0;if(b)return b(q,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:b}=c;return a===jI?this:b?b(q,this):this.multiplyUnsafe(c.h)}toRawBytes(a=!0){return iR("isCompressed",a),this.assertValidity(),f(q,this,a)}toHex(a=!0){return iR("isCompressed",a),iW(this.toRawBytes(a))}}q.BASE=new q(c.Gx,c.Gy,d.ONE),q.ZERO=new q(d.ZERO,d.ONE,d.ZERO);let{endo:r,nBitLength:s}=c,t=(b=r?Math.ceil(s/2):s,{constTimeNegate:jx,hasPrecomputes:a=>1!==jD(a),unsafeLadder(a,b,c=q.ZERO){let d=a;for(;b>jv;)b&jw&&(c=c.add(d)),d=d.double(),b>>=jw;return c},precomputeWindow(a,c){let{windows:d,windowSize:e}=jz(c,b),f=[],g=a,h=g;for(let a=0;a<d;a++){h=g,f.push(h);for(let a=1;a<e;a++)h=h.add(g),f.push(h);g=h.double()}return f},wNAF(a,c,d){let e=q.ZERO,f=q.BASE,g=jz(a,b);for(let a=0;a<g.windows;a++){let{nextN:b,offset:h,isZero:i,isNeg:j,isNegF:k,offsetF:l}=jA(d,a,g);d=b,i?f=f.add(jx(k,c[l])):e=e.add(jx(j,c[h]))}return{p:e,f}},wNAFUnsafe(a,c,d,e=q.ZERO){let f=jz(a,b);for(let a=0;a<f.windows&&d!==jv;a++){let{nextN:b,offset:g,isZero:h,isNeg:i}=jA(d,a,f);if(d=b,!h){let a=c[g];e=e.add(i?a.negate():a)}}return e},getPrecomputes(a,b,c){let d=jB.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&jB.set(b,c(d))),d},wNAFCached(a,b,c){let d=jD(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)},wNAFCachedUnsafe(a,b,c,d){let e=jD(a);return 1===e?this.unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)},setWindowSize(a,c){jy(c,b),jC.set(a,c),jB.delete(a)}});return{CURVE:c,ProjectivePoint:q,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:function(a){return i4(a,jI,c.n)}}}({...c,toBytes(a,b,c){let e=b.toAffine(),f=d.toBytes(e.x);return(iR("isCompressed",c),c)?i2(Uint8Array.from([b.hasEvenY()?2:3]),f):i2(Uint8Array.from([4]),f,d.toBytes(e.y))},fromBytes(a){let b=a.length,c=a[0],e=a.subarray(1);if(b===h&&(2===c||3===c)){let a,b=iZ(e);if(!i4(b,jI,d.ORDER))throw Error("Point is not on curve");let f=m(b);try{a=d.sqrt(f)}catch(a){throw Error("Point is not on curve"+(a instanceof Error?": "+a.message:""))}return(1&c)==1!=((a&jI)===jI)&&(a=d.neg(a)),{x:b,y:a}}if(b===i&&4===c)return{x:d.fromBytes(e.subarray(0,d.BYTES)),y:d.fromBytes(e.subarray(d.BYTES,2*d.BYTES))};throw Error("invalid Point, expected length of "+h+", or uncompressed "+i+", got "+b)}}),p=(a,b,c)=>iZ(a.slice(b,c));class q{constructor(a,b,c){i5("r",a,jI,e),i5("s",b,jI,e),this.r=a,this.s=b,null!=c&&(this.recovery=c),Object.freeze(this)}static fromCompact(a){return new q(p(a=i1("compactSignature",a,2*f),0,f),p(a,f,2*f))}static fromDER(a){let{r:b,s:c}=jG.toSig(i1("DER",a));return new q(b,c)}assertValidity(){}addRecoveryBit(a){return new q(this.r,this.s,a)}recoverPublicKey(a){let{r:b,s:f,recovery:g}=this,h=t(i1("msgHash",a));if(null==g||![0,1,2,3].includes(g))throw Error("recovery id invalid");let i=2===g||3===g?b+c.n:b;if(i>=d.ORDER)throw Error("recovery id 2 or 3 invalid");let l=(1&g)==0?"02":"03",m=k.fromHex(l+iW(i_(i,d.BYTES))),o=jk(i,e),p=j(-h*o),q=j(f*o),r=k.BASE.multiplyAndAddUnsafe(m,p,q);if(!r)throw Error("point at infinify");return r.assertValidity(),r}hasHighS(){return this.s>e>>jI}normalizeS(){return this.hasHighS()?new q(this.r,j(-this.s),this.recovery):this}toDERRawBytes(){return iY(this.toDERHex())}toDERHex(){return jG.hexFromSig(this)}toCompactRawBytes(){return iY(this.toCompactHex())}toCompactHex(){return iW(i_(this.r,f))+iW(i_(this.s,f))}}function r(a){if("bigint"==typeof a)return!1;if(a instanceof k)return!0;let b=i1("key",a).length,e=d.BYTES,g=e+1;if(!c.allowedPrivateKeyLengths&&f!==g)return b===g||b===2*e+1}let s=c.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let b=iZ(a),c=8*a.length-g;return c>0?b>>BigInt(c):b},t=c.bits2int_modN||function(a){return j(s(a))},u=i6(g);function v(a){return i5("num < 2^"+g,a,jH,u),i_(a,f)}let w={lowS:c.lowS,prehash:!1},x={lowS:c.lowS,prehash:!1};return k.BASE._setWindowSize(8),{CURVE:c,getPublicKey:function(a,b=!0){return k.fromPrivateKey(a).toRawBytes(b)},getSharedSecret:function(a,b,c=!0){if(!0===r(a))throw Error("first arg must be private key");if(!1===r(b))throw Error("second arg must be public key");return k.fromHex(b).multiply(l(a)).toRawBytes(c)},sign:function(a,b,f=w){let{seed:g,k2sig:h}=function(a,b,f=w){if(["recovered","canonical"].some(a=>a in f))throw Error("sign() legacy options not supported");let{hash:g,randomBytes:h}=c,{lowS:i,prehash:m,extraEntropy:p}=f;null==i&&(i=!0),a=i1("msgHash",a),jF(f),m&&(a=i1("prehashed msgHash",g(a)));let r=t(a),u=l(b),x=[v(u),v(r)];if(null!=p&&!1!==p){let a=!0===p?h(d.BYTES):p;x.push(i1("extraEntropy",a))}return{seed:i2(...x),k2sig:function(a){var b;let c=s(a);if(!o(c))return;let d=jk(c,e),f=k.BASE.multiply(c).toAffine(),g=j(f.x);if(g===jH)return;let h=j(d*j(r+g*u));if(h===jH)return;let l=2*(f.x!==g)|Number(f.y&jI),m=h;return i&&h>e>>jI&&(m=(b=h)>e>>jI?j(-b):b,l^=1),new q(g,m,l)}}}(a,b,f);return(function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=i7(a),e=i7(a),f=0,g=()=>{d.fill(1),e.fill(0),f=0},h=(...a)=>c(e,d,...a),i=(a=i7(0))=>{let b;if(e=h((b=[0],Uint8Array.from(b)),a),d=h(),0!==a.length){let b;e=h((b=[1],Uint8Array.from(b)),a),d=h()}},j=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(d=h()).slice();c.push(b),a+=d.length}return i2(...c)};return(a,b)=>{let c;for(g(),i(a);!(c=b(j()));)i();return g(),c}})(c.hash.outputLen,c.nByteLength,c.hmac)(g,h)},verify:function(a,b,d,f=x){let g,h;b=i1("msgHash",b),d=i1("publicKey",d);let{lowS:i,prehash:l,format:m}=f;if(jF(f),"strict"in f)throw Error("options.strict was renamed to lowS");if(void 0!==m&&"compact"!==m&&"der"!==m)throw Error("format must be compact or der");let o="string"==typeof a||iP(a),p=!o&&!m&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!o&&!p)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(p&&(h=new q(a.r,a.s)),o){try{"compact"!==m&&(h=q.fromDER(a))}catch(a){if(!(a instanceof jG.Err))throw a}h||"der"===m||(h=q.fromCompact(a))}g=k.fromHex(d)}catch(a){return!1}if(!h||i&&h.hasHighS())return!1;l&&(b=c.hash(b));let{r,s}=h,u=t(b),v=jk(s,e),w=j(u*v),y=j(r*v),z=k.BASE.multiplyAndAddUnsafe(g,w,y)?.toAffine();return!!z&&j(z.x)===r},ProjectivePoint:k,Signature:q,utils:{isValidPrivateKey(a){try{return l(a),!0}catch(a){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let a=ju(c.n);return function(a,b,c=!1){let d=a.length,e=jt(b),f=ju(b);if(d<16||d<f||d>1024)throw Error("expected "+f+"-1024 bytes of input, got "+d);let g=ji(c?i$(a):iZ(a),b-jc)+jc;return c?i0(g,e):i_(g,e)}(c.randomBytes(a),c.n)},precompute:(a=8,b=k.BASE)=>(b._setWindowSize(a),b.multiply(BigInt(3)),b)}}})({...D0,hash:a,hmac:(b,...c)=>iM(a,b,function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];ii(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}(...c)),randomBytes:it}))(iK),create:M});jT.ProjectivePoint;let jU=(N=[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(a=>a.map(a=>BigInt(a))).map(a=>Array.from(a).reverse()),(a,b)=>{let[c,d,e,f]=N.map(b=>b.reduce((b,c)=>jS.add(jS.mul(b,a),c))),[g,h]=jp(jS,[d,f],!0);return a=jS.mul(c,g),b=jS.mul(b,jS.mul(e,h)),{x:a,y:b}}),jV=function(a,b){if(jo(a),!a.isValid(b.A)||!a.isValid(b.B)||!a.isValid(b.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let c=function(a,b){let c=a.ORDER,d=jH;for(let a=c-jI;a%jJ===jH;a/=jJ)d+=jI;let e=d,f=jJ<<e-jI-jI,g=f*jJ,h=(c-jI)/g,i=(h-jI)/jJ,j=g-jI,k=a.pow(b,h),l=a.pow(b,(h+jI)/jJ),m=(b,c)=>{let d=k,g=a.pow(c,j),h=a.sqr(g);h=a.mul(h,c);let m=a.mul(b,h);m=a.pow(m,i),m=a.mul(m,g),g=a.mul(m,c),h=a.mul(m,b);let o=a.mul(h,g);m=a.pow(o,f);let p=a.eql(m,a.ONE);g=a.mul(h,l),m=a.mul(o,d),h=a.cmov(g,h,p),o=a.cmov(m,o,p);for(let b=e;b>jI;b--){let c=b-jJ;c=jJ<<c-jI;let e=a.pow(o,c),f=a.eql(e,a.ONE);g=a.mul(h,d),d=a.mul(d,d),e=a.mul(o,d),h=a.cmov(g,h,f),o=a.cmov(e,o,f)}return{isValid:p,value:h}};if(a.ORDER%jL===jK){let c=(a.ORDER-jK)/jL,d=a.sqrt(a.neg(b));m=(b,e)=>{let f=a.sqr(e),g=a.mul(b,e);f=a.mul(f,g);let h=a.pow(f,c);h=a.mul(h,g);let i=a.mul(h,d),j=a.mul(a.sqr(h),e),k=a.eql(j,b),l=a.cmov(i,h,k);return{isValid:k,value:l}}}return m}(a,b.Z);if(!a.isOdd)throw Error("Fp.isOdd is not implemented!");return d=>{let e,f,g,h,i,j,k,l;e=a.sqr(d),e=a.mul(e,b.Z),f=a.sqr(e),f=a.add(f,e),g=a.add(f,a.ONE),g=a.mul(g,b.B),h=a.cmov(b.Z,a.neg(f),!a.eql(f,a.ZERO)),h=a.mul(h,b.A),f=a.sqr(g),j=a.sqr(h),i=a.mul(j,b.A),f=a.add(f,i),f=a.mul(f,g),j=a.mul(j,h),i=a.mul(j,b.B),f=a.add(f,i),k=a.mul(e,g);let{isValid:m,value:o}=c(f,j);l=a.mul(e,d),l=a.mul(l,o),k=a.cmov(k,g,m),l=a.cmov(l,o,m);let p=a.isOdd(d)===a.isOdd(l);l=a.cmov(a.neg(l),l,p);let q=jp(a,[h],!0)[0];return{x:k=a.mul(k,q),y:l}}}(jS,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:jS.create(BigInt("-11"))});!function(a,b,c){if("function"!=typeof b)throw Error("mapToCurve() must be defined")}(jT.ProjectivePoint,a=>{let{x:b,y:c}=jV(jS.create(a[0]));return jU(b,c)},jS.ORDER);class jW extends Error{constructor(a,b={}){const c=(()=>{if(b.cause instanceof jW){if(b.cause.details)return b.cause.details;if(b.cause.shortMessage)return b.cause.shortMessage}return b.cause&&"details"in b.cause&&"string"==typeof b.cause.details?b.cause.details:b.cause?.message?b.cause.message:b.details})(),d=b.cause instanceof jW&&b.cause.docsPath||b.docsPath,e=`https://oxlib.sh${d??""}`;super([a||"An error occurred.",...b.metaMessages?["",...b.metaMessages]:[],...c||d?["",c?`Details: ${c}`:void 0,d?`See: ${e}`:void 0]:[]].filter(a=>"string"==typeof a).join("\n"),b.cause?{cause:b.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),this.cause=b.cause,this.details=c,this.docs=e,this.docsPath=d,this.shortMessage=a}walk(a){return function a(b,c){return c?.(b)?b:b&&"object"==typeof b&&"cause"in b&&b.cause?a(b.cause,c):c?null:b}(this,a)}}function jX(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}function jY(a,b){if(j6(a)>b)throw new kb({givenSize:j6(a),maxSize:b})}function jZ(a,b={}){let{dir:c,size:d=32}=b;if(0===d)return a;let e=a.replace("0x","");if(e.length>2*d)throw new kd({size:Math.ceil(e.length/2),targetSize:d,type:"Hex"});return`0x${e["right"===c?"padEnd":"padStart"](2*d,"0")}`}function j$(a,b,c){return JSON.stringify(a,(a,c)=>"function"==typeof b?b(a,c):"bigint"==typeof c?c.toString()+"#__bigint":c,c)}let j_=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function j0(...a){return`0x${a.reduce((a,b)=>a+b.replace("0x",""),"")}`}function j1(a){return a instanceof Uint8Array?j2(a):Array.isArray(a)?j2(new Uint8Array(a)):a}function j2(a,b={}){let c="";for(let b=0;b<a.length;b++)c+=j_[a[b]];let d=`0x${c}`;return"number"==typeof b.size?(jY(d,b.size),j4(d,b.size)):d}function j3(a,b={}){var c;let d,{signed:e,size:f}=b,g=BigInt(a);f?d=e?(1n<<8n*BigInt(f)-1n)-1n:2n**(8n*BigInt(f))-1n:"number"==typeof a&&(d=BigInt(Number.MAX_SAFE_INTEGER));let h="bigint"==typeof d&&e?-d-1n:0;if(d&&g>d||g<h){let b="bigint"==typeof a?"n":"";throw new j8({max:d?`${d}${b}`:void 0,min:`${h}${b}`,signed:e,size:f,value:`${a}${b}`})}let i=(e&&g<0?(1n<<BigInt(8*f))+BigInt(g):g).toString(16),j=`0x${i}`;return f?(c=j,jZ(c,{dir:"left",size:f})):j}function j4(a,b){return jZ(a,{dir:"right",size:b})}function j5(a,b,c,d={}){let{strict:e}=d;if("number"==typeof b&&b>0&&b>j6(a)-1)throw new kc({offset:b,position:"start",size:j6(a)});let f=`0x${a.replace("0x","").slice((b??0)*2,(c??a.length)*2)}`;return e&&function(a,b,c){if("number"==typeof b&&"number"==typeof c&&j6(a)!==c-b)throw new kc({offset:c,position:"end",size:j6(a)})}(f,b,c),f}function j6(a){return Math.ceil((a.length-2)/2)}function j7(a){return function(a,b={}){let{dir:c="left"}=b,d=a.replace("0x",""),e=0;for(let a=0;a<d.length-1;a++)if("0"===d["left"===c?a:d.length-a-1].toString())e++;else break;return"0"===(d="left"===c?d.slice(e):d.slice(0,d.length-e))?"0x":"right"===c&&d.length%2==1?`0x${d}0`:`0x${d}`}(a,{dir:"left"})}class j8 extends jW{constructor({max:a,min:b,signed:c,size:d,value:e}){super(`Number \`${e}\` is not in safe${d?` ${8*d}-bit`:""}${c?" signed":" unsigned"} integer range ${a?`(\`${b}\` to \`${a}\`)`:`(above \`${b}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class j9 extends jW{constructor(a){super(`Value \`${"object"==typeof a?j$(a):a}\` of type \`${typeof a}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class ka extends jW{constructor(a){super(`Value \`${a}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}class kb extends jW{constructor({givenSize:a,maxSize:b}){super(`Size cannot exceed \`${b}\` bytes. Given size: \`${a}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class kc extends jW{constructor({offset:a,position:b,size:c}){super(`Slice ${"start"===b?"starting":"ending"} at offset \`${a}\` is out-of-bounds (size: \`${c}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}class kd extends jW{constructor({size:a,targetSize:b,type:c}){super(`${c.charAt(0).toUpperCase()}${c.slice(1).toLowerCase()} size (\`${a}\`) exceeds padding size (\`${b}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}let ke=new TextEncoder;function kf(a){var b;return a instanceof Uint8Array?a:"string"==typeof a?kg(a):(b=a)instanceof Uint8Array?b:new Uint8Array(b)}function kg(a,b={}){let{size:c}=b,d=a;c&&(jY(a,c),d=j4(a,c));let e=d.slice(2);e.length%2&&(e=`0${e}`);let f=e.length/2,g=new Uint8Array(f);for(let a=0,b=0;a<f;a++){let c=jX(e.charCodeAt(b++)),d=jX(e.charCodeAt(b++));if(void 0===c||void 0===d)throw new jW(`Invalid byte sequence ("${e[b-2]}${e[b-1]}" in "${e}").`);g[a]=16*c+d}return g}class kh extends jW{constructor(a){super(`Value \`${"object"==typeof a?j$(a):a}\` of type \`${typeof a}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class ki extends jW{constructor({givenSize:a,maxSize:b}){super(`Size cannot exceed \`${b}\` bytes. Given size: \`${a}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class kj extends jW{constructor({size:a,targetSize:b,type:c}){super(`${c.charAt(0).toUpperCase()}${c.slice(1).toLowerCase()} size (\`${a}\`) exceeds padding size (\`${b}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}let kk=2n**256n-1n;function kl(a,b={}){let{recovered:c}=b;if(void 0===a.r||void 0===a.s||c&&void 0===a.yParity)throw new kG({signature:a});if(a.r<0n||a.r>kk)throw new kH({value:a.r});if(a.s<0n||a.s>kk)throw new kI({value:a.s});if("number"==typeof a.yParity&&0!==a.yParity&&1!==a.yParity)throw new kJ({value:a.yParity})}function km(a){return kn(j2(a))}function kn(a){if(130!==a.length&&132!==a.length)throw new kF({signature:a});let b=BigInt(j5(a,0,32)),c=BigInt(j5(a,32,64)),d=(()=>{let b=Number(`0x${a.slice(130)}`);if(!Number.isNaN(b))try{return kD(b)}catch{throw new kJ({value:b})}})();return void 0===d?{r:b,s:c}:{r:b,s:c,yParity:d}}function ko(a){if(void 0!==a.r&&void 0!==a.s)return kp(a)}function kp(a){let b="string"==typeof a?kn(a):a instanceof Uint8Array?km(a):"string"==typeof a.r?kt(a):a.v?ks(a):{r:a.r,s:a.s,...void 0!==a.yParity?{yParity:a.yParity}:{}};return kl(b),b}function kq(a){return kr(j2(a))}function kr(a){let{r:b,s:c}=jT.Signature.fromDER(j1(a).slice(2));return{r:b,s:c}}function ks(a){return{r:a.r,s:a.s,yParity:kD(a.v)}}function kt(a){let b=(()=>{let b=a.v?Number(a.v):void 0,c=a.yParity?Number(a.yParity):void 0;if("number"==typeof b&&"number"!=typeof c&&(c=kD(b)),"number"!=typeof c)throw new kJ({value:a.yParity});return c})();return{r:BigInt(a.r),s:BigInt(a.s),yParity:b}}function ku(a){let[b,c,d]=a;return kp({r:"0x"===c?0n:BigInt(c),s:"0x"===d?0n:BigInt(d),yParity:"0x"===b?0:Number(b)})}function kv(a){return kg(kw(a))}function kw(a){kl(a);let b=a.r,c=a.s;return j0(j3(b,{size:32}),j3(c,{size:32}),"number"==typeof a.yParity?j3(kE(a.yParity),{size:1}):"0x")}function kx(a){return new jT.Signature(a.r,a.s).toDERRawBytes()}function ky(a){let b=new jT.Signature(a.r,a.s);return`0x${b.toDERHex()}`}function kz(a){return{r:a.r,s:a.s,v:kE(a.yParity)}}function kA(a){let{r:b,s:c,yParity:d}=a;return{r:j3(b,{size:32}),s:j3(c,{size:32}),yParity:0===d?"0x0":"0x1"}}function kB(a){let{r:b,s:c,yParity:d}=a;return[d?"0x01":"0x",0n===b?"0x":j7(j3(b)),0n===c?"0x":j7(j3(c))]}function kC(a,b={}){try{return kl(a,b),!0}catch{return!1}}function kD(a){if(0===a||27===a)return 0;if(1===a||28===a)return 1;if(a>=35)return+(a%2==0);throw new kK({value:a})}function kE(a){if(0===a)return 27;if(1===a)return 28;throw new kJ({value:a})}class kF extends jW{constructor({signature:a}){super(`Value \`${a}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${j6(j1(a))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class kG extends jW{constructor({signature:a}){super(`Signature \`${j$(a)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}}class kH extends jW{constructor({value:a}){super(`Value \`${a}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}}class kI extends jW{constructor({value:a}){super(`Value \`${a}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}}class kJ extends jW{constructor({value:a}){super(`Value \`${a}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class kK extends jW{constructor({value:a}){super(`Value \`${a}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}a.s(["InvalidRError",()=>kH,"InvalidSError",()=>kI,"InvalidSerializedSizeError",()=>kF,"InvalidVError",()=>kK,"InvalidYParityError",()=>kJ,"MissingPropertiesError",()=>kG,"assert",()=>kl,"extract",()=>ko,"from",()=>kp,"fromBytes",()=>km,"fromDerBytes",()=>kq,"fromDerHex",()=>kr,"fromHex",()=>kn,"fromLegacy",()=>ks,"fromRpc",()=>kt,"fromTuple",()=>ku,"toBytes",()=>kv,"toDerBytes",()=>kx,"toDerHex",()=>ky,"toHex",()=>kw,"toLegacy",()=>kz,"toRpc",()=>kA,"toTuple",()=>kB,"vToYParity",()=>kD,"validate",()=>kC,"yParityToV",()=>kE],934671);var kL=a.i(934671),kL=kL;class kM extends Map{constructor(a){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=a}get(a){let b=super.get(a);return super.has(a)&&void 0!==b&&(this.delete(a),super.set(a,b)),b}set(a,b){if(super.set(a,b),this.maxSize&&this.size>this.maxSize){let a=this.keys().next().value;a&&this.delete(a)}return this}}let kN={checksum:new kM(8192)}.checksum,kO=Uint32Array.from([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]),kP=new Uint32Array(80);(a,b)=>Math.floor(0x100000000*Math.abs(Math.sin(b+1)));let kQ=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),kR=Uint8Array.from(Array(16).fill(0).map((a,b)=>b)),kS=kR.map(a=>(9*a+5)%16),kT=(()=>{let a=[[kR],[kS]];for(let b=0;b<4;b++)for(let c of a)c.push(c[b].map(a=>kQ[a]));return a})(),kU=kT[0],kV=kT[1],kW=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(a=>Uint8Array.from(a)),kX=kU.map((a,b)=>a.map(a=>kW[b][a])),kY=kV.map((a,b)=>a.map(a=>kW[b][a])),kZ=Uint32Array.from([0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),k$=Uint32Array.from([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0]),k_=BigInt(0),k0=BigInt(1),k1=BigInt(2),k2=BigInt(7),k3=BigInt(256),k4=BigInt(113),k5=[],k6=[],k7=[];for(let a=0,b=k0,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],k5.push(2*(5*d+c)),k6.push((a+1)*(a+2)/2%64);let e=k_;for(let a=0;a<7;a++)(b=(b<<k0^(b>>k2)*k4)%k3)&k1&&(e^=k0<<(k0<<BigInt(a))-k0);k7.push(e)}let k8=iB(k7,!0),k9=k8[0],la=k8[1],lb=(a,b,c)=>c>32?b<<c-32|a>>>64-c:a<<c|b>>>32-c,lc=(a,b,c)=>c>32?a<<c-32|b>>>64-c:b<<c|a>>>32-c;class ld extends ir{constructor(a,b,c,d=!1,e=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,ih(c),!(0<a&&a<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=function(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}(this.state)}clone(){return this._cloneInto()}keccak(){ip(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=lb(f,g,1)^c[d],i=lc(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=k6[c],f=lb(b,e,d),g=lc(b,e,d),h=k5[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=k9[d],a[1]^=la[d]}il(c)}(this.state32,this.rounds),ip(this.state32),this.posOut=0,this.pos=0}update(a){ij(this),ii(a=iq(a));let{blockLen:b,state:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){ij(this,!1),ii(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return ih(a),this.xofInto(new Uint8Array(a))}digestInto(a){if(ik(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,il(this.state)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new ld(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}let le=is(()=>new ld(136,1,32));function lf(a,b={}){let{as:c="string"==typeof a?"Hex":"Bytes"}=b,d=le(kf(a));return"Bytes"===c?d:j2(d)}function lg(a,b={}){let{compressed:c}=b,{prefix:d,x:e,y:f}=a;if(!1===c||"bigint"==typeof e&&"bigint"==typeof f){if(4!==d)throw new ll({prefix:d,cause:new ln});return}if(!0===c||"bigint"==typeof e&&void 0===f){if(3!==d&&2!==d)throw new ll({prefix:d,cause:new lm});return}throw new lk({publicKey:a})}function lh(a){let b=(()=>{if(function(a,b={}){let{strict:c=!1}=b;try{return!function(a,b={}){let{strict:c=!1}=b;if(!a||"string"!=typeof a)throw new j9(a);if(c&&!/^0x[0-9a-fA-F]*$/.test(a)||!a.startsWith("0x"))throw new ka(a)}(a,{strict:c}),!0}catch{return!1}}(a))return li(a);if(function(a){try{if(!(a instanceof Uint8Array)&&(!a||"object"!=typeof a||!("BYTES_PER_ELEMENT"in a)||1!==a.BYTES_PER_ELEMENT||"Uint8Array"!==a.constructor.name))throw new kh(a);return!0}catch{return!1}}(a))return li(j2(a));let{prefix:b,x:c,y:d}=a;return"bigint"==typeof c&&"bigint"==typeof d?{prefix:b??4,x:c,y:d}:{prefix:b,x:c}})();return lg(b),b}function li(a){if(132!==a.length&&130!==a.length&&68!==a.length)throw new lo({publicKey:a});if(130===a.length)return{prefix:4,x:BigInt(j5(a,0,32)),y:BigInt(j5(a,32,64))};if(132===a.length){let b=Number(j5(a,0,1));return{prefix:b,x:BigInt(j5(a,1,33)),y:BigInt(j5(a,33,65))}}return{prefix:Number(j5(a,0,1)),x:BigInt(j5(a,1,33))}}function lj(a,b={}){lg(a);let{prefix:c,x:d,y:e}=a,{includePrefix:f=!0}=b;return j0(f?j3(c,{size:1}):"0x",j3(d,{size:32}),"bigint"==typeof e?j3(e,{size:32}):"0x")}class lk extends jW{constructor({publicKey:a}){super(`Value \`${j$(a)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class ll extends jW{constructor({prefix:a,cause:b}){super(`Prefix "${a}" is invalid.`,{cause:b}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class lm extends jW{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class ln extends jW{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}class lo extends jW{constructor({publicKey:a}){super(`Value \`${a}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${j6(j1(a))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}}let lp=/^0x[a-fA-F0-9]{40}$/;function lq(a,b={}){let{strict:c=!0}=b;if(!lp.test(a))throw new ls({address:a,cause:new lt});if(c){if(a.toLowerCase()===a)return;if(lr(a)!==a)throw new ls({address:a,cause:new lu})}}function lr(a){if(kN.has(a))return kN.get(a);lq(a,{strict:!1});let b=a.substring(2).toLowerCase(),c=lf(function(a,b={}){let{size:c}=b,d=ke.encode(a);if("number"==typeof c){var e;if(d.length>c)throw new ki({givenSize:d.length,maxSize:c});return e=d,function(a,b={}){let{dir:c,size:d=32}=b;if(0===d)return a;if(a.length>d)throw new kj({size:a.length,targetSize:d,type:"Bytes"});let e=new Uint8Array(d);for(let b=0;b<d;b++){let f="right"===c;e[f?b:d-b-1]=a[f?b:a.length-b-1]}return e}(e,{dir:"right",size:c})}return d}(b),{as:"Bytes"}),d=b.split("");for(let a=0;a<40;a+=2)c[a>>1]>>4>=8&&d[a]&&(d[a]=d[a].toUpperCase()),(15&c[a>>1])>=8&&d[a+1]&&(d[a+1]=d[a+1].toUpperCase());let e=`0x${d.join("")}`;return kN.set(a,e),e}class ls extends jW{constructor({address:a,cause:b}){super(`Address "${a}" is invalid.`,{cause:b}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class lt extends jW{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class lu extends jW{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}function lv(a={}){let{as:b="Hex"}=a,c=ly({as:b}),d=lw({privateKey:c});return{privateKey:c,publicKey:d}}function lw(a){let{privateKey:b}=a;return lh(jT.ProjectivePoint.fromPrivateKey(j1(b).slice(2)))}function lx(a){let{as:b="Hex",privateKey:c,publicKey:d}=a,e=jT.ProjectivePoint.fromHex(lj(d).slice(2)).multiply(jT.utils.normPrivateKeyToScalar(j1(c).slice(2))).toRawBytes(!0);return"Hex"===b?j2(e):e}function ly(a={}){let{as:b="Hex"}=a,c=jT.utils.randomPrivateKey();return"Hex"===b?j2(c):c}function lz(a){return function(a,b={}){let c=lf(`0x${lj(a).slice(4)}`).substring(26);return function(a,b={}){let{checksum:c=!1}=b;return(lq(a),c)?lr(a):a}(`0x${c}`,b)}(lA(a))}function lA(a){let{payload:b,signature:c}=a,{r:d,s:e,yParity:f}=c;return lh(new jT.Signature(BigInt(d),BigInt(e)).addRecoveryBit(f).recoverPublicKey(j1(b).substring(2)))}function lB(a){let{extraEntropy:b=!1,hash:c,payload:d,privateKey:e}=a,{r:f,s:g,recovery:h}=jT.sign(kf(d),kf(e),{extraEntropy:"boolean"==typeof b?b:j1(b).slice(2),lowS:!0,...c?{prehash:!0}:{}});return{r:f,s:g,yParity:h}}function lC(a){let{address:b,hash:c,payload:d,publicKey:e,signature:f}=a;if(b){var g;return g=lz({payload:d,signature:f}),lq(b,{strict:!1}),lq(g,{strict:!1}),b.toLowerCase()===g.toLowerCase()}return jT.verify(f,kf(d),function(a,b={}){return kg(lj(a,b))}(e),...c?[{prehash:!0,lowS:!0}]:[])}a.s(["createKeyPair",()=>lv,"getPublicKey",()=>lw,"getSharedSecret",()=>lx,"noble",0,jT,"randomPrivateKey",()=>ly,"recoverAddress",()=>lz,"recoverPublicKey",()=>lA,"sign",()=>lB,"verify",()=>lC],5494);var lD=a.i(5494),lD=lD,lE=a.i(130934),lF=a.i(165782),lG=a.i(934008),lH=a.i(832819);a.i(78125);var lI=a.i(282800),lJ=a.i(864671),lK=a.i(60611),lL=a.i(73915),lM=a.i(572696),lN=a.i(626262),lO=a.i(920275);let lP="custom_context";var lQ=Object.defineProperty,lR=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?lQ(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class lS{constructor(a){lR(this,"nodeValue"),lR(this,"sizeInBytes"),lR(this,"next"),this.nodeValue=a,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class lT{constructor(a){lR(this,"lengthInNodes"),lR(this,"sizeInBytes"),lR(this,"head"),lR(this,"tail"),lR(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=a,this.sizeInBytes=0}append(a){let b=new lS(a);if(b.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${a} with size ${b.size}`);for(;this.size+b.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=b):this.head=b,this.tail=b,this.lengthInNodes++,this.sizeInBytes+=b.size}shift(){if(!this.head)return;let a=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=a.size}toArray(){let a=[],b=this.head;for(;null!==b;)a.push(b.value),b=b.next;return a}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let a=this.head;return{next:()=>{if(!a)return{done:!0,value:null};let b=a.value;return a=a.next,{done:!1,value:b}}}}}var lU=Object.defineProperty,lV=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?lU(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class lW{constructor(a,b=1024e3){lV(this,"logs"),lV(this,"level"),lV(this,"levelValue"),lV(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=a??"error",this.levelValue=lN.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=b,this.logs=new lT(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(a,b){b===lN.levels.values.error?console.error(a):b===lN.levels.values.warn?console.warn(a):b===lN.levels.values.debug?console.debug(a):b===lN.levels.values.trace?console.trace(a):console.log(a)}appendToLogs(a){this.logs.append((0,lO.safeJsonStringify)({timestamp:new Date().toISOString(),log:a}));let b="string"==typeof a?JSON.parse(a).level:a.level;b>=this.levelValue&&this.forwardToConsole(a,b)}getLogs(){return this.logs}clearLogs(){this.logs=new lT(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(a){let b=this.getLogArray();return b.push((0,lO.safeJsonStringify)({extraMetadata:a})),new Blob(b,{type:"application/json"})}}var lX=Object.defineProperty;class lY{constructor(a,b=1024e3){((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?lX(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"baseChunkLogger"),this.baseChunkLogger=new lW(a,b)}write(a){this.baseChunkLogger.appendToLogs(a)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(a){return this.baseChunkLogger.logsToBlob(a)}}var lZ=Object.defineProperty,l$=Object.defineProperties,l_=Object.getOwnPropertyDescriptors,l0=Object.getOwnPropertySymbols,l1=Object.prototype.hasOwnProperty,l2=Object.prototype.propertyIsEnumerable,l3=(a,b,c)=>b in a?lZ(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,l4=(a,b)=>{for(var c in b||(b={}))l1.call(b,c)&&l3(a,c,b[c]);if(l0)for(var c of l0(b))l2.call(b,c)&&l3(a,c,b[c]);return a};function l5(a,b=lP){return a[b]||""}function l6(a,b,c=lP){let d=function(a,b,c=lP){let d=l5(a,c);return d.trim()?`${d}/${b}`:b}(a,b,c);return function(a,b,c=lP){return a[c]=b,a}(a.child({context:d}),d,c)}function l7(a){var b;let c;return"u">typeof a.loggerOverride&&"string"!=typeof a.loggerOverride?{logger:a.loggerOverride,chunkLoggerController:null}:(c=new lY(null==(b=a.opts)?void 0:b.level,a.maxSizeInBytes),{logger:(0,lN.default)(l$(l4({},a.opts),l_({level:"trace"})),c),chunkLoggerController:c})}function l8(a){let[b,c]=a.split(":");return{namespace:b,reference:c}}function l9(a,b=[]){let c=[];return Object.keys(a).forEach(d=>{if(b.length&&!b.includes(d))return;let e=a[d];c.push(...e.accounts)}),c}function ma(a,b){return a.includes(":")?[a]:b.chains||[]}var mb=Object.defineProperty,mc=Object.defineProperties,md=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,mf=Object.prototype.hasOwnProperty,mg=Object.prototype.propertyIsEnumerable,mh=(a,b,c)=>b in a?mb(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,mi=(a,b)=>{for(var c in b||(b={}))mf.call(b,c)&&mh(a,c,b[c]);if(me)for(var c of me(b))mg.call(b,c)&&mh(a,c,b[c]);return a},mj=(a,b,c)=>mh(a,"symbol"!=typeof b?b+"":b,c);let mk="react-native",ml="node",mm="browser";function mn(){return"u">typeof process&&"u">typeof process.versions&&"u">typeof process.versions.node}function mo(){return!(0,id.getDocument)()&&!!(0,id.getNavigator)()&&"ReactNative"===navigator.product}function mp(){return!mn()&&!!(0,id.getNavigator)()&&!!(0,id.getDocument)()}function mq(){return mo()?mk:mn()?ml:mp()?mm:"unknown"}function mr(){var b;try{return mo()&&"u">typeof(null==a.g?void 0:a.g.Application)?null==(b=a.g.Application)?void 0:b.applicationId:void 0}catch{return}}function ms(){return(0,ie.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function mt(b,c,d){var e;let f,g=function(){if(mq()===mk&&"u">typeof(null==a.g?void 0:a.g.Platform)){let{OS:b,Version:c}=a.g.Platform;return[b,c].join("-")}let b=(0,ib.detect)();if(null===b)return"unknown";let c=b.os?b.os.replace(" ","").toLowerCase():"unknown";return"browser"===b.type?[c,b.name,b.version].join("-"):[c,b.version].join("-")}(),h=(f=mq())===mm?[f,(null==(e=(0,id.getLocation)())?void 0:e.host)||"unknown"].join(":"):f;return[[b,c].join("-"),["js",d].join("-"),g,h].join("/")}function mu(a,b){return a.filter(a=>b.includes(a)).length===a.length}function mv(a){return Object.fromEntries(a.entries())}function mw(a){return new Map(Object.entries(a))}function mx(a=ic.FIVE_MINUTES,b){let c,d,e,f,g=(0,ic.toMiliseconds)(a||ic.FIVE_MINUTES);return{resolve:a=>{e&&c&&(clearTimeout(e),c(a),f=Promise.resolve(a))},reject:a=>{e&&d&&(clearTimeout(e),d(a))},done:()=>new Promise((a,h)=>{if(f)return a(f);e=setTimeout(()=>{let a=Error(b);f=Promise.reject(a),h(a)},g),c=a,d=h})}}function my(a,b,c){return new Promise(async(d,e)=>{let f=setTimeout(()=>e(Error(c)),b);try{let b=await a;d(b)}catch(a){e(a)}clearTimeout(f)})}function mz(a,b){if("string"==typeof b&&b.startsWith(`${a}:`))return b;if("topic"===a.toLowerCase()){if("string"!=typeof b)throw Error('Value must be "string" for expirer target type: topic');return`topic:${b}`}if("id"===a.toLowerCase()){if("number"!=typeof b)throw Error('Value must be "number" for expirer target type: id');return`id:${b}`}throw Error(`Unknown expirer target type: ${a}`)}function mA(a){let[b,c]=a.split(":"),d={id:void 0,topic:void 0};if("topic"===b&&"string"==typeof c)d.topic=c;else if("id"===b&&Number.isInteger(Number(c)))d.id=Number(c);else throw Error(`Invalid target, expected id:number or topic:string, got ${b}:${c}`);return d}function mB(a,b){return(0,ic.fromMiliseconds)((b||Date.now())+(0,ic.toMiliseconds)(a))}function mC(a){return Date.now()>=(0,ic.toMiliseconds)(a)}function mD(a,b){return`${a}${b?`:${b}`:""}`}function mE(a=[],b=[]){return[...new Set([...a,...b])]}async function mF({id:b,topic:c,wcDeepLink:d}){var e,f;try{if(!d)return;let g="string"==typeof d?JSON.parse(d):d,h=g?.href;if("string"!=typeof h)return;let i=function(a,b,c){let d=`requestId=${b}&sessionTopic=${c}`;a.endsWith("/")&&(a=a.slice(0,-1));let e=`${a}`;if(a.startsWith("https://t.me")){let b=a.includes("?")?"&startapp=":"?startapp=";e=`${e}${b}${function(a,b=!1){let c=Buffer.from(a).toString("base64");return b?c.replace(/[=]/g,""):c}(d,!0)}`}else e=`${e}/wc?${d}`;return e}(h,b,c),j=mq();if(j===mm){let a;if(!(null!=(e=(0,id.getDocument)())&&e.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");f=i,a="_self",!function(){try{return window.self!==window.top}catch{return!1}}()?(f.startsWith("https://")||f.startsWith("http://"))&&(a="_blank"):a="_top",window.open(f,a,"noreferrer noopener")}else j===mk&&"u">typeof(null==a.g?void 0:a.g.Linking)&&await a.g.Linking.openURL(i)}catch(a){console.error(a)}}async function mG(a,b){let c="";try{if(mp()&&(c=localStorage.getItem(b)))return c;c=await a.getItem(b)}catch(a){console.error(a)}return c}function mH(a,b){if(!a.includes(b))return null;let c=a.split(/([&,?,=])/),d=c.indexOf(b);return c[d+2]}function mI(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,a=>{let b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)})}function mJ(){return"u">typeof process&&"true"===process.env.IS_VITEST}function mK(a){return Buffer.from(a,"base64").toString("utf-8")}class mL{constructor({limit:a}){mj(this,"limit"),mj(this,"set"),this.limit=a,this.set=new Set}add(a){if(!this.set.has(a)){if(this.set.size>=this.limit){let a=this.set.values().next().value;a&&this.set.delete(a)}this.set.add(a)}}has(a){return this.set.has(a)}}let mM=BigInt(0x100000000-1),mN=BigInt(32);function mO(a,b=!1){return b?{h:Number(a&mM),l:Number(a>>mN&mM)}:{h:0|Number(a>>mN&mM),l:0|Number(a&mM)}}function mP(a,b=!1){let c=a.length,d=new Uint32Array(c),e=new Uint32Array(c);for(let f=0;f<c;f++){let{h:c,l:g}=mO(a[f],b);[d[f],e[f]]=[c,g]}return[d,e]}let mQ=(a,b,c)=>a>>>c,mR=(a,b,c)=>a<<32-c|b>>>c,mS=(a,b,c)=>a>>>c|b<<32-c,mT=(a,b,c)=>a<<32-c|b>>>c,mU=(a,b,c)=>a<<64-c|b>>>c-32,mV=(a,b,c)=>a>>>c-32|b<<64-c;function mW(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}let mX=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0),mY=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0,mZ=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0),m$=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0,m_=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0),m0=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0,m1="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function m2(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function m3(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function m4(a,...b){if(!m2(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function m5(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.createHasher");m3(a.outputLen),m3(a.blockLen)}function m6(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function m7(a,b){m4(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}function m8(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function m9(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}function na(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function nb(a,b){return a<<32-b|a>>>b}let nc=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function nd(a){return a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255}let ne=nc?a=>a:a=>nd(a),nf=nc?a=>a:function(a){for(let b=0;b<a.length;b++)a[b]=nd(a[b]);return a},ng="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,nh=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function ni(a){if(m4(a),ng)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=nh[a[c]];return b}function nj(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}function nk(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(ng)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=nj(a.charCodeAt(e)),f=nj(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function nl(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}function nm(a){return"string"==typeof a&&(a=nl(a)),m4(a),a}function nn(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];m4(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}class no{}function np(a){let b=b=>a().update(nm(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function nq(a=32){if(m1&&"function"==typeof m1.getRandomValues)return m1.getRandomValues(new Uint8Array(a));if(m1&&"function"==typeof m1.randomBytes)return Uint8Array.from(m1.randomBytes(a));throw Error("crypto.getRandomValues must be defined")}let nr=BigInt(0),ns=BigInt(1),nt=BigInt(2),nu=BigInt(7),nv=BigInt(256),nw=BigInt(113),nx=[],ny=[],nz=[];for(let a=0,b=ns,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],nx.push(2*(5*d+c)),ny.push((a+1)*(a+2)/2%64);let e=nr;for(let a=0;a<7;a++)(b=(b<<ns^(b>>nu)*nw)%nv)&nt&&(e^=ns<<(ns<<BigInt(a))-ns);nz.push(e)}let nA=mP(nz,!0),nB=nA[0],nC=nA[1],nD=(a,b,c)=>c>32?b<<c-32|a>>>64-c:a<<c|b>>>32-c,nE=(a,b,c)=>c>32?a<<c-32|b>>>64-c:b<<c|a>>>32-c;class nF extends no{constructor(a,b,c,d=!1,e=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,m3(c),!(0<a&&a<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=m8(this.state)}clone(){return this._cloneInto()}keccak(){nf(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=nD(f,g,1)^c[d],i=nE(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=ny[c],f=nD(b,e,d),g=nE(b,e,d),h=nx[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=nB[d],a[1]^=nC[d]}m9(c)}(this.state32,this.rounds),nf(this.state32),this.posOut=0,this.pos=0}update(a){m6(this),m4(a=nm(a));let{blockLen:b,state:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){m6(this,!1),m4(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return m3(a),this.xofInto(new Uint8Array(a))}digestInto(a){if(m7(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,m9(this.state)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new nF(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}let nG=np(()=>new nF(136,1,32));class nH extends no{constructor(a,b,c,d){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.buffer=new Uint8Array(a),this.view=na(this.buffer)}update(a){m6(this),m4(a=nm(a));let{view:b,buffer:c,blockLen:d}=this,e=a.length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=na(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){m6(this),m7(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:d,isLE:e}=this,{pos:f}=this;b[f++]=128,m9(this.buffer.subarray(f)),this.padOffset>d-f&&(this.process(c,0),f=0);for(let a=f;a<d;a++)b[a]=0;(function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)})(c,d-8,BigInt(8*this.length),e),this.process(c,0);let g=na(a),h=this.outputLen;if(h%4)throw Error("_sha2: outputLen should be aligned to 32bit");let i=h/4,j=this.get();if(i>j.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<i;a++)g.setUint32(4*a,j[a],e)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.destroyed=f,a.finished=e,a.length=d,a.pos=g,d%b&&a.buffer.set(c),a}clone(){return this._cloneInto()}}let nI=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),nJ=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),nK=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),nL=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),nM=new Uint32Array(64);class nN extends nH{constructor(a=32){super(64,a,8,!1),this.A=0|nI[0],this.B=0|nI[1],this.C=0|nI[2],this.D=0|nI[3],this.E=0|nI[4],this.F=0|nI[5],this.G=0|nI[6],this.H=0|nI[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)nM[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=nM[a-15],c=nM[a-2],d=nb(b,7)^nb(b,18)^b>>>3,e=nb(c,17)^nb(c,19)^c>>>10;nM[a]=e+nM[a-7]+d+nM[a-16]|0}let{A:c,B:d,C:e,D:f,E:g,F:h,G:i,H:j}=this;for(let a=0;a<64;a++){var k,l,m,o;let b=j+(nb(g,6)^nb(g,11)^nb(g,25))+((k=g)&h^~k&i)+nL[a]+nM[a]|0,p=(nb(c,2)^nb(c,13)^nb(c,22))+((l=c)&(m=d)^l&(o=e)^m&o)|0;j=i,i=h,h=g,g=f+b|0,f=e,e=d,d=c,c=b+p|0}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,h=h+this.F|0,i=i+this.G|0,j=j+this.H|0,this.set(c,d,e,f,g,h,i,j)}roundClean(){m9(nM)}destroy(){this.set(0,0,0,0,0,0,0,0),m9(this.buffer)}}let nO=mP(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(a=>BigInt(a))),nP=nO[0],nQ=nO[1],nR=new Uint32Array(80),nS=new Uint32Array(80);class nT extends nH{constructor(a=64){super(128,a,16,!1),this.Ah=0|nK[0],this.Al=0|nK[1],this.Bh=0|nK[2],this.Bl=0|nK[3],this.Ch=0|nK[4],this.Cl=0|nK[5],this.Dh=0|nK[6],this.Dl=0|nK[7],this.Eh=0|nK[8],this.El=0|nK[9],this.Fh=0|nK[10],this.Fl=0|nK[11],this.Gh=0|nK[12],this.Gl=0|nK[13],this.Hh=0|nK[14],this.Hl=0|nK[15]}get(){let{Ah:a,Al:b,Bh:c,Bl:d,Ch:e,Cl:f,Dh:g,Dl:h,Eh:i,El:j,Fh:k,Fl:l,Gh:m,Gl:o,Hh:p,Hl:q}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q){this.Ah=0|a,this.Al=0|b,this.Bh=0|c,this.Bl=0|d,this.Ch=0|e,this.Cl=0|f,this.Dh=0|g,this.Dl=0|h,this.Eh=0|i,this.El=0|j,this.Fh=0|k,this.Fl=0|l,this.Gh=0|m,this.Gl=0|o,this.Hh=0|p,this.Hl=0|q}process(a,b){for(let c=0;c<16;c++,b+=4)nR[c]=a.getUint32(b),nS[c]=a.getUint32(b+=4);for(let a=16;a<80;a++){let b=0|nR[a-15],c=0|nS[a-15],d=mS(b,c,1)^mS(b,c,8)^mQ(b,c,7),e=mT(b,c,1)^mT(b,c,8)^mR(b,c,7),f=0|nR[a-2],g=0|nS[a-2],h=mS(f,g,19)^mU(f,g,61)^mQ(f,g,6),i=mZ(e,mT(f,g,19)^mV(f,g,61)^mR(f,g,6),nS[a-7],nS[a-16]),j=m$(i,d,h,nR[a-7],nR[a-16]);nR[a]=0|j,nS[a]=0|i}let{Ah:c,Al:d,Bh:e,Bl:f,Ch:g,Cl:h,Dh:i,Dl:j,Eh:k,El:l,Fh:m,Fl:o,Gh:p,Gl:q,Hh:r,Hl:s}=this;for(let a=0;a<80;a++){let b=mS(k,l,14)^mS(k,l,18)^mU(k,l,41),t=mT(k,l,14)^mT(k,l,18)^mV(k,l,41),u=k&m^~k&p,v=m_(s,t,l&o^~l&q,nQ[a],nS[a]),w=m0(v,r,b,u,nP[a],nR[a]),x=0|v,y=mS(c,d,28)^mU(c,d,34)^mU(c,d,39),z=mT(c,d,28)^mV(c,d,34)^mV(c,d,39),A=c&e^c&g^e&g,B=d&f^d&h^f&h;r=0|p,s=0|q,p=0|m,q=0|o,m=0|k,o=0|l,({h:k,l:l}=mW(0|i,0|j,0|w,0|x)),i=0|g,j=0|h,g=0|e,h=0|f,e=0|c,f=0|d;let C=mX(x,z,B);c=mY(C,w,y,A),d=0|C}({h:c,l:d}=mW(0|this.Ah,0|this.Al,0|c,0|d)),({h:e,l:f}=mW(0|this.Bh,0|this.Bl,0|e,0|f)),({h:g,l:h}=mW(0|this.Ch,0|this.Cl,0|g,0|h)),({h:i,l:j}=mW(0|this.Dh,0|this.Dl,0|i,0|j)),({h:k,l:l}=mW(0|this.Eh,0|this.El,0|k,0|l)),({h:m,l:o}=mW(0|this.Fh,0|this.Fl,0|m,0|o)),({h:p,l:q}=mW(0|this.Gh,0|this.Gl,0|p,0|q)),({h:r,l:s}=mW(0|this.Hh,0|this.Hl,0|r,0|s)),this.set(c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s)}roundClean(){m9(nR,nS)}destroy(){m9(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class nU extends nT{constructor(){super(48),this.Ah=0|nJ[0],this.Al=0|nJ[1],this.Bh=0|nJ[2],this.Bl=0|nJ[3],this.Ch=0|nJ[4],this.Cl=0|nJ[5],this.Dh=0|nJ[6],this.Dl=0|nJ[7],this.Eh=0|nJ[8],this.El=0|nJ[9],this.Fh=0|nJ[10],this.Fl=0|nJ[11],this.Gh=0|nJ[12],this.Gl=0|nJ[13],this.Hh=0|nJ[14],this.Hl=0|nJ[15]}}let nV=Uint32Array.from([0x22312194,0xfc2bf72c,0x9f555fa3,0xc84c64c2,0x2393b86b,0x6f53b151,0x96387719,0x5940eabd,0x96283ee2,0xa88effe3,0xbe5e1e25,0x53863992,0x2b0199fc,0x2c85b8aa,0xeb72ddc,0x81c52ca2]);class nW extends nT{constructor(){super(32),this.Ah=0|nV[0],this.Al=0|nV[1],this.Bh=0|nV[2],this.Bl=0|nV[3],this.Ch=0|nV[4],this.Cl=0|nV[5],this.Dh=0|nV[6],this.Dl=0|nV[7],this.Eh=0|nV[8],this.El=0|nV[9],this.Fh=0|nV[10],this.Fl=0|nV[11],this.Gh=0|nV[12],this.Gl=0|nV[13],this.Hh=0|nV[14],this.Hl=0|nV[15]}}let nX=np(()=>new nN),nY=np(()=>new nT),nZ=np(()=>new nU),n$=np(()=>new nW),n_=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),n0=Uint32Array.from([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),n1=new Uint32Array(32);function n2(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=n1[2*a],j=n1[2*a+1],k=n1[2*b],l=n1[2*b+1],m=n1[2*c],o=n1[2*c+1],p=n1[2*d],q=n1[2*d+1],r=mX(i,k,g);j=mY(r,j,l,h),i=0|r,({Dh:q,Dl:p}={Dh:q^j,Dl:p^i}),({Dh:q,Dl:p}={Dh:p,Dl:q}),({h:o,l:m}=mW(o,m,q,p)),({Bh:l,Bl:k}={Bh:l^o,Bl:k^m}),({Bh:l,Bl:k}={Bh:mS(l,k,24),Bl:mT(l,k,24)}),n1[2*a]=i,n1[2*a+1]=j,n1[2*b]=k,n1[2*b+1]=l,n1[2*c]=m,n1[2*c+1]=o,n1[2*d]=p,n1[2*d+1]=q}function n3(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=n1[2*a],j=n1[2*a+1],k=n1[2*b],l=n1[2*b+1],m=n1[2*c],o=n1[2*c+1],p=n1[2*d],q=n1[2*d+1],r=mX(i,k,g);j=mY(r,j,l,h),i=0|r,({Dh:q,Dl:p}={Dh:q^j,Dl:p^i}),({Dh:q,Dl:p}={Dh:mS(q,p,16),Dl:mT(q,p,16)}),({h:o,l:m}=mW(o,m,q,p)),({Bh:l,Bl:k}={Bh:l^o,Bl:k^m}),({Bh:l,Bl:k}={Bh:mU(l,k,63),Bl:mV(l,k,63)}),n1[2*a]=i,n1[2*a+1]=j,n1[2*b]=k,n1[2*b+1]=l,n1[2*c]=m,n1[2*c+1]=o,n1[2*d]=p,n1[2*d+1]=q}class n4 extends no{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,m3(a),m3(b),this.blockLen=a,this.outputLen=b,this.buffer=new Uint8Array(a),this.buffer32=m8(this.buffer)}update(a){m6(this),m4(a=nm(a));let{blockLen:b,buffer:c,buffer32:d}=this,e=a.length,f=a.byteOffset,g=a.buffer;for(let h=0;h<e;){this.pos===b&&(nf(d),this.compress(d,0,!1),nf(d),this.pos=0);let i=Math.min(b-this.pos,e-h),j=f+h;if(i===b&&!(j%4)&&h+i<e){let a=new Uint32Array(g,j,Math.floor((e-h)/4));nf(a);for(let c=0;h+b<e;c+=d.length,h+=b)this.length+=b,this.compress(a,c,!1);nf(a);continue}c.set(a.subarray(h,h+i),this.pos),this.pos+=i,this.length+=i,h+=i}return this}digestInto(a){m6(this),m7(a,this);let{pos:b,buffer32:c}=this;this.finished=!0,m9(this.buffer.subarray(b)),nf(c),this.compress(c,0,!0),nf(c);let d=m8(a);this.get().forEach((a,b)=>d[b]=ne(a))}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){let{buffer:b,length:c,finished:d,destroyed:e,outputLen:f,pos:g}=this;return a||(a=new this.constructor({dkLen:f})),a.set(...this.get()),a.buffer.set(b),a.destroyed=e,a.finished=d,a.length=c,a.pos=g,a.outputLen=f,a}clone(){return this._cloneInto()}}class n5 extends n4{constructor(a={}){const b=void 0===a.dkLen?64:a.dkLen;super(128,b),this.v0l=0|n0[0],this.v0h=0|n0[1],this.v1l=0|n0[2],this.v1h=0|n0[3],this.v2l=0|n0[4],this.v2h=0|n0[5],this.v3l=0|n0[6],this.v3h=0|n0[7],this.v4l=0|n0[8],this.v4h=0|n0[9],this.v5l=0|n0[10],this.v5h=0|n0[11],this.v6l=0|n0[12],this.v6h=0|n0[13],this.v7l=0|n0[14],this.v7h=0|n0[15],function(a,b={},c,d,e){if(m3(64),a<0||a>64)throw Error("outputLen bigger than keyLen");let{key:f,salt:g,personalization:h}=b;if(void 0!==f&&(f.length<1||f.length>64))throw Error("key length must be undefined or 1..64");if(void 0!==g&&16!==g.length)throw Error("salt must be undefined or 16");if(void 0!==h&&16!==h.length)throw Error("personalization must be undefined or 16")}(b,a,0,0,0);let{key:c,personalization:d,salt:e}=a,f=0;if(void 0!==c&&(f=(c=nm(c)).length),this.v0l^=this.outputLen|f<<8|0x1010000,void 0!==e){const a=m8(e=nm(e));this.v4l^=ne(a[0]),this.v4h^=ne(a[1]),this.v5l^=ne(a[2]),this.v5h^=ne(a[3])}if(void 0!==d){const a=m8(d=nm(d));this.v6l^=ne(a[0]),this.v6h^=ne(a[1]),this.v7l^=ne(a[2]),this.v7h^=ne(a[3])}if(void 0!==c){const a=new Uint8Array(this.blockLen);a.set(c),this.update(a)}}get(){let{v0l:a,v0h:b,v1l:c,v1h:d,v2l:e,v2h:f,v3l:g,v3h:h,v4l:i,v4h:j,v5l:k,v5h:l,v6l:m,v6h:o,v7l:p,v7h:q}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q){this.v0l=0|a,this.v0h=0|b,this.v1l=0|c,this.v1h=0|d,this.v2l=0|e,this.v2h=0|f,this.v3l=0|g,this.v3h=0|h,this.v4l=0|i,this.v4h=0|j,this.v5l=0|k,this.v5h=0|l,this.v6l=0|m,this.v6h=0|o,this.v7l=0|p,this.v7h=0|q}compress(a,b,c){this.get().forEach((a,b)=>n1[b]=a),n1.set(n0,16);let{h:d,l:e}=mO(BigInt(this.length));n1[24]=n0[8]^e,n1[25]=n0[9]^d,c&&(n1[28]=~n1[28],n1[29]=~n1[29]);let f=0;for(let c=0;c<12;c++)n2(0,4,8,12,a,b+2*n_[f++]),n3(0,4,8,12,a,b+2*n_[f++]),n2(1,5,9,13,a,b+2*n_[f++]),n3(1,5,9,13,a,b+2*n_[f++]),n2(2,6,10,14,a,b+2*n_[f++]),n3(2,6,10,14,a,b+2*n_[f++]),n2(3,7,11,15,a,b+2*n_[f++]),n3(3,7,11,15,a,b+2*n_[f++]),n2(0,5,10,15,a,b+2*n_[f++]),n3(0,5,10,15,a,b+2*n_[f++]),n2(1,6,11,12,a,b+2*n_[f++]),n3(1,6,11,12,a,b+2*n_[f++]),n2(2,7,8,13,a,b+2*n_[f++]),n3(2,7,8,13,a,b+2*n_[f++]),n2(3,4,9,14,a,b+2*n_[f++]),n3(3,4,9,14,a,b+2*n_[f++]);this.v0l^=n1[0]^n1[16],this.v0h^=n1[1]^n1[17],this.v1l^=n1[2]^n1[18],this.v1h^=n1[3]^n1[19],this.v2l^=n1[4]^n1[20],this.v2h^=n1[5]^n1[21],this.v3l^=n1[6]^n1[22],this.v3h^=n1[7]^n1[23],this.v4l^=n1[8]^n1[24],this.v4h^=n1[9]^n1[25],this.v5l^=n1[10]^n1[26],this.v5h^=n1[11]^n1[27],this.v6l^=n1[12]^n1[28],this.v6h^=n1[13]^n1[29],this.v7l^=n1[14]^n1[30],this.v7h^=n1[15]^n1[31],m9(n1)}destroy(){this.destroyed=!0,m9(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let n6=(D1=a=>new n5(a),(O=(a,b)=>D1(b).update(nm(a)).digest()).outputLen=(P=D1({})).outputLen,O.blockLen=P.blockLen,O.create=a=>D1(a),O);function n7(a){let b=`Ethereum Signed Message:
${a.length}`,c=new TextEncoder().encode(b+a);return"0x"+Buffer.from(nG(c)).toString("hex")}async function n8(a,b,c,d,e,f){switch(c.t){case"eip191":var g,h,i;let j;return await (g=a,h=b,i=c.s,j=kL.fromHex(i),lD.recoverAddress({payload:n7(h),signature:j}).toLowerCase()===g.toLowerCase());case"eip1271":return await n9(a,b,c.s,d,e,f);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${c.t}`)}}async function n9(a,b,c,d,e,f){let g=l8(d);if(!g.namespace||!g.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${d}`);try{let g="0x1626ba7e",h=c.substring(2),i=(h.length/2).toString(16).padStart(64,"0"),j=(b.startsWith("0x")?b:n7(b)).substring(2),k=g+j+"0000000000000000000000000000000000000000000000000000000000000040"+i+h,l=await fetch(`${f||"https://rpc.walletconnect.org/v1"}/?chainId=${d}&projectId=${e}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:a,data:k},"latest"]})}),{result:m}=await l.json();return!!m&&m.slice(0,g.length).toLowerCase()===g.toLowerCase()}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function oa(a){let b=new Uint8Array(nX(function(a){if(a instanceof Uint8Array)return a;if(Array.isArray(a))return new Uint8Array(a);if("object"==typeof a&&null!=a&&a.data)return new Uint8Array(Object.values(a.data));if("object"==typeof a&&a)return new Uint8Array(Object.values(a));throw Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(a)));return lE.default.encode(b)}function ob(a){let b=Buffer.from(a,"base64"),c=(0,lF.decode)(b).txn;if(!c)throw Error("Invalid signed transaction: missing 'txn' field");let d=(0,lG.encode)(c),e=Buffer.from("TX"),f=n$(Buffer.concat([e,Buffer.from(d)]));return fE.base32.encode(f).replace(/=+$/,"")}function oc(a){let b=[],c=BigInt(a);for(;c>=BigInt(128);)b.push(Number(c&BigInt(127)|BigInt(128))),c>>=BigInt(7);return b.push(Number(c)),Buffer.from(b)}var od=Object.defineProperty,oe=Object.defineProperties,of=Object.getOwnPropertyDescriptors,og=Object.getOwnPropertySymbols,oh=Object.prototype.hasOwnProperty,oi=Object.prototype.propertyIsEnumerable,oj=(a,b,c)=>b in a?od(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c;let ok=a=>a?.split(":"),ol=a=>{let b=a&&ok(a);if(b)return b[2]+":"+b[3]},om=a=>{let b=a&&ok(a);if(b)return b.pop()};async function on(a){let{cacao:b,projectId:c}=a,{s:d,p:e}=b,f=oo(e,e.iss),g=om(e.iss);return await n8(g,f,d,ol(e.iss),c)}let oo=(a,b)=>{let c=`${a.domain} wants you to sign in with your Ethereum account:`,d=om(b);if(!a.aud&&!a.uri)throw Error("Either `aud` or `uri` is required to construct the message");let e=a.statement||void 0,f=`URI: ${a.aud||a.uri}`,g=`Version: ${a.version}`,h=`Chain ID: ${(a=>{let b=a&&ok(a);if(b)return a.includes("did:pkh:")?b[3]:b[1]})(b)}`,i=`Nonce: ${a.nonce}`,j=`Issued At: ${a.iat}`,k=a.exp?`Expiration Time: ${a.exp}`:void 0,l=a.nbf?`Not Before: ${a.nbf}`:void 0,m=a.requestId?`Request ID: ${a.requestId}`:void 0,o=a.resources?`Resources:${a.resources.map(a=>`
- ${a}`).join("")}`:void 0,p=ou(a.resources);return p&&(e=function(a="",b){op(b);let c="I further authorize the stated URI to perform the following actions on my behalf: ";if(a.includes(c))return a;let d=[],e=0;Object.keys(b.att).forEach(a=>{let c=Object.keys(b.att[a]).map(a=>({ability:a.split("/")[0],action:a.split("/")[1]}));c.sort((a,b)=>a.action.localeCompare(b.action));let f={};c.forEach(a=>{f[a.ability]||(f[a.ability]=[]),f[a.ability].push(a.action)});let g=Object.keys(f).map(b=>(e++,`(${e}) '${b}': '${f[b].join("', '")}' for '${a}'.`));d.push(g.join(", ").replace(".,","."))});let f=d.join(" "),g=`${c}${f}`;return`${a?a+" ":""}${g}`}(e,or(p))),[c,d,"",e,"",f,g,h,i,j,k,l,m,o].filter(a=>null!=a).join(`
`)};function op(a){if(!a)throw Error("No recap provided, value is undefined");if(!a.att)throw Error("No `att` property found");let b=Object.keys(a.att);if(!(null!=b&&b.length))throw Error("No resources found in `att` property");b.forEach(b=>{let c=a.att[b];if(Array.isArray(c)||"object"!=typeof c)throw Error(`Resource must be an object: ${b}`);if(!Object.keys(c).length)throw Error(`Resource object is empty: ${b}`);Object.keys(c).forEach(a=>{let b=c[a];if(!Array.isArray(b))throw Error(`Ability limits ${a} must be an array of objects, found: ${b}`);if(!b.length)throw Error(`Value of ${a} is empty array, must be an array with objects`);b.forEach(b=>{if("object"!=typeof b)throw Error(`Ability limits (${a}) must be an array of objects, found: ${b}`)})})})}function oq(a){return op(a),`urn:recap:${Buffer.from(JSON.stringify(a)).toString("base64").replace(/=/g,"")}`}function or(a){var b;let c=(b=a.replace("urn:recap:",""),JSON.parse(Buffer.from(b,"base64").toString("utf-8")));return op(c),c}function os(a){var b;let c=or(a);op(c);let d=null==(b=c.att)?void 0:b.eip155;return d?Object.keys(d).map(a=>a.split("/")[1]):[]}function ot(a){let b=or(a);op(b);let c=[];return Object.values(b.att).forEach(a=>{Object.values(a).forEach(a=>{var b;null!=(b=a?.[0])&&b.chains&&c.push(a[0].chains)})}),[...new Set(c.flat())]}function ou(a){if(!a)return;let b=a?.[a.length-1];return b&&b.includes("urn:recap:")?b:void 0}function ov(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function ow(a){if("boolean"!=typeof a)throw Error(`boolean expected, not ${a}`)}function ox(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function oy(a,...b){if(!ov(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function oz(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function oA(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function oB(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}let oC=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function oD(a){if("string"==typeof a)a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a);else if(ov(a))a=oG(a);else throw Error("Uint8Array expected, got "+typeof a);return a}function oE(a,b,c=!0){if(void 0===b)return new Uint8Array(a);if(b.length!==a)throw Error("invalid output length, expected "+a+", got: "+b.length);if(c&&b.byteOffset%4!=0)throw Error("invalid output, must be aligned");return b}function oF(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}function oG(a){return Uint8Array.from(a)}let oH=a=>Uint8Array.from(a.split("").map(a=>a.charCodeAt(0))),oI=oH("expand 16-byte k"),oJ=oH("expand 32-byte k"),oK=oA(oI),oL=oA(oJ);function oM(a,b){return a<<b|a>>>32-b}function oN(a){return a.byteOffset%4==0}let oO=0x100000000-1,oP=new Uint32Array,oQ=(a,b)=>255&a[b++]|(255&a[b++])<<8;class oR{constructor(a){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,oy(a=oD(a),32);const b=oQ(a,0),c=oQ(a,2),d=oQ(a,4),e=oQ(a,6),f=oQ(a,8),g=oQ(a,10),h=oQ(a,12),i=oQ(a,14);this.r[0]=8191&b,this.r[1]=(b>>>13|c<<3)&8191,this.r[2]=(c>>>10|d<<6)&7939,this.r[3]=(d>>>7|e<<9)&8191,this.r[4]=(e>>>4|f<<12)&255,this.r[5]=f>>>1&8190,this.r[6]=(f>>>14|g<<2)&8191,this.r[7]=(g>>>11|h<<5)&8065,this.r[8]=(h>>>8|i<<8)&8191,this.r[9]=i>>>5&127;for(let b=0;b<8;b++)this.pad[b]=oQ(a,16+2*b)}process(a,b,c=!1){let{h:d,r:e}=this,f=e[0],g=e[1],h=e[2],i=e[3],j=e[4],k=e[5],l=e[6],m=e[7],o=e[8],p=e[9],q=oQ(a,b+0),r=oQ(a,b+2),s=oQ(a,b+4),t=oQ(a,b+6),u=oQ(a,b+8),v=oQ(a,b+10),w=oQ(a,b+12),x=oQ(a,b+14),y=d[0]+(8191&q),z=d[1]+((q>>>13|r<<3)&8191),A=d[2]+((r>>>10|s<<6)&8191),B=d[3]+((s>>>7|t<<9)&8191),C=d[4]+((t>>>4|u<<12)&8191),D=d[5]+(u>>>1&8191),E=d[6]+((u>>>14|v<<2)&8191),F=d[7]+((v>>>11|w<<5)&8191),G=d[8]+((w>>>8|x<<8)&8191),H=d[9]+(x>>>5|2048*!c),I=0,J=0+y*f+5*p*z+5*o*A+5*m*B+5*l*C;I=J>>>13,J&=8191,J+=5*k*D+5*j*E+5*i*F+5*h*G+5*g*H,I+=J>>>13,J&=8191;let K=I+y*g+z*f+5*p*A+5*o*B+5*m*C;I=K>>>13,K&=8191,K+=5*l*D+5*k*E+5*j*F+5*i*G+5*h*H,I+=K>>>13,K&=8191;let L=I+y*h+z*g+A*f+5*p*B+5*o*C;I=L>>>13,L&=8191,L+=5*m*D+5*l*E+5*k*F+5*j*G+5*i*H,I+=L>>>13,L&=8191;let M=I+y*i+z*h+A*g+B*f+5*p*C;I=M>>>13,M&=8191,M+=5*o*D+5*m*E+5*l*F+5*k*G+5*j*H,I+=M>>>13,M&=8191;let N=I+y*j+z*i+A*h+B*g+C*f;I=N>>>13,N&=8191,N+=5*p*D+5*o*E+5*m*F+5*l*G+5*k*H,I+=N>>>13,N&=8191;let O=I+y*k+z*j+A*i+B*h+C*g;I=O>>>13,O&=8191,O+=D*f+5*p*E+5*o*F+5*m*G+5*l*H,I+=O>>>13,O&=8191;let P=I+y*l+z*k+A*j+B*i+C*h;I=P>>>13,P&=8191,P+=D*g+E*f+5*p*F+5*o*G+5*m*H,I+=P>>>13,P&=8191;let Q=I+y*m+z*l+A*k+B*j+C*i;I=Q>>>13,Q&=8191,Q+=D*h+E*g+F*f+5*p*G+5*o*H,I+=Q>>>13,Q&=8191;let R=I+y*o+z*m+A*l+B*k+C*j;I=R>>>13,R&=8191,R+=D*i+E*h+F*g+G*f+5*p*H,I+=R>>>13,R&=8191;let S=I+y*p+z*o+A*m+B*l+C*k;I=S>>>13,S&=8191,S+=D*j+E*i+F*h+G*g+H*f,I+=S>>>13,S&=8191,J=8191&(I=(I=(I<<2)+I|0)+J|0),I>>>=13,K+=I,d[0]=J,d[1]=K,d[2]=L,d[3]=M,d[4]=N,d[5]=O,d[6]=P,d[7]=Q,d[8]=R,d[9]=S}finalize(){let{h:a,pad:b}=this,c=new Uint16Array(10),d=a[1]>>>13;a[1]&=8191;for(let b=2;b<10;b++)a[b]+=d,d=a[b]>>>13,a[b]&=8191;a[0]+=5*d,d=a[0]>>>13,a[0]&=8191,a[1]+=d,d=a[1]>>>13,a[1]&=8191,a[2]+=d,c[0]=a[0]+5,d=c[0]>>>13,c[0]&=8191;for(let b=1;b<10;b++)c[b]=a[b]+d,d=c[b]>>>13,c[b]&=8191;c[9]-=8192;let e=(1^d)-1;for(let a=0;a<10;a++)c[a]&=e;e=~e;for(let b=0;b<10;b++)a[b]=a[b]&e|c[b];a[0]=(a[0]|a[1]<<13)&65535,a[1]=(a[1]>>>3|a[2]<<10)&65535,a[2]=(a[2]>>>6|a[3]<<7)&65535,a[3]=(a[3]>>>9|a[4]<<4)&65535,a[4]=(a[4]>>>12|a[5]<<1|a[6]<<14)&65535,a[5]=(a[6]>>>2|a[7]<<11)&65535,a[6]=(a[7]>>>5|a[8]<<8)&65535,a[7]=(a[8]>>>8|a[9]<<5)&65535;let f=a[0]+b[0];a[0]=65535&f;for(let c=1;c<8;c++)f=(a[c]+b[c]|0)+(f>>>16)|0,a[c]=65535&f;oB(c)}update(a){oz(this),oy(a=oD(a));let{buffer:b,blockLen:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(c-this.pos,d-e);if(f===c){for(;c<=d-e;e+=c)this.process(a,e);continue}b.set(a.subarray(e,e+f),this.pos),this.pos+=f,e+=f,this.pos===c&&(this.process(b,0,!1),this.pos=0)}return this}destroy(){oB(this.h,this.r,this.buffer,this.pad)}digestInto(a){oz(this),function(a,b){oy(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}(a,this),this.finished=!0;let{buffer:b,h:c}=this,{pos:d}=this;if(d){for(b[d++]=1;d<16;d++)b[d]=0;this.process(b,0,!0)}this.finalize();let e=0;for(let b=0;b<8;b++)a[e++]=c[b]>>>0,a[e++]=c[b]>>>8;return a}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}}let oS=(D2=a=>new oR(a),(Q=(a,b)=>D2(b).update(oD(a)).digest()).outputLen=(R=D2(new Uint8Array(32))).outputLen,Q.blockLen=R.blockLen,Q.create=a=>D2(a),Q),oT=function(a,b){let{allowShortKeys:c,extendNonceFn:d,counterLength:e,counterRight:f,rounds:g}=function(a,b){if(null==b||"object"!=typeof b)throw Error("options must be defined");return Object.assign(a,b)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},b);if("function"!=typeof a)throw Error("core must be a function");return ox(e),ox(g),ow(f),ow(c),(b,h,i,j,k=0)=>{oy(b),oy(h),oy(i);let l=i.length;if(void 0===j&&(j=new Uint8Array(l)),oy(j),ox(k),k<0||k>=oO)throw Error("arx: counter overflow");if(j.length<l)throw Error(`arx: output (${j.length}) is shorter than data (${l})`);let m=[],o=b.length,p,q;if(32===o)m.push(p=oG(b)),q=oL;else if(16===o&&c)(p=new Uint8Array(32)).set(b),p.set(b,16),q=oK,m.push(p);else throw Error(`arx: invalid 32-byte key, got length=${o}`);oN(h)||m.push(h=oG(h));let r=oA(p);if(d){if(24!==h.length)throw Error("arx: extended nonce must be 24 bytes");d(q,r,oA(h.subarray(0,16)),r),h=h.subarray(16)}let s=16-e;if(s!==h.length)throw Error(`arx: nonce must be ${s} or 16 bytes`);if(12!==s){let a=new Uint8Array(12);a.set(h,f?0:12-h.length),h=a,m.push(h)}return function(a,b,c,d,e,f,g,h){let i=e.length,j=new Uint8Array(64),k=oA(j),l=oN(e)&&oN(f),m=l?oA(e):oP,o=l?oA(f):oP;for(let p=0;p<i;g++){if(a(b,c,d,k,g,h),g>=oO)throw Error("arx: counter overflow");let q=Math.min(64,i-p);if(l&&64===q){let a=p/4;if(p%4!=0)throw Error("arx: invalid block position");for(let b=0,c;b<16;b++)o[c=a+b]=m[c]^k[b];p+=64;continue}for(let a=0,b;a<q;a++)f[b=p+a]=e[b]^j[a];p+=q}}(a,q,r,oA(h),i,j,k,g),oB(...m),j}}(function(a,b,c,d,e,f=20){let g=a[0],h=a[1],i=a[2],j=a[3],k=b[0],l=b[1],m=b[2],o=b[3],p=b[4],q=b[5],r=b[6],s=b[7],t=c[0],u=c[1],v=c[2],w=g,x=h,y=i,z=j,A=k,B=l,C=m,D=o,E=p,F=q,G=r,H=s,I=e,J=t,K=u,L=v;for(let a=0;a<f;a+=2)E=E+(I=oM(I^(w=w+A|0),16))|0,w=w+(A=oM(A^E,12))|0,E=E+(I=oM(I^w,8))|0,A=oM(A^E,7),F=F+(J=oM(J^(x=x+B|0),16))|0,x=x+(B=oM(B^F,12))|0,F=F+(J=oM(J^x,8))|0,B=oM(B^F,7),G=G+(K=oM(K^(y=y+C|0),16))|0,y=y+(C=oM(C^G,12))|0,G=G+(K=oM(K^y,8))|0,C=oM(C^G,7),H=H+(L=oM(L^(z=z+D|0),16))|0,z=z+(D=oM(D^H,12))|0,H=H+(L=oM(L^z,8))|0,D=oM(D^H,7),G=G+(L=oM(L^(w=w+B|0),16))|0,w=w+(B=oM(B^G,12))|0,G=G+(L=oM(L^w,8))|0,B=oM(B^G,7),H=H+(I=oM(I^(x=x+C|0),16))|0,x=x+(C=oM(C^H,12))|0,H=H+(I=oM(I^x,8))|0,C=oM(C^H,7),E=E+(J=oM(J^(y=y+D|0),16))|0,y=y+(D=oM(D^E,12))|0,E=E+(J=oM(J^y,8))|0,D=oM(D^E,7),F=F+(K=oM(K^(z=z+A|0),16))|0,z=z+(A=oM(A^F,12))|0,F=F+(K=oM(K^z,8))|0,A=oM(A^F,7);let M=0;d[M++]=g+w|0,d[M++]=h+x|0,d[M++]=i+y|0,d[M++]=j+z|0,d[M++]=k+A|0,d[M++]=l+B|0,d[M++]=m+C|0,d[M++]=o+D|0,d[M++]=p+E|0,d[M++]=q+F|0,d[M++]=r+G|0,d[M++]=s+H|0,d[M++]=e+I|0,d[M++]=t+J|0,d[M++]=u+K|0,d[M++]=v+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),oU=new Uint8Array(16),oV=(a,b)=>{a.update(b);let c=b.length%16;c&&a.update(oU.subarray(c))},oW=new Uint8Array(32);function oX(a,b,c,d,e){var f,g;let h,i,j=a(b,c,oW),k=oS.create(j);e&&oV(k,e),oV(k,d);let l=(f=d.length,g=e?e.length:0,ow(!0),oF(i=new DataView((h=new Uint8Array(16)).buffer,h.byteOffset,h.byteLength),0,BigInt(g),!0),oF(i,8,BigInt(f),!0),h);k.update(l);let m=k.digest();return oB(j,l),m}let oY=((a,b)=>{function c(d,...e){if(oy(d),!oC)throw Error("Non little-endian hardware is not yet supported");if(void 0!==a.nonceLength){let b=e[0];if(!b)throw Error("nonce / iv required");a.varSizeNonce?oy(b):oy(b,a.nonceLength)}let f=a.tagLength;f&&void 0!==e[1]&&oy(e[1]);let g=b(d,...e),h=(a,b)=>{if(void 0!==b){if(2!==a)throw Error("cipher output not supported");oy(b)}},i=!1;return{encrypt(a,b){if(i)throw Error("cannot encrypt() twice with same key + nonce");return i=!0,oy(a),h(g.encrypt.length,b),g.encrypt(a,b)},decrypt(a,b){if(oy(a),f&&a.length<f)throw Error("invalid ciphertext length: smaller than tagLength="+f);return h(g.decrypt.length,b),g.decrypt(a,b)}}}return Object.assign(c,a),c})({blockSize:64,nonceLength:12,tagLength:16},(a,b,c)=>({encrypt(d,e){let f=d.length;(e=oE(f+16,e,!1)).set(d);let g=e.subarray(0,-16);oT(a,b,g,g,1);let h=oX(oT,a,b,g,c);return e.set(h,f),oB(h),e},decrypt(d,e){e=oE(d.length-16,e,!1);let f=d.subarray(0,-16),g=d.subarray(-16),h=oX(oT,a,b,f,c);if(!function(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c}(g,h))throw Error("invalid tag");return e.set(d.subarray(0,-16)),oT(a,b,e,e,1),oB(h),e}}));class oZ extends no{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,m5(a);const c=nm(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const d=this.blockLen,e=new Uint8Array(d);e.set(c.length>d?a.create().update(c).digest():c);for(let a=0;a<e.length;a++)e[a]^=54;this.iHash.update(e),this.oHash=a.create();for(let a=0;a<e.length;a++)e[a]^=106;this.oHash.update(e),m9(e)}update(a){return m6(this),this.iHash.update(a),this}digestInto(a){m6(this),m4(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let o$=(a,b,c)=>new oZ(a,b).update(c).digest();o$.create=(a,b)=>new oZ(a,b);let o_=Uint8Array.from([0]),o0=Uint8Array.of(),o1=BigInt(0),o2=BigInt(1);function o3(a,b=""){if("boolean"!=typeof a)throw Error((b&&`"${b}"`)+"expected boolean, got type="+typeof a);return a}function o4(a,b,c=""){let d=m2(a),e=a?.length,f=void 0!==b;if(!d||f&&e!==b)throw Error((c&&`"${c}" `)+"expected Uint8Array"+(f?` of length ${b}`:"")+", got "+(d?`length=${e}`:`type=${typeof a}`));return a}function o5(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function o6(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?o1:BigInt("0x"+a)}function o7(a){return m4(a),o6(ni(Uint8Array.from(a).reverse()))}function o8(a,b){return nk(a.toString(16).padStart(2*b,"0"))}function o9(a,b){return o8(a,b).reverse()}function pa(a,b,c){let d;if("string"==typeof b)try{d=nk(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(m2(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}let pb=a=>"bigint"==typeof a&&o1<=a;function pc(a,b,c,d){if(!(pb(b)&&pb(c)&&pb(d))||!(c<=b)||!(b<d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}function pd(a){let b;for(b=0;a>o1;a>>=o2,b+=1);return b}let pe=a=>(o2<<BigInt(a))-o2;function pf(a,b,c={}){if(!a||"object"!=typeof a)throw Error("expected valid options object");function d(b,c,d){let e=a[b];if(d&&void 0===e)return;let f=typeof e;if(f!==c||null===e)throw Error(`param "${b}" is invalid: expected ${c}, got ${f}`)}Object.entries(b).forEach(([a,b])=>d(a,b,!1)),Object.entries(c).forEach(([a,b])=>d(a,b,!0))}function pg(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}let ph=BigInt(0),pi=BigInt(1),pj=BigInt(2),pk=BigInt(3),pl=BigInt(4),pm=BigInt(5),pn=BigInt(7),po=BigInt(8),pp=BigInt(9),pq=BigInt(16);function pr(a,b){let c=a%b;return c>=ph?c:b+c}function ps(a,b,c){let d=a;for(;b-- >ph;)d*=d,d%=c;return d}function pt(a,b){if(a===ph)throw Error("invert: expected non-zero number");if(b<=ph)throw Error("invert: expected positive modulus, got "+b);let c=pr(a,b),d=b,e=ph,f=pi;for(;c!==ph;){let a=d/c,b=d%c,g=e-f*a;d=c,c=b,e=f,f=g}if(d!==pi)throw Error("invert: does not exist");return pr(e,b)}function pu(a,b,c){if(!a.eql(a.sqr(b),c))throw Error("Cannot find square root")}function pv(a,b){let c=(a.ORDER+pi)/pl,d=a.pow(b,c);return pu(a,d,b),d}function pw(a,b){let c=(a.ORDER-pm)/po,d=a.mul(b,pj),e=a.pow(d,c),f=a.mul(b,e),g=a.mul(a.mul(f,pj),e),h=a.mul(f,a.sub(g,a.ONE));return pu(a,h,b),h}function px(a){if(a<pk)throw Error("sqrt is not defined for small field");let b=a-pi,c=0;for(;b%pj===ph;)b/=pj,c++;let d=pj,e=pC(a);for(;1===pA(e,d);)if(d++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===c)return pv;let f=e.pow(d,b),g=(b+pi)/pj;return function(a,d){if(a.is0(d))return d;if(1!==pA(a,d))throw Error("Cannot find square root");let e=c,h=a.mul(a.ONE,f),i=a.pow(d,b),j=a.pow(d,g);for(;!a.eql(i,a.ONE);){if(a.is0(i))return a.ZERO;let b=1,c=a.sqr(i);for(;!a.eql(c,a.ONE);)if(b++,c=a.sqr(c),b===e)throw Error("Cannot find square root");let d=pi<<BigInt(e-b-1),f=a.pow(h,d);e=b,h=a.sqr(f),i=a.mul(i,h),j=a.mul(j,f)}return j}}let py=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function pz(a,b,c=!1){let d=Array(b.length).fill(c?a.ZERO:void 0),e=b.reduce((b,c,e)=>a.is0(c)?b:(d[e]=b,a.mul(b,c)),a.ONE),f=a.inv(e);return b.reduceRight((b,c,e)=>a.is0(c)?b:(d[e]=a.mul(b,d[e]),a.mul(b,c)),f),d}function pA(a,b){let c=(a.ORDER-pi)/pj,d=a.pow(b,c),e=a.eql(d,a.ONE),f=a.eql(d,a.ZERO),g=a.eql(d,a.neg(a.ONE));if(!e&&!f&&!g)throw Error("invalid Legendre symbol result");return e?1:f?0:-1}function pB(a,b){void 0!==b&&m3(b);let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function pC(a,b,c=!1,d={}){let e;if(a<=ph)throw Error("invalid field: expected ORDER > 0, got "+a);let f,g,h=!1,i;if("object"==typeof b&&null!=b){if(d.sqrt||c)throw Error("cannot specify opts in two arguments");b.BITS&&(f=b.BITS),b.sqrt&&(g=b.sqrt),"boolean"==typeof b.isLE&&(c=b.isLE),"boolean"==typeof b.modFromBytes&&(h=b.modFromBytes),i=b.allowedLengths}else"number"==typeof b&&(f=b),d.sqrt&&(g=d.sqrt);let{nBitLength:j,nByteLength:k}=pB(a,f);if(k>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let l=Object.freeze({ORDER:a,isLE:c,BITS:j,BYTES:k,MASK:pe(j),ZERO:ph,ONE:pi,allowedLengths:i,create:b=>pr(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return ph<=b&&b<a},is0:a=>a===ph,isValidNot0:a=>!l.is0(a)&&l.isValid(a),isOdd:a=>(a&pi)===pi,neg:b=>pr(-b,a),eql:(a,b)=>a===b,sqr:b=>pr(b*b,a),add:(b,c)=>pr(b+c,a),sub:(b,c)=>pr(b-c,a),mul:(b,c)=>pr(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<ph)throw Error("invalid exponent, negatives unsupported");if(c===ph)return a.ONE;if(c===pi)return b;let d=a.ONE,e=b;for(;c>ph;)c&pi&&(d=a.mul(d,e)),e=a.sqr(e),c>>=pi;return d})(l,a,b),div:(b,c)=>pr(b*pt(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>pt(b,a),sqrt:g||(b=>{let c,d,f,g,h,i;return e||(e=a%pl===pk?pv:a%po===pm?pw:a%pq===pp?(c=pC(a),f=(d=px(a))(c,c.neg(c.ONE)),g=d(c,f),h=d(c,c.neg(f)),i=(a+pn)/pq,(a,b)=>{let c=a.pow(b,i),d=a.mul(c,f),e=a.mul(c,g),j=a.mul(c,h),k=a.eql(a.sqr(d),b),l=a.eql(a.sqr(e),b);c=a.cmov(c,d,k),d=a.cmov(j,e,l);let m=a.eql(a.sqr(d),b),o=a.cmov(c,d,m);return pu(a,o,b),o}):px(a)),e(l,b)}),toBytes:a=>c?o9(a,k):o8(a,k),fromBytes:(b,d=!0)=>{if(i){if(!i.includes(b.length)||b.length>k)throw Error("Field.fromBytes: expected "+i+" bytes, got "+b.length);let a=new Uint8Array(k);a.set(b,c?0:a.length-b.length),b=a}if(b.length!==k)throw Error("Field.fromBytes: expected "+k+" bytes, got "+b.length);let e=c?o7(b):o6(ni(b));if(h&&(e=pr(e,a)),!d&&!l.isValid(e))throw Error("invalid field element: outside of range 0..ORDER");return e},invertBatch:a=>pz(l,a),cmov:(a,b,c)=>c?b:a});return Object.freeze(l)}function pD(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function pE(a){let b=pD(a);return b+Math.ceil(b/2)}let pF=BigInt(0),pG=BigInt(1);function pH(a,b){let c=b.negate();return a?c:b}function pI(a,b){let c=pz(a.Fp,b.map(a=>a.Z));return b.map((b,d)=>a.fromAffine(b.toAffine(c[d])))}function pJ(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function pK(a,b){pJ(a,b);let c=Math.ceil(b/a)+1,d=2**(a-1),e=2**a;return{windows:c,windowSize:d,mask:pe(a),maxNumber:e,shiftBy:BigInt(a)}}function pL(a,b,c){let{windowSize:d,mask:e,maxNumber:f,shiftBy:g}=c,h=Number(a&e),i=a>>g;h>d&&(h-=f,i+=pG);let j=b*d;return{nextN:i,offset:j+Math.abs(h)-1,isZero:0===h,isNeg:h<0,isNegF:b%2!=0,offsetF:j}}let pM=new WeakMap,pN=new WeakMap;function pO(a){return pN.get(a)||1}function pP(a){if(a!==pF)throw Error("invalid wNAF")}class pQ{constructor(a,b){this.BASE=a.BASE,this.ZERO=a.ZERO,this.Fn=a.Fn,this.bits=b}_unsafeLadder(a,b,c=this.ZERO){let d=a;for(;b>pF;)b&pG&&(c=c.add(d)),d=d.double(),b>>=pG;return c}precomputeWindow(a,b){let{windows:c,windowSize:d}=pK(b,this.bits),e=[],f=a,g=f;for(let a=0;a<c;a++){g=f,e.push(g);for(let a=1;a<d;a++)g=g.add(f),e.push(g);f=g.double()}return e}wNAF(a,b,c){if(!this.Fn.isValid(c))throw Error("invalid scalar");let d=this.ZERO,e=this.BASE,f=pK(a,this.bits);for(let a=0;a<f.windows;a++){let{nextN:g,offset:h,isZero:i,isNeg:j,isNegF:k,offsetF:l}=pL(c,a,f);c=g,i?e=e.add(pH(k,b[l])):d=d.add(pH(j,b[h]))}return pP(c),{p:d,f:e}}wNAFUnsafe(a,b,c,d=this.ZERO){let e=pK(a,this.bits);for(let a=0;a<e.windows&&c!==pF;a++){let{nextN:f,offset:g,isZero:h,isNeg:i}=pL(c,a,e);if(c=f,!h){let a=b[g];d=d.add(i?a.negate():a)}}return pP(c),d}getPrecomputes(a,b,c){let d=pM.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&("function"==typeof c&&(d=c(d)),pM.set(b,d))),d}cached(a,b,c){let d=pO(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)}unsafe(a,b,c,d){let e=pO(a);return 1===e?this._unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)}createCache(a,b){pJ(b,this.bits),pN.set(a,b),pM.delete(a)}hasCache(a){return 1!==pO(a)}}function pR(a,b,c){if(!b)return pC(a,{isLE:c});if(b.ORDER!==a)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return pf(b,py.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),b}BigInt(0),BigInt(1),BigInt(2),BigInt(8),nl("HashToScalar-");let pS=BigInt(0),pT=BigInt(1),pU=BigInt(2),pV=BigInt(1),pW=BigInt(2),pX=BigInt(3),pY=BigInt(5),pZ=BigInt(8),p$=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),p_={p:p$,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:pZ,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")},p0=function(a){let{P:b,type:c,adjustScalarBytes:d,powPminus2:e,randomBytes:f}=(pf(a,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...a})),g="x25519"===c;if(!g&&"x448"!==c)throw Error("invalid type");let h=f||nq,i=g?255:448,j=g?32:56,k=BigInt(g?9:5),l=BigInt(g?121665:39081),m=g?pU**BigInt(254):pU**BigInt(447),o=m+(g?BigInt(8)*pU**BigInt(251)-pT:BigInt(4)*pU**BigInt(445)-pT)+pT,p=a=>pr(a,b),q=o9(p(k),j);function r(a,c){let f,h=function(a,c){pc("u",a,pS,b),pc("scalar",c,m,o);let d=pT,f=pS,g=a,h=pT,j=pS;for(let b=BigInt(i-1);b>=pS;b--){let e=c>>b&pT;j^=e,({x_2:d,x_3:g}=t(j,d,g)),({x_2:f,x_3:h}=t(j,f,h)),j=e;let i=d+f,k=p(i*i),m=d-f,o=p(m*m),q=k-o,r=g+h,s=p((g-h)*i),u=p(r*m),v=s+u,w=s-u;g=p(v*v),h=p(a*p(w*w)),d=p(k*o),f=p(q*(k+p(l*q)))}return{x_2:d,x_3:g}=t(j,d,g),{x_2:f,x_3:h}=t(j,f,h),p(d*e(f))}((f=pa("u coordinate",c,j),g&&(f[31]&=127),p(o7(f))),o7(d(pa("scalar",a,j))));if(h===pS)throw Error("invalid private or public key received");return o9(p(h),j)}function s(a){return r(a,q)}function t(a,b,c){let d=p(a*(b-c));return{x_2:b=p(b-d),x_3:c=p(c+d)}}let u={secretKey:j,publicKey:j,seed:j},v=(a=h(j))=>(m4(a,u.seed),a);return{keygen:function(a){let b=v(a);return{secretKey:b,publicKey:s(b)}},getSharedSecret:(a,b)=>r(a,b),getPublicKey:a=>s(a),scalarMult:r,scalarMultBase:s,utils:{randomSecretKey:v,randomPrivateKey:v},GuBytes:q.slice(),lengths:u}}({P:S=pC(p_.p,{isLE:!0}).ORDER,type:"x25519",powPminus2:a=>{let b,c,d,e,f,g,h,i,j,k,l,m,o,p,{pow_p_5_8:q,b2:r}=(b=BigInt(10),c=BigInt(20),d=BigInt(40),e=BigInt(80),g=ps(f=a*a%p$*a%p$,pW,p$)*f%p$,h=ps(g,pV,p$)*a%p$,i=ps(h,pY,p$)*h%p$,j=ps(i,b,p$)*i%p$,k=ps(j,c,p$)*j%p$,l=ps(k,d,p$)*k%p$,m=ps(l,e,p$)*l%p$,o=ps(m,e,p$)*l%p$,p=ps(o,b,p$)*i%p$,{pow_p_5_8:ps(p,pW,p$)*a%p$,b2:f});return pr(ps(q,pX,S)*r,S)},adjustScalarBytes:function(a){return a[0]&=248,a[31]&=127,a[31]|=64,a}}),p1=(a,b)=>(a+(a>=0?b:-b)/p7)/b;function p2(a){if(!["compact","recovered","der"].includes(a))throw Error('Signature format must be "compact", "recovered", or "der"');return a}function p3(a,b){let c={};for(let d of Object.keys(b))c[d]=void 0===a[d]?b[d]:a[d];return o3(c.lowS,"lowS"),o3(c.prehash,"prehash"),void 0!==c.format&&p2(c.format),c}let p4={Err:class extends Error{constructor(a=""){super(a)}},_tlv:{encode:(a,b)=>{let{Err:c}=p4;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(1&b.length)throw new c("tlv.encode: unpadded data");let d=b.length/2,e=o5(d);if(e.length/2&128)throw new c("tlv.encode: long form length too big");let f=d>127?o5(e.length/2|128):"";return o5(a)+f+e+b},decode(a,b){let{Err:c}=p4,d=0;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(b.length<2||b[d++]!==a)throw new c("tlv.decode: wrong tlv");let e=b[d++],f=0;if(128&e){let a=127&e;if(!a)throw new c("tlv.decode(long): indefinite length not supported");if(a>4)throw new c("tlv.decode(long): byte length is too big");let g=b.subarray(d,d+a);if(g.length!==a)throw new c("tlv.decode: length bytes not complete");if(0===g[0])throw new c("tlv.decode(long): zero leftmost byte");for(let a of g)f=f<<8|a;if(d+=a,f<128)throw new c("tlv.decode(long): not minimal encoding")}else f=e;let g=b.subarray(d,d+f);if(g.length!==f)throw new c("tlv.decode: wrong value length");return{v:g,l:b.subarray(d+f)}}},_int:{encode(a){let{Err:b}=p4;if(a<p5)throw new b("integer: negative integers are not allowed");let c=o5(a);if(8&Number.parseInt(c[0],16)&&(c="00"+c),1&c.length)throw new b("unexpected DER parsing assertion: unpadded hex");return c},decode(a){let{Err:b}=p4;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return o6(ni(a))}},toSig(a){let{Err:b,_int:c,_tlv:d}=p4,e=pa("signature",a),{v:f,l:g}=d.decode(48,e);if(g.length)throw new b("invalid signature: left bytes after parsing");let{v:h,l:i}=d.decode(2,f),{v:j,l:k}=d.decode(2,i);if(k.length)throw new b("invalid signature: left bytes after parsing");return{r:c.decode(h),s:c.decode(j)}},hexFromSig(a){let{_tlv:b,_int:c}=p4,d=b.encode(2,c.encode(a.r)),e=b.encode(2,c.encode(a.s));return b.encode(48,d+e)}},p5=BigInt(0),p6=BigInt(1),p7=BigInt(2),p8=BigInt(3),p9=BigInt(4);function qa(a,b){let c,{BYTES:d}=a;if("bigint"==typeof b)c=b;else{let e=pa("private key",b);try{c=a.fromBytes(e)}catch{throw Error(`invalid private key: expected ui8a of size ${d}, got ${typeof b}`)}}if(!a.isValidNot0(c))throw Error("invalid private key: out of range [1..N-1]");return c}function qb(a){return Uint8Array.of(a?2:3)}function qc(a,b){return{secretKey:b.BYTES,publicKey:1+a.BYTES,publicKeyUncompressed:1+2*a.BYTES,publicKeyHasPrefix:!0,signature:2*b.BYTES}}function qd(a,b){let c=b=>(function(a){let b,{CURVE:c,curveOpts:d,hash:e,ecdsaOpts:f}=function(a){let b,c,d,e,{CURVE:f,curveOpts:g}=(b={a:a.a,b:a.b,p:a.Fp.ORDER,n:a.n,h:a.h,Gx:a.Gx,Gy:a.Gy},c=a.Fp,d=a.allowedPrivateKeyLengths?Array.from(new Set(a.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,e={Fp:c,Fn:pC(b.n,{BITS:a.nBitLength,allowedLengths:d,modFromBytes:a.wrapPrivateKey}),allowInfinityPoint:a.allowInfinityPoint,endo:a.endo,isTorsionFree:a.isTorsionFree,clearCofactor:a.clearCofactor,fromBytes:a.fromBytes,toBytes:a.toBytes},{CURVE:b,curveOpts:e}),h={hmac:a.hmac,randomBytes:a.randomBytes,lowS:a.lowS,bits2int:a.bits2int,bits2int_modN:a.bits2int_modN};return{CURVE:f,curveOpts:g,hash:a.hash,ecdsaOpts:h}}(a),g=function(a,b,c={}){m5(b),pf(c,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let d=c.randomBytes||nq,e=c.hmac||((a,...c)=>o$(b,a,nn(...c))),{Fp:f,Fn:g}=a,{ORDER:h,BITS:i}=g,{keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:o}=function(a,b={}){let{Fn:c}=a,d=b.randomBytes||nq,e=Object.assign(qc(a.Fp,c),{seed:pE(c.ORDER)});function f(a){try{return!!qa(c,a)}catch{return!1}}function g(a=d(e.seed)){return function(a,b,c=!1){let d=a.length,e=pD(b),f=pE(b);if(d<16||d<f||d>1024)throw Error("expected "+f+"-1024 bytes of input, got "+d);let g=pr(c?o7(a):o6(ni(a)),b-pi)+pi;return c?o9(g,e):o8(g,e)}(o4(a,e.seed,"seed"),c.ORDER)}function h(b,d=!0){return a.BASE.multiply(qa(c,b)).toBytes(d)}function i(b){if("bigint"==typeof b)return!1;if(b instanceof a)return!0;let{secretKey:d,publicKey:f,publicKeyUncompressed:g}=e;if(c.allowedLengths||d===f)return;let h=pa("key",b).length;return h===f||h===g}return Object.freeze({getPublicKey:h,getSharedSecret:function(b,d,e=!0){if(!0===i(b))throw Error("first arg must be private key");if(!1===i(d))throw Error("second arg must be public key");let f=qa(c,b);return a.fromHex(d).multiply(f).toBytes(e)},keygen:function(a){let b=g(a);return{secretKey:b,publicKey:h(b)}},Point:a,utils:{isValidSecretKey:f,isValidPublicKey:function(b,c){let{publicKey:d,publicKeyUncompressed:f}=e;try{let e=b.length;return(!0!==c||e===d)&&(!1!==c||e===f)&&!!a.fromBytes(b)}catch{return!1}},randomSecretKey:g,isValidPrivateKey:f,randomPrivateKey:g,normPrivateKeyToScalar:a=>qa(c,a),precompute:(b=8,c=a.BASE)=>c.precompute(b,!1)},lengths:e})}(a,c),p={prehash:!1,lowS:"boolean"==typeof c.lowS&&c.lowS,format:void 0,extraEntropy:!1},q="compact";function r(a,b){if(!g.isValidNot0(b))throw Error(`invalid signature ${a}: out of range 1..Point.Fn.ORDER`);return b}class s{constructor(a,b,c){this.r=r("r",a),this.s=r("s",b),null!=c&&(this.recovery=c),Object.freeze(this)}static fromBytes(a,b=q){var c,d;let e,f;if(c=a,p2(d=b),f=o.signature,o4(c,"compact"===d?f:"recovered"===d?f+1:void 0,`${d} signature`),"der"===b){let{r:b,s:c}=p4.toSig(o4(a));return new s(b,c)}"recovered"===b&&(e=a[0],b="compact",a=a.subarray(1));let h=g.BYTES,i=a.subarray(0,h),j=a.subarray(h,2*h);return new s(g.fromBytes(i),g.fromBytes(j),e)}static fromHex(a,b){return this.fromBytes(nk(a),b)}addRecoveryBit(a){return new s(this.r,this.s,a)}recoverPublicKey(b){let c=f.ORDER,{r:d,s:e,recovery:i}=this;if(null==i||![0,1,2,3].includes(i))throw Error("recovery id invalid");if(h*p7<c&&i>1)throw Error("recovery id is ambiguous for h>1 curve");let j=2===i||3===i?d+h:d;if(!f.isValid(j))throw Error("recovery id 2 or 3 invalid");let k=f.toBytes(j),l=a.fromBytes(nn(qb((1&i)==0),k)),m=g.inv(j),o=u(pa("msgHash",b)),p=g.create(-o*m),q=g.create(e*m),r=a.BASE.multiplyUnsafe(p).add(l.multiplyUnsafe(q));if(r.is0())throw Error("point at infinify");return r.assertValidity(),r}hasHighS(){return this.s>h>>p6}toBytes(a=q){if(p2(a),"der"===a)return nk(p4.hexFromSig(this));let b=g.toBytes(this.r),c=g.toBytes(this.s);if("recovered"===a){if(null==this.recovery)throw Error("recovery bit must be present");return nn(Uint8Array.of(this.recovery),b,c)}return nn(b,c)}toHex(a){return ni(this.toBytes(a))}assertValidity(){}static fromCompact(a){return s.fromBytes(pa("sig",a),"compact")}static fromDER(a){return s.fromBytes(pa("sig",a),"der")}normalizeS(){return this.hasHighS()?new s(this.r,g.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return ni(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return ni(this.toBytes("compact"))}}let t=c.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let b=o6(ni(a)),c=8*a.length-i;return c>0?b>>BigInt(c):b},u=c.bits2int_modN||function(a){return g.create(t(a))},v=pe(i);function w(a){return pc("num < 2^"+i,a,p5,v),g.toBytes(a)}function x(a,c){return o4(a,void 0,"message"),c?o4(b(a),void 0,"prehashed message"):a}return Object.freeze({keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:o,Point:a,sign:function(c,f,i={}){let{seed:j,k2sig:k}=function(b,c,e){if(["recovered","canonical"].some(a=>a in e))throw Error("sign() legacy options not supported");let{lowS:f,prehash:i,extraEntropy:j}=p3(e,p),k=u(b=x(b,i)),l=qa(g,c),m=[w(l),w(k)];if(null!=j&&!1!==j){let a=!0===j?d(o.secretKey):j;m.push(pa("extraEntropy",a))}return{seed:nn(...m),k2sig:function(b){let c=t(b);if(!g.isValidNot0(c))return;let d=g.inv(c),e=a.BASE.multiply(c).toAffine(),i=g.create(e.x);if(i===p5)return;let j=g.create(d*g.create(k+i*l));if(j===p5)return;let m=2*(e.x!==i)|Number(e.y&p6),o=j;return f&&j>h>>p6&&(o=g.neg(j),m^=1),new s(i,o,m)}}}(c=pa("message",c),f,i);return(function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=a=>new Uint8Array(a),e=d(a),f=d(a),g=0,h=()=>{e.fill(1),f.fill(0),g=0},i=(...a)=>c(f,e,...a),j=(a=d(0))=>{f=i(Uint8Array.of(0),a),e=i(),0!==a.length&&(f=i(Uint8Array.of(1),a),e=i())},k=()=>{if(g++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(e=i()).slice();c.push(b),a+=e.length}return nn(...c)};return(a,b)=>{let c;for(h(),j(a);!(c=b(k()));)j();return h(),c}})(b.outputLen,g.BYTES,e)(j,k)},verify:function(b,c,d,e={}){let{lowS:f,prehash:h,format:i}=p3(e,p);if(d=pa("publicKey",d),c=x(pa("message",c),h),"strict"in e)throw Error("options.strict was renamed to lowS");let j=void 0===i?function(a){let b,c="string"==typeof a||m2(a),d=!c&&null!==a&&"object"==typeof a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!c&&!d)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(d)b=new s(a.r,a.s);else if(c){try{b=s.fromBytes(pa("sig",a),"der")}catch(a){if(!(a instanceof p4.Err))throw a}if(!b)try{b=s.fromBytes(pa("sig",a),"compact")}catch{return!1}}return b||!1}(b):s.fromBytes(pa("sig",b),i);if(!1===j)return!1;try{let b=a.fromBytes(d);if(f&&j.hasHighS())return!1;let{r:e,s:h}=j,i=u(c),k=g.inv(h),l=g.create(i*k),m=g.create(e*k),o=a.BASE.multiplyUnsafe(l).add(b.multiplyUnsafe(m));return!o.is0()&&g.create(o.x)===e}catch{return!1}},recoverPublicKey:function(a,b,c={}){let{prehash:d}=p3(c,p);return b=x(b,d),s.fromBytes(a,"recovered").recoverPublicKey(b).toBytes()},Signature:s,hash:b})}(function(a,b={}){let c=function(a,b,c={},d){if(void 0===d&&(d="edwards"===a),!b||"object"!=typeof b)throw Error(`expected valid ${a} CURVE object`);for(let a of["p","n","h"]){let c=b[a];if(!("bigint"==typeof c&&c>pF))throw Error(`CURVE.${a} must be positive bigint`)}let e=pR(b.p,c.Fp,d),f=pR(b.n,c.Fn,d);for(let c of["Gx","Gy","a","weierstrass"===a?"b":"d"])if(!e.isValid(b[c]))throw Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return{CURVE:b=Object.freeze(Object.assign({},b)),Fp:e,Fn:f}}("weierstrass",a,b),{Fp:d,Fn:e}=c,f=c.CURVE,{h:g,n:h}=f;pf(b,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=b;if(i&&(!d.is0(f.a)||"bigint"!=typeof i.beta||!Array.isArray(i.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let j=qc(d,e);function k(){if(!d.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let l=b.toBytes||function(a,b,c){let{x:e,y:f}=b.toAffine(),g=d.toBytes(e);return(o3(c,"isCompressed"),c)?(k(),nn(qb(!d.isOdd(f)),g)):nn(Uint8Array.of(4),g,d.toBytes(f))},m=b.fromBytes||function(a){o4(a,void 0,"Point");let{publicKey:b,publicKeyUncompressed:c}=j,e=a.length,f=a[0],g=a.subarray(1);if(e===b&&(2===f||3===f)){let a,b=d.fromBytes(g);if(!d.isValid(b))throw Error("bad point: is not on curve, wrong x");let c=o(b);try{a=d.sqrt(c)}catch(a){throw Error("bad point: is not on curve, sqrt error"+(a instanceof Error?": "+a.message:""))}return k(),(1&f)==1!==d.isOdd(a)&&(a=d.neg(a)),{x:b,y:a}}if(e===c&&4===f){let a=d.BYTES,b=d.fromBytes(g.subarray(0,a)),c=d.fromBytes(g.subarray(a,2*a));if(!p(b,c))throw Error("bad point: is not on curve");return{x:b,y:c}}throw Error(`bad point: got length ${e}, expected compressed=${b} or uncompressed=${c}`)};function o(a){let b=d.sqr(a),c=d.mul(b,a);return d.add(d.add(c,d.mul(a,f.a)),f.b)}function p(a,b){let c=d.sqr(b),e=o(a);return d.eql(c,e)}if(!p(f.Gx,f.Gy))throw Error("bad curve params: generator point");let q=d.mul(d.pow(f.a,p8),p9),r=d.mul(d.sqr(f.b),BigInt(27));if(d.is0(d.add(q,r)))throw Error("bad curve params: a or b");function s(a,b,c=!1){if(!d.isValid(b)||c&&d.is0(b))throw Error(`bad point coordinate ${a}`);return b}function t(a){if(!(a instanceof y))throw Error("ProjectivePoint expected")}function u(a){if(!i||!i.basises)throw Error("no endo");return function(a,b,c){let[[d,e],[f,g]]=b,h=p1(g*a,c),i=p1(-e*a,c),j=a-h*d-i*f,k=-h*e-i*g,l=j<p5,m=k<p5;l&&(j=-j),m&&(k=-k);let o=pe(Math.ceil(pd(c)/2))+p6;if(j<p5||j>=o||k<p5||k>=o)throw Error("splitScalar (endomorphism): failed, k="+a);return{k1neg:l,k1:j,k2neg:m,k2:k}}(a,i.basises,e.ORDER)}let v=pg((a,b)=>{let{X:c,Y:e,Z:f}=a;if(d.eql(f,d.ONE))return{x:c,y:e};let g=a.is0();null==b&&(b=g?d.ONE:d.inv(f));let h=d.mul(c,b),i=d.mul(e,b),j=d.mul(f,b);if(g)return{x:d.ZERO,y:d.ZERO};if(!d.eql(j,d.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),w=pg(a=>{if(a.is0()){if(b.allowInfinityPoint&&!d.is0(a.Y))return;throw Error("bad point: ZERO")}let{x:c,y:e}=a.toAffine();if(!d.isValid(c)||!d.isValid(e))throw Error("bad point: x or y not field elements");if(!p(c,e))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function x(a,b,c,e,f){return c=new y(d.mul(c.X,a),c.Y,c.Z),b=pH(e,b),c=pH(f,c),b.add(c)}class y{constructor(a,b,c){this.X=s("x",a),this.Y=s("y",b,!0),this.Z=s("z",c),Object.freeze(this)}static CURVE(){return f}static fromAffine(a){let{x:b,y:c}=a||{};if(!a||!d.isValid(b)||!d.isValid(c))throw Error("invalid affine point");if(a instanceof y)throw Error("projective point not allowed");return d.is0(b)&&d.is0(c)?y.ZERO:new y(b,c,d.ONE)}static fromBytes(a){let b=y.fromAffine(m(o4(a,void 0,"point")));return b.assertValidity(),b}static fromHex(a){return y.fromBytes(pa("pointHex",a))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(a=8,b=!0){return A.createCache(this,a),b||this.multiply(p8),this}assertValidity(){w(this)}hasEvenY(){let{y:a}=this.toAffine();if(!d.isOdd)throw Error("Field doesn't support isOdd");return!d.isOdd(a)}equals(a){t(a);let{X:b,Y:c,Z:e}=this,{X:f,Y:g,Z:h}=a,i=d.eql(d.mul(b,h),d.mul(f,e)),j=d.eql(d.mul(c,h),d.mul(g,e));return i&&j}negate(){return new y(this.X,d.neg(this.Y),this.Z)}double(){let{a:a,b}=f,c=d.mul(b,p8),{X:e,Y:g,Z:h}=this,i=d.ZERO,j=d.ZERO,k=d.ZERO,l=d.mul(e,e),m=d.mul(g,g),o=d.mul(h,h),p=d.mul(e,g);return p=d.add(p,p),k=d.mul(e,h),k=d.add(k,k),i=d.mul(a,k),j=d.mul(c,o),j=d.add(i,j),i=d.sub(m,j),j=d.add(m,j),j=d.mul(i,j),i=d.mul(p,i),k=d.mul(c,k),o=d.mul(a,o),p=d.sub(l,o),p=d.mul(a,p),p=d.add(p,k),k=d.add(l,l),l=d.add(k,l),l=d.add(l,o),l=d.mul(l,p),j=d.add(j,l),o=d.mul(g,h),o=d.add(o,o),l=d.mul(o,p),i=d.sub(i,l),k=d.mul(o,m),k=d.add(k,k),new y(i,j,k=d.add(k,k))}add(a){t(a);let{X:b,Y:c,Z:e}=this,{X:g,Y:h,Z:i}=a,j=d.ZERO,k=d.ZERO,l=d.ZERO,m=f.a,o=d.mul(f.b,p8),p=d.mul(b,g),q=d.mul(c,h),r=d.mul(e,i),s=d.add(b,c),u=d.add(g,h);s=d.mul(s,u),u=d.add(p,q),s=d.sub(s,u),u=d.add(b,e);let v=d.add(g,i);return u=d.mul(u,v),v=d.add(p,r),u=d.sub(u,v),v=d.add(c,e),j=d.add(h,i),v=d.mul(v,j),j=d.add(q,r),v=d.sub(v,j),l=d.mul(m,u),j=d.mul(o,r),l=d.add(j,l),j=d.sub(q,l),l=d.add(q,l),k=d.mul(j,l),q=d.add(p,p),q=d.add(q,p),r=d.mul(m,r),u=d.mul(o,u),q=d.add(q,r),r=d.sub(p,r),r=d.mul(m,r),u=d.add(u,r),p=d.mul(q,u),k=d.add(k,p),p=d.mul(v,u),j=d.mul(s,j),j=d.sub(j,p),p=d.mul(s,q),l=d.mul(v,l),new y(j,k,l=d.add(l,p))}subtract(a){return this.add(a.negate())}is0(){return this.equals(y.ZERO)}multiply(a){let c,d,{endo:f}=b;if(!e.isValidNot0(a))throw Error("invalid scalar: out of range");let g=a=>A.cached(this,a,a=>pI(y,a));if(f){let{k1neg:b,k1:e,k2neg:h,k2:i}=u(a),{p:j,f:k}=g(e),{p:l,f:m}=g(i);d=k.add(m),c=x(f.beta,j,l,b,h)}else{let{p:b,f:e}=g(a);c=b,d=e}return pI(y,[c,d])[0]}multiplyUnsafe(a){let{endo:c}=b;if(!e.isValid(a))throw Error("invalid scalar: out of range");if(a===p5||this.is0())return y.ZERO;if(a===p6)return this;if(A.hasCache(this))return this.multiply(a);if(!c)return A.unsafe(this,a);{let{k1neg:b,k1:d,k2neg:e,k2:f}=u(a),{p1:g,p2:h}=function(a,b,c,d){let e=b,f=a.ZERO,g=a.ZERO;for(;c>pF||d>pF;)c&pG&&(f=f.add(e)),d&pG&&(g=g.add(e)),e=e.double(),c>>=pG,d>>=pG;return{p1:f,p2:g}}(y,this,d,f);return x(c.beta,g,h,b,e)}}multiplyAndAddUnsafe(a,b,c){let d=this.multiplyUnsafe(b).add(a.multiplyUnsafe(c));return d.is0()?void 0:d}toAffine(a){return v(this,a)}isTorsionFree(){let{isTorsionFree:a}=b;return g===p6||(a?a(y,this):A.unsafe(this,h).is0())}clearCofactor(){let{clearCofactor:a}=b;return g===p6?this:a?a(y,this):this.multiplyUnsafe(g)}isSmallOrder(){return this.multiplyUnsafe(g).is0()}toBytes(a=!0){return o3(a,"isCompressed"),this.assertValidity(),l(y,this,a)}toHex(a=!0){return ni(this.toBytes(a))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(a=!0){return this.toBytes(a)}_setWindowSize(a){this.precompute(a)}static normalizeZ(a){return pI(y,a)}static msm(a,b){return function(a,b,c,d){(function(a,b){if(!Array.isArray(a))throw Error("array expected");a.forEach((a,c)=>{if(!(a instanceof b))throw Error("invalid point at index "+c)})})(c,a),function(a,b){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)})}(d,b);let e=c.length,f=d.length;if(e!==f)throw Error("arrays of points and scalars must have equal length");let g=a.ZERO,h=pd(BigInt(e)),i=1;h>12?i=h-3:h>4?i=h-2:h>0&&(i=2);let j=pe(i),k=Array(Number(j)+1).fill(g),l=Math.floor((b.BITS-1)/i)*i,m=g;for(let a=l;a>=0;a-=i){k.fill(g);for(let b=0;b<f;b++){let e=Number(d[b]>>BigInt(a)&j);k[e]=k[e].add(c[b])}let b=g;for(let a=k.length-1,c=g;a>0;a--)c=c.add(k[a]),b=b.add(c);if(m=m.add(b),0!==a)for(let a=0;a<i;a++)m=m.double()}return m}(y,e,a,b)}static fromPrivateKey(a){return y.BASE.multiply(qa(e,a))}}y.BASE=new y(f.Gx,f.Gy,d.ONE),y.ZERO=new y(d.ZERO,d.ONE,d.ZERO),y.Fp=d,y.Fn=e;let z=e.BITS,A=new pQ(y,b.endo?Math.ceil(z/2):z);return y.BASE.precompute(8),y}(c,d),e,f);return b=g.Point,Object.assign({},g,{ProjectivePoint:b,CURVE:Object.assign({},a,pB(b.Fn.ORDER,b.Fn.BITS))})})({...a,hash:b});return{...c(b),create:c}}let qe={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},qf={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},qg={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},qh=pC(qe.p),qi=pC(qf.p),qj=pC(qg.p),qk=qd({...qe,Fp:qh,lowS:!1},nX);qd({...qf,Fp:qi,lowS:!1},nZ),qd({...qg,Fp:qj,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},nY);let ql="base10",qm="base16",qn="base64pad",qo="base64url",qp="utf8";function qq(){let a=nq(32);return(0,lI.toString)(a,qm)}function qr(a){let b=nX((0,lJ.fromString)(a,qm));return(0,lI.toString)(b,qm)}function qs(a){let b=nX((0,lJ.fromString)(a,qp));return(0,lI.toString)(b,qm)}function qt(a){return(0,lJ.fromString)(`${a}`,ql)}function qu(a){return Number((0,lI.toString)(a,ql))}function qv(a){return a.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function qw(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=(4-b.length%4)%4;return b+"=".repeat(c)}function qx(a){if(2===qu(a.type))return(0,lI.toString)((0,lK.concat)([a.type,a.sealed]),qn);if(1===qu(a.type)){if(typeof a.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,lI.toString)((0,lK.concat)([a.type,a.senderPublicKey,a.iv,a.sealed]),qn)}return(0,lI.toString)((0,lK.concat)([a.type,a.iv,a.sealed]),qn)}function qy(a){let b=(a.encoding||qn)===qo?qw(a.encoded):a.encoded,c=(0,lJ.fromString)(b,qn),d=c.slice(0,1);if(1===qu(d)){let a=c.slice(1,33),b=c.slice(33,45);return{type:d,sealed:c.slice(45),iv:b,senderPublicKey:a}}if(2===qu(d))return{type:d,sealed:c.slice(1),iv:nq(12)};let e=c.slice(1,13);return{type:d,sealed:c.slice(13),iv:e}}function qz(a){let b=a?.type||0;if(1===b){if(typeof a?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof a?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:b,senderPublicKey:a?.senderPublicKey,receiverPublicKey:a?.receiverPublicKey}}function qA(a){return 1===a.type&&"string"==typeof a.senderPublicKey&&"string"==typeof a.receiverPublicKey}function qB(a){return a?.relay||{protocol:"irn"}}function qC(a){let b=lL.RELAY_JSONRPC[a];if(typeof b>"u")throw Error(`Relay Protocol not supported: ${a}`);return b}var qD=Object.defineProperty,qE=Object.defineProperties,qF=Object.getOwnPropertyDescriptors,qG=Object.getOwnPropertySymbols,qH=Object.prototype.hasOwnProperty,qI=Object.prototype.propertyIsEnumerable,qJ=(a,b,c)=>b in a?qD(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,qK=(a,b)=>{for(var c in b||(b={}))qH.call(b,c)&&qJ(a,c,b[c]);if(qG)for(var c of qG(b))qI.call(b,c)&&qJ(a,c,b[c]);return a};function qL(a){var b;if(!a.includes("wc:")){let b=mK(a);null!=b&&b.includes("wc:")&&(a=b)}let c=(a=(a=a.includes("wc://")?a.replace("wc://",""):a).includes("wc:")?a.replace("wc:",""):a).indexOf(":"),d=-1!==a.indexOf("?")?a.indexOf("?"):void 0,e=a.substring(0,c),f=a.substring(c+1,d).split("@"),g=Object.fromEntries(new URLSearchParams("u">typeof d?a.substring(d):"").entries()),h="string"==typeof g.methods?g.methods.split(","):void 0;return{protocol:e,topic:(b=f[0]).startsWith("//")?b.substring(2):b,version:parseInt(f[1],10),symKey:g.symKey,relay:function(a,b="-"){let c={},d="relay"+b;return Object.keys(a).forEach(b=>{if(b.startsWith(d)){let e=b.replace(d,""),f=a[b];c[e]=f}}),c}(g),methods:h,expiryTimestamp:g.expiryTimestamp?parseInt(g.expiryTimestamp,10):void 0}}function qM(a){let b=new URLSearchParams;return Object.entries(qK(qK(qE(qK({},function(a,b="-"){let c={};return Object.keys(a).forEach(d=>{a[d]&&(c["relay"+b+d]=a[d])}),c}(a.relay)),qF({symKey:a.symKey})),a.expiryTimestamp&&{expiryTimestamp:a.expiryTimestamp.toString()}),a.methods&&{methods:a.methods.join(",")})).sort(([a],[b])=>a.localeCompare(b)).forEach(([a,c])=>{void 0!==c&&b.append(a,String(c))}),`${a.protocol}:${a.topic}@${a.version}?${b}`}function qN(a,b,c){return`${a}?wc_ev=${c}&topic=${b}`}var qO=Object.defineProperty,qP=Object.defineProperties,qQ=Object.getOwnPropertyDescriptors,qR=Object.getOwnPropertySymbols,qS=Object.prototype.hasOwnProperty,qT=Object.prototype.propertyIsEnumerable,qU=(a,b,c)=>b in a?qO(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,qV=(a,b)=>{for(var c in b||(b={}))qS.call(b,c)&&qU(a,c,b[c]);if(qR)for(var c of qR(b))qT.call(b,c)&&qU(a,c,b[c]);return a},qW=(a,b)=>qP(a,qQ(b));function qX(a){let b=[];return a.forEach(a=>{let[c,d]=a.split(":");b.push(`${c}:${d}`)}),b}function qY(a){return a.includes(":")}function qZ(a){return qY(a)?a.split(":")[0]:a}function q$(a){var b,c,d;let e={};if(!q5(a))return e;for(let[f,g]of Object.entries(a)){let a=qY(f)?[f]:g.chains,h=g.methods||[],i=g.events||[],j=qZ(f);e[j]=qW(qV({},e[j]),{chains:mE(a,null==(b=e[j])?void 0:b.chains),methods:mE(h,null==(c=e[j])?void 0:c.methods),events:mE(i,null==(d=e[j])?void 0:d.events)})}return e}function q_(a,b){var c;let d,e=(c=b=b.map(a=>a.replace("did:pkh:","")),d={},c?.forEach(a=>{var b;let[c,e]=a.split(":");d[c]||(d[c]={accounts:[],chains:[],events:[],methods:[]}),d[c].accounts.push(a),null==(b=d[c].chains)||b.push(`${c}:${e}`)}),d);for(let[b,c]of Object.entries(e))c.methods?c.methods=mE(c.methods,a):c.methods=a,c.events=["chainChanged","accountsChanged"];return e}let q0={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},q1={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function q2(a,b){let{message:c,code:d}=q1[a];return{message:b?`${c} ${b}`:c,code:d}}function q3(a,b){let{message:c,code:d}=q0[a];return{message:b?`${c} ${b}`:c,code:d}}function q4(a,b){return!!Array.isArray(a)&&(!("u">typeof b)||!a.length||a.every(b))}function q5(a){return Object.getPrototypeOf(a)===Object.prototype&&Object.keys(a).length}function q6(a){return typeof a>"u"}function q7(a,b){return!!(b&&q6(a))||"string"==typeof a&&!!a.trim().length}function q8(a,b){return!!(b&&q6(a))||"number"==typeof a&&!isNaN(a)}function q9(a){return!!(q7(a,!1)&&a.includes(":"))&&2===a.split(":").length}function ra(a){let b=!0;return q4(a)?a.length&&(b=a.every(a=>q7(a,!1))):b=!1,b}function rb(a,b){let c=null;return Object.values(a).forEach(a=>{var d;let e;if(c)return;let f=(d=`${b}, namespace`,e=null,ra(a?.methods)?ra(a?.events)||(e=q3("UNSUPPORTED_EVENTS",`${d}, events should be an array of strings or empty array for no events`)):e=q3("UNSUPPORTED_METHODS",`${d}, methods should be an array of strings or empty array for no methods`),e);f&&(c=f)}),c}function rc(a,b){let c=null;if(a&&q5(a)){let d,e=rb(a,b);e&&(c=e);let f=(d=null,Object.values(a).forEach(a=>{var c,e;let f;if(d)return;let g=(c=a?.accounts,e=`${b} namespace`,f=null,q4(c)?c.forEach(a=>{f||function(a){if(q7(a,!1)&&a.includes(":")){let b=a.split(":");if(3===b.length){let a=b[0]+":"+b[1];return!!b[2]&&q9(a)}}return!1}(a)||(f=q3("UNSUPPORTED_ACCOUNTS",`${e}, account ${a} should be a string and conform to "namespace:chainId:address" format`))}):f=q3("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),f);g&&(d=g)}),d);f&&(c=f)}else c=q2("MISSING_OR_INVALID",`${b}, namespaces should be an object with data`);return c}function rd(a){return q7(a.protocol,!0)}function re(a){return"u">typeof a}function rf(a,b){let c;return!(!q9(b)||!(c=[],Object.values(a).forEach(a=>{c.push(...qX(a.accounts))}),c).includes(b))}function rg(a,b,c){var d,e;let f,g,h=null,i=(f={},Object.keys(d=a).forEach(a=>{var b;a.includes(":")?f[a]=d[a]:null==(b=d[a].chains)||b.forEach(b=>{f[b]={methods:d[a].methods,events:d[a].events}})}),f),j=(g={},Object.keys(e=b).forEach(a=>{if(a.includes(":"))g[a]=e[a];else{let b=qX(e[a].accounts);b?.forEach(b=>{g[b]={accounts:e[a].accounts.filter(a=>a.includes(`${b}:`)),methods:e[a].methods,events:e[a].events}})}}),g),k=Object.keys(i),l=Object.keys(j),m=rh(Object.keys(a)),o=rh(Object.keys(b)),p=m.filter(a=>!o.includes(a));return p.length&&(h=q2("NON_CONFORMING_NAMESPACES",`${c} namespaces keys don't satisfy requiredNamespaces.
      Required: ${p.toString()}
      Received: ${Object.keys(b).toString()}`)),mu(k,l)||(h=q2("NON_CONFORMING_NAMESPACES",`${c} namespaces chains don't satisfy required namespaces.
      Required: ${k.toString()}
      Approved: ${l.toString()}`)),Object.keys(b).forEach(a=>{if(!a.includes(":")||h)return;let d=qX(b[a].accounts);d.includes(a)||(h=q2("NON_CONFORMING_NAMESPACES",`${c} namespaces accounts don't satisfy namespace accounts for ${a}
        Required: ${a}
        Approved: ${d.toString()}`))}),k.forEach(a=>{h||(mu(i[a].methods,j[a].methods)?mu(i[a].events,j[a].events)||(h=q2("NON_CONFORMING_NAMESPACES",`${c} namespaces events don't satisfy namespace events for ${a}`)):h=q2("NON_CONFORMING_NAMESPACES",`${c} namespaces methods don't satisfy namespace methods for ${a}`))}),h}function rh(a){return[...new Set(a.map(a=>a.includes(":")?a.split(":")[0]:a))]}function ri(){let a=mq();return new Promise(b=>{switch(a){case mm:b(mp()&&navigator?.onLine);break;case mk:b(rj());break;default:b(!0)}})}async function rj(){if(mo()&&null!=a.g&&a.g.NetInfo){let b=await (null==a.g?void 0:a.g.NetInfo.fetch());return b?.isConnected}return!0}let rk={};class rl{static get(a){return rk[a]}static set(a,b){rk[a]=b}static delete(a){delete rk[a]}}function rm(a){return new Uint8Array(a.replace(/^0x/,"").match(/.{1,2}/g).map(a=>parseInt(a,16)))}function rn({logger:a,name:b}){let c="string"==typeof a?l7({opts:{level:a,name:b}}).logger:a;return c.level="string"==typeof a?a:a.level,c}var ro=a.i(241958),rp=a.i(996840);a.i(157938);var rq=a.i(693172),rr=Object.defineProperty,rs=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?rr(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class rt extends rq.IEvents{constructor(a){super(),this.opts=a,rs(this,"protocol","wc"),rs(this,"version",2)}}var ru=Object.defineProperty;class rv extends rq.IEvents{constructor(a,b){super(),this.core=a,this.logger=b,((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?ru(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"records",new Map)}}class rw{constructor(a,b){this.logger=a,this.core=b}}class rx extends rq.IEvents{constructor(a,b){super(),this.relayer=a,this.logger=b}}class ry extends rq.IEvents{constructor(a){super()}}class rz{constructor(a,b,c,d){this.core=a,this.logger=b,this.name=c}}class rA extends rq.IEvents{constructor(a,b){super(),this.relayer=a,this.logger=b}}class rB extends rq.IEvents{constructor(a,b){super(),this.core=a,this.logger=b}}class rC{constructor(a,b,c){this.core=a,this.logger=b,this.store=c}}class rD{constructor(a,b){this.projectId=a,this.logger=b}}class rE{constructor(a,b,c){this.core=a,this.logger=b,this.telemetryEnabled=c}}var rF=Object.defineProperty,rG=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?rF(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};cg.default;class rH{constructor(a){this.opts=a,rG(this,"protocol","wc"),rG(this,"version",2)}}cg.EventEmitter;class rI{constructor(a){this.client=a}}var rJ=a.i(271137);a.i(258910);var rK=a.i(499963),rL=a.i(517992),rM=a.i(901631);let rN="core",rO=`wc@2:${rN}:`,rP={database:":memory:"},rQ="client_ed25519_seed",rR=ic.ONE_DAY,rS=ic.SIX_HOURS,rT="wss://relay.walletconnect.org",rU="relayer_message",rV="relayer_message_ack",rW="relayer_connection_stalled",rX="relayer_publish",rY="payload",rZ="connect",r$="disconnect",r_="error",r0="2.22.4",r1="link_mode",r2="relay",r3="inbound",r4="WALLETCONNECT_LINK_MODE_APPS",r5="subscription_created",r6="subscription_deleted",r7=(ic.THIRTY_DAYS,ic.FIVE_SECONDS,ic.THIRTY_DAYS,{wc_pairingDelete:{req:{ttl:ic.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ic.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ic.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ic.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ic.ONE_DAY,prompt:!1,tag:0},res:{ttl:ic.ONE_DAY,prompt:!1,tag:0}}}),r8="pairing_create",r9="pairing_delete",sa="history_created",sb="history_updated",sc="history_deleted",sd="expirer_created",se="expirer_deleted",sf="expirer_expired",sg=(ic.ONE_DAY,"https://verify.walletconnect.org"),sh=`${sg}/v3`,si=["https://verify.walletconnect.com",sg],sj="malformed_pairing_uri",sk="session_approve_started";var sl=function(a,b){if(a.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;for(var e=0;e<a.length;e++){var f=a.charAt(e),g=f.charCodeAt(0);if(255!==c[g])throw TypeError(f+" is ambiguous");c[g]=e}var h=a.length,i=a.charAt(0),j=Math.log(h)/Math.log(256),k=Math.log(256)/Math.log(h);function l(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;var b=0;if(" "!==a[0]){for(var d=0,e=0;a[b]===i;)d++,b++;for(var f=(a.length-b)*j+1>>>0,g=new Uint8Array(f);a[b];){var k=c[a.charCodeAt(b)];if(255===k)return;for(var l=0,m=f-1;(0!==k||l<e)&&-1!==m;m--,l++)k+=h*g[m]>>>0,g[m]=k%256>>>0,k=k/256>>>0;if(0!==k)throw Error("Non-zero carry");e=l,b++}if(" "!==a[b]){for(var o=f-e;o!==f&&0===g[o];)o++;for(var p=new Uint8Array(d+(f-o)),q=d;o!==f;)p[q++]=g[o++];return p}}}return{encode:function(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";for(var c=0,d=0,e=0,f=b.length;e!==f&&0===b[e];)e++,c++;for(var g=(f-e)*k+1>>>0,j=new Uint8Array(g);e!==f;){for(var l=b[e],m=0,o=g-1;(0!==l||m<d)&&-1!==o;o--,m++)l+=256*j[o]>>>0,j[o]=l%h>>>0,l=l/h>>>0;if(0!==l)throw Error("Non-zero carry");d=m,e++}for(var p=g-d;p!==g&&0===j[p];)p++;for(var q=i.repeat(c);p<g;++p)q+=a.charAt(j[p]);return q},decodeUnsafe:l,decode:function(a){var c=l(a);if(c)return c;throw Error(`Non-${b} character`)}}};let sm=a=>{if(a instanceof Uint8Array&&"Uint8Array"===a.constructor.name)return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw Error("Unknown type, must be binary type")};class sn{constructor(a,b,c){this.name=a,this.prefix=b,this.baseEncode=c}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class so{constructor(a,b,c){if(this.name=a,this.prefix=b,void 0===b.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=b.codePointAt(0),this.baseDecode=c}decode(a){if("string"==typeof a){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return sq(this,a)}}class sp{constructor(a){this.decoders=a}or(a){return sq(this,a)}decode(a){let b=a[0],c=this.decoders[b];if(c)return c.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let sq=(a,b)=>new sp({...a.decoders||{[a.prefix]:a},...b.decoders||{[b.prefix]:b}});class sr{constructor(a,b,c,d){this.name=a,this.prefix=b,this.baseEncode=c,this.baseDecode=d,this.encoder=new sn(a,b,c),this.decoder=new so(a,b,d)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}let ss=({name:a,prefix:b,encode:c,decode:d})=>new sr(a,b,c,d),st=({prefix:a,name:b,alphabet:c})=>{let{encode:d,decode:e}=sl(c,b);return ss({prefix:a,name:b,encode:d,decode:a=>sm(e(a))})},su=({name:a,prefix:b,bitsPerChar:c,alphabet:d})=>ss({prefix:b,name:a,encode:a=>((a,b,c)=>{let d="="===b[b.length-1],e=(1<<c)-1,f="",g=0,h=0;for(let d=0;d<a.length;++d)for(h=h<<8|a[d],g+=8;g>c;)g-=c,f+=b[e&h>>g];if(g&&(f+=b[e&h<<c-g]),d)for(;f.length*c&7;)f+="=";return f})(a,d,c),decode:b=>((a,b,c,d)=>{let e={};for(let a=0;a<b.length;++a)e[b[a]]=a;let f=a.length;for(;"="===a[f-1];)--f;let g=new Uint8Array(f*c/8|0),h=0,i=0,j=0;for(let b=0;b<f;++b){let f=e[a[b]];if(void 0===f)throw SyntaxError(`Non-${d} character`);i=i<<c|f,(h+=c)>=8&&(h-=8,g[j++]=255&i>>h)}if(h>=c||255&i<<8-h)throw SyntaxError("Unexpected end of data");return g})(b,d,c,a)});var sv=Object.freeze({__proto__:null,identity:ss({prefix:"\0",name:"identity",encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)})}),sw=Object.freeze({__proto__:null,base2:su({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),sx=Object.freeze({__proto__:null,base8:su({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),sy=Object.freeze({__proto__:null,base10:st({prefix:"9",name:"base10",alphabet:"0123456789"})}),sz=Object.freeze({__proto__:null,base16:su({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:su({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})}),sA=Object.freeze({__proto__:null,base32:su({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper:su({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad:su({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper:su({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex:su({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper:su({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad:su({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:su({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:su({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),sB=Object.freeze({__proto__:null,base36:st({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:st({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),sC=Object.freeze({__proto__:null,base58btc:st({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:st({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})}),sD=Object.freeze({__proto__:null,base64:su({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad:su({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:su({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:su({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let sE=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),sF=sE.reduce((a,b,c)=>(a[c]=b,a),[]),sG=sE.reduce((a,b,c)=>(a[b.codePointAt(0)]=c,a),[]);var sH=Object.freeze({__proto__:null,base256emoji:ss({prefix:"ðŸš€",name:"base256emoji",encode:function(a){return a.reduce((a,b)=>a+=sF[b],"")},decode:function(a){let b=[];for(let c of a){let a=sG[c.codePointAt(0)];if(void 0===a)throw Error(`Non-base256emoji character: ${c}`);b.push(a)}return new Uint8Array(b)}})});function sI(a,b,c){b=b||[],c=c||0;for(var d=c;a>=0x80000000;)b[c++]=255&a|128,a/=128;for(;-128&a;)b[c++]=255&a|128,a>>>=7;return b[c]=0|a,sI.bytes=c-d+1,b}var sJ=function(a){return a<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:a<0x800000000?5:a<0x40000000000?6:a<0x2000000000000?7:a<0x100000000000000?8:a<0x8000000000000000?9:10};let sK=(a,b,c=0)=>(sI(a,b,c),b),sL=(a,b)=>{let c=b.byteLength,d=sJ(a),e=d+sJ(c),f=new Uint8Array(e+c);return sK(a,f,0),sK(c,f,d),f.set(b,e),new sM(a,c,b,f)};class sM{constructor(a,b,c,d){this.code=a,this.size=b,this.digest=c,this.bytes=d}}let sN=({name:a,code:b,encode:c})=>new sO(a,b,c);class sO{constructor(a,b,c){this.name=a,this.code=b,this.encode=c}digest(a){if(a instanceof Uint8Array){let b=this.encode(a);return b instanceof Uint8Array?sL(this.code,b):b.then(a=>sL(this.code,a))}throw Error("Unknown type, must be binary type")}}let sP=a=>async b=>new Uint8Array(await crypto.subtle.digest(a,b));var sQ=Object.freeze({__proto__:null,sha256:sN({name:"sha2-256",code:18,encode:sP("SHA-256")}),sha512:sN({name:"sha2-512",code:19,encode:sP("SHA-512")})}),sR=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:sm,digest:a=>sL(0,sm(a))}});new TextEncoder,new TextDecoder;let sS={...sv,...sw,...sx,...sy,...sz,...sA,...sB,...sC,...sD,...sH};function sT(a){return null!=globalThis.Buffer?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function sU(a,b,c,d){return{name:a,prefix:b,encoder:{name:a,prefix:b,encode:c},decoder:{decode:d}}}({...sQ,...sR});let sV=sU("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),sW=sU("ascii","a",a=>{let b="a";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},a=>{let b=function(a=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?sT(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}((a=a.substring(1)).length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}),sX={utf8:sV,"utf-8":sV,hex:sS.base16,latin1:sW,ascii:sW,binary:sW,...sS};var sY=Object.defineProperty,sZ=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?sY(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class s${constructor(a,b){this.core=a,this.logger=b,sZ(this,"keychain",new Map),sZ(this,"name","keychain"),sZ(this,"version","0.3"),sZ(this,"initialized",!1),sZ(this,"storagePrefix",rO),sZ(this,"init",async()=>{if(!this.initialized){let a=await this.getKeyChain();"u">typeof a&&(this.keychain=a),this.initialized=!0}}),sZ(this,"has",a=>(this.isInitialized(),this.keychain.has(a))),sZ(this,"set",async(a,b)=>{this.isInitialized(),this.keychain.set(a,b),await this.persist()}),sZ(this,"get",a=>{this.isInitialized();let b=this.keychain.get(a);if(typeof b>"u"){let{message:b}=q2("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}),sZ(this,"del",async a=>{this.isInitialized(),this.keychain.delete(a),await this.persist()}),this.core=a,this.logger=l6(b,this.name)}get context(){return l5(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(a){await this.core.storage.setItem(this.storageKey,mv(a))}async getKeyChain(){let a=await this.core.storage.getItem(this.storageKey);return"u">typeof a?mw(a):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}}var s_=Object.defineProperty,s0=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?s_(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class s1{constructor(a,b,c){this.core=a,this.logger=b,s0(this,"name","crypto"),s0(this,"keychain"),s0(this,"randomSessionIdentifier",qq()),s0(this,"initialized",!1),s0(this,"clientId"),s0(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),s0(this,"hasKeys",a=>(this.isInitialized(),this.keychain.has(a))),s0(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;let a=await this.getClientSeed(),b=lH.generateKeyPair(a),c=lH.encodeIss(b.publicKey);return this.clientId=c,c}),s0(this,"generateKeyPair",()=>{let a,b;this.isInitialized();let c=(a=p0.utils.randomPrivateKey(),b=p0.getPublicKey(a),{privateKey:(0,lI.toString)(a,qm),publicKey:(0,lI.toString)(b,qm)});return this.setPrivateKey(c.publicKey,c.privateKey)}),s0(this,"signJWT",async a=>{this.isInitialized();let b=await this.getClientSeed(),c=lH.generateKeyPair(b),d=this.randomSessionIdentifier;return await lH.signJWT(d,a,rR,c)}),s0(this,"generateSharedKey",(a,b,c)=>{var d,e,f;let g,h;this.isInitialized();let i=(d=this.getPrivateKey(a),g=p0.getSharedSecret((0,lJ.fromString)(d,qm),(0,lJ.fromString)(b,qm)),e=void 0,h=function(a,b,c,d=32){m5(a),m3(d);let e=a.outputLen;if(d>255*e)throw Error("Length should be <= 255*HashLen");let f=Math.ceil(d/e);void 0===c&&(c=o0);let g=new Uint8Array(f*e),h=o$.create(a,b),i=h._cloneInto(),j=new Uint8Array(h.outputLen);for(let a=0;a<f;a++)o_[0]=a+1,i.update(0===a?o0:j).update(c).update(o_).digestInto(j),g.set(j,e*a),h._cloneInto(i);return h.destroy(),i.destroy(),m9(j,o_),g.slice(0,d)}(nX,(f=void 0,m5(nX),void 0===f&&(f=new Uint8Array(nX.outputLen)),o$(nX,nm(f),nm(g))),e,32),(0,lI.toString)(h,qm));return this.setSymKey(i,c)}),s0(this,"setSymKey",async(a,b)=>{this.isInitialized();let c=b||qr(a);return await this.keychain.set(c,a),c}),s0(this,"deleteKeyPair",async a=>{this.isInitialized(),await this.keychain.del(a)}),s0(this,"deleteSymKey",async a=>{this.isInitialized(),await this.keychain.del(a)}),s0(this,"encode",async(a,b,c)=>{this.isInitialized();let d=qz(c),e=(0,lO.safeJsonStringify)(b);if(2===d.type){var f;let a,b,d;return f=c?.encoding,a=qt(2),b=nq(12),d=qx({type:a,sealed:(0,lJ.fromString)(e,qp),iv:b}),f===qo?qv(d):d}if(qA(d)){let b=d.senderPublicKey,c=d.receiverPublicKey;a=await this.generateSharedKey(b,c)}let g=this.getSymKey(a),{type:h,senderPublicKey:i}=d;return function(a){let b=qt("u">typeof a.type?a.type:0);if(1===qu(b)&&typeof a.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let c="u">typeof a.senderPublicKey?(0,lJ.fromString)(a.senderPublicKey,qm):void 0,d="u">typeof a.iv?(0,lJ.fromString)(a.iv,qm):nq(12),e=qx({type:b,sealed:oY((0,lJ.fromString)(a.symKey,qm),d).encrypt((0,lJ.fromString)(a.message,qp)),iv:d,senderPublicKey:c});return a.encoding===qo?qv(e):e}({type:h,symKey:g,message:e,senderPublicKey:i,encoding:c?.encoding})}),s0(this,"decode",async(a,b,c)=>{let d;this.isInitialized();let e=qz({type:qu((d=qy({encoded:b,encoding:c?.encoding})).type),senderPublicKey:"u">typeof d.senderPublicKey?(0,lI.toString)(d.senderPublicKey,qm):void 0,receiverPublicKey:c?.receiverPublicKey});if(2===e.type){let a=function(a,b){let{sealed:c}=qy({encoded:a,encoding:b});return(0,lI.toString)(c,qp)}(b,c?.encoding);return(0,lO.safeJsonParse)(a)}if(qA(e)){let b=e.receiverPublicKey,c=e.senderPublicKey;a=await this.generateSharedKey(b,c)}try{let d=this.getSymKey(a),e=function(a){let b=(0,lJ.fromString)(a.symKey,qm),{sealed:c,iv:d}=qy({encoded:a.encoded,encoding:a.encoding}),e=oY(b,d).decrypt(c);if(null===e)throw Error("Failed to decrypt");return(0,lI.toString)(e,qp)}({symKey:d,encoded:b,encoding:c?.encoding});return(0,lO.safeJsonParse)(e)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}}),s0(this,"getPayloadType",(a,b=qn)=>qu(qy({encoded:a,encoding:b}).type)),s0(this,"getPayloadSenderPublicKey",(a,b=qn)=>{let c=qy({encoded:a,encoding:b});return c.senderPublicKey?(0,lI.toString)(c.senderPublicKey,qm):void 0}),this.core=a,this.logger=l6(b,this.name),this.keychain=c||new s$(this.core,this.logger)}get context(){return l5(this.logger)}async setPrivateKey(a,b){return await this.keychain.set(a,b),a}getPrivateKey(a){return this.keychain.get(a)}async getClientSeed(){let a="";try{a=this.keychain.get(rQ)}catch{a=qq(),await this.keychain.set(rQ,a)}return function(a,b="utf8"){let c=sX[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?sT(globalThis.Buffer.from(a,"utf-8")):c.decoder.decode(`${c.prefix}${a}`)}(a,"base16")}getSymKey(a){return this.keychain.get(a)}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}}var s2=Object.defineProperty,s3=Object.defineProperties,s4=Object.getOwnPropertyDescriptors,s5=Object.getOwnPropertySymbols,s6=Object.prototype.hasOwnProperty,s7=Object.prototype.propertyIsEnumerable,s8=(a,b,c)=>b in a?s2(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,s9=(a,b,c)=>s8(a,"symbol"!=typeof b?b+"":b,c);class ta extends rw{constructor(a,b){super(a,b),this.logger=a,this.core=b,s9(this,"messages",new Map),s9(this,"messagesWithoutClientAck",new Map),s9(this,"name","messages"),s9(this,"version","0.3"),s9(this,"initialized",!1),s9(this,"storagePrefix",rO),s9(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let a=await this.getRelayerMessages();"u">typeof a&&(this.messages=a);let b=await this.getRelayerMessagesWithoutClientAck();"u">typeof b&&(this.messagesWithoutClientAck=b),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(a){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(a)}finally{this.initialized=!0}}}),s9(this,"set",async(a,b,c)=>{this.isInitialized();let d=qs(b),e=this.messages.get(a);if(typeof e>"u"&&(e={}),"u">typeof e[d])return d;if(e[d]=b,this.messages.set(a,e),c===r3){let c=this.messagesWithoutClientAck.get(a)||{};this.messagesWithoutClientAck.set(a,s3(((a,b)=>{for(var c in b||(b={}))s6.call(b,c)&&s8(a,c,b[c]);if(s5)for(var c of s5(b))s7.call(b,c)&&s8(a,c,b[c]);return a})({},c),s4({[d]:b})))}return await this.persist(),d}),s9(this,"get",a=>{this.isInitialized();let b=this.messages.get(a);return typeof b>"u"&&(b={}),b}),s9(this,"getWithoutAck",a=>{this.isInitialized();let b={};for(let c of a){let a=this.messagesWithoutClientAck.get(c)||{};b[c]=Object.values(a)}return b}),s9(this,"has",(a,b)=>(this.isInitialized(),"u">typeof this.get(a)[qs(b)])),s9(this,"ack",async(a,b)=>{this.isInitialized();let c=this.messagesWithoutClientAck.get(a);if(typeof c>"u")return;let d=qs(b);delete c[d],0===Object.keys(c).length?this.messagesWithoutClientAck.delete(a):this.messagesWithoutClientAck.set(a,c),await this.persist()}),s9(this,"del",async a=>{this.isInitialized(),this.messages.delete(a),this.messagesWithoutClientAck.delete(a),await this.persist()}),this.logger=l6(a,this.name),this.core=b}get context(){return l5(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(a){await this.core.storage.setItem(this.storageKey,mv(a))}async setRelayerMessagesWithoutClientAck(a){await this.core.storage.setItem(this.storageKeyWithoutClientAck,mv(a))}async getRelayerMessages(){let a=await this.core.storage.getItem(this.storageKey);return"u">typeof a?mw(a):void 0}async getRelayerMessagesWithoutClientAck(){let a=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof a?mw(a):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}}var tb=Object.defineProperty,tc=Object.defineProperties,td=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,tf=Object.prototype.hasOwnProperty,tg=Object.prototype.propertyIsEnumerable,th=(a,b,c)=>b in a?tb(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,ti=(a,b)=>{for(var c in b||(b={}))tf.call(b,c)&&th(a,c,b[c]);if(te)for(var c of te(b))tg.call(b,c)&&th(a,c,b[c]);return a},tj=(a,b,c)=>th(a,"symbol"!=typeof b?b+"":b,c);class tk extends rx{constructor(a,b){super(a,b),this.relayer=a,this.logger=b,tj(this,"events",new cg.EventEmitter),tj(this,"name","publisher"),tj(this,"queue",new Map),tj(this,"publishTimeout",(0,ic.toMiliseconds)(ic.ONE_MINUTE)),tj(this,"initialPublishTimeout",(0,ic.toMiliseconds)(15*ic.ONE_SECOND)),tj(this,"needsTransportRestart",!1),tj(this,"publish",async(a,b,c)=>{var d,e,f,g,h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:a,message:b,opts:c}});let i=c?.ttl||rS,j=c?.prompt||!1,k=c?.tag||0,l=c?.id||(0,rK.getBigIntRpcId)().toString(),m=qC(qB().protocol),o={id:l,method:c?.publishMethod||m.publish,params:ti({topic:a,message:b,ttl:i,prompt:j,tag:k,attestation:c?.attestation},c?.tvf)},p=`Failed to publish payload, please try again. id:${l} tag:${k}`;try{q6(null==(d=o.params)?void 0:d.prompt)&&(null==(e=o.params)||delete e.prompt),q6(null==(f=o.params)?void 0:f.tag)&&(null==(g=o.params)||delete g.tag);let h=new Promise(async a=>{let b=({id:c})=>{var d;(null==(d=o.id)?void 0:d.toString())===c.toString()&&(this.removeRequestFromQueue(c),this.relayer.events.removeListener(rX,b),a())};this.relayer.events.on(rX,b);let d=my(new Promise((a,b)=>{this.rpcPublish(o,c).then(a).catch(a=>{this.logger.warn(a,a?.message),b(a)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${l} tag:${k}`);try{await d,this.events.removeListener(rX,b)}catch(a){this.queue.set(l,{request:o,opts:c,attempt:1}),this.logger.warn(a,a?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:l,topic:a,message:b,opts:c}}),await my(h,this.publishTimeout,p)}catch(a){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(a),null!=(h=c?.internal)&&h.throwOnFailedPublish)throw a}finally{this.queue.delete(l)}}),tj(this,"publishCustom",async a=>{var b,c,d,e,f;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:a});let{payload:g,opts:h={}}=a,{attestation:i,tvf:j,publishMethod:k,prompt:l,tag:m,ttl:o=ic.FIVE_MINUTES}=h,p=h.id||(0,rK.getBigIntRpcId)().toString(),q=qC(qB().protocol),r=k||q.publish,s={id:p,method:r,params:ti(tc(ti({},g),td({ttl:o,prompt:l,tag:m,attestation:i})),j)},t=`Failed to publish custom payload, please try again. id:${p} tag:${m}`;try{q6(null==(b=s.params)?void 0:b.prompt)&&(null==(c=s.params)||delete c.prompt),q6(null==(d=s.params)?void 0:d.tag)&&(null==(e=s.params)||delete e.tag);let a=new Promise(async a=>{let b=({id:c})=>{var d;(null==(d=s.id)?void 0:d.toString())===c.toString()&&(this.removeRequestFromQueue(c),this.relayer.events.removeListener(rX,b),a())};this.relayer.events.on(rX,b);let c=my(new Promise((a,b)=>{this.rpcPublish(s,h).then(a).catch(a=>{this.logger.warn(a,a?.message),b(a)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${r} id:${p} tag:${m}`);try{await c,this.events.removeListener(rX,b)}catch(a){this.queue.set(p,{request:s,opts:h,attempt:1}),this.logger.warn(a,a?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,payload:g,opts:h}}),await my(a,this.publishTimeout,t)}catch(a){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(a),null!=(f=h?.internal)&&f.throwOnFailedPublish)throw a}finally{this.queue.delete(p)}}),tj(this,"on",(a,b)=>{this.events.on(a,b)}),tj(this,"once",(a,b)=>{this.events.once(a,b)}),tj(this,"off",(a,b)=>{this.events.off(a,b)}),tj(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.relayer=a,this.logger=l6(b,this.name),this.registerEventListeners()}get context(){return l5(this.logger)}async rpcPublish(a,b){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:a});let c=await this.relayer.request(a);return this.relayer.events.emit(rX,ti(ti({},a),b)),this.logger.debug("Successfully Published Payload"),c}removeRequestFromQueue(a){this.queue.delete(a)}checkQueue(){this.queue.forEach(async(a,b)=>{var c;let d=a.attempt+1;this.queue.set(b,tc(ti({},a),td({attempt:d}))),this.logger.warn({},`Publisher: queue->publishing: ${a.request.id}, tag: ${null==(c=a.request.params)?void 0:c.tag}, attempt: ${d}`),await this.rpcPublish(a.request,a.opts),this.logger.warn({},`Publisher: queue->published: ${a.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(ro.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(rW);return}this.checkQueue()}),this.relayer.on(rV,a=>{this.removeRequestFromQueue(a.id.toString())})}}var tl=Object.defineProperty,tm=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?tl(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class tn{constructor(){tm(this,"map",new Map),tm(this,"set",(a,b)=>{let c=this.get(a);this.exists(a,b)||this.map.set(a,[...c,b])}),tm(this,"get",a=>this.map.get(a)||[]),tm(this,"exists",(a,b)=>this.get(a).includes(b)),tm(this,"delete",(a,b)=>{if(typeof b>"u")return void this.map.delete(a);if(!this.map.has(a))return;let c=this.get(a);if(!this.exists(a,b))return;let d=c.filter(a=>a!==b);d.length?this.map.set(a,d):this.map.delete(a)}),tm(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var to=Object.defineProperty,tp=Object.defineProperties,tq=Object.getOwnPropertyDescriptors,tr=Object.getOwnPropertySymbols,ts=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable,tu=(a,b,c)=>b in a?to(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,tv=(a,b)=>{for(var c in b||(b={}))ts.call(b,c)&&tu(a,c,b[c]);if(tr)for(var c of tr(b))tt.call(b,c)&&tu(a,c,b[c]);return a},tw=(a,b,c)=>tu(a,"symbol"!=typeof b?b+"":b,c);class tx extends rA{constructor(a,b){super(a,b),this.relayer=a,this.logger=b,tw(this,"subscriptions",new Map),tw(this,"topicMap",new tn),tw(this,"events",new cg.EventEmitter),tw(this,"name","subscription"),tw(this,"version","0.3"),tw(this,"pending",new Map),tw(this,"cached",[]),tw(this,"initialized",!1),tw(this,"storagePrefix",rO),tw(this,"subscribeTimeout",(0,ic.toMiliseconds)(ic.ONE_MINUTE)),tw(this,"initialSubscribeTimeout",(0,ic.toMiliseconds)(15*ic.ONE_SECOND)),tw(this,"clientId"),tw(this,"batchSubscribeTopicsLimit",500),tw(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),tw(this,"subscribe",async(a,b)=>{var c;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:a,opts:b}});try{let d=qB(b),e={topic:a,relay:d,transportType:b?.transportType};null!=(c=b?.internal)&&c.skipSubscribe||this.pending.set(a,e);let f=await this.rpcSubscribe(a,d,b);return"string"==typeof f&&(this.onSubscribe(f,e),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:a,opts:b}})),f}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}}),tw(this,"unsubscribe",async(a,b)=>{this.isInitialized(),"u">typeof b?.id?await this.unsubscribeById(a,b.id,b):await this.unsubscribeByTopic(a,b)}),tw(this,"isSubscribed",a=>new Promise(b=>{b(this.topicMap.topics.includes(a))})),tw(this,"isKnownTopic",a=>new Promise(b=>{b(this.topicMap.topics.includes(a)||this.pending.has(a)||this.cached.some(b=>b.topic===a))})),tw(this,"on",(a,b)=>{this.events.on(a,b)}),tw(this,"once",(a,b)=>{this.events.once(a,b)}),tw(this,"off",(a,b)=>{this.events.off(a,b)}),tw(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),tw(this,"start",async()=>{await this.onConnect()}),tw(this,"stop",async()=>{await this.onDisconnect()}),tw(this,"restart",async()=>{await this.restore(),await this.onRestart()}),tw(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let a=[];this.pending.forEach(b=>{a.push(b)}),await this.batchSubscribe(a)}),tw(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(ro.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.events.on(r5,async a=>{this.logger.info(`Emitting ${r5}`),this.logger.debug({type:"event",event:r5,data:a}),await this.persist()}),this.events.on(r6,async a=>{this.logger.info(`Emitting ${r6}`),this.logger.debug({type:"event",event:r6,data:a}),await this.persist()})}),this.relayer=a,this.logger=l6(b,this.name),this.clientId=""}get context(){return l5(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(a,b){let c=!1;try{c=this.getSubscription(a).topic===b}catch{}return c}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(a,b){let c=this.topicMap.get(a);await Promise.all(c.map(async c=>await this.unsubscribeById(a,c,b)))}async unsubscribeById(a,b,c){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:a,id:b,opts:c}});try{let d=qB(c);await this.restartToComplete({topic:a,id:b,relay:d}),await this.rpcUnsubscribe(a,b,d);let e=q3("USER_DISCONNECTED",`${this.name}, ${a}`);await this.onUnsubscribe(a,b,e),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:a,id:b,opts:c}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(a,b,c){var d,e;let f=await this.getSubscriptionId(a);if(null!=(d=c?.internal)&&d.skipSubscribe)return f;c&&c?.transportType!==r2||await this.restartToComplete({topic:a,id:a,relay:b});let g={method:qC(b.protocol).subscribe,params:{topic:a}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:g});let h=null==(e=c?.internal)?void 0:e.throwOnFailedPublish;try{if(c?.transportType===r1)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(g).catch(a=>this.logger.warn(a))},(0,ic.toMiliseconds)(ic.ONE_SECOND)),f;let b=new Promise(async b=>{let c=d=>{d.topic===a&&(this.events.removeListener(r5,c),b(d.id))};this.events.on(r5,c);try{let d=await my(new Promise((a,b)=>{this.relayer.request(g).catch(a=>{this.logger.warn(a,a?.message),b(a)}).then(a)}),this.initialSubscribeTimeout,`Subscribing to ${a} failed, please try again`);this.events.removeListener(r5,c),b(d)}catch{}}),d=await my(b,this.subscribeTimeout,`Subscribing to ${a} failed, please try again`);if(!d&&h)throw Error(`Subscribing to ${a} failed, please try again`);return d?f:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(rW),h)throw a}return null}async rpcBatchSubscribe(a){if(!a.length)return;let b={method:qC(a[0].relay.protocol).batchSubscribe,params:{topics:a.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:b});try{await await my(new Promise(a=>{this.relayer.request(b).catch(a=>this.logger.warn(a)).then(a)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(rW)}}async rpcBatchFetchMessages(a){let b;if(!a.length)return;let c={method:qC(a[0].relay.protocol).batchFetchMessages,params:{topics:a.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:c});try{b=await await my(new Promise((a,b)=>{this.relayer.request(c).catch(a=>{this.logger.warn(a),b(a)}).then(a)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(rW)}return b}rpcUnsubscribe(a,b,c){let d={method:qC(c.protocol).unsubscribe,params:{topic:a,id:b}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:d}),this.relayer.request(d)}onSubscribe(a,b){this.setSubscription(a,tp(tv({},b),tq({id:a}))),this.pending.delete(b.topic)}onBatchSubscribe(a){a.length&&a.forEach(a=>{this.setSubscription(a.id,tv({},a)),this.pending.delete(a.topic)})}async onUnsubscribe(a,b,c){this.events.removeAllListeners(b),this.hasSubscription(b,a)&&this.deleteSubscription(b,c),await this.relayer.messages.del(a)}async setRelayerSubscriptions(a){await this.relayer.core.storage.setItem(this.storageKey,a)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(a,b){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:a,subscription:b}),this.addSubscription(a,b)}addSubscription(a,b){this.subscriptions.set(a,tv({},b)),this.topicMap.set(b.topic,a),this.events.emit(r5,b)}getSubscription(a){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:a});let b=this.subscriptions.get(a);if(!b){let{message:b}=q2("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}deleteSubscription(a,b){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:a,reason:b});let c=this.getSubscription(a);this.subscriptions.delete(a),this.topicMap.delete(c.topic,a),this.events.emit(r6,tp(tv({},c),tq({reason:b})))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit("subscription_sync")}async onRestart(){if(this.cached.length){let a=[...this.cached],b=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let c=0;c<b;c++){let b=a.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(b)}}this.events.emit("subscription_resubscribed")}async restore(){try{let a=await this.getRelayerSubscriptions();if(typeof a>"u"||!a.length)return;if(this.subscriptions.size&&!a.every(a=>{var b;return a.topic===(null==(b=this.subscriptions.get(a.id))?void 0:b.topic)})){let{message:a}=q2("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(a){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(a)}}async batchSubscribe(a){a.length&&(await this.rpcBatchSubscribe(a),this.onBatchSubscribe(await Promise.all(a.map(async a=>tp(tv({},a),tq({id:await this.getSubscriptionId(a.topic)}))))))}async batchFetchMessages(a){var b;if(!a.length)return;this.logger.trace(`Fetching batch messages for ${a.length} subscriptions`);let c=await this.rpcBatchFetchMessages(a);c&&c.messages&&(await (b=(0,ic.toMiliseconds)(ic.ONE_SECOND),new Promise(a=>setTimeout(a,b))),await this.relayer.handleBatchMessageEvents(c.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}async restartToComplete(a){this.relayer.connected||this.relayer.connecting||(this.cached.push(a),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(a){return qs(a+await this.getClientId())}}var ty=Object.defineProperty,tz=Object.getOwnPropertySymbols,tA=Object.prototype.hasOwnProperty,tB=Object.prototype.propertyIsEnumerable,tC=(a,b,c)=>b in a?ty(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,tD=(a,b)=>{for(var c in b||(b={}))tA.call(b,c)&&tC(a,c,b[c]);if(tz)for(var c of tz(b))tB.call(b,c)&&tC(a,c,b[c]);return a},tE=(a,b,c)=>tC(a,"symbol"!=typeof b?b+"":b,c);class tF extends ry{constructor(b){var c;super(b),tE(this,"protocol","wc"),tE(this,"version",2),tE(this,"core"),tE(this,"logger"),tE(this,"events",new cg.EventEmitter),tE(this,"provider"),tE(this,"messages"),tE(this,"subscriber"),tE(this,"publisher"),tE(this,"name","relayer"),tE(this,"transportExplicitlyClosed",!1),tE(this,"initialized",!1),tE(this,"connectionAttemptInProgress",!1),tE(this,"relayUrl"),tE(this,"projectId"),tE(this,"packageName"),tE(this,"bundleId"),tE(this,"hasExperiencedNetworkDisruption",!1),tE(this,"pingTimeout"),tE(this,"heartBeatTimeout",(0,ic.toMiliseconds)(ic.THIRTY_SECONDS+ic.FIVE_SECONDS)),tE(this,"reconnectTimeout"),tE(this,"connectPromise"),tE(this,"reconnectInProgress",!1),tE(this,"requestsInFlight",[]),tE(this,"connectTimeout",(0,ic.toMiliseconds)(15*ic.ONE_SECOND)),tE(this,"request",async a=>{var b,c;this.logger.debug("Publishing Request Payload");let d=a.id||(0,rK.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:d,method:a.method,topic:null==(b=a.params)?void 0:b.topic},"relayer.request - publishing...");let e=`${d}:${(null==(c=a.params)?void 0:c.tag)||""}`;this.requestsInFlight.push(e);let f=await this.provider.request(a);return this.requestsInFlight=this.requestsInFlight.filter(a=>a!==e),f}catch(a){throw this.logger.debug(`Failed to Publish Request: ${d}`),a}}),tE(this,"resetPingTimeout",()=>{mn()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var a,b,c,d;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(d=null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.terminate)||d.call(c)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),tE(this,"onPayloadHandler",a=>{this.onProviderPayload(a),this.resetPingTimeout()}),tE(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected ðŸ›œ"),this.startPingTimeout(),this.events.emit("relayer_connect")}),tE(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected ðŸ›‘"),this.requestsInFlight=[],this.onProviderDisconnect()}),tE(this,"onProviderErrorHandler",a=>{this.logger.fatal(`Fatal socket error: ${a.message}`),this.events.emit("relayer_error",a),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),tE(this,"registerProviderListeners",()=>{this.provider.on(rY,this.onPayloadHandler),this.provider.on(rZ,this.onConnectHandler),this.provider.on(r$,this.onDisconnectHandler),this.provider.on(r_,this.onProviderErrorHandler)}),this.core=b.core,this.logger=rn({logger:null!=(c=b.logger)?c:"error",name:this.name}),this.messages=new ta(this.logger,b.core),this.subscriber=new tx(this,this.logger),this.publisher=new tk(this,this.logger),this.projectId=b?.projectId,this.relayUrl=b?.relayUrl||rT,mo()&&"u">typeof(null==a.g?void 0:a.g.Platform)&&(null==a.g?void 0:a.g.Platform.OS)==="android"?this.packageName=mr():mo()&&"u">typeof(null==a.g?void 0:a.g.Platform)&&(null==a.g?void 0:a.g.Platform.OS)==="ios"&&(this.bundleId=mr()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(a=>this.logger.warn(a,a?.message))}get context(){return l5(this.logger)}get connected(){var a,b,c;return(null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.readyState)===1}get connecting(){var a,b,c;return(null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.readyState)===0||void 0!==this.connectPromise}async publish(a,b,c){this.isInitialized(),await this.publisher.publish(a,b,c),await this.recordMessageEvent({topic:a,message:b,publishedAt:Date.now(),transportType:r2},"outbound")}async publishCustom(a){this.isInitialized(),await this.publisher.publishCustom(a)}async subscribe(a,b){var c,d,e;this.isInitialized(),null!=b&&b.transportType&&b?.transportType!=="relay"||await this.toEstablishConnection();let f=typeof(null==(c=b?.internal)?void 0:c.throwOnFailedPublish)>"u"||(null==(d=b?.internal)?void 0:d.throwOnFailedPublish),g=(null==(e=this.subscriber.topicMap.get(a))?void 0:e[0])||"",h,i=b=>{b.topic===a&&(this.subscriber.off(r5,i),h())};return await Promise.all([new Promise(a=>{h=a,this.subscriber.on(r5,i)}),new Promise(async(c,d)=>{g=await this.subscriber.subscribe(a,tD({internal:{throwOnFailedPublish:f}},b)).catch(a=>{f&&d(a)})||g,c()})]),g}async unsubscribe(a,b){this.isInitialized(),await this.subscriber.unsubscribe(a,b)}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}off(a,b){this.events.off(a,b)}removeListener(a,b){this.events.removeListener(a,b)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await my(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(a){if(!this.subscriber.hasAnyTopics)return void this.logger.info("Starting WS connection skipped because the client has no topics to work with.");if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(b,c)=>{await this.connect(a).then(b).catch(c).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(a){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=a||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await ri())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(a){if(a?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let b=a.sort((a,b)=>a.publishedAt-b.publishedAt);for(let a of(this.logger.debug(`Batch of ${b.length} message events sorted`),b))try{await this.onMessageEvent(a)}catch(a){this.logger.warn(a,"Error while processing batch message event: "+a?.message)}this.logger.trace(`Batch of ${b.length} message events processed`)}async onLinkMessageEvent(a,b){let{topic:c}=a;if(!b.sessionExists){let a=mB(ic.FIVE_MINUTES);await this.core.pairing.pairings.set(c,{topic:c,expiry:a,relay:{protocol:"irn"},active:!1})}this.events.emit(rU,a),await this.recordMessageEvent(a,r3)}async connect(a){await this.confirmOnlineStateOrThrow(),a&&a!==this.relayUrl&&(this.relayUrl=a,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let b=1;for(;b<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${b}...`),await this.createProvider(),await new Promise(async(a,b)=>{let c=()=>{b(Error("Connection interrupted while trying to connect"))};this.provider.once(r$,c),await my(new Promise((a,b)=>{this.provider.connect().then(a).catch(b)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{b(a)}).finally(()=>{this.provider.off(r$,c),clearTimeout(this.reconnectTimeout)}),await new Promise(async(a,c)=>{let d=()=>{b(Error("Connection interrupted while trying to subscribe"))};this.provider.once(r$,d),await this.subscriber.start().then(a).catch(c).finally(()=>{this.provider.off(r$,d)})}),this.hasExperiencedNetworkDisruption=!1,a()})}catch(a){await this.subscriber.stop(),this.logger.warn({},a.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${b}`);break}await new Promise(a=>setTimeout(a,(0,ic.toMiliseconds)(+b))),b++}}startPingTimeout(){var a,b,c,d,e;if(mn())try{null!=(b=null==(a=this.provider)?void 0:a.connection)&&b.socket&&(null==(e=null==(d=null==(c=this.provider)?void 0:c.connection)?void 0:d.socket)||e.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(a){this.logger.warn(a,a?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let a=await this.core.crypto.signJWT(this.relayUrl);this.provider=new rJ.JsonRpcProvider(new rM.default(function({protocol:a,version:b,relayUrl:c,sdkVersion:d,auth:e,projectId:f,useOnCloseEvent:g,bundleId:h,packageName:i}){var j,k;let l,m=c.split("?"),o=mt(a,b,d),p=(j=m[1]||"",k={auth:e,ua:o,projectId:f,useOnCloseEvent:g||void 0,packageName:i||void 0,bundleId:h||void 0},l=new URLSearchParams(j),Object.entries(k).sort(([a],[b])=>a.localeCompare(b)).forEach(([a,b])=>{null!=b&&l.set(a,String(b))}),l.toString());return m[0]+"?"+p}({sdkVersion:r0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:a,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(a,b){let{topic:c,message:d}=a;await this.messages.set(c,d,b)}async shouldIgnoreMessageEvent(a){let{topic:b,message:c}=a;if(!c||0===c.length)return this.logger.warn(`Ignoring invalid/empty message: ${c}`),!0;if(!await this.subscriber.isKnownTopic(b))return this.logger.warn(`Ignoring message for unknown topic ${b}`),!0;let d=this.messages.has(b,c);return d&&this.logger.warn(`Ignoring duplicate message: ${c}`),d}async onProviderPayload(a){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:a}),(0,rL.isJsonRpcRequest)(a)){if(!a.method.endsWith("_subscription"))return;let b=a.params,{topic:c,message:d,publishedAt:e,attestation:f}=b.data,g={topic:c,message:d,publishedAt:e,transportType:r2,attestation:f};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(tD({type:"event",event:b.id},g)),this.events.emit(b.id,g),await this.acknowledgePayload(a),await this.onMessageEvent(g)}else(0,rL.isJsonRpcResponse)(a)&&this.events.emit(rV,a)}async onMessageEvent(a){await this.shouldIgnoreMessageEvent(a)||(await this.recordMessageEvent(a,r3),this.events.emit(rU,a))}async acknowledgePayload(a){let b=(0,rK.formatJsonRpcResult)(a.id,!0);await this.provider.connection.send(b)}unregisterProviderListeners(){this.provider.off(rY,this.onPayloadHandler),this.provider.off(rZ,this.onConnectHandler),this.provider.off(r$,this.onDisconnectHandler),this.provider.off(r_,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let b=await ri();(function(b){var c,d;switch(mq()){case mm:c=b,!mo()&&mp()&&(window.addEventListener("online",()=>c(!0)),window.addEventListener("offline",()=>c(!1)));break;case mk:d=b,mo()&&null!=a.g&&a.g.NetInfo&&a.g?.NetInfo.addEventListener(a=>d(a?.isConnected))}})(async a=>{b!==a&&(b=a,a?await this.transportOpen().catch(a=>this.logger.error(a,a?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(ro.HEARTBEAT_EVENTS.pulse,async()=>{var a;if(!this.transportExplicitlyClosed&&!this.connected&&(!(mp()&&(0,id.getDocument)())||(null==(a=(0,id.getDocument)())?void 0:a.visibilityState)==="visible"))try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(a){this.logger.warn(a,a?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit("relayer_disconnect"),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(a=>this.logger.error(a,a?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,ic.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise)return void await this.connectPromise;await this.connect()}}}function tG(a){return Object.getOwnPropertySymbols(a).filter(b=>Object.prototype.propertyIsEnumerable.call(a,b))}function tH(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":Object.prototype.toString.call(a)}let tI="[object Arguments]",tJ="[object Object]";function tK(){}function tL(a){if(!a||"object"!=typeof a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&"[object Object]"===Object.prototype.toString.call(a)}var tM=Object.defineProperty,tN=Object.getOwnPropertySymbols,tO=Object.prototype.hasOwnProperty,tP=Object.prototype.propertyIsEnumerable,tQ=(a,b,c)=>b in a?tM(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,tR=(a,b)=>{for(var c in b||(b={}))tO.call(b,c)&&tQ(a,c,b[c]);if(tN)for(var c of tN(b))tP.call(b,c)&&tQ(a,c,b[c]);return a},tS=(a,b,c)=>tQ(a,"symbol"!=typeof b?b+"":b,c);class tT extends rz{constructor(a,b,c,d=rO,e){super(a,b,c,d),this.core=a,this.logger=b,this.name=c,tS(this,"map",new Map),tS(this,"version","0.3"),tS(this,"cached",[]),tS(this,"initialized",!1),tS(this,"getKey"),tS(this,"storagePrefix",rO),tS(this,"recentlyDeleted",[]),tS(this,"recentlyDeletedLimit",200),tS(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{var b;this.getKey&&null!==a&&!q6(a)?this.map.set(this.getKey(a),a):(null==(b=a?.proposer)?void 0:b.publicKey)?this.map.set(a.id,a):a?.topic&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)}),tS(this,"set",async(a,b)=>{this.isInitialized(),this.map.has(a)?await this.update(a,b):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:b}),this.map.set(a,b),await this.persist())}),tS(this,"get",a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a))),tS(this,"getAll",a=>(this.isInitialized(),a?this.values.filter(b=>Object.keys(a).every(c=>{var d;return d=b[c],function a(b,c,d,e,f,g,h){let i=h(b,c,d,e,f,g);if(void 0!==i)return i;if(typeof b==typeof c)switch(typeof b){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return b===c;case"number":return b===c||Object.is(b,c)}return function b(c,d,e,f){if(Object.is(c,d))return!0;let g=tH(c),h=tH(d);if(g===tI&&(g=tJ),h===tI&&(h=tJ),g!==h)return!1;switch(g){case"[object String]":return c.toString()===d.toString();case"[object Number]":{let a=c.valueOf(),b=d.valueOf();return a===b||Number.isNaN(a)&&Number.isNaN(b)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(c.valueOf(),d.valueOf());case"[object RegExp]":return c.source===d.source&&c.flags===d.flags;case"[object Function]":return c===d}let i=(e=e??new Map).get(c),j=e.get(d);if(null!=i&&null!=j)return i===d;e.set(c,d),e.set(d,c);try{switch(g){case"[object Map]":if(c.size!==d.size)return!1;for(let[b,g]of c.entries())if(!d.has(b)||!a(g,d.get(b),b,c,d,e,f))return!1;return!0;case"[object Set]":{if(c.size!==d.size)return!1;let b=Array.from(c.values()),g=Array.from(d.values());for(let h=0;h<b.length;h++){let i=b[h],j=g.findIndex(b=>a(i,b,void 0,c,d,e,f));if(-1===j)return!1;g.splice(j,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof Buffer&&Buffer.isBuffer(c)!==Buffer.isBuffer(d)||c.length!==d.length)return!1;for(let b=0;b<c.length;b++)if(!a(c[b],d[b],b,c,d,e,f))return!1;return!0;case"[object ArrayBuffer]":return c.byteLength===d.byteLength&&b(new Uint8Array(c),new Uint8Array(d),e,f);case"[object DataView]":return c.byteLength===d.byteLength&&c.byteOffset===d.byteOffset&&b(new Uint8Array(c),new Uint8Array(d),e,f);case"[object Error]":return c.name===d.name&&c.message===d.message;case tJ:{if(!(b(c.constructor,d.constructor,e,f)||tL(c)&&tL(d)))return!1;let g=[...Object.keys(c),...tG(c)],h=[...Object.keys(d),...tG(d)];if(g.length!==h.length)return!1;for(let b=0;b<g.length;b++){let h=g[b],i=c[h];if(!Object.hasOwn(d,h))return!1;let j=d[h];if(!a(i,j,h,c,d,e,f))return!1}return!0}default:return!1}}finally{e.delete(c),e.delete(d)}}(b,c,g,h)}(d,a[c],void 0,void 0,void 0,void 0,tK)})):this.values)),tS(this,"update",async(a,b)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:b});let c=tR(tR({},this.getData(a)),b);this.map.set(a,c),await this.persist()}),tS(this,"delete",async(a,b)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:b}),this.map.delete(a),this.addToRecentlyDeleted(a),await this.persist())}),this.logger=l6(b,this.name),this.storagePrefix=d,this.getKey=e}get context(){return l5(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(a){this.recentlyDeleted.push(a),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(a){await this.core.storage.setItem(this.storageKey,a)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(a){let b=this.map.get(a);if(!b){if(this.recentlyDeleted.includes(a)){let{message:b}=q2("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${a}`);throw this.logger.error(b),Error(b)}let{message:b}=q2("NO_MATCHING_KEY",`${this.name}: ${a}`);throw this.logger.error(b),Error(b)}return b}async persist(){await this.setDataStore(this.values)}async restore(){try{let a=await this.getDataStore();if(typeof a>"u"||!a.length)return;if(this.map.size){let{message:a}=q2("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(a){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(a)}}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}}var tU=Object.defineProperty,tV=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?tU(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class tW{constructor(a,b){this.core=a,this.logger=b,tV(this,"name","pairing"),tV(this,"version","0.3"),tV(this,"events",new cg.default),tV(this,"pairings"),tV(this,"initialized",!1),tV(this,"storagePrefix",rO),tV(this,"ignoredPayloadTypes",[1]),tV(this,"registeredMethods",[]),tV(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),tV(this,"register",({methods:a})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...a])]}),tV(this,"create",async a=>{this.isInitialized();let b=qq(),c=await this.core.crypto.setSymKey(b),d=mB(ic.FIVE_MINUTES),e={protocol:"irn"},f={topic:c,expiry:d,relay:e,active:!1,methods:a?.methods},g=qM({protocol:this.core.protocol,version:this.core.version,topic:c,symKey:b,relay:e,expiryTimestamp:d,methods:a?.methods});return this.events.emit(r8,f),this.core.expirer.set(c,d),await this.pairings.set(c,f),await this.core.relayer.subscribe(c,{transportType:a?.transportType,internal:a?.internal}),{topic:c,uri:g}}),tV(this,"pair",async a=>{let b;this.isInitialized();let c=this.core.eventClient.createEvent({properties:{topic:a?.uri,trace:["pairing_started"]}});this.isValidPair(a,c);let{topic:d,symKey:e,relay:f,expiryTimestamp:g,methods:h}=qL(a.uri);if(c.props.properties.topic=d,c.addTrace("pairing_uri_validation_success"),c.addTrace("pairing_uri_not_expired"),this.pairings.keys.includes(d)){if(b=this.pairings.get(d),c.addTrace("existing_pairing"),b.active)throw c.setError("active_pairing_already_exists"),Error(`Pairing already exists: ${d}. Please try again with a new connection URI.`);c.addTrace("pairing_not_expired")}let i=g||mB(ic.FIVE_MINUTES),j={topic:d,relay:f,expiry:i,active:!1,methods:h};this.core.expirer.set(d,i),await this.pairings.set(d,j),c.addTrace("store_new_pairing"),a.activatePairing&&await this.activate({topic:d}),this.events.emit(r8,j),c.addTrace("emit_inactive_pairing"),this.core.crypto.keychain.has(d)||await this.core.crypto.setSymKey(e,d),c.addTrace("subscribing_pairing_topic");try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{c.setError("no_internet_connection")}try{await this.core.relayer.subscribe(d,{relay:f})}catch(a){throw c.setError("subscribe_pairing_topic_failure"),a}return c.addTrace("subscribe_pairing_topic_success"),j}),tV(this,"activate",async({topic:a})=>{this.isInitialized();let b=mB(ic.FIVE_MINUTES);this.core.expirer.set(a,b),await this.pairings.update(a,{active:!0,expiry:b})}),tV(this,"ping",async a=>{this.isInitialized(),await this.isValidPing(a),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:b}=a;if(this.pairings.keys.includes(b)){let a=await this.sendRequest(b,"wc_pairingPing",{}),{done:c,resolve:d,reject:e}=mx();this.events.once(mD("pairing_ping",a),({error:a})=>{a?e(a):d()}),await c()}}),tV(this,"updateExpiry",async({topic:a,expiry:b})=>{this.isInitialized(),await this.pairings.update(a,{expiry:b})}),tV(this,"updateMetadata",async({topic:a,metadata:b})=>{this.isInitialized(),await this.pairings.update(a,{peerMetadata:b})}),tV(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),tV(this,"disconnect",async a=>{this.isInitialized(),await this.isValidDisconnect(a);let{topic:b}=a;this.pairings.keys.includes(b)&&(await this.sendRequest(b,"wc_pairingDelete",q3("USER_DISCONNECTED")),await this.deletePairing(b))}),tV(this,"formatUriFromPairing",a=>{this.isInitialized();let{topic:b,relay:c,expiry:d,methods:e}=a,f=this.core.crypto.keychain.get(b);return qM({protocol:this.core.protocol,version:this.core.version,topic:b,symKey:f,relay:c,expiryTimestamp:d,methods:e})}),tV(this,"sendRequest",async(a,b,c)=>{let d=(0,rK.formatJsonRpcRequest)(b,c),e=await this.core.crypto.encode(a,d),f=r7[b].req;return this.core.history.set(a,d),this.core.relayer.publish(a,e,f),d.id}),tV(this,"sendResult",async(a,b,c)=>{let d=(0,rK.formatJsonRpcResult)(a,c),e=await this.core.crypto.encode(b,d),f=r7[(await this.core.history.get(b,a)).request.method].res;await this.core.relayer.publish(b,e,f),await this.core.history.resolve(d)}),tV(this,"sendError",async(a,b,c)=>{let d=(0,rK.formatJsonRpcError)(a,c),e=await this.core.crypto.encode(b,d),f=(await this.core.history.get(b,a)).request.method,g=r7[f]?r7[f].res:r7.unregistered_method.res;await this.core.relayer.publish(b,e,g),await this.core.history.resolve(d)}),tV(this,"deletePairing",async(a,b)=>{await this.core.relayer.unsubscribe(a),await Promise.all([this.pairings.delete(a,q3("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(a),b?Promise.resolve():this.core.expirer.del(a)])}),tV(this,"cleanup",async()=>{let a=this.pairings.getAll().filter(a=>mC(a.expiry));await Promise.all(a.map(a=>this.deletePairing(a.topic)))}),tV(this,"onRelayEventRequest",async a=>{let{topic:b,payload:c}=a;switch(c.method){case"wc_pairingPing":return await this.onPairingPingRequest(b,c);case"wc_pairingDelete":return await this.onPairingDeleteRequest(b,c);default:return await this.onUnknownRpcMethodRequest(b,c)}}),tV(this,"onRelayEventResponse",async a=>{let{topic:b,payload:c}=a,d=(await this.core.history.get(b,c.id)).request.method;return"wc_pairingPing"===d?this.onPairingPingResponse(b,c):this.onUnknownRpcMethodResponse(d)}),tV(this,"onPairingPingRequest",async(a,b)=>{let{id:c}=b;try{this.isValidPing({topic:a}),await this.sendResult(c,a,!0),this.events.emit("pairing_ping",{id:c,topic:a})}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),tV(this,"onPairingPingResponse",(a,b)=>{let{id:c}=b;setTimeout(()=>{(0,rL.isJsonRpcResult)(b)?this.events.emit(mD("pairing_ping",c),{}):(0,rL.isJsonRpcError)(b)&&this.events.emit(mD("pairing_ping",c),{error:b.error})},500)}),tV(this,"onPairingDeleteRequest",async(a,b)=>{let{id:c}=b;try{this.isValidDisconnect({topic:a}),await this.deletePairing(a),this.events.emit(r9,{id:c,topic:a})}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),tV(this,"onUnknownRpcMethodRequest",async(a,b)=>{let{id:c,method:d}=b;try{if(this.registeredMethods.includes(d))return;let b=q3("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,a,b),this.logger.error(b)}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),tV(this,"onUnknownRpcMethodResponse",a=>{this.registeredMethods.includes(a)||this.logger.error(q3("WC_METHOD_UNSUPPORTED",a))}),tV(this,"isValidPair",(a,b)=>{var c;if(!re(a)){let{message:c}=q2("MISSING_OR_INVALID",`pair() params: ${a}`);throw b.setError(sj),Error(c)}if(!function(a){function b(a){try{return"u">typeof new URL(a)}catch{return!1}}try{if(q7(a,!1)){if(b(a))return!0;let c=mK(a);return b(c)}}catch{}return!1}(a.uri)){let{message:c}=q2("MISSING_OR_INVALID",`pair() uri: ${a.uri}`);throw b.setError(sj),Error(c)}let d=qL(a?.uri);if(!(null!=(c=d?.relay)&&c.protocol)){let{message:a}=q2("MISSING_OR_INVALID","pair() uri#relay-protocol");throw b.setError(sj),Error(a)}if(!(null!=d&&d.symKey)){let{message:a}=q2("MISSING_OR_INVALID","pair() uri#symKey");throw b.setError(sj),Error(a)}if(null!=d&&d.expiryTimestamp&&(0,ic.toMiliseconds)(d?.expiryTimestamp)<Date.now()){b.setError("pairing_expired");let{message:a}=q2("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(a)}}),tV(this,"isValidPing",async a=>{if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`ping() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidPairingTopic(b)}),tV(this,"isValidDisconnect",async a=>{if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`disconnect() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidPairingTopic(b)}),tV(this,"isValidPairingTopic",async a=>{if(!q7(a,!1)){let{message:b}=q2("MISSING_OR_INVALID",`pairing topic should be a string: ${a}`);throw Error(b)}if(!this.pairings.keys.includes(a)){let{message:b}=q2("NO_MATCHING_KEY",`pairing topic doesn't exist: ${a}`);throw Error(b)}if(mC(this.pairings.get(a).expiry)){await this.deletePairing(a);let{message:b}=q2("EXPIRED",`pairing topic: ${a}`);throw Error(b)}}),this.core=a,this.logger=l6(b,this.name),this.pairings=new tT(this.core,this.logger,this.name,this.storagePrefix)}get context(){return l5(this.logger)}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}registerRelayerEvents(){this.core.relayer.on(rU,async a=>{let{topic:b,message:c,transportType:d}=a;if(this.pairings.keys.includes(b)&&d!==r1&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(c)))try{let a=await this.core.crypto.decode(b,c);(0,rL.isJsonRpcRequest)(a)?(this.core.history.set(b,a),await this.onRelayEventRequest({topic:b,payload:a})):(0,rL.isJsonRpcResponse)(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:b,payload:a}),this.core.history.delete(b,a.id)),await this.core.relayer.messages.ack(b,c)}catch(a){this.logger.error(a)}})}registerExpirerEvents(){this.core.expirer.on(sf,async a=>{let{topic:b}=mA(a.target);b&&this.pairings.keys.includes(b)&&(await this.deletePairing(b,!0),this.events.emit("pairing_expire",{topic:b}))})}}var tX=Object.defineProperty,tY=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?tX(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class tZ extends rv{constructor(a,b){super(a,b),this.core=a,this.logger=b,tY(this,"records",new Map),tY(this,"events",new cg.EventEmitter),tY(this,"name","history"),tY(this,"version","0.3"),tY(this,"cached",[]),tY(this,"initialized",!1),tY(this,"storagePrefix",rO),tY(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>this.records.set(a.id,a)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),tY(this,"set",(a,b,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:a,request:b,chainId:c}),this.records.has(b.id))return;let d={id:b.id,topic:a,request:{method:b.method,params:b.params||null},chainId:c,expiry:mB(ic.THIRTY_DAYS)};this.records.set(d.id,d),this.persist(),this.events.emit(sa,d)}),tY(this,"resolve",async a=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:a}),!this.records.has(a.id))return;let b=await this.getRecord(a.id);typeof b.response>"u"&&(b.response=(0,rL.isJsonRpcError)(a)?{error:a.error}:{result:a.result},this.records.set(b.id,b),this.persist(),this.events.emit(sb,b))}),tY(this,"get",async(a,b)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:a,id:b}),await this.getRecord(b))),tY(this,"delete",(a,b)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:b}),this.values.forEach(c=>{c.topic===a&&("u">typeof b&&c.id!==b||(this.records.delete(c.id),this.events.emit(sc,c)))}),this.persist()}),tY(this,"exists",async(a,b)=>(this.isInitialized(),!!this.records.has(b)&&(await this.getRecord(b)).topic===a)),tY(this,"on",(a,b)=>{this.events.on(a,b)}),tY(this,"once",(a,b)=>{this.events.once(a,b)}),tY(this,"off",(a,b)=>{this.events.off(a,b)}),tY(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.logger=l6(b,this.name)}get context(){return l5(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let a=[];return this.values.forEach(b=>{if("u">typeof b.response)return;let c={topic:b.topic,request:(0,rK.formatJsonRpcRequest)(b.request.method,b.request.params,b.id),chainId:b.chainId};return a.push(c)}),a}async setJsonRpcRecords(a){await this.core.storage.setItem(this.storageKey,a)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(a){this.isInitialized();let b=this.records.get(a);if(!b){let{message:b}=q2("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit("history_sync")}async restore(){try{let a=await this.getJsonRpcRecords();if(typeof a>"u"||!a.length)return;if(this.records.size){let{message:a}=q2("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(a){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(a)}}registerEventListeners(){this.events.on(sa,a=>{this.logger.info(`Emitting ${sa}`),this.logger.debug({type:"event",event:sa,record:a})}),this.events.on(sb,a=>{this.logger.info(`Emitting ${sb}`),this.logger.debug({type:"event",event:sb,record:a})}),this.events.on(sc,a=>{this.logger.info(`Emitting ${sc}`),this.logger.debug({type:"event",event:sc,record:a})}),this.core.heartbeat.on(ro.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let a=!1;this.records.forEach(b=>{(0,ic.toMiliseconds)(b.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${b.id}`),this.records.delete(b.id),this.events.emit(sc,b,!1),a=!0)}),a&&this.persist()}catch(a){this.logger.warn(a)}}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}}var t$=Object.defineProperty,t_=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?t$(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class t0 extends rB{constructor(a,b){super(a,b),this.core=a,this.logger=b,t_(this,"expirations",new Map),t_(this,"events",new cg.EventEmitter),t_(this,"name","expirer"),t_(this,"version","0.3"),t_(this,"cached",[]),t_(this,"initialized",!1),t_(this,"storagePrefix",rO),t_(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>this.expirations.set(a.target,a)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),t_(this,"has",a=>{try{let b=this.formatTarget(a);return"u">typeof this.getExpiration(b)}catch{return!1}}),t_(this,"set",(a,b)=>{this.isInitialized();let c=this.formatTarget(a),d={target:c,expiry:b};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(sd,{target:c,expiration:d})}),t_(this,"get",a=>{this.isInitialized();let b=this.formatTarget(a);return this.getExpiration(b)}),t_(this,"del",a=>{if(this.isInitialized(),this.has(a)){let b=this.formatTarget(a),c=this.getExpiration(b);this.expirations.delete(b),this.events.emit(se,{target:b,expiration:c})}}),t_(this,"on",(a,b)=>{this.events.on(a,b)}),t_(this,"once",(a,b)=>{this.events.once(a,b)}),t_(this,"off",(a,b)=>{this.events.off(a,b)}),t_(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.logger=l6(b,this.name)}get context(){return l5(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(a){if("string"==typeof a)return mz("topic",a);if("number"==typeof a)return mz("id",a);let{message:b}=q2("UNKNOWN_TYPE",`Target type: ${typeof a}`);throw Error(b)}async setExpirations(a){await this.core.storage.setItem(this.storageKey,a)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit("expirer_sync")}async restore(){try{let a=await this.getExpirations();if(typeof a>"u"||!a.length)return;if(this.expirations.size){let{message:a}=q2("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(a){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(a)}}getExpiration(a){let b=this.expirations.get(a);if(!b){let{message:b}=q2("NO_MATCHING_KEY",`${this.name}: ${a}`);throw this.logger.warn(b),Error(b)}return b}checkExpiry(a,b){let{expiry:c}=b;(0,ic.toMiliseconds)(c)-Date.now()<=0&&this.expire(a,b)}expire(a,b){this.expirations.delete(a),this.events.emit(sf,{target:a,expiration:b})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((a,b)=>this.checkExpiry(b,a))}registerEventListeners(){this.core.heartbeat.on(ro.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(sd,a=>{this.logger.info(`Emitting ${sd}`),this.logger.debug({type:"event",event:sd,data:a}),this.persist()}),this.events.on(sf,a=>{this.logger.info(`Emitting ${sf}`),this.logger.debug({type:"event",event:sf,data:a}),this.persist()}),this.events.on(se,a=>{this.logger.info(`Emitting ${se}`),this.logger.debug({type:"event",event:se,data:a}),this.persist()})}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}}var t1=Object.defineProperty,t2=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?t1(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class t3 extends rC{constructor(a,b,c){super(a,b,c),this.core=a,this.logger=b,this.store=c,t2(this,"name","verify-api"),t2(this,"abortController"),t2(this,"isDevEnv"),t2(this,"verifyUrlV3",sh),t2(this,"storagePrefix",rO),t2(this,"version",2),t2(this,"publicKey"),t2(this,"fetchPromise"),t2(this,"init",async()=>{var a;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,ic.toMiliseconds)(null==(a=this.publicKey)?void 0:a.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),t2(this,"register",async a=>{if(!mp()||this.isDevEnv)return;let b=window.location.origin,{id:c,decryptedId:d}=a,e=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${b}&id=${c}&decryptedId=${d}`;try{let a=(0,id.getDocument)(),b=this.startAbortTimer(5*ic.ONE_SECOND),d=await new Promise((d,f)=>{let g=()=>{window.removeEventListener("message",i),a.body.removeChild(h),f("attestation aborted")};this.abortController.signal.addEventListener("abort",g);let h=a.createElement("iframe");h.src=e,h.style.display="none",h.addEventListener("error",g,{signal:this.abortController.signal});let i=e=>{if(e.data&&"string"==typeof e.data)try{let f=JSON.parse(e.data);if("verify_attestation"===f.type){if((0,lH.decodeJWT)(f.attestation).payload.id!==c)return;clearInterval(b),a.body.removeChild(h),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",i),d(null===f.attestation?"":f.attestation)}}catch(a){this.logger.warn(a)}};a.body.appendChild(h),window.addEventListener("message",i,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(a){this.logger.warn(a)}return""}),t2(this,"resolve",async a=>{if(this.isDevEnv)return"";let{attestationId:b,hash:c,encryptedId:d}=a;if(""===b)return void this.logger.debug("resolve: attestationId is empty, skipping");if(b){if((0,lH.decodeJWT)(b).payload.id!==d)return;let a=await this.isValidJwtAttestation(b);if(a)return a.isVerified?a:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!c)return;let e=this.getVerifyUrl(a?.verifyUrl);return this.fetchAttestation(c,e)}),t2(this,"fetchAttestation",async(a,b)=>{this.logger.debug(`resolving attestation: ${a} from url: ${b}`);let c=this.startAbortTimer(5*ic.ONE_SECOND),d=await fetch(`${b}/attestation/${a}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(c),200===d.status?await d.json():void 0}),t2(this,"getVerifyUrl",a=>{let b=a||sg;return si.includes(b)||(this.logger.info(`verify url: ${b}, not included in trusted list, assigning default: ${sg}`),b=sg),b}),t2(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let a=this.startAbortTimer(ic.FIVE_SECONDS),b=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(a),await b.json()}catch(a){this.logger.warn(a)}}),t2(this,"persistPublicKey",async a=>{this.logger.debug(a,"persisting public key to local storage"),await this.store.setItem(this.storeKey,a),this.publicKey=a}),t2(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),t2(this,"isValidJwtAttestation",async a=>{let b=await this.getPublicKey();try{if(b)return this.validateAttestation(a,b)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}let c=await this.fetchAndPersistPublicKey();try{if(c)return this.validateAttestation(a,c)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),t2(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),t2(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{let b=await this.fetchPublicKey();b&&(await this.persistPublicKey(b),a(b))});let a=await this.fetchPromise;return this.fetchPromise=void 0,a}),t2(this,"validateAttestation",(a,b)=>{let c=function(a,b){let c,d,[e,f,g]=a.split("."),h=Buffer.from(qw(g),"base64");if(64!==h.length)throw Error("Invalid signature length");let i=h.slice(0,32),j=h.slice(32,64),k=nX(`${e}.${f}`),l=(c=Buffer.from(b.x,"base64"),d=Buffer.from(b.y,"base64"),(0,lK.concat)([new Uint8Array([4]),c,d]));if(!qk.verify((0,lK.concat)([i,j]),k,l))throw Error("Invalid signature");return(0,lH.decodeJWT)(a).payload}(a,b.publicKey),d={hasExpired:(0,ic.toMiliseconds)(c.exp)<Date.now(),payload:c};if(d.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:d.payload.origin,isScam:d.payload.isScam,isVerified:d.payload.isVerified}}),this.logger=l6(b,this.name),this.abortController=new AbortController,this.isDevEnv=mJ(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return l5(this.logger)}startAbortTimer(a){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,ic.toMiliseconds)(a))}}var t4=Object.defineProperty,t5=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?t4(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class t6 extends rD{constructor(a,b){super(a,b),this.projectId=a,this.logger=b,t5(this,"context","echo"),t5(this,"registerDeviceToken",async a=>{let{clientId:b,token:c,notificationType:d,enableEncrypted:e=!1}=a,f=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:b,type:d,token:c,always_raw:e})})}),this.logger=l6(b,this.context)}}var t7=Object.defineProperty,t8=Object.getOwnPropertySymbols,t9=Object.prototype.hasOwnProperty,ua=Object.prototype.propertyIsEnumerable,ub=(a,b,c)=>b in a?t7(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,uc=(a,b)=>{for(var c in b||(b={}))t9.call(b,c)&&ub(a,c,b[c]);if(t8)for(var c of t8(b))ua.call(b,c)&&ub(a,c,b[c]);return a},ud=(a,b,c)=>ub(a,"symbol"!=typeof b?b+"":b,c);class ue extends rE{constructor(a,b,c=!0){super(a,b,c),this.core=a,this.logger=b,ud(this,"context","event-client"),ud(this,"storagePrefix",rO),ud(this,"storageVersion",.1),ud(this,"events",new Map),ud(this,"shouldPersist",!1),ud(this,"init",async()=>{if(!mJ())try{let a={eventId:mI(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:mt(this.core.relayer.protocol,this.core.relayer.version,r0)}}};await this.sendEvent([a])}catch(a){this.logger.warn(a)}}),ud(this,"createEvent",a=>{let{event:b="ERROR",type:c="",properties:{topic:d,trace:e}}=a,f=mI(),g=this.core.projectId||"",h=uc({eventId:f,timestamp:Date.now(),props:{event:b,type:c,properties:{topic:d,trace:e}},bundleId:g,domain:this.getAppDomain()},this.setMethods(f));return this.telemetryEnabled&&(this.events.set(f,h),this.shouldPersist=!0),h}),ud(this,"getEvent",a=>{let{eventId:b,topic:c}=a;if(b)return this.events.get(b);let d=Array.from(this.events.values()).find(a=>a.props.properties.topic===c);if(d)return uc(uc({},d),this.setMethods(d.eventId))}),ud(this,"deleteEvent",a=>{let{eventId:b}=a;this.events.delete(b),this.shouldPersist=!0}),ud(this,"setEventListeners",()=>{this.core.heartbeat.on(ro.HEARTBEAT_EVENTS.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(a=>{(0,ic.fromMiliseconds)(Date.now())-(0,ic.fromMiliseconds)(a.timestamp)>86400&&(this.events.delete(a.eventId),this.shouldPersist=!0)})})}),ud(this,"setMethods",a=>({addTrace:b=>this.addTrace(a,b),setError:b=>this.setError(a,b)})),ud(this,"addTrace",(a,b)=>{let c=this.events.get(a);c&&(c.props.properties.trace.push(b),this.events.set(a,c),this.shouldPersist=!0)}),ud(this,"setError",(a,b)=>{let c=this.events.get(a);c&&(c.props.type=b,c.timestamp=Date.now(),this.events.set(a,c),this.shouldPersist=!0)}),ud(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),ud(this,"restore",async()=>{try{let a=await this.core.storage.getItem(this.storageKey)||[];if(!a.length)return;a.forEach(a=>{this.events.set(a.eventId,uc(uc({},a),this.setMethods(a.eventId)))})}catch(a){this.logger.warn(a)}}),ud(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let a=[];for(let[b,c]of this.events)c.props.type&&a.push(c);if(0!==a.length)try{if((await this.sendEvent(a)).ok)for(let b of a)this.events.delete(b.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}}),ud(this,"sendEvent",async a=>{let b=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${r0}${b}`,{method:"POST",body:JSON.stringify(a)})}),ud(this,"getAppDomain",()=>ms().url),this.logger=l6(b,this.context),this.telemetryEnabled=c,c?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var uf=Object.defineProperty,ug=Object.getOwnPropertySymbols,uh=Object.prototype.hasOwnProperty,ui=Object.prototype.propertyIsEnumerable,uj=(a,b,c)=>b in a?uf(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,uk=(a,b)=>{for(var c in b||(b={}))uh.call(b,c)&&uj(a,c,b[c]);if(ug)for(var c of ug(b))ui.call(b,c)&&uj(a,c,b[c]);return a},ul=(a,b,c)=>uj(a,"symbol"!=typeof b?b+"":b,c);class um extends rt{constructor(a){var b;super(a),ul(this,"protocol","wc"),ul(this,"version",2),ul(this,"name",rN),ul(this,"relayUrl"),ul(this,"projectId"),ul(this,"customStoragePrefix"),ul(this,"events",new cg.EventEmitter),ul(this,"logger"),ul(this,"heartbeat"),ul(this,"relayer"),ul(this,"crypto"),ul(this,"storage"),ul(this,"history"),ul(this,"expirer"),ul(this,"pairing"),ul(this,"verify"),ul(this,"echoClient"),ul(this,"linkModeSupportedApps"),ul(this,"eventClient"),ul(this,"initialized",!1),ul(this,"logChunkController"),ul(this,"on",(a,b)=>this.events.on(a,b)),ul(this,"once",(a,b)=>this.events.once(a,b)),ul(this,"off",(a,b)=>this.events.off(a,b)),ul(this,"removeListener",(a,b)=>this.events.removeListener(a,b)),ul(this,"dispatchEnvelope",({topic:a,message:b,sessionExists:c})=>{if(!a||!b)return;let d={topic:a,message:b,publishedAt:Date.now(),transportType:r1};this.relayer.onLinkMessageEvent(d,{sessionExists:c})});const c=this.getGlobalCore(a?.customStoragePrefix);if(c)try{return this.customStoragePrefix=c.customStoragePrefix,this.logger=c.logger,this.heartbeat=c.heartbeat,this.crypto=c.crypto,this.history=c.history,this.expirer=c.expirer,this.storage=c.storage,this.relayer=c.relayer,this.pairing=c.pairing,this.verify=c.verify,this.echoClient=c.echoClient,this.linkModeSupportedApps=c.linkModeSupportedApps,this.eventClient=c.eventClient,this.initialized=c.initialized,this.logChunkController=c.logChunkController,c}catch(a){console.warn("Failed to copy global core",a)}this.projectId=a?.projectId,this.relayUrl=a?.relayUrl||rT,this.customStoragePrefix=null!=a&&a.customStoragePrefix?`:${a.customStoragePrefix}`:"";const{logger:d,chunkLoggerController:e}=l7({opts:function(a){return l$(l4({},a),l_({level:a?.level||"info"}))}({level:"string"==typeof a?.logger&&a.logger?a.logger:"error",name:rN}),maxSizeInBytes:a?.maxLogBlobSizeInBytes,loggerOverride:a?.logger});this.logChunkController=e,null!=(b=this.logChunkController)&&b.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,b;null!=(a=this.logChunkController)&&a.downloadLogsBlobInBrowser&&(null==(b=this.logChunkController)||b.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=l6(d,this.name),this.heartbeat=new ro.HeartBeat,this.crypto=new s1(this,this.logger,a?.keychain),this.history=new tZ(this,this.logger),this.expirer=new t0(this,this.logger),this.storage=null!=a&&a.storage?a.storage:new rp.default(uk(uk({},rP),a?.storageOptions)),this.relayer=new tF({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new tW(this,this.logger),this.verify=new t3(this,this.logger,this.storage),this.echoClient=new t6(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new ue(this,this.logger,a?.telemetryEnabled),this.setGlobalCore(this)}static async init(a){let b=new um(a);await b.initialize();let c=await b.crypto.getClientId();return await b.storage.setItem("WALLETCONNECT_CLIENT_ID",c),b}get context(){return l5(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var a;return null==(a=this.logChunkController)?void 0:a.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(a){this.linkModeSupportedApps.includes(a)||(this.linkModeSupportedApps.push(a),await this.storage.setItem(r4,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(r4)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(a){throw this.logger.warn(a,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(a.message),a}}getGlobalCore(a=""){try{if(this.isGlobalCoreDisabled())return;let b=`_walletConnectCore_${a}`,c=`${b}_count`;return globalThis[c]=(globalThis[c]||0)+1,globalThis[c]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[c]} times.`),globalThis[b]}catch(a){console.warn("Failed to get global WalletConnect core",a);return}}setGlobalCore(a){var b;try{if(this.isGlobalCoreDisabled())return;let c=`_walletConnectCore_${(null==(b=a.opts)?void 0:b.customStoragePrefix)||""}`;globalThis[c]=a}catch(a){console.warn("Failed to set global WalletConnect core",a)}}isGlobalCoreDisabled(){try{return"u">typeof process&&"true"===process.env.DISABLE_GLOBAL_CORE}catch{return!0}}}let un="client",uo=`wc@2:${un}:`,up="WALLETCONNECT_DEEPLINK_CHOICE",uq=(ic.THIRTY_DAYS,"Proposal expired"),ur=ic.SEVEN_DAYS,us={wc_sessionPropose:{req:{ttl:ic.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ic.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ic.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ic.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ic.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ic.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ic.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ic.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ic.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ic.ONE_DAY,prompt:!1,tag:1114},res:{ttl:ic.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:ic.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:ic.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:ic.FIVE_MINUTES,prompt:!1,tag:1119}}},ut={min:ic.FIVE_MINUTES,max:ic.SEVEN_DAYS},uu="IDLE",uv="ACTIVE",uw={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},ux=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],uy="wc@1.5:auth:",uz=`${uy}:PUB_KEY`;var uA=Object.defineProperty,uB=Object.defineProperties,uC=Object.getOwnPropertyDescriptors,uD=Object.getOwnPropertySymbols,uE=Object.prototype.hasOwnProperty,uF=Object.prototype.propertyIsEnumerable,uG=(a,b,c)=>b in a?uA(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,uH=(a,b)=>{for(var c in b||(b={}))uE.call(b,c)&&uG(a,c,b[c]);if(uD)for(var c of uD(b))uF.call(b,c)&&uG(a,c,b[c]);return a},uI=(a,b,c)=>uG(a,"symbol"!=typeof b?b+"":b,c);class uJ extends rI{constructor(b){super(b),uI(this,"name","engine"),uI(this,"events",new cg.default),uI(this,"initialized",!1),uI(this,"requestQueue",{state:uu,queue:[]}),uI(this,"sessionRequestQueue",{state:uu,queue:[]}),uI(this,"emittedSessionRequests",new mL({limit:500})),uI(this,"requestQueueDelay",ic.ONE_SECOND),uI(this,"expectedPairingMethodMap",new Map),uI(this,"recentlyDeletedMap",new Map),uI(this,"recentlyDeletedLimit",200),uI(this,"relayMessageCache",[]),uI(this,"pendingSessions",new Map),uI(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(us)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,ic.toMiliseconds)(this.requestQueueDelay)))}),uI(this,"connect",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let b=uB(uH({},a),uC({requiredNamespaces:a.requiredNamespaces||{},optionalNamespaces:a.optionalNamespaces||{}}));await this.isValidConnect(b),b.optionalNamespaces=function(a,b){var c,d,e,f,g,h;let i=q$(a),j=q$(b),k={};for(let a of Object.keys(i).concat(Object.keys(j)))k[a]={chains:mE(null==(c=i[a])?void 0:c.chains,null==(d=j[a])?void 0:d.chains),methods:mE(null==(e=i[a])?void 0:e.methods,null==(f=j[a])?void 0:f.methods),events:mE(null==(g=i[a])?void 0:g.events,null==(h=j[a])?void 0:h.events)};return k}(b.requiredNamespaces,b.optionalNamespaces),b.requiredNamespaces={};let{pairingTopic:c,requiredNamespaces:d,optionalNamespaces:e,sessionProperties:f,scopedProperties:g,relays:h}=b,i=c,j,k=!1;try{if(i){let a=this.client.core.pairing.pairings.get(i);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),k=a.active}}catch(a){throw this.client.logger.error(`connect() -> pairing.get(${i}) failed`),a}if(!i||!k){let{topic:a,uri:b}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});i=a,j=b}if(!i){let{message:a}=q2("NO_MATCHING_KEY",`connect() pairing topic: ${i}`);throw Error(a)}let l=await this.client.core.crypto.generateKeyPair(),m=us.wc_sessionPropose.req.ttl||ic.FIVE_MINUTES,o=mB(m),p=uB(uH(uH({requiredNamespaces:d,optionalNamespaces:e,relays:h??[{protocol:"irn"}],proposer:{publicKey:l,metadata:this.client.metadata},expiryTimestamp:o,pairingTopic:i},f&&{sessionProperties:f}),g&&{scopedProperties:g}),uC({id:(0,rK.payloadId)()})),q=mD("session_connect",p.id),{reject:r,resolve:s,done:t}=mx(m,uq),u=({id:a})=>{a===p.id&&(this.client.events.off("proposal_expire",u),this.pendingSessions.delete(p.id),this.events.emit(q,{error:{message:uq,code:0}}))};return this.client.events.on("proposal_expire",u),this.events.once(q,({error:a,session:b})=>{this.client.events.off("proposal_expire",u),a?r(a):b&&s(b)}),await this.sendProposeSession({proposal:p,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:p.id}}}),await this.setProposal(p.id,p),{uri:j,approval:t}}),uI(this,"pair",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(a)}catch(a){throw this.client.logger.error("pair() failed"),a}}),uI(this,"approve",async a=>{var b,c,d;let e=this.client.core.eventClient.createEvent({properties:{topic:null==(b=a?.id)?void 0:b.toString(),trace:[sk]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(a){throw e.setError("no_internet_connection"),a}try{await this.isValidProposalId(a?.id)}catch(b){throw this.client.logger.error(`approve() -> proposal.get(${a?.id}) failed`),e.setError("proposal_not_found"),b}try{await this.isValidApprove(a)}catch(a){throw this.client.logger.error("approve() -> isValidApprove() failed"),e.setError("session_approve_namespace_validation_failure"),a}let{id:f,relayProtocol:g,namespaces:h,sessionProperties:i,scopedProperties:j,sessionConfig:k}=a,l=this.client.proposal.get(f);this.client.core.eventClient.deleteEvent({eventId:e.eventId});let{pairingTopic:m,proposer:o,requiredNamespaces:p,optionalNamespaces:q}=l,r=null==(c=this.client.core.eventClient)?void 0:c.getEvent({topic:m});r||(r=null==(d=this.client.core.eventClient)?void 0:d.createEvent({type:sk,properties:{topic:m,trace:[sk,"session_namespaces_validation_success"]}}));let s=await this.client.core.crypto.generateKeyPair(),t=o.publicKey,u=await this.client.core.crypto.generateSharedKey(s,t),v=uH(uH(uH({relay:{protocol:g??"irn"},namespaces:h,controller:{publicKey:s,metadata:this.client.metadata},expiry:mB(ur)},i&&{sessionProperties:i}),j&&{scopedProperties:j}),k&&{sessionConfig:k});r.addTrace("subscribing_session_topic");try{await this.client.core.relayer.subscribe(u,{transportType:r2,internal:{skipSubscribe:!0}})}catch(a){throw r.setError("subscribe_session_topic_failure"),a}r.addTrace("subscribe_session_topic_success");let w=uB(uH({},v),uC({topic:u,requiredNamespaces:p,optionalNamespaces:q,pairingTopic:m,acknowledged:!1,self:v.controller,peer:{publicKey:o.publicKey,metadata:o.metadata},controller:s,transportType:r2}));await this.client.session.set(u,w),r.addTrace("store_session");try{await this.sendApproveSession({sessionTopic:u,proposal:l,pairingProposalResponse:{relay:{protocol:g??"irn"},responderPublicKey:s},sessionSettleRequest:v,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:f}}}),r.addTrace("session_approve_publish_success")}catch(a){throw this.client.logger.error(a),this.client.session.delete(u,q3("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(u),a}return this.client.core.eventClient.deleteEvent({eventId:r.eventId}),await this.client.core.pairing.updateMetadata({topic:m,metadata:o.metadata}),await this.deleteProposal(f),await this.client.core.pairing.activate({topic:m}),await this.setExpiry(u,mB(ur)),{topic:u,acknowledged:()=>Promise.resolve(this.client.session.get(u))}}),uI(this,"reject",async a=>{let b;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(a)}catch(a){throw this.client.logger.error("reject() -> isValidReject() failed"),a}let{id:c,reason:d}=a;try{b=this.client.proposal.get(c).pairingTopic}catch(a){throw this.client.logger.error(`reject() -> proposal.get(${c}) failed`),a}b&&await this.sendError({id:c,topic:b,error:d,rpcOpts:us.wc_sessionPropose.reject}),await this.deleteProposal(c)}),uI(this,"update",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(a)}catch(a){throw this.client.logger.error("update() -> isValidUpdate() failed"),a}let{topic:b,namespaces:c}=a,{done:d,resolve:e,reject:f}=mx(),g=(0,rK.payloadId)(),h=(0,rK.getBigIntRpcId)().toString(),i=this.client.session.get(b).namespaces;return this.events.once(mD("session_update",g),({error:a})=>{a?f(a):e()}),await this.client.session.update(b,{namespaces:c}),await this.sendRequest({topic:b,method:"wc_sessionUpdate",params:{namespaces:c},throwOnFailedPublish:!0,clientRpcId:g,relayRpcId:h}).catch(a=>{this.client.logger.error(a),this.client.session.update(b,{namespaces:i}),f(a)}),{acknowledged:d}}),uI(this,"extend",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(a)}catch(a){throw this.client.logger.error("extend() -> isValidExtend() failed"),a}let{topic:b}=a,c=(0,rK.payloadId)(),{done:d,resolve:e,reject:f}=mx();return this.events.once(mD("session_extend",c),({error:a})=>{a?f(a):e()}),await this.setExpiry(b,mB(ur)),this.sendRequest({topic:b,method:"wc_sessionExtend",params:{},clientRpcId:c,throwOnFailedPublish:!0}).catch(a=>{f(a)}),{acknowledged:d}}),uI(this,"request",async a=>{this.isInitialized();try{await this.isValidRequest(a)}catch(a){throw this.client.logger.error("request() -> isValidRequest() failed"),a}let{chainId:b,request:c,topic:d,expiry:e=us.wc_sessionRequest.req.ttl}=a,f=this.client.session.get(d);f?.transportType===r2&&await this.confirmOnlineStateOrThrow();let g=(0,rK.payloadId)(),h=(0,rK.getBigIntRpcId)().toString(),{done:i,resolve:j,reject:k}=mx(e,"Request expired. Please try again.");this.events.once(mD("session_request",g),({error:a,result:b})=>{a?k(a):j(b)});let l="wc_sessionRequest",m=this.getAppLinkIfEnabled(f.peer.metadata,f.transportType);if(m)return await this.sendRequest({clientRpcId:g,relayRpcId:h,topic:d,method:l,params:{request:uB(uH({},c),uC({expiryTimestamp:mB(e)})),chainId:b},expiry:e,throwOnFailedPublish:!0,appLink:m}).catch(a=>k(a)),this.client.events.emit("session_request_sent",{topic:d,request:c,chainId:b,id:g}),await i();let o={request:uB(uH({},c),uC({expiryTimestamp:mB(e)})),chainId:b};return await Promise.all([new Promise(async a=>{await this.sendRequest({clientRpcId:g,relayRpcId:h,topic:d,method:l,params:o,expiry:e,throwOnFailedPublish:!0,tvf:this.getTVFParams(g,o)}).catch(a=>k(a)),this.client.events.emit("session_request_sent",{topic:d,request:c,chainId:b,id:g}),a()}),new Promise(async a=>{var b;if(!(null!=(b=f.sessionConfig)&&b.disableDeepLink)){let a=await mG(this.client.core.storage,up);await mF({id:g,topic:d,wcDeepLink:a})}a()}),i()]).then(a=>a[2])}),uI(this,"respond",async a=>{var b,c;this.isInitialized();let d=this.client.core.eventClient.createEvent({properties:{topic:a?.topic||(null==(c=null==(b=a?.response)?void 0:b.id)?void 0:c.toString()),trace:["session_request_response_started"]}});try{await this.isValidRespond(a)}catch(a){throw d.addTrace(a?.message),d.setError("session_request_response_validation_failure"),a}d.addTrace("session_request_response_validation_success");let{topic:e,response:f}=a,{id:g}=f,h=this.client.session.get(e);h.transportType===r2&&await this.confirmOnlineStateOrThrow();let i=this.getAppLinkIfEnabled(h.peer.metadata,h.transportType);try{d.addTrace("session_request_response_publish_started"),(0,rL.isJsonRpcResult)(f)?await this.sendResult({id:g,topic:e,result:f.result,throwOnFailedPublish:!0,appLink:i}):(0,rL.isJsonRpcError)(f)&&await this.sendError({id:g,topic:e,error:f.error,appLink:i}),this.cleanupAfterResponse(a)}catch(a){throw d.addTrace(a?.message),d.setError("session_request_response_publish_failure"),a}}),uI(this,"ping",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(a)}catch(a){throw this.client.logger.error("ping() -> isValidPing() failed"),a}let{topic:b}=a;if(this.client.session.keys.includes(b)){let a=(0,rK.payloadId)(),c=(0,rK.getBigIntRpcId)().toString(),{done:d,resolve:e,reject:f}=mx();this.events.once(mD("session_ping",a),({error:a})=>{a?f(a):e()}),await Promise.all([this.sendRequest({topic:b,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:c}),d()])}else this.client.core.pairing.pairings.keys.includes(b)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:b}))}),uI(this,"emit",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(a);let{topic:b,event:c,chainId:d}=a,e=(0,rK.getBigIntRpcId)().toString(),f=(0,rK.payloadId)();await this.sendRequest({topic:b,method:"wc_sessionEvent",params:{event:c,chainId:d},throwOnFailedPublish:!0,relayRpcId:e,clientRpcId:f})}),uI(this,"disconnect",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(a);let{topic:b}=a;if(this.client.session.keys.includes(b))await this.sendRequest({topic:b,method:"wc_sessionDelete",params:q3("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:b,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(b))await this.client.core.pairing.disconnect({topic:b});else{let{message:a}=q2("MISMATCHED_TOPIC",`Session or pairing topic not found: ${b}`);throw Error(a)}}),uI(this,"find",a=>(this.isInitialized(),this.client.session.getAll().filter(b=>(function(a,b){let{requiredNamespaces:c}=b,d=Object.keys(a.namespaces),e=Object.keys(c),f=!0;return!!mu(e,d)&&(d.forEach(b=>{let{accounts:d,methods:e,events:g}=a.namespaces[b],h=qX(d),i=c[b];mu(ma(b,i),h)&&mu(i.methods,e)&&mu(i.events,g)||(f=!1)}),f)})(b,a)))),uI(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),uI(this,"authenticate",async(a,b)=>{var c,d,e,f,g;let h;this.isInitialized(),this.isValidAuthenticate(a);let i=b&&this.client.core.linkModeSupportedApps.includes(b)&&(null==(c=this.client.metadata.redirect)?void 0:c.linkMode),j=i?r1:r2;j===r2&&await this.confirmOnlineStateOrThrow();let{chains:k,statement:l="",uri:m,domain:o,nonce:p,type:q,exp:r,nbf:s,methods:t=[],expiry:u}=a,v=[...a.resources||[]],{topic:w,uri:x}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:j});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:x}});let y=await this.client.core.crypto.generateKeyPair(),z=qr(y);if(await Promise.all([this.client.auth.authKeys.set(uz,{responseTopic:z,publicKey:y}),this.client.auth.pairingTopics.set(z,{topic:z,pairingTopic:w})]),await this.client.core.relayer.subscribe(z,{transportType:j}),this.client.logger.info(`sending request to new pairing topic: ${w}`),t.length>0){let a,b,{namespace:c}=l8(k[0]),h=oq(function(a,b,c,d={}){return c?.sort((a,b)=>a.localeCompare(b)),{att:{[a]:function(a,b,c={}){return Object.assign({},...(b=b?.sort((a,b)=>a.localeCompare(b))).map(b=>({[`${a}/${b}`]:[c]})))}(b,c,d)}}}(c,"request",t));ou(v)&&(d=h,e=v.pop(),h=oq((f=or(d),g=or(e),op(f),op(g),a=Object.keys(f.att).concat(Object.keys(g.att)).sort((a,b)=>a.localeCompare(b)),b={att:{}},a.forEach(a=>{var c,d;Object.keys((null==(c=f.att)?void 0:c[a])||{}).concat(Object.keys((null==(d=g.att)?void 0:d[a])||{})).sort((a,b)=>a.localeCompare(b)).forEach(c=>{var d,e;b.att[a]=oe(((a,b)=>{for(var c in b||(b={}))oh.call(b,c)&&oj(a,c,b[c]);if(og)for(var c of og(b))oi.call(b,c)&&oj(a,c,b[c]);return a})({},b.att[a]),of({[c]:(null==(d=f.att[a])?void 0:d[c])||(null==(e=g.att[a])?void 0:e[c])}))})}),b))),v.push(h)}let A=u&&u>us.wc_sessionAuthenticate.req.ttl?u:us.wc_sessionAuthenticate.req.ttl,B={authPayload:{type:q??"caip122",chains:k,statement:l,aud:m,domain:o,version:"1",nonce:p,iat:new Date().toISOString(),exp:r,nbf:s,resources:v},requester:{publicKey:y,metadata:this.client.metadata},expiryTimestamp:mB(A)},C={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:k,methods:[...new Set(["personal_sign",...t])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:y,metadata:this.client.metadata},expiryTimestamp:mB(us.wc_sessionPropose.req.ttl),id:(0,rK.payloadId)()},{done:D,resolve:E,reject:F}=mx(A,"Request expired"),G=(0,rK.payloadId)(),H=mD("session_connect",C.id),I=mD("session_request",G),J=async({error:a,session:b})=>{this.events.off(I,K),a?F(a):b&&E({session:b})},K=async a=>{var c,d,e;let f;if(await this.deletePendingAuthRequest(G,{message:"fulfilled",code:0}),a.error){let b=q3("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return a.error.code===b.code?void 0:(this.events.off(H,J),F(a.error.message))}await this.deleteProposal(C.id),this.events.off(H,J);let{cacaos:g,responder:h}=a.result,i=[],k=[];for(let a of g){await on({cacao:a,projectId:this.client.core.projectId})||(this.client.logger.error(a,"Signature verification failed"),F(q3("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:b}=a,c=ou(b.resources),d=[ol(b.iss)],e=om(b.iss);if(c){let a=os(c),b=ot(c);i.push(...a),d.push(...b)}for(let a of d)k.push(`${a}:${e}`)}let l=await this.client.core.crypto.generateSharedKey(y,h.publicKey);i.length>0&&(f={topic:l,acknowledged:!0,self:{publicKey:y,metadata:this.client.metadata},peer:h,controller:h.publicKey,expiry:mB(ur),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:q_([...new Set(i)],[...new Set(k)]),transportType:j},await this.client.core.relayer.subscribe(l,{transportType:j}),await this.client.session.set(l,f),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:h.metadata}),f=this.client.session.get(l)),null!=(c=this.client.metadata.redirect)&&c.linkMode&&null!=(d=h.metadata.redirect)&&d.linkMode&&null!=(e=h.metadata.redirect)&&e.universal&&b&&(this.client.core.addLinkModeSupportedApp(h.metadata.redirect.universal),this.client.session.update(l,{transportType:r1})),E({auths:g,session:f})};this.events.once(H,J),this.events.once(I,K);try{if(i){let a=(0,rK.formatJsonRpcRequest)("wc_sessionAuthenticate",B,G);this.client.core.history.set(w,a);let c=await this.client.core.crypto.encode("",a,{type:2,encoding:qo});h=qN(b,w,c)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:B,expiry:a.expiry,throwOnFailedPublish:!0,clientRpcId:G}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:C,expiry:us.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:C.id})])}catch(a){throw this.events.off(H,J),this.events.off(I,K),a}return await this.setProposal(C.id,C),await this.setAuthRequest(G,{request:uB(uH({},B),uC({verifyContext:{}})),pairingTopic:w,transportType:j}),{uri:h??x,response:D}}),uI(this,"approveSessionAuthenticate",async a=>{let b,{id:c,auths:d}=a,e=this.client.core.eventClient.createEvent({properties:{topic:c.toString(),trace:["authenticated_session_approve_started"]}});try{this.isInitialized()}catch(a){throw e.setError("no_internet_connection"),a}let f=this.getPendingAuthRequest(c);if(!f)throw e.setError("authenticated_session_pending_request_not_found"),Error(`Could not find pending auth request with id ${c}`);let g=f.transportType||r2;g===r2&&await this.confirmOnlineStateOrThrow();let h=f.requester.publicKey,i=await this.client.core.crypto.generateKeyPair(),j=qr(h),k={type:1,receiverPublicKey:h,senderPublicKey:i},l=[],m=[];for(let a of d){if(!await on({cacao:a,projectId:this.client.core.projectId})){e.setError("invalid_cacao");let a=q3("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:c,topic:j,error:a,encodeOpts:k}),Error(a.message)}e.addTrace("cacaos_verified");let{p:b}=a,d=ou(b.resources),f=[ol(b.iss)],g=om(b.iss);if(d){let a=os(d),b=ot(d);l.push(...a),f.push(...b)}for(let a of f)m.push(`${a}:${g}`)}let o=await this.client.core.crypto.generateSharedKey(i,h);if(e.addTrace("create_authenticated_session_topic"),l?.length>0){b={topic:o,acknowledged:!0,self:{publicKey:i,metadata:this.client.metadata},peer:{publicKey:h,metadata:f.requester.metadata},controller:h,expiry:mB(ur),authentication:d,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:f.pairingTopic,namespaces:q_([...new Set(l)],[...new Set(m)]),transportType:g},e.addTrace("subscribing_authenticated_session_topic");try{await this.client.core.relayer.subscribe(o,{transportType:g})}catch(a){throw e.setError("subscribe_authenticated_session_topic_failure"),a}e.addTrace("subscribe_authenticated_session_topic_success"),await this.client.session.set(o,b),e.addTrace("store_authenticated_session"),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:f.requester.metadata})}e.addTrace("publishing_authenticated_session_approve");try{await this.sendResult({topic:j,id:c,result:{cacaos:d,responder:{publicKey:i,metadata:this.client.metadata}},encodeOpts:k,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(f.requester.metadata,g)})}catch(a){throw e.setError("authenticated_session_approve_publish_failure"),a}return await this.client.auth.requests.delete(c,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:f.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:e.eventId}),{session:b}}),uI(this,"rejectSessionAuthenticate",async a=>{this.isInitialized();let{id:b,reason:c}=a,d=this.getPendingAuthRequest(b);if(!d)throw Error(`Could not find pending auth request with id ${b}`);d.transportType===r2&&await this.confirmOnlineStateOrThrow();let e=d.requester.publicKey,f=await this.client.core.crypto.generateKeyPair(),g=qr(e);await this.sendError({id:b,topic:g,error:c,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:f},rpcOpts:us.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(d.requester.metadata,d.transportType)}),await this.client.auth.requests.delete(b,{message:"rejected",code:0}),await this.deleteProposal(b)}),uI(this,"formatAuthMessage",a=>{this.isInitialized();let{request:b,iss:c}=a;return oo(b,c)}),uI(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let a=this.relayMessageCache.shift();a&&await this.onRelayMessage(a)}catch(a){this.client.logger.error(a)}},50)}),uI(this,"cleanupDuplicatePairings",async a=>{if(a.pairingTopic)try{let b=this.client.core.pairing.pairings.get(a.pairingTopic),c=this.client.core.pairing.pairings.getAll().filter(c=>{var d,e;return(null==(d=c.peerMetadata)?void 0:d.url)&&(null==(e=c.peerMetadata)?void 0:e.url)===a.peer.metadata.url&&c.topic&&c.topic!==b.topic});if(0===c.length)return;this.client.logger.info(`Cleaning up ${c.length} duplicate pairing(s)`),await Promise.all(c.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(a){this.client.logger.error(a)}}),uI(this,"deleteSession",async a=>{var b;let{topic:c,expirerHasDeleted:d=!1,emitEvent:e=!0,id:f=0}=a,{self:g}=this.client.session.get(c);await this.client.core.relayer.unsubscribe(c),await this.client.session.delete(c,q3("USER_DISCONNECTED")),this.addToRecentlyDeleted(c,"session"),this.client.core.crypto.keychain.has(g.publicKey)&&await this.client.core.crypto.deleteKeyPair(g.publicKey),this.client.core.crypto.keychain.has(c)&&await this.client.core.crypto.deleteSymKey(c),d||this.client.core.expirer.del(c),this.client.core.storage.removeItem(up).catch(a=>this.client.logger.warn(a)),this.getPendingSessionRequests().forEach(a=>{a.topic===c&&this.deletePendingSessionRequest(a.id,q3("USER_DISCONNECTED"))}),c===(null==(b=this.sessionRequestQueue.queue[0])?void 0:b.topic)&&(this.sessionRequestQueue.state=uu),e&&this.client.events.emit("session_delete",{id:f,topic:c})}),uI(this,"deleteProposal",async(a,b)=>{if(b)try{let b=this.client.proposal.get(a),c=this.client.core.eventClient.getEvent({topic:b.pairingTopic});c?.setError("proposal_expired")}catch{}await Promise.all([this.client.proposal.delete(a,q3("USER_DISCONNECTED")),b?Promise.resolve():this.client.core.expirer.del(a)]),this.addToRecentlyDeleted(a,"proposal")}),uI(this,"deletePendingSessionRequest",async(a,b,c=!1)=>{await Promise.all([this.client.pendingRequest.delete(a,b),c?Promise.resolve():this.client.core.expirer.del(a)]),this.addToRecentlyDeleted(a,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(b=>b.id!==a),c&&(this.sessionRequestQueue.state=uu,this.client.events.emit("session_request_expire",{id:a}))}),uI(this,"deletePendingAuthRequest",async(a,b,c=!1)=>{await Promise.all([this.client.auth.requests.delete(a,b),c?Promise.resolve():this.client.core.expirer.del(a)])}),uI(this,"setExpiry",async(a,b)=>{this.client.session.keys.includes(a)&&(this.client.core.expirer.set(a,b),await this.client.session.update(a,{expiry:b}))}),uI(this,"setProposal",async(a,b)=>{this.client.core.expirer.set(a,mB(us.wc_sessionPropose.req.ttl)),await this.client.proposal.set(a,b)}),uI(this,"setAuthRequest",async(a,b)=>{let{request:c,pairingTopic:d,transportType:e=r2}=b;this.client.core.expirer.set(a,c.expiryTimestamp),await this.client.auth.requests.set(a,{authPayload:c.authPayload,requester:c.requester,expiryTimestamp:c.expiryTimestamp,id:a,pairingTopic:d,verifyContext:c.verifyContext,transportType:e})}),uI(this,"setPendingSessionRequest",async a=>{let{id:b,topic:c,params:d,verifyContext:e}=a,f=d.request.expiryTimestamp||mB(us.wc_sessionRequest.req.ttl);this.client.core.expirer.set(b,f),await this.client.pendingRequest.set(b,{id:b,topic:c,params:d,verifyContext:e})}),uI(this,"sendRequest",async b=>{let c,d,{topic:e,method:f,params:g,expiry:h,relayRpcId:i,clientRpcId:j,throwOnFailedPublish:k,appLink:l,tvf:m,publishOpts:o={}}=b,p=(0,rK.formatJsonRpcRequest)(f,g,j),q=!!l;try{let a=q?qo:qn;c=await this.client.core.crypto.encode(e,p,{encoding:a})}catch(a){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${e} failed`),a}if(ux.includes(f)){let a=qs(JSON.stringify(p)),b=qs(c);d=await this.client.core.verify.register({id:b,decryptedId:a})}let r=uH(uH({},us[f].req),o);if(r.attestation=d,h&&(r.ttl=h),i&&(r.id=i),this.client.core.history.set(e,p),q){let b=qN(l,e,c);await a.g.Linking.openURL(b,this.client.name)}else{let a;r.tvf=uB(uH({},m),uC({correlationId:p.id})),k?(a=uH({},r.internal),r.internal=uB(a,uC({throwOnFailedPublish:!0})),await this.client.core.relayer.publish(e,c,r)):this.client.core.relayer.publish(e,c,r).catch(a=>this.client.logger.error(a))}return p.id}),uI(this,"sendProposeSession",async a=>{let{proposal:b,publishOpts:c}=a,d=(0,rK.formatJsonRpcRequest)("wc_sessionPropose",b,b.id);this.client.core.history.set(b.pairingTopic,d);let e=await this.client.core.crypto.encode(b.pairingTopic,d,{encoding:qn}),f=qs(JSON.stringify(d)),g=qs(e),h=await this.client.core.verify.register({id:g,decryptedId:f});await this.client.core.relayer.publishCustom({payload:{pairingTopic:b.pairingTopic,sessionProposal:e},opts:uB(uH({},c),uC({publishMethod:"wc_proposeSession",attestation:h}))})}),uI(this,"sendApproveSession",async a=>{let{sessionTopic:b,pairingProposalResponse:c,proposal:d,sessionSettleRequest:e,publishOpts:f}=a,g=(0,rK.formatJsonRpcResult)(d.id,c),h=await this.client.core.crypto.encode(d.pairingTopic,g,{encoding:qn}),i=(0,rK.formatJsonRpcRequest)("wc_sessionSettle",e,f?.id),j=await this.client.core.crypto.encode(b,i,{encoding:qn});this.client.core.history.set(b,i),await this.client.core.relayer.publishCustom({payload:{sessionTopic:b,pairingTopic:d.pairingTopic,sessionProposalResponse:h,sessionSettlementRequest:j},opts:uB(uH({},f),uC({publishMethod:"wc_approveSession"}))})}),uI(this,"sendResult",async b=>{let c,d,e,{id:f,topic:g,result:h,throwOnFailedPublish:i,encodeOpts:j,appLink:k}=b,l=(0,rK.formatJsonRpcResult)(f,h),m=k&&"u">typeof(null==a.g?void 0:a.g.Linking);try{let a,b,d=m?qo:qn;c=await this.client.core.crypto.encode(g,l,(a=uH({},j||{}),b={encoding:d},uB(a,uC(b))))}catch(a){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${g} failed`),a}try{let a=(d=await this.client.core.history.get(g,f)).request;try{e=this.getTVFParams(f,a.params,h)}catch(a){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${a?.message}`)}}catch(a){throw this.client.logger.error(`sendResult() -> history.get(${g}, ${f}) failed`),a}if(m){let b=qN(k,g,c);await a.g.Linking.openURL(b,this.client.name)}else{let a,b=us[d.request.method].res;b.tvf=uB(uH({},e),uC({correlationId:f})),i?(a=uH({},b.internal),b.internal=uB(a,uC({throwOnFailedPublish:!0})),await this.client.core.relayer.publish(g,c,b)):this.client.core.relayer.publish(g,c,b).catch(a=>this.client.logger.error(a))}await this.client.core.history.resolve(l)}),uI(this,"sendError",async b=>{let c,d,{id:e,topic:f,error:g,encodeOpts:h,rpcOpts:i,appLink:j}=b,k=(0,rK.formatJsonRpcError)(e,g),l=j&&"u">typeof(null==a.g?void 0:a.g.Linking);try{let a,b,d=l?qo:qn;c=await this.client.core.crypto.encode(f,k,(a=uH({},h||{}),b={encoding:d},uB(a,uC(b))))}catch(a){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${f} failed`),a}try{d=await this.client.core.history.get(f,e)}catch(a){throw this.client.logger.error(`sendError() -> history.get(${f}, ${e}) failed`),a}if(l){let b=qN(j,f,c);await a.g.Linking.openURL(b,this.client.name)}else{let a=d.request.method,b=i||us[a].res;this.client.core.relayer.publish(f,c,b)}await this.client.core.history.resolve(k)}),uI(this,"cleanup",async()=>{let a=[],b=[];this.client.session.getAll().forEach(b=>{let c=!1;mC(b.expiry)&&(c=!0),this.client.core.crypto.keychain.has(b.topic)||(c=!0),c&&a.push(b.topic)}),this.client.proposal.getAll().forEach(a=>{mC(a.expiryTimestamp)&&b.push(a.id)}),await Promise.all([...a.map(a=>this.deleteSession({topic:a})),...b.map(a=>this.deleteProposal(a))])}),uI(this,"onProviderMessageEvent",async a=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(a):await this.onRelayMessage(a)}),uI(this,"onRelayEventRequest",async a=>{this.requestQueue.queue.push(a),await this.processRequestsQueue()}),uI(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===uv)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=uv;let a=this.requestQueue.queue.shift();if(a)try{await this.processRequest(a)}catch(a){this.client.logger.warn(a)}}this.requestQueue.state=uu}),uI(this,"processRequest",async a=>{let{topic:b,payload:c,attestation:d,transportType:e,encryptedId:f}=a,g=c.method;if(!this.shouldIgnorePairingRequest({topic:b,requestMethod:g}))switch(g){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:b,payload:c,attestation:d,encryptedId:f});case"wc_sessionSettle":return await this.onSessionSettleRequest(b,c);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(b,c);case"wc_sessionExtend":return await this.onSessionExtendRequest(b,c);case"wc_sessionPing":return await this.onSessionPingRequest(b,c);case"wc_sessionDelete":return await this.onSessionDeleteRequest(b,c);case"wc_sessionRequest":return await this.onSessionRequest({topic:b,payload:c,attestation:d,encryptedId:f,transportType:e});case"wc_sessionEvent":return await this.onSessionEventRequest(b,c);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:b,payload:c,attestation:d,encryptedId:f,transportType:e});default:return this.client.logger.info(`Unsupported request method ${g}`)}}),uI(this,"onRelayEventResponse",async a=>{let{topic:b,payload:c,transportType:d}=a,e=(await this.client.core.history.get(b,c.id)).request.method;switch(e){case"wc_sessionPropose":return this.onSessionProposeResponse(b,c,d);case"wc_sessionSettle":return this.onSessionSettleResponse(b,c);case"wc_sessionUpdate":return this.onSessionUpdateResponse(b,c);case"wc_sessionExtend":return this.onSessionExtendResponse(b,c);case"wc_sessionPing":return this.onSessionPingResponse(b,c);case"wc_sessionRequest":return this.onSessionRequestResponse(b,c);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(b,c);default:return this.client.logger.info(`Unsupported response method ${e}`)}}),uI(this,"onRelayEventUnknownPayload",a=>{let{topic:b}=a,{message:c}=q2("MISSING_OR_INVALID",`Decoded payload on topic ${b} is not identifiable as a JSON-RPC request or a response.`);throw Error(c)}),uI(this,"shouldIgnorePairingRequest",a=>{let{topic:b,requestMethod:c}=a,d=this.expectedPairingMethodMap.get(b);return!(!d||d.includes(c))&&!!(d.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),uI(this,"onSessionProposeRequest",async a=>{let{topic:b,payload:c,attestation:d,encryptedId:e}=a,{params:f,id:g}=c;try{let a=this.client.core.eventClient.getEvent({topic:b});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),a?.setError("proposal_listener_not_found")),this.isValidConnect(uH({},c.params));let h=f.expiryTimestamp||mB(us.wc_sessionPropose.req.ttl),i=uH({id:g,pairingTopic:b,expiryTimestamp:h,attestation:d,encryptedId:e},f);await this.setProposal(g,i);let j=await this.getVerifyContext({attestationId:d,hash:qs(JSON.stringify(c)),encryptedId:e,metadata:i.proposer.metadata});a?.addTrace("emit_session_proposal"),this.client.events.emit("session_proposal",{id:g,params:i,verifyContext:j})}catch(a){await this.sendError({id:g,topic:b,error:a,rpcOpts:us.wc_sessionPropose.autoReject}),this.client.logger.error(a)}}),uI(this,"onSessionProposeResponse",async(a,b,c)=>{let{id:d}=b;if((0,rL.isJsonRpcResult)(b)){let{result:e}=b;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:e});let f=this.client.proposal.get(d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});let g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});let h=e.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});let i=await this.client.core.crypto.generateSharedKey(g,h);this.pendingSessions.set(d,{sessionTopic:i,pairingTopic:a,proposalId:d,publicKey:g});let j=await this.client.core.relayer.subscribe(i,{transportType:c});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:j}),await this.client.core.pairing.activate({topic:a})}else if((0,rL.isJsonRpcError)(b)){await this.deleteProposal(d);let a=mD("session_connect",d);if(0===this.events.listenerCount(a))throw Error(`emitting ${a} without any listeners, 954`);this.events.emit(a,{error:b.error})}}),uI(this,"onSessionSettleRequest",async(a,b)=>{let{id:c,params:d}=b;try{let c,e;this.isValidSessionSettleRequest(d);let{relay:f,controller:g,expiry:h,namespaces:i,sessionProperties:j,scopedProperties:k,sessionConfig:l}=b.params,m=[...this.pendingSessions.values()].find(b=>b.sessionTopic===a);if(!m)return this.client.logger.error(`Pending session not found for topic ${a}`);let o=this.client.proposal.get(m.proposalId),p=(c=uH(uH(uH({topic:a,relay:f,expiry:h,namespaces:i,acknowledged:!0,pairingTopic:m.pairingTopic,requiredNamespaces:o.requiredNamespaces,optionalNamespaces:o.optionalNamespaces,controller:g.publicKey,self:{publicKey:m.publicKey,metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},j&&{sessionProperties:j}),k&&{scopedProperties:k}),l&&{sessionConfig:l}),e={transportType:r2},uB(c,uC(e)));await this.client.session.set(p.topic,p),await this.setExpiry(p.topic,p.expiry),await this.client.core.pairing.updateMetadata({topic:m.pairingTopic,metadata:p.peer.metadata}),this.client.events.emit("session_connect",{session:p}),this.events.emit(mD("session_connect",m.proposalId),{session:p}),this.pendingSessions.delete(m.proposalId),this.deleteProposal(m.proposalId,!1),this.cleanupDuplicatePairings(p),await this.sendResult({id:b.id,topic:a,result:!0})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uI(this,"onSessionSettleResponse",async(a,b)=>{let{id:c}=b;(0,rL.isJsonRpcResult)(b)?(await this.client.session.update(a,{acknowledged:!0}),this.events.emit(mD("session_approve",c),{})):(0,rL.isJsonRpcError)(b)&&(await this.client.session.delete(a,q3("USER_DISCONNECTED")),this.events.emit(mD("session_approve",c),{error:b.error}))}),uI(this,"onSessionUpdateRequest",async(a,b)=>{let{params:c,id:d}=b;try{let b=`${a}_session_update`,e=rl.get(b);if(e&&this.isRequestOutOfSync(e,d)){this.client.logger.warn(`Discarding out of sync request - ${d}`),this.sendError({id:d,topic:a,error:q3("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(uH({topic:a},c));try{rl.set(b,d),await this.client.session.update(a,{namespaces:c.namespaces}),await this.sendResult({id:d,topic:a,result:!0})}catch(a){throw rl.delete(b),a}this.client.events.emit("session_update",{id:d,topic:a,params:c})}catch(b){await this.sendError({id:d,topic:a,error:b}),this.client.logger.error(b)}}),uI(this,"isRequestOutOfSync",(a,b)=>b.toString().slice(0,-3)<a.toString().slice(0,-3)),uI(this,"onSessionUpdateResponse",(a,b)=>{let{id:c}=b,d=mD("session_update",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,rL.isJsonRpcResult)(b)?this.events.emit(mD("session_update",c),{}):(0,rL.isJsonRpcError)(b)&&this.events.emit(mD("session_update",c),{error:b.error})}),uI(this,"onSessionExtendRequest",async(a,b)=>{let{id:c}=b;try{this.isValidExtend({topic:a}),await this.setExpiry(a,mB(ur)),await this.sendResult({id:c,topic:a,result:!0}),this.client.events.emit("session_extend",{id:c,topic:a})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uI(this,"onSessionExtendResponse",(a,b)=>{let{id:c}=b,d=mD("session_extend",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,rL.isJsonRpcResult)(b)?this.events.emit(mD("session_extend",c),{}):(0,rL.isJsonRpcError)(b)&&this.events.emit(mD("session_extend",c),{error:b.error})}),uI(this,"onSessionPingRequest",async(a,b)=>{let{id:c}=b;try{this.isValidPing({topic:a}),await this.sendResult({id:c,topic:a,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:c,topic:a})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uI(this,"onSessionPingResponse",(a,b)=>{let{id:c}=b,d=mD("session_ping",c);setTimeout(()=>{if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners 2176`);(0,rL.isJsonRpcResult)(b)?this.events.emit(mD("session_ping",c),{}):(0,rL.isJsonRpcError)(b)&&this.events.emit(mD("session_ping",c),{error:b.error})},500)}),uI(this,"onSessionDeleteRequest",async(a,b)=>{let{id:c}=b;try{this.isValidDisconnect({topic:a,reason:b.params}),await Promise.all([new Promise(b=>{this.client.core.relayer.once(rX,async()=>{b(await this.deleteSession({topic:a,id:c}))})}),this.sendResult({id:c,topic:a,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:a,error:q3("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}}),uI(this,"onSessionRequest",async a=>{var b,c,d;let{topic:e,payload:f,attestation:g,encryptedId:h,transportType:i}=a,{id:j,params:k}=f;try{await this.isValidRequest(uH({topic:e},k));let a=this.client.session.get(e),f=await this.getVerifyContext({attestationId:g,hash:qs(JSON.stringify((0,rK.formatJsonRpcRequest)("wc_sessionRequest",k,j))),encryptedId:h,metadata:a.peer.metadata,transportType:i}),l={id:j,topic:e,params:k,verifyContext:f};await this.setPendingSessionRequest(l),i===r1&&null!=(b=a.peer.metadata.redirect)&&b.universal&&this.client.core.addLinkModeSupportedApp(null==(c=a.peer.metadata.redirect)?void 0:c.universal),null!=(d=this.client.signConfig)&&d.disableRequestQueue?this.emitSessionRequest(l):(this.addSessionRequestToSessionRequestQueue(l),this.processSessionRequestQueue())}catch(a){await this.sendError({id:j,topic:e,error:a}),this.client.logger.error(a)}}),uI(this,"onSessionRequestResponse",(a,b)=>{let{id:c}=b,d=mD("session_request",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,rL.isJsonRpcResult)(b)?this.events.emit(mD("session_request",c),{result:b.result}):(0,rL.isJsonRpcError)(b)&&this.events.emit(mD("session_request",c),{error:b.error})}),uI(this,"onSessionEventRequest",async(a,b)=>{let{id:c,params:d}=b;try{let b=`${a}_session_event_${d.event.name}`,e=rl.get(b);if(e&&this.isRequestOutOfSync(e,c))return void this.client.logger.info(`Discarding out of sync request - ${c}`);this.isValidEmit(uH({topic:a},d)),this.client.events.emit("session_event",{id:c,topic:a,params:d}),rl.set(b,c)}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),uI(this,"onSessionAuthenticateResponse",(a,b)=>{let{id:c}=b;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:a,payload:b}),(0,rL.isJsonRpcResult)(b)?this.events.emit(mD("session_request",c),{result:b.result}):(0,rL.isJsonRpcError)(b)&&this.events.emit(mD("session_request",c),{error:b.error})}),uI(this,"onSessionAuthenticateRequest",async a=>{var b;let{topic:c,payload:d,attestation:e,encryptedId:f,transportType:g}=a;try{let{requester:a,authPayload:h,expiryTimestamp:i}=d.params,j=await this.getVerifyContext({attestationId:e,hash:qs(JSON.stringify(d)),encryptedId:f,metadata:a.metadata,transportType:g}),k={requester:a,pairingTopic:c,id:d.id,authPayload:h,verifyContext:j,expiryTimestamp:i};await this.setAuthRequest(d.id,{request:k,pairingTopic:c,transportType:g}),g===r1&&null!=(b=a.metadata.redirect)&&b.universal&&this.client.core.addLinkModeSupportedApp(a.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:c,params:d.params,id:d.id,verifyContext:j})}catch(f){this.client.logger.error(f);let a=d.params.requester.publicKey,b=await this.client.core.crypto.generateKeyPair(),e=this.getAppLinkIfEnabled(d.params.requester.metadata,g);await this.sendError({id:d.id,topic:c,error:f,encodeOpts:{type:1,receiverPublicKey:a,senderPublicKey:b},rpcOpts:us.wc_sessionAuthenticate.autoReject,appLink:e})}}),uI(this,"addSessionRequestToSessionRequestQueue",a=>{this.sessionRequestQueue.queue.push(a)}),uI(this,"cleanupAfterResponse",a=>{this.deletePendingSessionRequest(a.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=uu,this.processSessionRequestQueue()},(0,ic.toMiliseconds)(this.requestQueueDelay))}),uI(this,"cleanupPendingSentRequestsForTopic",({topic:a,error:b})=>{let c=this.client.core.history.pending;c.length>0&&c.filter(b=>b.topic===a&&"wc_sessionRequest"===b.request.method).forEach(a=>{let c=mD("session_request",a.request.id);if(0===this.events.listenerCount(c))throw Error(`emitting ${c} without any listeners`);this.events.emit(mD("session_request",a.request.id),{error:b})})}),uI(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===uv)return void this.client.logger.info("session request queue is already active.");let a=this.sessionRequestQueue.queue[0];if(!a)return void this.client.logger.info("session request queue is empty.");try{this.emitSessionRequest(a)}catch(a){this.client.logger.error(a)}}),uI(this,"emitSessionRequest",a=>{this.emittedSessionRequests.has(a.id)?this.client.logger.warn({id:a.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${a.id}`):(this.sessionRequestQueue.state=uv,this.emittedSessionRequests.add(a.id),this.client.events.emit("session_request",a))}),uI(this,"onPairingCreated",a=>{if(a.methods&&this.expectedPairingMethodMap.set(a.topic,a.methods),a.active)return;let b=this.client.proposal.getAll().find(b=>b.pairingTopic===a.topic);b&&this.onSessionProposeRequest({topic:a.topic,payload:(0,rK.formatJsonRpcRequest)("wc_sessionPropose",uB(uH({},b),uC({requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces,relays:b.relays,proposer:b.proposer,sessionProperties:b.sessionProperties,scopedProperties:b.scopedProperties})),b.id),attestation:b.attestation,encryptedId:b.encryptedId})}),uI(this,"isValidConnect",async a=>{let b;if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(a)}`);throw Error(b)}let{pairingTopic:c,requiredNamespaces:d,optionalNamespaces:e,sessionProperties:f,scopedProperties:g,relays:h}=a;if(q6(c)||await this.isValidPairingTopic(c),b=!1,h?h&&q4(h)&&h.length&&h.forEach(a=>{b=rd(a)}):b=!0,!b){let{message:a}=q2("MISSING_OR_INVALID",`connect() relays: ${h}`);throw Error(a)}if(d&&!q6(d)&&0!==q5(d)){let a="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(a):this.client.logger.warn(a),this.validateNamespaces(d,"requiredNamespaces")}if(e&&!q6(e)&&0!==q5(e)&&this.validateNamespaces(e,"optionalNamespaces"),f&&!q6(f)&&this.validateSessionProps(f,"sessionProperties"),g&&!q6(g)){this.validateSessionProps(g,"scopedProperties");let a=Object.keys(d||{}).concat(Object.keys(e||{}));if(!Object.keys(g).every(b=>a.includes(b.split(":")[0])))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(g)}, required/optional namespaces: ${JSON.stringify(a)}`)}}),uI(this,"validateNamespaces",(a,b)=>{let c=function(a,b,c){let d=null;if(a&&q5(a)){let e,f=rb(a,b);f&&(d=f);let g=(e=null,Object.entries(a).forEach(([a,d])=>{var f,g;let h;if(e)return;let i=(f=ma(a,d),g=`${b} ${c}`,h=null,q4(f)&&f.length?f.forEach(a=>{h||q9(a)||(h=q3("UNSUPPORTED_CHAINS",`${g}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):q9(a)||(h=q3("UNSUPPORTED_CHAINS",`${g}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),h);i&&(e=i)}),e);g&&(d=g)}else d=q2("MISSING_OR_INVALID",`${b}, ${c} should be an object with data`);return d}(a,"connect()",b);if(c)throw Error(c.message)}),uI(this,"isValidApprove",async a=>{if(!re(a))throw Error(q2("MISSING_OR_INVALID",`approve() params: ${a}`).message);let{id:b,namespaces:c,relayProtocol:d,sessionProperties:e,scopedProperties:f}=a;this.checkRecentlyDeleted(b),await this.isValidProposalId(b);let g=this.client.proposal.get(b),h=rc(c,"approve()");if(h)throw Error(h.message);let i=rg(g.requiredNamespaces,c,"approve()");if(i)throw Error(i.message);if(!q7(d,!0)){let{message:a}=q2("MISSING_OR_INVALID",`approve() relayProtocol: ${d}`);throw Error(a)}if(e&&!q6(e)&&this.validateSessionProps(e,"sessionProperties"),f&&!q6(f)){this.validateSessionProps(f,"scopedProperties");let a=new Set(Object.keys(c));if(!Object.keys(f).every(b=>a.has(b.split(":")[0])))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(f)}, approved namespaces: ${Array.from(a).join(", ")}`)}}),uI(this,"isValidReject",async a=>{if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`reject() params: ${a}`);throw Error(b)}let{id:b,reason:c}=a;if(this.checkRecentlyDeleted(b),await this.isValidProposalId(b),!c||"object"!=typeof c||!c.code||!q8(c.code,!1)||!c.message||!q7(c.message,!1)){let{message:a}=q2("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(c)}`);throw Error(a)}}),uI(this,"isValidSessionSettleRequest",a=>{let b;if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${a}`);throw Error(b)}let{relay:c,controller:d,namespaces:e,expiry:f}=a;if(!rd(c)){let{message:a}=q2("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(a)}let g=(b=null,q7(d?.publicKey,!1)||(b=q2("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),b);if(g)throw Error(g.message);let h=rc(e,"onSessionSettleRequest()");if(h)throw Error(h.message);if(mC(f)){let{message:a}=q2("EXPIRED","onSessionSettleRequest()");throw Error(a)}}),uI(this,"isValidUpdate",async a=>{if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`update() params: ${a}`);throw Error(b)}let{topic:b,namespaces:c}=a;this.checkRecentlyDeleted(b),await this.isValidSessionTopic(b);let d=this.client.session.get(b),e=rc(c,"update()");if(e)throw Error(e.message);let f=rg(d.requiredNamespaces,c,"update()");if(f)throw Error(f.message)}),uI(this,"isValidExtend",async a=>{if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`extend() params: ${a}`);throw Error(b)}let{topic:b}=a;this.checkRecentlyDeleted(b),await this.isValidSessionTopic(b)}),uI(this,"isValidRequest",async a=>{var b;let c;if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`request() params: ${a}`);throw Error(b)}let{topic:d,request:e,chainId:f,expiry:g}=a;this.checkRecentlyDeleted(d),await this.isValidSessionTopic(d);let{namespaces:h}=this.client.session.get(d);if(!rf(h,f)){let{message:a}=q2("MISSING_OR_INVALID",`request() chainId: ${f}`);throw Error(a)}if(q6(e)||!q7(e.method,!1)){let{message:a}=q2("MISSING_OR_INVALID",`request() ${JSON.stringify(e)}`);throw Error(a)}if(!(q7(b=e.method,!1)&&(c=[],Object.values(h).forEach(a=>{qX(a.accounts).includes(f)&&c.push(...a.methods)}),c).includes(b))){let{message:a}=q2("MISSING_OR_INVALID",`request() method: ${e.method}`);throw Error(a)}if(g&&(!q8(g,!1)||!(g<=ut.max)||!(g>=ut.min))){let{message:a}=q2("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${ut.min} and ${ut.max}`);throw Error(a)}}),uI(this,"isValidRespond",async a=>{var b;if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`respond() params: ${a}`);throw Error(b)}let{topic:c,response:d}=a;try{await this.isValidSessionTopic(c)}catch(c){throw null!=(b=a?.response)&&b.id&&this.cleanupAfterResponse(a),c}if(q6(d)||q6(d.result)&&q6(d.error)||!q8(d.id,!1)||!q7(d.jsonrpc,!1)){let{message:a}=q2("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(d)}`);throw Error(a)}let e=this.client.pendingRequest.get(d.id);if(e.topic!==c){let{message:a}=q2("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${d.id}, expected topic: ${e.topic}, received topic: ${c}`);throw Error(a)}}),uI(this,"isValidPing",async a=>{if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`ping() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidSessionOrPairingTopic(b)}),uI(this,"isValidEmit",async a=>{var b;let c;if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`emit() params: ${a}`);throw Error(b)}let{topic:d,event:e,chainId:f}=a;await this.isValidSessionTopic(d);let{namespaces:g}=this.client.session.get(d);if(!rf(g,f)){let{message:a}=q2("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw Error(a)}if(q6(e)||!q7(e.name,!1)||!(q7(b=e.name,!1)&&(c=[],Object.values(g).forEach(a=>{qX(a.accounts).includes(f)&&c.push(...a.events)}),c).includes(b))){let{message:a}=q2("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(e)}`);throw Error(a)}}),uI(this,"isValidDisconnect",async a=>{if(!re(a)){let{message:b}=q2("MISSING_OR_INVALID",`disconnect() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidSessionOrPairingTopic(b)}),uI(this,"isValidAuthenticate",a=>{let{chains:b,uri:c,domain:d,nonce:e}=a;if(!Array.isArray(b)||0===b.length)throw Error("chains is required and must be a non-empty array");if(!q7(c,!1))throw Error("uri is required parameter");if(!q7(d,!1))throw Error("domain is required parameter");if(!q7(e,!1))throw Error("nonce is required parameter");if([...new Set(b.map(a=>l8(a).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:f}=l8(b[0]);if("eip155"!==f)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),uI(this,"getVerifyContext",async a=>{let{attestationId:b,hash:c,encryptedId:d,metadata:e,transportType:f}=a,g={verified:{verifyUrl:e.verifyUrl||sg,validation:"UNKNOWN",origin:e.url||""}};try{if(f===r1){let a=this.getAppLinkIfEnabled(e,f);return g.verified.validation=a&&new URL(a).origin===new URL(e.url).origin?"VALID":"INVALID",g}let a=await this.client.core.verify.resolve({attestationId:b,hash:c,encryptedId:d,verifyUrl:e.verifyUrl});a&&(g.verified.origin=a.origin,g.verified.isScam=a.isScam,g.verified.validation=a.origin===new URL(e.url).origin?"VALID":"INVALID")}catch(a){this.client.logger.warn(a)}return this.client.logger.debug(`Verify context: ${JSON.stringify(g)}`),g}),uI(this,"validateSessionProps",(a,b)=>{Object.values(a).forEach((c,d)=>{if(null==c){let{message:e}=q2("MISSING_OR_INVALID",`${b} must contain an existing value for each key. Received: ${c} for key ${Object.keys(a)[d]}`);throw Error(e)}})}),uI(this,"getPendingAuthRequest",a=>{let b=this.client.auth.requests.get(a);return"object"==typeof b?b:void 0}),uI(this,"addToRecentlyDeleted",(a,b)=>{if(this.recentlyDeletedMap.set(a,b),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let a=0,b=this.recentlyDeletedLimit/2;for(let c of this.recentlyDeletedMap.keys()){if(a++>=b)break;this.recentlyDeletedMap.delete(c)}}}),uI(this,"checkRecentlyDeleted",a=>{let b=this.recentlyDeletedMap.get(a);if(b){let{message:c}=q2("MISSING_OR_INVALID",`Record was recently deleted - ${b}: ${a}`);throw Error(c)}}),uI(this,"isLinkModeEnabled",(b,c)=>{var d,e,f,g,h,i,j,k,l;return!!b&&c===r1&&(null==(e=null==(d=this.client.metadata)?void 0:d.redirect)?void 0:e.linkMode)===!0&&(null==(g=null==(f=this.client.metadata)?void 0:f.redirect)?void 0:g.universal)!==void 0&&(null==(i=null==(h=this.client.metadata)?void 0:h.redirect)?void 0:i.universal)!==""&&(null==(j=b?.redirect)?void 0:j.universal)!==void 0&&(null==(k=b?.redirect)?void 0:k.universal)!==""&&(null==(l=b?.redirect)?void 0:l.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(b.redirect.universal)&&"u">typeof(null==a.g?void 0:a.g.Linking)}),uI(this,"getAppLinkIfEnabled",(a,b)=>{var c;return this.isLinkModeEnabled(a,b)?null==(c=a?.redirect)?void 0:c.universal:void 0}),uI(this,"handleLinkModeMessage",({url:a})=>{if(!a||!a.includes("wc_ev")||!a.includes("topic"))return;let b=mH(a,"topic")||"",c=decodeURIComponent(mH(a,"wc_ev")||""),d=this.client.session.keys.includes(b);d&&this.client.session.update(b,{transportType:r1}),this.client.core.dispatchEnvelope({topic:b,message:c,sessionExists:d})}),uI(this,"registerLinkModeListeners",async()=>{var b;if(mJ()||mo()&&null!=(b=this.client.metadata.redirect)&&b.linkMode){let b=null==a.g?void 0:a.g.Linking;if("u">typeof b){b.addEventListener("url",this.handleLinkModeMessage,this.client.name);let a=await b.getInitialURL();a&&setTimeout(()=>{this.handleLinkModeMessage({url:a})},50)}}}),uI(this,"getTVFParams",(a,b,c)=>{var d,e,f;if(!(null!=(d=b.request)&&d.method))return{};let g={correlationId:a,rpcMethods:[b.request.method],chainId:b.chainId};try{g.txHashes=this.extractTxHashesFromResult(b.request,c),g.contractAddresses=this.isValidContractData(b.request.params)?[null==(f=null==(e=b.request.params)?void 0:e[0])?void 0:f.to]:[]}catch(a){this.client.logger.warn(a,"Error getting TVF params")}return g}),uI(this,"isValidContractData",a=>{var b;if(!a)return!1;try{let c=a?.data||(null==(b=a?.[0])?void 0:b.data);if(!c.startsWith("0x"))return!1;let d=c.slice(2);return!!/^[0-9a-fA-F]*$/.test(d)&&d.length%2==0}catch{}return!1}),uI(this,"extractTxHashesFromResult",(a,b)=>{var c,d,e,f,g;try{if(!b)return[];let h=a.method,i=uw[h];if("sui_signTransaction"===h){let a,c,d,f;return[(e=b.transactionBytes,a=new Uint8Array(Buffer.from(e,"base64")),c=Array.from("TransactionData::").map(a=>a.charCodeAt(0)),(d=new Uint8Array(c.length+a.length)).set(c),d.set(a,c.length),f=n6(d,{dkLen:32}),lE.default.encode(f))]}if("near_signTransaction"===h)return[oa(b)];if("near_signTransactions"===h)return b.map(a=>oa(a));if("xrpl_signTransactionFor"===h||"xrpl_signTransaction"===h)return[null==(c=b.tx_json)?void 0:c.hash];if("polkadot_signTransaction"===h){let c,e,f,g;return[(d={transaction:a.params.transactionPayload,signature:b.signature},f=Uint8Array.from(Buffer.from(d.signature,"hex")),g=function({publicKey:a,signature:b,payload:c}){var d,e,f;let g,h=rm(c.method),i=128|parseInt((null==(d=c.version)?void 0:d.toString())||"4"),j=(e=c.address,g=lE.default.decode(e)[0],42===g?0:60===g?2:1),k="00"===c.era?new Uint8Array([0]):rm(c.era);if(1!==k.length&&2!==k.length)throw Error("Invalid era length");let l=parseInt(c.nonce,16),m=new Uint8Array([255&l,l>>8&255]),o=new Uint8Array([0,...a,j,...b,...k,...m,...function(a){if(a<BigInt(1)<<BigInt(6))return new Uint8Array([Number(a<<BigInt(2))]);if(a<BigInt(1)<<BigInt(14)){let b=a<<BigInt(2)|BigInt(1);return new Uint8Array([Number(b&BigInt(255)),Number(b>>BigInt(8)&BigInt(255))])}if(a<BigInt(1)<<BigInt(30)){let b=a<<BigInt(2)|BigInt(2);return new Uint8Array([Number(b&BigInt(255)),Number(b>>BigInt(8)&BigInt(255)),Number(b>>BigInt(16)&BigInt(255)),Number(b>>BigInt(24)&BigInt(255))])}throw Error("BigInt compact encoding not supported > 2^30")}(BigInt(`0x${(f=c.tip).startsWith("0x")?f.slice(2):f}`)),...h]);return new Uint8Array([...function(a){if(a<64)return new Uint8Array([a<<2]);if(a<16384){let b=a<<2|1;return new Uint8Array([255&b,b>>8&255])}if(a<0x40000000){let b=a<<2|2;return new Uint8Array([255&b,b>>8&255,b>>16&255,b>>24&255])}throw Error("Compact encoding > 2^30 not supported")}(o.length+1),i,...o])}({publicKey:function(a){let b=lE.default.decode(a);if(b.length<33)throw Error("Too short to contain a public key");return b.slice(1,33)}(d.transaction.address),signature:f,payload:d.transaction}),c=rm(Buffer.from(g).toString("hex")),e=(0,lM.blake2b)(c,void 0,32),"0x"+Buffer.from(e).toString("hex"))]}if("algo_signTxn"===h)return q4(b)?b.map(a=>ob(a)):[ob(b)];if("cosmos_signDirect"===h){let a,c,d,e,f;return[(a=Buffer.from(b.signed.bodyBytes,"base64"),c=Buffer.from(b.signed.authInfoBytes,"base64"),d=Buffer.from(b.signature.signature,"base64"),(e=[]).push(Buffer.from([10])),e.push(oc(a.length)),e.push(a),e.push(Buffer.from([18])),e.push(oc(c.length)),e.push(c),e.push(Buffer.from([26])),e.push(oc(d.length)),e.push(d),f=nX(Buffer.concat(e)),Buffer.from(f).toString("hex").toUpperCase())]}if("wallet_sendCalls"===h){let a=[];try{if("string"==typeof b)return a.push(b),a;if("object"!=typeof b)return a;null!=b&&b.id&&a.push(b.id);let c=null==(g=null==(f=b?.capabilities)?void 0:f.caip345)?void 0:g.transactionHashes;c&&a.push(...c)}catch(a){console.warn("getWalletSendCallsHashes failed: ",a)}return a}if("string"==typeof b)return[b];let j=b[i.key];if(q4(j))return"solana_signAllTransactions"===h?j.map(a=>(function(a){let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);let d=c[0];if(0===d)throw Error("No signatures found");if(c.length<1+64*d)throw Error("Transaction data too short for claimed signature count");if(c.length<100)throw Error("Transaction too short");let e=Buffer.from(a,"base64").slice(1,65);return lE.default.encode(e)})(a)):j;if("string"==typeof j)return[j]}catch(a){this.client.logger.warn(a,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{let a=this.client.session.keys,b=this.client.core.relayer.messages.getWithoutAck(a);for(let[a,c]of Object.entries(b))for(let b of c)try{await this.onProviderMessageEvent({topic:a,message:b,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${a}, message: ${b}`)}}catch(a){this.client.logger.warn(a,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){let{message:a}=q2("NOT_INITIALIZED",this.name);throw Error(a)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(rU,a=>{this.onProviderMessageEvent(a)})}async onRelayMessage(a){let{topic:b,message:c,attestation:d,transportType:e}=a,{publicKey:f}=this.client.auth.authKeys.keys.includes(uz)?this.client.auth.authKeys.get(uz):{responseTopic:void 0,publicKey:void 0};try{let a=await this.client.core.crypto.decode(b,c,{receiverPublicKey:f,encoding:e===r1?qo:qn});(0,rL.isJsonRpcRequest)(a)?(this.client.core.history.set(b,a),await this.onRelayEventRequest({topic:b,payload:a,attestation:d,transportType:e,encryptedId:qs(c)})):(0,rL.isJsonRpcResponse)(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:b,payload:a,transportType:e}),this.client.core.history.delete(b,a.id)):await this.onRelayEventUnknownPayload({topic:b,payload:a,transportType:e}),await this.client.core.relayer.messages.ack(b,c)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(sf,async a=>{let{topic:b,id:c}=mA(a.target);return c&&this.client.pendingRequest.keys.includes(c)?await this.deletePendingSessionRequest(c,q2("EXPIRED"),!0):c&&this.client.auth.requests.keys.includes(c)?await this.deletePendingAuthRequest(c,q2("EXPIRED"),!0):void(b?this.client.session.keys.includes(b)&&(await this.deleteSession({topic:b,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:b})):c&&(await this.deleteProposal(c,!0),this.client.events.emit("proposal_expire",{id:c})))})}registerPairingEvents(){this.client.core.pairing.events.on(r8,a=>this.onPairingCreated(a)),this.client.core.pairing.events.on(r9,a=>{this.addToRecentlyDeleted(a.topic,"pairing")})}isValidPairingTopic(a){if(!q7(a,!1)){let{message:b}=q2("MISSING_OR_INVALID",`pairing topic should be a string: ${a}`);throw Error(b)}if(!this.client.core.pairing.pairings.keys.includes(a)){let{message:b}=q2("NO_MATCHING_KEY",`pairing topic doesn't exist: ${a}`);throw Error(b)}if(mC(this.client.core.pairing.pairings.get(a).expiry)){let{message:b}=q2("EXPIRED",`pairing topic: ${a}`);throw Error(b)}}async isValidSessionTopic(a){if(!q7(a,!1)){let{message:b}=q2("MISSING_OR_INVALID",`session topic should be a string: ${a}`);throw Error(b)}if(this.checkRecentlyDeleted(a),!this.client.session.keys.includes(a)){let{message:b}=q2("NO_MATCHING_KEY",`session topic doesn't exist: ${a}`);throw Error(b)}if(mC(this.client.session.get(a).expiry)){await this.deleteSession({topic:a});let{message:b}=q2("EXPIRED",`session topic: ${a}`);throw Error(b)}if(!this.client.core.crypto.keychain.has(a)){let{message:b}=q2("MISSING_OR_INVALID",`session topic does not exist in keychain: ${a}`);throw await this.deleteSession({topic:a}),Error(b)}}async isValidSessionOrPairingTopic(a){if(this.checkRecentlyDeleted(a),this.client.session.keys.includes(a))await this.isValidSessionTopic(a);else if(this.client.core.pairing.pairings.keys.includes(a))this.isValidPairingTopic(a);else if(q7(a,!1)){let{message:b}=q2("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${a}`);throw Error(b)}else{let{message:b}=q2("MISSING_OR_INVALID",`session or pairing topic should be a string: ${a}`);throw Error(b)}}async isValidProposalId(a){if("number"!=typeof a){let{message:b}=q2("MISSING_OR_INVALID",`proposal id should be a number: ${a}`);throw Error(b)}if(!this.client.proposal.keys.includes(a)){let{message:b}=q2("NO_MATCHING_KEY",`proposal id doesn't exist: ${a}`);throw Error(b)}if(mC(this.client.proposal.get(a).expiryTimestamp)){await this.deleteProposal(a);let{message:b}=q2("EXPIRED",`proposal id: ${a}`);throw Error(b)}}}class uK extends tT{constructor(a,b){super(a,b,"proposal",uo),this.core=a,this.logger=b}}class uL extends tT{constructor(a,b){super(a,b,"session",uo),this.core=a,this.logger=b}}class uM extends tT{constructor(a,b){super(a,b,"request",uo,a=>a.id),this.core=a,this.logger=b}}class uN extends tT{constructor(a,b){super(a,b,"authKeys",uy,()=>uz),this.core=a,this.logger=b}}class uO extends tT{constructor(a,b){super(a,b,"pairingTopics",uy),this.core=a,this.logger=b}}class uP extends tT{constructor(a,b){super(a,b,"requests",uy,a=>a.id),this.core=a,this.logger=b}}var uQ=Object.defineProperty,uR=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?uQ(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class uS{constructor(a,b){this.core=a,this.logger=b,uR(this,"authKeys"),uR(this,"pairingTopics"),uR(this,"requests"),this.authKeys=new uN(this.core,this.logger),this.pairingTopics=new uO(this.core,this.logger),this.requests=new uP(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var uT=Object.defineProperty,uU=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?uT(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class uV extends rH{constructor(a){super(a),uU(this,"protocol","wc"),uU(this,"version",2),uU(this,"name",un),uU(this,"metadata"),uU(this,"core"),uU(this,"logger"),uU(this,"events",new cg.EventEmitter),uU(this,"engine"),uU(this,"session"),uU(this,"proposal"),uU(this,"pendingRequest"),uU(this,"auth"),uU(this,"signConfig"),uU(this,"on",(a,b)=>this.events.on(a,b)),uU(this,"once",(a,b)=>this.events.once(a,b)),uU(this,"off",(a,b)=>this.events.off(a,b)),uU(this,"removeListener",(a,b)=>this.events.removeListener(a,b)),uU(this,"removeAllListeners",a=>this.events.removeAllListeners(a)),uU(this,"connect",async a=>{try{return await this.engine.connect(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"pair",async a=>{try{return await this.engine.pair(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"approve",async a=>{try{return await this.engine.approve(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"reject",async a=>{try{return await this.engine.reject(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"update",async a=>{try{return await this.engine.update(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"extend",async a=>{try{return await this.engine.extend(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"request",async a=>{try{return await this.engine.request(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"respond",async a=>{try{return await this.engine.respond(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"ping",async a=>{try{return await this.engine.ping(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"emit",async a=>{try{return await this.engine.emit(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"disconnect",async a=>{try{return await this.engine.disconnect(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"find",a=>{try{return this.engine.find(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(a){throw this.logger.error(a.message),a}}),uU(this,"authenticate",async(a,b)=>{try{return await this.engine.authenticate(a,b)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"formatAuthMessage",a=>{try{return this.engine.formatAuthMessage(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"approveSessionAuthenticate",async a=>{try{return await this.engine.approveSessionAuthenticate(a)}catch(a){throw this.logger.error(a.message),a}}),uU(this,"rejectSessionAuthenticate",async a=>{try{return await this.engine.rejectSessionAuthenticate(a)}catch(a){throw this.logger.error(a.message),a}}),this.name=a?.name||un,this.metadata=function(a){var b,c;let d=ms();try{let e,f;return null!=a&&a.url&&d.url&&new URL(a.url).host!==new URL(d.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${a.url} differs from the actual page url:${d.url}. This is probably unintended and can lead to issues.`),a.url=d.url),null!=(b=a?.icons)&&b.length&&a.icons.length>0&&(a.icons=a.icons.filter(a=>""!==a)),e=mi(mi({},d),a),f={url:a?.url||d.url,name:a?.name||d.name,description:a?.description||d.description,icons:null!=(c=a?.icons)&&c.length&&a.icons.length>0?a.icons:d.icons},mc(e,md(f))}catch(b){return console.warn("Error populating app metadata",b),a||d}}(a?.metadata),this.signConfig=a?.signConfig;const b=rn({logger:a?.logger||"error",name:this.name});this.logger=b,this.core=a?.core||new um(a),this.session=new uL(this.core,this.logger),this.proposal=new uK(this.core,this.logger),this.pendingRequest=new uM(this.core,this.logger),this.engine=new uJ(this),this.auth=new uS(this.core,this.logger)}static async init(a){let b=new uV(a);return await b.initialize(),b}get context(){return l5(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(a){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(a.message),a}}}var uW=a.i(419997);function uX(a){return null==a||"object"!=typeof a&&"function"!=typeof a}function uY(a){return Object.getOwnPropertySymbols(a).filter(b=>Object.prototype.propertyIsEnumerable.call(a,b))}function uZ(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":Object.prototype.toString.call(a)}let u$="[object String]",u_="[object Number]",u0="[object Boolean]",u1="[object Arguments]";function u2(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function u3(a,b,c,d=new Map,e){let f=e?.(a,b,c,d);if(null!=f)return f;if(uX(a))return a;if(d.has(a))return d.get(a);if(Array.isArray(a)){let b=Array(a.length);d.set(a,b);for(let f=0;f<a.length;f++)b[f]=u3(a[f],f,c,d,e);return Object.hasOwn(a,"index")&&(b.index=a.index),Object.hasOwn(a,"input")&&(b.input=a.input),b}if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp){let b=new RegExp(a.source,a.flags);return b.lastIndex=a.lastIndex,b}if(a instanceof Map){let b=new Map;for(let[f,g]of(d.set(a,b),a))b.set(f,u3(g,f,c,d,e));return b}if(a instanceof Set){let b=new Set;for(let f of(d.set(a,b),a))b.add(u3(f,void 0,c,d,e));return b}if("u">typeof Buffer&&Buffer.isBuffer(a))return a.subarray();if(u2(a)){let b=new(Object.getPrototypeOf(a)).constructor(a.length);d.set(a,b);for(let f=0;f<a.length;f++)b[f]=u3(a[f],f,c,d,e);return b}if(a instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&a instanceof SharedArrayBuffer)return a.slice(0);if(a instanceof DataView){let b=new DataView(a.buffer.slice(0),a.byteOffset,a.byteLength);return d.set(a,b),u4(b,a,c,d,e),b}if("u">typeof File&&a instanceof File){let b=new File([a],a.name,{type:a.type});return d.set(a,b),u4(b,a,c,d,e),b}if(a instanceof Blob){let b=new Blob([a],{type:a.type});return d.set(a,b),u4(b,a,c,d,e),b}if(a instanceof Error){let b=new a.constructor;return d.set(a,b),b.message=a.message,b.name=a.name,b.stack=a.stack,b.cause=a.cause,u4(b,a,c,d,e),b}if("object"==typeof a&&function(a){switch(uZ(a)){case u1:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case u0:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case u_:case"[object Object]":case"[object RegExp]":case"[object Set]":case u$:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(a)){let b=Object.create(Object.getPrototypeOf(a));return d.set(a,b),u4(b,a,c,d,e),b}return a}function u4(a,b,c=a,d,e){let f=[...Object.keys(b),...uY(b)];for(let g=0;g<f.length;g++){let h=f[g],i=Object.getOwnPropertyDescriptor(a,h);(null==i||i.writable)&&(a[h]=u3(b[h],h,c,d,e))}}function u5(a){var b;return b=(b,c,d,e)=>{let f;if(null!=f)return f;if("object"==typeof a)switch(Object.prototype.toString.call(a)){case u_:case u$:case u0:{let b=new a.constructor(a?.valueOf());return u4(b,a),b}case u1:{let b={};return u4(b,a),b.length=a.length,b[Symbol.iterator]=a[Symbol.iterator],b}default:return}},u3(a,void 0,a,new Map,b)}function u6(a){return null!==a&&"object"==typeof a&&"[object Arguments]"===uZ(a)}function u7(a){return"object"==typeof a&&null!==a}function u8(){}let u9="error",va="universal_provider",vb=`wc@2:${va}:`,vc="https://rpc.walletconnect.org/v1/",vd="generic",ve=`${vc}bundler`,vf="call_status",vg="default_chain_changed";var vh=Object.defineProperty,vi=Object.defineProperties,vj=Object.getOwnPropertyDescriptors,vk=Object.getOwnPropertySymbols,vl=Object.prototype.hasOwnProperty,vm=Object.prototype.propertyIsEnumerable,vn=(a,b,c)=>b in a?vh(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,vo=(a,b)=>{for(var c in b||(b={}))vl.call(b,c)&&vn(a,c,b[c]);if(vk)for(var c of vk(b))vm.call(b,c)&&vn(a,c,b[c]);return a},vp=(a,b)=>vi(a,vj(b));function vq(a,b,c){var d;let e=l8(a);return(null==(d=b.rpcMap)?void 0:d[e.reference])||`${vc}?chainId=${e.namespace}:${e.reference}&projectId=${c}`}function vr(a){return a.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)}function vs(a){return Object.fromEntries(Object.entries(a).filter(([a,b])=>{var c,d;return(null==(c=b?.chains)?void 0:c.length)&&(null==(d=b?.chains)?void 0:d.length)>0}))}function vt(a={},b={}){return function(a,...b){return function(a,...b){let c=b.slice(0,-1),d=b[b.length-1],e=a;for(let a=0;a<c.length;a++)e=function a(b,c,d,e){if(uX(b)&&(b=Object(b)),null==c||"object"!=typeof c)return b;if(e.has(c))return function(a){if(uX(a))return a;if(Array.isArray(a)||u2(a)||a instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&a instanceof SharedArrayBuffer)return a.slice(0);let b=Object.getPrototypeOf(a),c=b.constructor;if(a instanceof Date||a instanceof Map||a instanceof Set)return new c(a);if(a instanceof RegExp){let b=new c(a);return b.lastIndex=a.lastIndex,b}if(a instanceof DataView)return new c(a.buffer.slice(0));if(a instanceof Error){let b=new c(a.message);return b.stack=a.stack,b.name=a.name,b.cause=a.cause,b}return"u">typeof File&&a instanceof File?new c([a],a.name,{type:a.type,lastModified:a.lastModified}):"object"==typeof a?Object.assign(Object.create(b),a):a}(e.get(c));if(e.set(c,b),Array.isArray(c)){c=c.slice();for(let a=0;a<c.length;a++)c[a]=c[a]??void 0}let f=[...Object.keys(c),...uY(c)];for(let g=0;g<f.length;g++){let h=f[g],i=c[h],j=b[h];if(u6(i)&&(i={...i}),u6(j)&&(j={...j}),"u">typeof Buffer&&Buffer.isBuffer(i)&&(i=u5(i)),Array.isArray(i))if("object"==typeof j&&null!=j){let a=[],b=Reflect.ownKeys(j);for(let c=0;c<b.length;c++){let d=b[c];a[d]=j[d]}j=a}else j=[];let k=d(j,i,h,b,c,e);null!=k?b[h]=k:Array.isArray(i)||u7(j)&&u7(i)?b[h]=a(j,i,d,e):null==j&&function(a){if("object"!=typeof a||null==a)return!1;if(null===Object.getPrototypeOf(a))return!0;if("[object Object]"!==Object.prototype.toString.call(a)){let b=a[Symbol.toStringTag];return null!=b&&!!Object.getOwnPropertyDescriptor(a,Symbol.toStringTag)?.writable&&a.toString()===`[object ${b}]`}let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}(i)?b[h]=a({},i,d,e):null==j&&u2(i)?b[h]=u5(i):(void 0===j||void 0!==i)&&(b[h]=i)}return b}(e,c[a],d,new Map);return e}(a,...b,u8)}(vs(vu(a)),vs(vu(b)))}function vu(a){var b,c,d,e,f;let g={};if(!q5(a))return g;for(let[h,i]of Object.entries(a)){let a=qY(h)?[h]:i.chains,j=i.methods||[],k=i.events||[],l=i.rpcMap||{},m=qZ(h);g[m]=vp(vo(vo({},g[m]),i),{chains:mE(a,null==(b=g[m])?void 0:b.chains),methods:mE(j,null==(c=g[m])?void 0:c.methods),events:mE(k,null==(d=g[m])?void 0:d.events)}),(q5(l)||q5((null==(e=g[m])?void 0:e.rpcMap)||{}))&&(g[m].rpcMap=vo(vo({},l),null==(f=g[m])?void 0:f.rpcMap))}return g}function vv(a){return a.includes(":")?a.split(":")[2]:a}function vw(a){let b={};for(let[c,d]of Object.entries(a)){let a=d.methods||[],e=d.events||[],f=d.accounts||[],g=qY(c)?[c]:d.chains?d.chains:vr(d.accounts);b[c]={chains:g,methods:a,events:e,accounts:f}}return b}function vx(a){return"number"==typeof a?a:a.includes("0x")?parseInt(a,16):isNaN(Number(a=a.includes(":")?a.split(":")[1]:a))?a:Number(a)}let vy={},vz=a=>vy[a],vA=(a,b)=>{vy[a]=b};var vB=Object.defineProperty,vC=Object.getOwnPropertySymbols,vD=Object.prototype.hasOwnProperty,vE=Object.prototype.propertyIsEnumerable,vF=(a,b,c)=>b in a?vB(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,vG=(a,b)=>{for(var c in b||(b={}))vD.call(b,c)&&vF(a,c,b[c]);if(vC)for(var c of vC(b))vE.call(b,c)&&vF(a,c,b[c]);return a};let vH="eip155",vI=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],vJ=a=>a&&a.startsWith("0x")?BigInt(a).toString(10):a,vK=a=>a&&a.startsWith("0x")?a:`0x${BigInt(a).toString(16)}`,vL=a=>Object.keys(a).filter(a=>vI.includes(a)).reduce((b,c)=>(b[c]=vM(a[c]),b),{}),vM=a=>"string"==typeof a&&function(a){try{let b=JSON.parse(a);return"object"==typeof b&&null!==b&&!Array.isArray(b)}catch{return!1}}(a)?JSON.parse(a):a;var vN=Object.defineProperty;class vO{constructor(a){((a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?vN(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c})(this,"storage"),this.storage=a}async getItem(a){return await this.storage.getItem(a)}async setItem(a,b){return await this.storage.setItem(a,b)}async removeItem(a){return await this.storage.removeItem(a)}static getStorage(a){return e||(e=new vO(a)),e}}var vP=Object.defineProperty,vQ=Object.defineProperties,vR=Object.getOwnPropertyDescriptors,vS=Object.getOwnPropertySymbols,vT=Object.prototype.hasOwnProperty,vU=Object.prototype.propertyIsEnumerable,vV=(a,b,c)=>b in a?vP(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c;async function vW(a,b){let c,d=l8(a.result.capabilities.caip345.caip2),e=a.result.capabilities.caip345.transactionHashes,f=await Promise.allSettled(e.map(a=>vX(d.reference,a,b))),g=f.filter(a=>"fulfilled"===a.status).map(a=>a.value).filter(a=>a);f.filter(a=>"rejected"===a.status).forEach(a=>console.warn("Failed to fetch transaction receipt:",a.reason));let h=!g.length||g.some(a=>!a),i=g.every(a=>a?.status==="0x1"),j=g.every(a=>a?.status==="0x0"),k=g.some(a=>a?.status==="0x0");return h?c=100:i?c=200:j?c=500:k&&(c=600),{id:a.result.id,version:a.request.version,atomic:a.request.atomicRequired,chainId:a.request.chainId,capabilities:a.result.capabilities,receipts:g,status:c}}async function vX(a,b,c){return await c(parseInt(a)).request((0,rK.formatJsonRpcRequest)("eth_getTransactionReceipt",[b]))}async function vY({sendCalls:a,storage:b}){let c=await b.getItem(vf);await b.setItem(vf,vQ(((a,b)=>{for(var c in b||(b={}))vT.call(b,c)&&vV(a,c,b[c]);if(vS)for(var c of vS(b))vU.call(b,c)&&vV(a,c,b[c]);return a})({},c),vR({[a.result.id]:{request:a.request,result:a.result,expiry:mB(86400)}})))}async function vZ({resultId:a,storage:b}){let c=await b.getItem(vf);if(c){for(let d in delete c[a],await b.setItem(vf,c),c)mC(c[d].expiry)&&delete c[d];await b.setItem(vf,c)}}async function v$({resultId:a,storage:b}){let c=await b.getItem(vf),d=c?.[a];if(d&&!mC(d.expiry))return d;await vZ({resultId:a,storage:b})}var v_=Object.defineProperty,v0=Object.defineProperties,v1=Object.getOwnPropertyDescriptors,v2=Object.getOwnPropertySymbols,v3=Object.prototype.hasOwnProperty,v4=Object.prototype.propertyIsEnumerable,v5=(a,b,c)=>b in a?v_(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,v6=(a,b)=>{for(var c in b||(b={}))v3.call(b,c)&&v5(a,c,b[c]);if(v2)for(var c of v2(b))v4.call(b,c)&&v5(a,c,b[c]);return a},v7=(a,b,c)=>v5(a,"symbol"!=typeof b?b+"":b,c);class v8{constructor(a){v7(this,"name","eip155"),v7(this,"client"),v7(this,"chainId"),v7(this,"namespace"),v7(this,"httpProviders"),v7(this,"events"),v7(this,"storage"),this.namespace=a.namespace,this.events=vz("events"),this.client=vz("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=vO.getStorage(this.client.core.storage)}async request(a){switch(a.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(a);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(a);case"wallet_getCallsStatus":return await this.getCallStatus(a);case"wallet_sendCalls":return await this.sendCalls(a)}return this.namespace.methods.includes(a.request.method)?await this.client.request(a):this.getHttpProvider().request(a.request)}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(parseInt(a),b);let c=this.chainId;this.chainId=parseInt(a),this.events.emit(vg,{currentCaipChainId:`${this.name}:${a}`,previousCaipChainId:`${this.name}:${c}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}createHttpProvider(a,b){let c=b||vq(`${this.name}:${a}`,this.namespace,this.client.core.projectId);return new rJ.JsonRpcProvider(new uW.HttpConnection(c,vz("disableProviderPing")))}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=parseInt(b.includes(":")?b.split(":")[1]:b);a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}getHttpProvider(a){let b=a||this.chainId;return this.httpProviders[b]||(this.httpProviders=v0(v6({},this.httpProviders),v1({[b]:this.createHttpProvider(b)})),this.httpProviders[b])}async handleSwitchChain(a){var b,c;let d=a.request.params?null==(b=a.request.params[0])?void 0:b.chainId:"0x0",e=parseInt(d=d.startsWith("0x")?d:`0x${d}`,16);if(this.isChainApproved(e))this.setDefaultChain(`${e}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:a.topic,request:{method:a.request.method,params:[{chainId:d}]},chainId:null==(c=this.namespace.chains)?void 0:c[0]}),this.setDefaultChain(`${e}`);else throw Error(`Failed to switch to chain 'eip155:${e}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(a){return this.namespace.chains.includes(`${this.name}:${a}`)}async getCapabilities(a){var b,c,d,e,f;let g,h=null==(c=null==(b=a.request)?void 0:b.params)?void 0:c[0],i=(null==(e=null==(d=a.request)?void 0:d.params)?void 0:e[1])||[];if(!h)throw Error("Missing address parameter in `wallet_getCapabilities` request");let j=this.client.session.get(a.topic),k=(null==(f=j?.sessionProperties)?void 0:f.capabilities)||{},l=`${h}${i.join(",")}`,m=k?.[l];if(m)return m;try{g=((a,b,c)=>{let{sessionProperties:d={},scopedProperties:e={}}=a,f={};if(!q5(e)&&!q5(d))return;let g=vL(d);for(let a of c){let c=vJ(a);if(!c)continue;f[vK(c)]=g;let d=e?.[`${vH}:${c}`];if(d){let a=d?.[`${vH}:${c}:${b}`];f[vK(c)]=vG(vG({},f[vK(c)]),vL(a||d))}}for(let[a,b]of Object.entries(f))0===Object.keys(b).length&&delete f[a];return Object.keys(f).length>0?f:void 0})(j,h,i)}catch(a){console.warn("Failed to extract capabilities from session",a)}if(g)return g;let o=await this.client.request(a);try{let b,c,d,e;await this.client.session.update(a.topic,{sessionProperties:(d=v6({},j.sessionProperties||{}),e={capabilities:(b=v6({},k||{}),c={[l]:o},v0(b,v1(c)))},v0(d,v1(e)))})}catch(a){console.warn("Failed to update session with capabilities",a)}return o}async getCallStatus(a){var b,c,d;let e=this.client.session.get(a.topic),f=null==(b=e.sessionProperties)?void 0:b.bundler_name;if(f){let b=this.getBundlerUrl(a.chainId,f);try{return await this.getUserOperationReceipt(b,a)}catch(a){console.warn("Failed to fetch call status from bundler",a,b)}}let g=null==(c=e.sessionProperties)?void 0:c.bundler_url;if(g)try{return await this.getUserOperationReceipt(g,a)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,g)}let h=await v$({resultId:null==(d=a.request.params)?void 0:d[0],storage:this.storage});if(h)try{return await vW(h,this.getHttpProvider.bind(this))}catch(a){console.warn("Failed to fetch call status from stored send calls",a,h)}if(this.namespace.methods.includes(a.request.method))return await this.client.request(a);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(a,b){var c;let d=new URL(a),e=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,rK.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(c=b.request.params)?void 0:c[0]]))});if(!e.ok)throw Error(`Failed to fetch user operation receipt - ${e.status}`);return await e.json()}getBundlerUrl(a,b){return`${ve}?projectId=${this.client.core.projectId}&chainId=${a}&bundler=${b}`}async sendCalls(a){var b,c,d;let e=await this.client.request(a),f=null==(b=a.request.params)?void 0:b[0],g=e?.id,h=e?.capabilities||{},i=null==(c=h?.caip345)?void 0:c.caip2,j=null==(d=h?.caip345)?void 0:d.transactionHashes;return g&&i&&null!=j&&j.length&&await vY({sendCalls:{request:f,result:e},storage:this.storage}),e}}var v9=Object.defineProperty,wa=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?v9(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};class wb{constructor(a){wa(this,"name",vd),wa(this,"client"),wa(this,"httpProviders"),wa(this,"events"),wa(this,"namespace"),wa(this,"chainId"),this.namespace=a.namespace,this.events=vz("events"),this.client=vz("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(a.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(a.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(a.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(a.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider(a.chainId).request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b);let c=this.chainId;this.chainId=a,this.events.emit(vg,{currentCaipChainId:`${this.name}:${a}`,previousCaipChainId:`${this.name}:${c}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}getNamespaceName(){let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return l8(a).namespace}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){var a,b;let c={};return null==(b=null==(a=this.namespace)?void 0:a.accounts)||b.forEach(a=>{var b,d;let e=l8(a),f=null==(d=null==(b=this.namespace)?void 0:b.rpcMap)?void 0:d[`${e.namespace}:${e.reference}`];c[e.reference]=this.createHttpProvider(a,f)}),c}getHttpProvider(a){let b=l8(a).reference,c=this.httpProviders[b];if(typeof c>"u")throw Error(`JSON-RPC provider for ${a} not found`);return c}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||vq(a,this.namespace,this.client.core.projectId);return new rJ.JsonRpcProvider(new uW.default(c,vz("disableProviderPing")))}}var wc=Object.defineProperty,wd=Object.defineProperties,we=Object.getOwnPropertyDescriptors,wf=Object.getOwnPropertySymbols,wg=Object.prototype.hasOwnProperty,wh=Object.prototype.propertyIsEnumerable,wi=(a,b,c)=>b in a?wc(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,wj=(a,b)=>{for(var c in b||(b={}))wg.call(b,c)&&wi(a,c,b[c]);if(wf)for(var c of wf(b))wh.call(b,c)&&wi(a,c,b[c]);return a},wk=(a,b,c)=>wi(a,"symbol"!=typeof b?b+"":b,c);class wl{constructor(a){var b,c;wk(this,"client"),wk(this,"namespaces"),wk(this,"optionalNamespaces"),wk(this,"sessionProperties"),wk(this,"scopedProperties"),wk(this,"events",new cg.default),wk(this,"rpcProviders",{}),wk(this,"session"),wk(this,"providerOpts"),wk(this,"logger"),wk(this,"uri"),wk(this,"disableProviderPing",!1),this.providerOpts=a,this.logger=rn({logger:null!=(b=a.logger)?b:u9,name:null!=(c=this.providerOpts.name)?c:va}),this.disableProviderPing=a?.disableProviderPing||!1}static async init(a){let b=new wl(a);return await b.initialize(),b}async request(a,b,c){let[d,e]=this.validateChain(b);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(d).request({request:wj({},a),chainId:`${d}:${e}`,topic:this.session.topic,expiry:c})}sendAsync(a,b,c,d){let e=new Date().getTime();this.request(a,c,d).then(a=>b(null,(0,rK.formatJsonRpcResult)(e,a))).catch(a=>b(a,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var a;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(a=this.session)?void 0:a.topic,reason:q3("USER_DISCONNECTED")}),await this.cleanup()}async connect(a){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(a),this.cleanupPendingPairings(),!a.skipPairing)return await this.pair(a.pairingTopic)}async authenticate(a,b){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(a),await this.cleanupPendingPairings();let{uri:c,response:d}=await this.client.authenticate(a,b);c&&(this.uri=c,this.events.emit("display_uri",c));let e=await d();if(this.session=e.session,this.session){let a=vw(this.session.namespaces);this.namespaces=vt(this.namespaces,a),await this.persist("namespaces",this.namespaces),this.onConnect()}return e}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}removeListener(a,b){this.events.removeListener(a,b)}off(a,b){this.events.off(a,b)}get isWalletConnect(){return!0}async pair(a){let{uri:b,approval:c}=await this.client.connect({pairingTopic:a,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});b&&(this.uri=b,this.events.emit("display_uri",b));let d=await c();this.session=d;let e=vw(d.namespaces);return this.namespaces=vt(this.namespaces,e),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(a,b){try{if(!this.session)return;let[c,d]=this.validateChain(a);this.getProvider(c).setDefaultChain(d,b)}catch(a){if(!/Please call connect/.test(a.message))throw a}}async cleanupPendingPairings(a={}){try{this.logger.info("Cleaning up inactive pairings...");let b=this.client.pairing.getAll();if(!q4(b))return;for(let c of b)a.deletePairings?this.client.core.expirer.set(c.topic,0):await this.client.core.relayer.subscriber.unsubscribe(c.topic);this.logger.info(`Inactive pairings cleared: ${b.length}`)}catch(a){this.logger.warn(a,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var a,b;if(this.client=this.providerOpts.client||await uV.init({core:this.providerOpts.core,logger:this.providerOpts.logger||u9,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(c){throw this.logger.error(c,"Failed to get session"),Error(`The provided session: ${null==(b=null==(a=this.providerOpts)?void 0:a.session)?void 0:b.topic} doesn't exist in the Sign client`)}else{let a=this.client.session.getAll();this.session=a[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let a=[...new Set(Object.keys(this.session.namespaces).map(a=>qZ(a)))];vA("client",this.client),vA("events",this.events),vA("disableProviderPing",this.disableProviderPing),a.forEach(a=>{if(!this.session)return;let b=function(a,b){let c=Object.keys(b.namespaces).filter(b=>b.includes(a));if(!c.length)return[];let d=[];return c.forEach(a=>{let c=b.namespaces[a].accounts;d.push(...c)}),d}(a,this.session);if(b?.length===0)return;let c=vr(b),d=wd(wj({},vt(this.namespaces,this.optionalNamespaces)[a]),we({accounts:b,chains:c}));"eip155"===a?this.rpcProviders[a]=new v8({namespace:d}):this.rpcProviders[a]=new wb({namespace:d})})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",a=>{var b;let{topic:c}=a;c===(null==(b=this.session)?void 0:b.topic)&&this.events.emit("session_ping",a)}),this.client.on("session_event",a=>{var b;let{params:c,topic:d}=a;if(d!==(null==(b=this.session)?void 0:b.topic))return;let{event:e}=c;if("accountsChanged"===e.name){let a=e.data;a&&q4(a)&&this.events.emit("accountsChanged",a.map(vv))}else if("chainChanged"===e.name){let a=c.chainId,b=c.event.data,d=qZ(a),e=vx(a)!==vx(b)?`${d}:${vx(b)}`:a;this.onChainChanged({currentCaipChainId:e})}else this.events.emit(e.name,e.data);this.events.emit("session_event",a)}),this.client.on("session_update",({topic:a,params:b})=>{var c,d;if(a!==(null==(c=this.session)?void 0:c.topic))return;let{namespaces:e}=b,f=null==(d=this.client)?void 0:d.session.get(a);this.session=wd(wj({},f),we({namespaces:e})),this.onSessionUpdate(),this.events.emit("session_update",{topic:a,params:b})}),this.client.on("session_delete",async a=>{var b;a.topic===(null==(b=this.session)?void 0:b.topic)&&(await this.cleanup(),this.events.emit("session_delete",a),this.events.emit("disconnect",wd(wj({},q3("USER_DISCONNECTED")),we({data:a.topic}))))}),this.on(vg,a=>{this.onChainChanged(wd(wj({},a),we({internal:!0})))})}getProvider(a){return this.rpcProviders[a]||this.rpcProviders[vd]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(a=>{var b;this.getProvider(a).updateNamespace(null==(b=this.session)?void 0:b.namespaces[a])})}setNamespaces(a){let{namespaces:b={},optionalNamespaces:c={},sessionProperties:d,scopedProperties:e}=a;this.optionalNamespaces=vt(b,c),this.sessionProperties=d,this.scopedProperties=e}validateChain(a){let[b,c]=a?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[b,c];if(b&&!Object.keys(this.namespaces||{}).map(a=>qZ(a)).includes(b))throw Error(`Namespace '${b}' is not configured. Please call connect() first with namespace config.`);if(b&&c)return[b,c];let d=qZ(Object.keys(this.namespaces)[0]),e=this.rpcProviders[d].getDefaultChain();return[d,e]}async requestAccounts(){let[a]=this.validateChain();return await this.getProvider(a).requestAccounts()}async onChainChanged({currentCaipChainId:a,previousCaipChainId:b,internal:c=!1}){if(!this.namespaces)return;let[d,e]=this.validateChain(a);e&&(this.updateNamespaceChain(d,e),c?(this.events.emit("chainChanged",e),this.emitAccountsChangedOnChainChange({namespace:d,currentCaipChainId:a,previousCaipChainId:b})):this.getProvider(d).setDefaultChain(e),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:a,currentCaipChainId:b,previousCaipChainId:c}){var d,e;try{if(c===b)return;let f=null==(e=null==(d=this.session)?void 0:d.namespaces[a])?void 0:e.accounts;if(!f)return;let g=f.filter(a=>a.includes(`${b}:`)).map(vv);if(!q4(g))return;this.events.emit("accountsChanged",g)}catch(a){this.logger.warn(a,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(a,b){if(!this.namespaces)return;let c=this.namespaces[a]?a:`${a}:${b}`;this.namespaces[c]?this.namespaces[c]&&(this.namespaces[c].defaultChain=b):this.namespaces[c]={chains:[],methods:[],events:[],defaultChain:b}}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(a,b){var c;let d=(null==(c=this.session)?void 0:c.topic)||"";await this.client.core.storage.setItem(`${vb}/${a}${d}`,b)}async getFromStore(a){var b;let c=(null==(b=this.session)?void 0:b.topic)||"";return await this.client.core.storage.getItem(`${vb}/${a}${c}`)}async deleteFromStore(a){var b;let c=(null==(b=this.session)?void 0:b.topic)||"";await this.client.core.storage.removeItem(`${vb}/${a}${c}`)}async cleanupStorage(){var a;try{if((null==(a=this.client)?void 0:a.session.length)>0)return;for(let a of(await this.client.core.storage.getKeys()))a.startsWith(vb)&&await this.client.core.storage.removeItem(a)}catch(a){this.logger.warn(a,"Failed to cleanup storage")}}}let wm=["eth_sendTransaction","personal_sign"],wn=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],wo=["chainChanged","accountsChanged"],wp=["chainChanged","accountsChanged","message","disconnect","connect"],wq=async()=>{let{createAppKit:b}=await a.A(225206);return b};var wr=Object.defineProperty,ws=Object.defineProperties,wt=Object.getOwnPropertyDescriptors,wu=Object.getOwnPropertySymbols,wv=Object.prototype.hasOwnProperty,ww=Object.prototype.propertyIsEnumerable,wx=(a,b,c)=>b in a?wr(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,wy=(a,b)=>{for(var c in b||(b={}))wv.call(b,c)&&wx(a,c,b[c]);if(wu)for(var c of wu(b))ww.call(b,c)&&wx(a,c,b[c]);return a},wz=(a,b,c)=>wx(a,"symbol"!=typeof b?b+"":b,c);function wA(a){return Number(a[0].split(":")[1])}function wB(a){return`0x${a.toString(16)}`}class wC{constructor(){wz(this,"events",new cg.EventEmitter),wz(this,"namespace","eip155"),wz(this,"accounts",[]),wz(this,"signer"),wz(this,"chainId",1),wz(this,"modal"),wz(this,"rpc"),wz(this,"STORAGE_KEY","wc@2:ethereum_provider:"),wz(this,"on",(a,b)=>(this.events.on(a,b),this)),wz(this,"once",(a,b)=>(this.events.once(a,b),this)),wz(this,"removeListener",(a,b)=>(this.events.removeListener(a,b),this)),wz(this,"off",(a,b)=>(this.events.off(a,b),this)),wz(this,"parseAccount",a=>this.isCompatibleChainId(a)?this.parseAccountId(a).address:a),this.signer={},this.rpc={}}static async init(a){let b=new wC;return await b.initialize(a),b}async request(a,b){return await this.signer.request(a,this.formatChainId(this.chainId),b)}sendAsync(a,b,c){this.signer.sendAsync(a,b,this.formatChainId(this.chainId),c)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(a){var b;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts(a);let{required:c,optional:d}=function(a){let{chains:b,optionalChains:c,methods:d,optionalMethods:e,events:f,optionalEvents:g,rpcMap:h}=a;if(!q4(b))throw Error("Invalid chains");let i={chains:b,methods:d||wm,events:f||wo,rpcMap:wy({},b.length?{[wA(b)]:h[wA(b)]}:{})},j=f?.filter(a=>!wo.includes(a)),k=d?.filter(a=>!wm.includes(a));if(!c&&!g&&!e&&!(null!=j&&j.length)&&!(null!=k&&k.length))return{required:b.length?i:void 0};let l={chains:[...new Set(j?.length&&k?.length||!c?i.chains.concat(c||[]):c)],methods:[...new Set(i.methods.concat(null!=e&&e.length?e:wn))],events:[...new Set(i.events.concat(null!=g&&g.length?g:wp))],rpcMap:h};return{required:b.length?i:void 0,optional:c.length?l:void 0}}(this.rpc);try{let b=await new Promise(async(b,e)=>{var f,g;let h,i;this.rpc.showQrModal&&(null==(f=this.modal)||f.open(),null==(g=this.modal)||g.subscribeState(a=>{a.open||this.signer.session||(this.signer.abortPairingAttempt(),e(Error("Connection request reset. Please try again.")))}));let j=null!=a&&a.scopedProperties?{[this.namespace]:a.scopedProperties}:void 0;await this.signer.connect((h=wy({namespaces:wy({},c&&{[this.namespace]:c})},d&&{optionalNamespaces:{[this.namespace]:d}}),i={pairingTopic:a?.pairingTopic,scopedProperties:j},ws(h,wt(i)))).then(a=>{b(a)}).catch(a=>{var b;null==(b=this.modal)||b.showErrorMessage("Unable to connect"),e(Error(a.message))})});if(!b)return;let e=l9(b.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:e),this.setAccounts(e),this.events.emit("connect",{chainId:wB(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{null==(b=this.modal)||b.close()}}async authenticate(a,b){var c;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:a?.chains});try{let c=await new Promise(async(c,d)=>{var e,f;let g,h;this.rpc.showQrModal&&(null==(e=this.modal)||e.open(),null==(f=this.modal)||f.subscribeState(a=>{a.open||this.signer.session||(this.signer.abortPairingAttempt(),d(Error("Connection request reset. Please try again.")))})),await this.signer.authenticate((g=wy({},a),h={chains:this.rpc.chains},ws(g,wt(h))),b).then(a=>{c(a)}).catch(a=>{var b;null==(b=this.modal)||b.showErrorMessage("Unable to connect"),d(Error(a.message))})}),d=c.session;if(d){let a=l9(d.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:wB(this.chainId)})}return c}catch(a){throw this.signer.logger.error(a),a}finally{null==(c=this.modal)||c.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",a=>{let{params:b}=a,{event:c}=b;"accountsChanged"===c.name?(this.accounts=this.parseAccounts(c.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===c.name?this.setChainId(this.formatChainId(c.data)):this.events.emit(c.name,c.data),this.events.emit("session_event",a)}),this.signer.on("accountsChanged",a=>{this.accounts=this.parseAccounts(a),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",a=>{let b=parseInt(a);this.chainId=b,this.events.emit("chainChanged",wB(this.chainId)),this.persist()}),this.signer.on("session_update",a=>{this.events.emit("session_update",a)}),this.signer.on("session_delete",a=>{this.reset(),this.events.emit("session_delete",a),this.events.emit("disconnect",ws(wy({},q3("USER_DISCONNECTED")),wt({data:a.topic,name:"USER_DISCONNECTED"})))}),this.signer.on("display_uri",a=>{this.events.emit("display_uri",a)})}switchEthereumChain(a){this.request({method:"wallet_switchEthereumChain",params:[{chainId:a.toString(16)}]})}isCompatibleChainId(a){return"string"==typeof a&&a.startsWith(`${this.namespace}:`)}formatChainId(a){return`${this.namespace}:${a}`}parseChainId(a){return Number(a.split(":")[1])}setChainIds(a){let b=a.filter(a=>this.isCompatibleChainId(a)).map(a=>this.parseChainId(a));b.length&&(this.chainId=b[0],this.events.emit("chainChanged",wB(this.chainId)),this.persist())}setChainId(a){if(this.isCompatibleChainId(a)){let b=this.parseChainId(a);this.chainId=b,this.switchEthereumChain(b)}}parseAccountId(a){let[b,c,d]=a.split(":");return{chainId:`${b}:${c}`,address:d}}setAccounts(a){this.accounts=a.filter(a=>this.parseChainId(this.parseAccountId(a).chainId)===this.chainId).map(a=>this.parseAccountId(a).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(a){var b,c;let d=null!=(b=a?.chains)?b:[],e=null!=(c=a?.optionalChains)?c:[],f=d.concat(e);if(!f.length)throw Error("No chains specified in either `chains` or `optionalChains`");let g=d.length?a?.methods||wm:[],h=d.length?a?.events||wo:[],i=a?.optionalMethods||[],j=a?.optionalEvents||[],k=a?.rpcMap||this.buildRpcMap(f,a.projectId),l=a?.qrModalOptions||void 0;return{chains:d?.map(a=>this.formatChainId(a)),optionalChains:e.map(a=>this.formatChainId(a)),methods:g,events:h,optionalMethods:i,optionalEvents:j,rpcMap:k,showQrModal:!!(null!=a&&a.showQrModal),qrModalOptions:l,projectId:a.projectId,metadata:a.metadata}}buildRpcMap(a,b){let c={};return a.forEach(a=>{c[a]=this.getRpcUrl(a,b)}),c}async initialize(a){var b;if(this.rpc=this.getRpcConfig(a),this.chainId=this.rpc.chains.length?wA(this.rpc.chains):wA(this.rpc.optionalChains),this.signer=await wl.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:a.disableProviderPing,relayUrl:a.relayUrl,storage:a.storage,storageOptions:a.storageOptions,customStoragePrefix:a.customStoragePrefix,telemetryEnabled:a.telemetryEnabled,logger:a.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let a;try{let c,d,e,f,g=await wq(),{convertWCMToAppKitOptions:h}=await Promise.resolve().then(function(){return wN}),i=h((c=wy({},this.rpc.qrModalOptions),d={chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId},ws(c,wt(d))));if(!i.networks.length)throw Error("No networks found for WalletConnectÂ·");a=g((e=wy({},i),f={universalProvider:this.signer,manualWCControl:!0,enableMobileFullScreen:(null==(b=this.rpc.qrModalOptions)?void 0:b.enableMobileFullScreen)===!0},ws(e,wt(f))))}catch(a){throw console.warn(a),Error("To use QR modal, please install @reown/appkit package")}if(a)try{this.modal=a}catch(a){throw this.signer.logger.error(a),Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(a){if(!a)return;let{chains:b,optionalChains:c,rpcMap:d}=a;b&&q4(b)&&(this.rpc.chains=b.map(a=>this.formatChainId(a)),b.forEach(a=>{this.rpc.rpcMap[a]=d?.[a]||this.getRpcUrl(a)})),c&&q4(c)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=c?.map(a=>this.formatChainId(a)),c.forEach(a=>{this.rpc.rpcMap[a]=d?.[a]||this.getRpcUrl(a)}))}getRpcUrl(a,b){var c;return(null==(c=this.rpc.rpcMap)?void 0:c[a])||`https://rpc.walletconnect.org/v1/?chainId=eip155:${a}&projectId=${b||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{let a=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),b=this.session.namespaces[`${this.namespace}:${a}`]?this.session.namespaces[`${this.namespace}:${a}`]:this.session.namespaces[this.namespace];this.setChainIds(a?[this.formatChainId(a)]:b?.accounts),this.setAccounts(b?.accounts)}catch(a){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(a),await this.disconnect().catch(a=>this.signer.logger.warn(a))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(a){return"string"==typeof a||a instanceof String?[this.parseAccount(a)]:a.map(a=>this.parseAccount(a))}}var wD=Object.defineProperty,wE=Object.defineProperties,wF=Object.getOwnPropertyDescriptors,wG=Object.getOwnPropertySymbols,wH=Object.prototype.hasOwnProperty,wI=Object.prototype.propertyIsEnumerable,wJ=(a,b,c)=>b in a?wD(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,wK=(a,b)=>{for(var c in b||(b={}))wH.call(b,c)&&wJ(a,c,b[c]);if(wG)for(var c of wG(b))wI.call(b,c)&&wJ(a,c,b[c]);return a};let wL=a=>{let[b,c]=a.split(":");return wM({id:c,caipNetworkId:a,chainNamespace:b,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function wM(a){return wK({formatters:void 0,fees:void 0,serializers:void 0},a)}var wN=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(a){var b,c,d,e,f,g,h;let i=null==(b=a.chains)?void 0:b.map(wL).filter(Boolean);if(0===i.length)throw Error("At least one chain must be specified");let j=i.find(b=>{var c;return b.id===(null==(c=a.defaultChain)?void 0:c.id)}),k={projectId:a.projectId,networks:i,themeMode:a.themeMode,themeVariables:function(a){if(a)return{"--w3m-font-family":a["--wcm-font-family"],"--w3m-accent":a["--wcm-accent-color"],"--w3m-color-mix":a["--wcm-background-color"],"--w3m-z-index":a["--wcm-z-index"]?Number(a["--wcm-z-index"]):void 0,"--w3m-qr-color":a["--wcm-accent-color"],"--w3m-font-size-master":a["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":a["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}(a.themeVariables),chainImages:a.chainImages,connectorImages:a.walletImages,defaultNetwork:j,metadata:wE(wK({},a.metadata),wF({name:(null==(c=a.metadata)?void 0:c.name)||"WalletConnect",description:(null==(d=a.metadata)?void 0:d.description)||"Connect to WalletConnect-compatible wallets",url:(null==(e=a.metadata)?void 0:e.url)||"https://walletconnect.org",icons:(null==(f=a.metadata)?void 0:f.icons)||["https://walletconnect.org/walletconnect-logo.png"]})),showWallets:!0,featuredWalletIds:"NONE"===a.explorerRecommendedWalletIds?[]:Array.isArray(a.explorerRecommendedWalletIds)?a.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===a.explorerExcludedWalletIds?[]:Array.isArray(a.explorerExcludedWalletIds)?a.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(g=a.mobileWallets)&&g.length||null!=(h=a.desktopWallets)&&h.length){let b=[...(a.mobileWallets||[]).map(a=>({id:a.id,name:a.name,links:a.links})),...(a.desktopWallets||[]).map(a=>({id:a.id,name:a.name,links:{native:a.links.native,universal:a.links.universal}}))],c=[...k.featuredWalletIds||[],...k.excludeWalletIds||[]],d=b.filter(a=>!c.includes(a.id));d.length&&(k.customWallets=d)}return k},defineChain:wM}),wO=a.i(629273);a.i(206323);var wP=a.i(584617),wQ=a.i(392911);a.i(628952);var wR=a.i(104235),wS=a.i(697913),wT=a.i(505434),wU=Object.defineProperty,wV=(a,b)=>{for(var c in b)wU(a,c,{get:b[c],enumerable:!0})},wW={84532:{usdcAddress:"0x036CbD53842c5426634e7929541eC2318f3dCF7e",usdcName:"USDC"},8453:{usdcAddress:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",usdcName:"USD Coin"},43113:{usdcAddress:"0x5425890298aed601595a70AB815c96711a31Bc65",usdcName:"USD Coin"},43114:{usdcAddress:"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E",usdcName:"USD Coin"},4689:{usdcAddress:"0xcdf79194c6c285077a58da47641d4dbe51f63542",usdcName:"Bridged USDC"},103:{usdcAddress:"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU",usdcName:"USDC"},101:{usdcAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",usdcName:"USDC"},1328:{usdcAddress:"0x4fcf1784b31630811181f670aea7a7bef803eaed",usdcName:"USDC"},1329:{usdcAddress:"0xe15fc38f6d8c56af07bbcbe3baf5708a2bf42392",usdcName:"USDC"},137:{usdcAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",usdcName:"USD Coin"},80002:{usdcAddress:"0x41E94Eb019C0762f9Bfcf9Fb1E58725BfB0e7582",usdcName:"USDC"},3338:{usdcAddress:"0xbbA60da06c2c5424f03f7434542280FCAd453d10",usdcName:"USDC"},2741:{usdcAddress:"0x84a71ccd554cc1b02749b35d22f684cc8ec987e1",usdcName:"Bridged USDC"},11124:{usdcAddress:"0xe4C7fBB0a626ed208021ccabA6Be1566905E2dFc",usdcName:"Bridged USDC"},1514:{usdcAddress:"0xF1815bd50389c46847f0Bda824eC8da914045D14",usdcName:"Bridged USDC"},41923:{usdcAddress:"0x12a272A581feE5577A5dFa371afEB4b2F3a8C2F8",usdcName:"Bridged USDC (Stargate)"},0x135a9d92:{usdcAddress:"0x2e08028E3C4c2356572E096d8EF835cD5C6030bD",usdcName:"Bridged USDC (SKALE Bridge)"}},wX=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"authorizer",type:"address"},{indexed:!0,internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"AuthorizationCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"authorizer",type:"address"},{indexed:!0,internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"AuthorizationUsed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_account",type:"address"}],name:"Blacklisted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newBlacklister",type:"address"}],name:"BlacklisterChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"burner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Burn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newMasterMinter",type:"address"}],name:"MasterMinterChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"minter",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"minter",type:"address"},{indexed:!1,internalType:"uint256",name:"minterAllowedAmount",type:"uint256"}],name:"MinterConfigured",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"oldMinter",type:"address"}],name:"MinterRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"previousOwner",type:"address"},{indexed:!1,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[],name:"Pause",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newAddress",type:"address"}],name:"PauserChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newRescuer",type:"address"}],name:"RescuerChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_account",type:"address"}],name:"UnBlacklisted",type:"event"},{anonymous:!1,inputs:[],name:"Unpause",type:"event"},{inputs:[],name:"CANCEL_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"PERMIT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"RECEIVE_WITH_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"TRANSFER_WITH_AUTHORIZATION_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"}],name:"authorizationState",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"blacklist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"blacklister",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_amount",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"cancelAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"authorizer",type:"address"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"cancelAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"},{internalType:"uint256",name:"minterAllowedAmount",type:"uint256"}],name:"configureMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"currency",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"decrement",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"increment",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"tokenName",type:"string"},{internalType:"string",name:"tokenSymbol",type:"string"},{internalType:"string",name:"tokenCurrency",type:"string"},{internalType:"uint8",name:"tokenDecimals",type:"uint8"},{internalType:"address",name:"newMasterMinter",type:"address"},{internalType:"address",name:"newPauser",type:"address"},{internalType:"address",name:"newBlacklister",type:"address"},{internalType:"address",name:"newOwner",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newName",type:"string"}],name:"initializeV2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"lostAndFound",type:"address"}],name:"initializeV2_1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"accountsToBlacklist",type:"address[]"},{internalType:"string",name:"newSymbol",type:"string"}],name:"initializeV2_2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"isBlacklisted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"masterMinter",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_to",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"minterAllowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"pauser",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"receiveWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"receiveWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"minter",type:"address"}],name:"removeMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"tokenContract",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"rescueERC20",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rescuer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"transferWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"validAfter",type:"uint256"},{internalType:"uint256",name:"validBefore",type:"uint256"},{internalType:"bytes32",name:"nonce",type:"bytes32"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"transferWithAuthorization",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_account",type:"address"}],name:"unBlacklist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newBlacklister",type:"address"}],name:"updateBlacklister",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newMasterMinter",type:"address"}],name:"updateMasterMinter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newPauser",type:"address"}],name:"updatePauser",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newRescuer",type:"address"}],name:"updateRescuer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function"}];a.s([],958425),a.i(958425),(D3=Ej||(Ej={})).assertEqual=a=>{},D3.assertIs=function(a){},D3.assertNever=function(a){throw Error()},D3.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},D3.getValidEnumValues=a=>{let b=D3.objectKeys(a).filter(b=>"number"!=typeof a[a[b]]),c={};for(let d of b)c[d]=a[d];return D3.objectValues(c)},D3.objectValues=a=>D3.objectKeys(a).map(function(b){return a[b]}),D3.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},D3.find=(a,b)=>{for(let c of a)if(b(c))return c},D3.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&Number.isFinite(a)&&Math.floor(a)===a,D3.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},D3.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b,(Ek||(Ek={})).mergeShapes=(a,b)=>({...a,...b});let wY=Ej.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),wZ=a=>{switch(typeof a){case"undefined":return wY.undefined;case"string":return wY.string;case"number":return Number.isNaN(a)?wY.nan:wY.number;case"boolean":return wY.boolean;case"function":return wY.function;case"bigint":return wY.bigint;case"symbol":return wY.symbol;case"object":if(Array.isArray(a))return wY.array;if(null===a)return wY.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return wY.promise;if("undefined"!=typeof Map&&a instanceof Map)return wY.map;if("undefined"!=typeof Set&&a instanceof Set)return wY.set;if("undefined"!=typeof Date&&a instanceof Date)return wY.date;return wY.object;default:return wY.unknown}};a.s(["ZodParsedType",0,wY,"getParsedType",0,wZ,"objectUtil",()=>Ek,"util",()=>Ej],609197);let w$=Ej.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),w_=a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:");class w0 extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof w0))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ej.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)if(d.path.length>0){let c=d.path[0];b[c]=b[c]||[],b[c].push(a(d))}else c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}w0.create=a=>new w0(a),a.s(["ZodError",()=>w0,"ZodIssueCode",0,w$,"quotelessJson",0,w_],481440);let w1=(a,b)=>{let c;switch(a.code){case w$.invalid_type:c=a.received===wY.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case w$.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,Ej.jsonStringifyReplacer)}`;break;case w$.unrecognized_keys:c=`Unrecognized key(s) in object: ${Ej.joinValues(a.keys,", ")}`;break;case w$.invalid_union:c="Invalid input";break;case w$.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${Ej.joinValues(a.options)}`;break;case w$.invalid_enum_value:c=`Invalid enum value. Expected ${Ej.joinValues(a.options)}, received '${a.received}'`;break;case w$.invalid_arguments:c="Invalid function arguments";break;case w$.invalid_return_type:c="Invalid function return type";break;case w$.invalid_date:c="Invalid date";break;case w$.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:Ej.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case w$.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type||"bigint"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case w$.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case w$.custom:c="Invalid input";break;case w$.invalid_intersection_types:c="Intersection results could not be merged";break;case w$.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case w$.not_finite:c="Number must be finite";break;default:c=b.defaultError,Ej.assertNever(a)}return{message:c}},w2=w1;function w3(a){w2=a}function w4(){return w2}a.s(["getErrorMap",()=>w4,"setErrorMap",()=>w3],929415),a.i(929415),a.s(["defaultErrorMap",0,w1,"getErrorMap",()=>w4,"setErrorMap",()=>w3],177662),a.i(177662);let w5=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}},w6=[];function w7(a,b){let c=w2,d=w5({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,c,c===w1?void 0:w1].filter(a=>!!a)});a.common.issues.push(d)}class w8{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return w9;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return w8.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return w9;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let w9=Object.freeze({status:"aborted"}),xa=a=>({status:"dirty",value:a}),xb=a=>({status:"valid",value:a}),xc=a=>"aborted"===a.status,xd=a=>"dirty"===a.status,xe=a=>"valid"===a.status,xf=a=>"undefined"!=typeof Promise&&a instanceof Promise;a.s(["DIRTY",0,xa,"EMPTY_PATH",0,w6,"INVALID",0,w9,"OK",0,xb,"ParseStatus",()=>w8,"addIssueToContext",()=>w7,"isAborted",0,xc,"isAsync",0,xf,"isDirty",0,xd,"isValid",0,xe,"makeIssue",0,w5],285244),a.i(285244),a.s([],65416),a.i(65416),a.i(609197),(D4=El||(El={})).errToObj=a=>"string"==typeof a?{message:a}:a||{},D4.toString=a=>"string"==typeof a?a:a?.message;class xg{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let xh=(a,b)=>{if(xe(b))return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new w0(a.common.issues);return this._error=b,this._error}}};function xi(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{let{message:f}=a;return"invalid_enum_value"===b.code?{message:f??e.defaultError}:void 0===e.data?{message:f??d??e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:f??c??e.defaultError}},description:e}}class xj{get description(){return this._def.description}_getType(a){return wZ(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:wZ(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new w8,ctx:{common:a.parent.common,data:a.data,parsedType:wZ(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(xf(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){let c={common:{issues:[],async:b?.async??!1,contextualErrorMap:b?.errorMap},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:wZ(a)},d=this._parseSync({data:a,path:c.path,parent:c});return xh(c,d)}"~validate"(a){let b={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:wZ(a)};if(!this["~standard"].async)try{let c=this._parseSync({data:a,path:[],parent:b});return xe(c)?{value:c.value}:{issues:b.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),b.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:b}).then(a=>xe(a)?{value:a.value}:{issues:b.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:b?.errorMap,async:!0},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:wZ(a)},d=this._parse({data:a,path:c.path,parent:c});return xh(c,await (xf(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:w$.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new x3({schema:this,typeName:Em.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return x4.create(this,this._def)}nullable(){return x5.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xO.create(this)}promise(){return x2.create(this,this._def)}or(a){return xQ.create([this,a],this._def)}and(a){return xT.create(this,a,this._def)}transform(a){return new x3({...xi(this._def),schema:this,typeName:Em.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new x6({...xi(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:Em.ZodDefault})}brand(){return new ya({typeName:Em.ZodBranded,type:this,...xi(this._def)})}catch(a){return new x7({...xi(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:Em.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return yb.create(this,a)}readonly(){return yc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let xk=/^c[^\s-]{8,}$/i,xl=/^[0-9a-z]+$/,xm=/^[0-9A-HJKMNP-TV-Z]{26}$/i,xn=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xo=/^[a-z0-9_-]{21}$/i,xp=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,xq=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,xr=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,xs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,xt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,xu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,xv=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,xw=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,xx=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,xy="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",xz=RegExp(`^${xy}$`);function xA(a){let b="[0-5]\\d";a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`);let c=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${b})${c}`}function xB(a){let b=`${xy}T${xA(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)}class xC extends xj{_parse(a){var b,c,d,e;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==wY.string){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.string,received:b.parsedType}),w9}let h=new w8;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(w7(g=this._getOrReturnCtx(a,g),{code:w$.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(w7(g=this._getOrReturnCtx(a,g),{code:w$.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?w7(g,{code:w$.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&w7(g,{code:w$.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)xr.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"email",code:w$.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)f||(f=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),f.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:w$.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)xn.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:w$.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)xo.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:w$.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)xk.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:w$.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)xl.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:w$.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)xm.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:w$.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch{w7(g=this._getOrReturnCtx(a,g),{validation:"url",code:w$.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"regex",code:w$.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(w7(g=this._getOrReturnCtx(a,g),{code:w$.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(w7(g=this._getOrReturnCtx(a,g),{code:w$.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(w7(g=this._getOrReturnCtx(a,g),{code:w$.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?xB(i).test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{code:w$.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?xz.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{code:w$.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${xA(i)}$`).test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{code:w$.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?xq.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"duration",code:w$.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&xs.test(b)||("v6"===c||!c)&&xu.test(b))&&1&&(w7(g=this._getOrReturnCtx(a,g),{validation:"ip",code:w$.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!xp.test(a))return!1;try{let[c]=a.split(".");if(!c)return!1;let d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||"typ"in e&&e?.typ!=="JWT"||!e.alg||b&&e.alg!==b)return!1;return!0}catch{return!1}}(a.data,i.alg)&&(w7(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:w$.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(d=a.data,!(("v4"===(e=i.version)||!e)&&xt.test(d)||("v6"===e||!e)&&xv.test(d))&&1&&(w7(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:w$.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?xw.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"base64",code:w$.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?xx.test(a.data)||(w7(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:w$.invalid_string,message:i.message}),h.dirty()):Ej.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:w$.invalid_string,...El.errToObj(c)})}_addCheck(a){return new xC({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...El.errToObj(a)})}url(a){return this._addCheck({kind:"url",...El.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...El.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...El.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...El.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...El.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...El.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...El.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...El.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...El.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...El.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...El.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...El.errToObj(a)})}datetime(a){return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===a?.precision?null:a?.precision,offset:a?.offset??!1,local:a?.local??!1,...El.errToObj(a?.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===a?.precision?null:a?.precision,...El.errToObj(a?.message)})}duration(a){return this._addCheck({kind:"duration",...El.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...El.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:b?.position,...El.errToObj(b?.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...El.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...El.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...El.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...El.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...El.errToObj(b)})}nonempty(a){return this.min(1,El.errToObj(a))}trim(){return new xC({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new xC({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new xC({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}xC.create=a=>new xC({checks:[],typeName:Em.ZodString,coerce:a?.coerce??!1,...xi(a)});class xD extends xj{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==wY.number){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.number,received:b.parsedType}),w9}let c=new w8;for(let d of this._def.checks)"int"===d.kind?Ej.isInteger(a.data)||(w7(b=this._getOrReturnCtx(a,b),{code:w$.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(a.data,d.value)&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(w7(b=this._getOrReturnCtx(a,b),{code:w$.not_finite,message:d.message}),c.dirty()):Ej.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,El.toString(b))}gt(a,b){return this.setLimit("min",a,!1,El.toString(b))}lte(a,b){return this.setLimit("max",a,!0,El.toString(b))}lt(a,b){return this.setLimit("max",a,!1,El.toString(b))}setLimit(a,b,c,d){return new xD({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:El.toString(d)}]})}_addCheck(a){return new xD({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:El.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:El.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:El.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:El.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:El.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:El.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:El.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:El.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:El.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&Ej.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}xD.create=a=>new xD({checks:[],typeName:Em.ZodNumber,coerce:a?.coerce||!1,...xi(a)});class xE extends xj{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch{return this._getInvalidInput(a)}if(this._getType(a)!==wY.bigint)return this._getInvalidInput(a);let c=new w8;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):Ej.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.bigint,received:b.parsedType}),w9}gte(a,b){return this.setLimit("min",a,!0,El.toString(b))}gt(a,b){return this.setLimit("min",a,!1,El.toString(b))}lte(a,b){return this.setLimit("max",a,!0,El.toString(b))}lt(a,b){return this.setLimit("max",a,!1,El.toString(b))}setLimit(a,b,c,d){return new xE({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:El.toString(d)}]})}_addCheck(a){return new xE({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:El.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:El.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:El.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:El.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:El.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}xE.create=a=>new xE({checks:[],typeName:Em.ZodBigInt,coerce:a?.coerce??!1,...xi(a)});class xF extends xj{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==wY.boolean){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.boolean,received:b.parsedType}),w9}return xb(a.data)}}xF.create=a=>new xF({typeName:Em.ZodBoolean,coerce:a?.coerce||!1,...xi(a)});class xG extends xj{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==wY.date){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.date,received:b.parsedType}),w9}if(Number.isNaN(a.data.getTime()))return w7(this._getOrReturnCtx(a),{code:w$.invalid_date}),w9;let c=new w8;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(w7(b=this._getOrReturnCtx(a,b),{code:w$.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):Ej.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new xG({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:El.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:El.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}xG.create=a=>new xG({checks:[],coerce:a?.coerce||!1,typeName:Em.ZodDate,...xi(a)});class xH extends xj{_parse(a){if(this._getType(a)!==wY.symbol){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.symbol,received:b.parsedType}),w9}return xb(a.data)}}xH.create=a=>new xH({typeName:Em.ZodSymbol,...xi(a)});class xI extends xj{_parse(a){if(this._getType(a)!==wY.undefined){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.undefined,received:b.parsedType}),w9}return xb(a.data)}}xI.create=a=>new xI({typeName:Em.ZodUndefined,...xi(a)});class xJ extends xj{_parse(a){if(this._getType(a)!==wY.null){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.null,received:b.parsedType}),w9}return xb(a.data)}}xJ.create=a=>new xJ({typeName:Em.ZodNull,...xi(a)});class xK extends xj{constructor(){super(...arguments),this._any=!0}_parse(a){return xb(a.data)}}xK.create=a=>new xK({typeName:Em.ZodAny,...xi(a)});class xL extends xj{constructor(){super(...arguments),this._unknown=!0}_parse(a){return xb(a.data)}}xL.create=a=>new xL({typeName:Em.ZodUnknown,...xi(a)});class xM extends xj{_parse(a){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.never,received:b.parsedType}),w9}}xM.create=a=>new xM({typeName:Em.ZodNever,...xi(a)});class xN extends xj{_parse(a){if(this._getType(a)!==wY.undefined){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.void,received:b.parsedType}),w9}return xb(a.data)}}xN.create=a=>new xN({typeName:Em.ZodVoid,...xi(a)});class xO extends xj{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==wY.array)return w7(b,{code:w$.invalid_type,expected:wY.array,received:b.parsedType}),w9;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(w7(b,{code:a?w$.too_big:w$.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(w7(b,{code:w$.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(w7(b,{code:w$.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new xg(b,a,b.path,c)))).then(a=>w8.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new xg(b,a,b.path,c)));return w8.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new xO({...this._def,minLength:{value:a,message:El.toString(b)}})}max(a,b){return new xO({...this._def,maxLength:{value:a,message:El.toString(b)}})}length(a,b){return new xO({...this._def,exactLength:{value:a,message:El.toString(b)}})}nonempty(a){return this.min(1,a)}}xO.create=(a,b)=>new xO({type:a,minLength:null,maxLength:null,exactLength:null,typeName:Em.ZodArray,...xi(b)});class xP extends xj{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=Ej.objectKeys(a);return this._cached={shape:a,keys:b},this._cached}_parse(a){if(this._getType(a)!==wY.object){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.object,received:b.parsedType}),w9}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof xM&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new xg(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof xM){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(w7(c,{code:w$.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new xg(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>w8.mergeObjectSync(b,a)):w8.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return El.errToObj,new xP({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{let d=this._def.errorMap?.(b,c).message??c.defaultError;return"unrecognized_keys"===b.code?{message:El.errToObj(a).message??d}:{message:d}}}:{}})}strip(){return new xP({...this._def,unknownKeys:"strip"})}passthrough(){return new xP({...this._def,unknownKeys:"passthrough"})}extend(a){return new xP({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new xP({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:Em.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new xP({...this._def,catchall:a})}pick(a){let b={};for(let c of Ej.objectKeys(a))a[c]&&this.shape[c]&&(b[c]=this.shape[c]);return new xP({...this._def,shape:()=>b})}omit(a){let b={};for(let c of Ej.objectKeys(this.shape))a[c]||(b[c]=this.shape[c]);return new xP({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof xP){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=x4.create(a(e))}return new xP({...b._def,shape:()=>c})}if(b instanceof xO)return new xO({...b._def,type:a(b.element)});if(b instanceof x4)return x4.create(a(b.unwrap()));if(b instanceof x5)return x5.create(a(b.unwrap()));if(b instanceof xU)return xU.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};for(let c of Ej.objectKeys(this.shape)){let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}return new xP({...this._def,shape:()=>b})}required(a){let b={};for(let c of Ej.objectKeys(this.shape))if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof x4;)a=a._def.innerType;b[c]=a}return new xP({...this._def,shape:()=>b})}keyof(){return x_(Ej.objectKeys(this.shape))}}xP.create=(a,b)=>new xP({shape:()=>a,unknownKeys:"strip",catchall:xM.create(),typeName:Em.ZodObject,...xi(b)}),xP.strictCreate=(a,b)=>new xP({shape:()=>a,unknownKeys:"strict",catchall:xM.create(),typeName:Em.ZodObject,...xi(b)}),xP.lazycreate=(a,b)=>new xP({shape:a,unknownKeys:"strip",catchall:xM.create(),typeName:Em.ZodObject,...xi(b)});class xQ extends xj{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new w0(a.ctx.common.issues));return w7(b,{code:w$.invalid_union,unionErrors:c}),w9});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new w0(a));return w7(b,{code:w$.invalid_union,unionErrors:e}),w9}}get options(){return this._def.options}}xQ.create=(a,b)=>new xQ({options:a,typeName:Em.ZodUnion,...xi(b)});let xR=a=>{if(a instanceof xZ)return xR(a.schema);if(a instanceof x3)return xR(a.innerType());if(a instanceof x$)return[a.value];if(a instanceof x0)return a.options;if(a instanceof x1)return Ej.objectValues(a.enum);else if(a instanceof x6)return xR(a._def.innerType);else if(a instanceof xI)return[void 0];else if(a instanceof xJ)return[null];else if(a instanceof x4)return[void 0,...xR(a.unwrap())];else if(a instanceof x5)return[null,...xR(a.unwrap())];else if(a instanceof ya)return xR(a.unwrap());else if(a instanceof yc)return xR(a.unwrap());else if(a instanceof x7)return xR(a._def.innerType);else return[]};class xS extends xj{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==wY.object)return w7(b,{code:w$.invalid_type,expected:wY.object,received:b.parsedType}),w9;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(w7(b,{code:w$.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),w9)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=xR(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new xS({typeName:Em.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...xi(c)})}}class xT extends xj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if(xc(a)||xc(d))return w9;let e=function a(b,c){let d=wZ(b),e=wZ(c);if(b===c)return{valid:!0,data:b};if(d===wY.object&&e===wY.object){let d=Ej.objectKeys(c),e=Ej.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===wY.array&&e===wY.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===wY.date&&e===wY.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?((xd(a)||xd(d))&&b.dirty(),{status:b.value,value:e.data}):(w7(c,{code:w$.invalid_intersection_types}),w9)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}xT.create=(a,b,c)=>new xT({left:a,right:b,typeName:Em.ZodIntersection,...xi(c)});class xU extends xj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wY.array)return w7(c,{code:w$.invalid_type,expected:wY.array,received:c.parsedType}),w9;if(c.data.length<this._def.items.length)return w7(c,{code:w$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),w9;!this._def.rest&&c.data.length>this._def.items.length&&(w7(c,{code:w$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new xg(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>w8.mergeArray(b,a)):w8.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new xU({...this._def,rest:a})}}xU.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new xU({items:a,typeName:Em.ZodTuple,rest:null,...xi(b)})};class xV extends xj{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wY.object)return w7(c,{code:w$.invalid_type,expected:wY.object,received:c.parsedType}),w9;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new xg(c,a,c.path,a)),value:f._parse(new xg(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?w8.mergeObjectAsync(b,d):w8.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new xV(b instanceof xj?{keyType:a,valueType:b,typeName:Em.ZodRecord,...xi(c)}:{keyType:xC.create(),valueType:a,typeName:Em.ZodRecord,...xi(b)})}}class xW extends xj{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wY.map)return w7(c,{code:w$.invalid_type,expected:wY.map,received:c.parsedType}),w9;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new xg(c,a,c.path,[f,"key"])),value:e._parse(new xg(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return w9;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return w9;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}xW.create=(a,b,c)=>new xW({valueType:b,keyType:a,typeName:Em.ZodMap,...xi(c)});class xX extends xj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==wY.set)return w7(c,{code:w$.invalid_type,expected:wY.set,received:c.parsedType}),w9;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(w7(c,{code:w$.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(w7(c,{code:w$.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return w9;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new xg(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new xX({...this._def,minSize:{value:a,message:El.toString(b)}})}max(a,b){return new xX({...this._def,maxSize:{value:a,message:El.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}xX.create=(a,b)=>new xX({valueType:a,minSize:null,maxSize:null,typeName:Em.ZodSet,...xi(b)});class xY extends xj{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==wY.function)return w7(b,{code:w$.invalid_type,expected:wY.function,received:b.parsedType}),w9;function c(a,c){return w5({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,w2,w1].filter(a=>!!a),issueData:{code:w$.invalid_arguments,argumentsError:c}})}function d(a,c){return w5({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,w2,w1].filter(a=>!!a),issueData:{code:w$.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof x2){let a=this;return xb(async function(...b){let g=new w0([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return xb(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new w0([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new w0([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new xY({...this._def,args:xU.create(a).rest(xL.create())})}returns(a){return new xY({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new xY({args:a||xU.create([]).rest(xL.create()),returns:b||xL.create(),typeName:Em.ZodFunction,...xi(c)})}}class xZ extends xj{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}xZ.create=(a,b)=>new xZ({getter:a,typeName:Em.ZodLazy,...xi(b)});class x$ extends xj{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return w7(b,{received:b.data,code:w$.invalid_literal,expected:this._def.value}),w9}return{status:"valid",value:a.data}}get value(){return this._def.value}}function x_(a,b){return new x0({values:a,typeName:Em.ZodEnum,...xi(b)})}x$.create=(a,b)=>new x$({value:a,typeName:Em.ZodLiteral,...xi(b)});class x0 extends xj{_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return w7(b,{expected:Ej.joinValues(c),received:b.parsedType,code:w$.invalid_type}),w9}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return w7(b,{received:b.data,code:w$.invalid_enum_value,options:c}),w9}return xb(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return x0.create(a,{...this._def,...b})}exclude(a,b=this._def){return x0.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}x0.create=x_;class x1 extends xj{_parse(a){let b=Ej.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==wY.string&&c.parsedType!==wY.number){let a=Ej.objectValues(b);return w7(c,{expected:Ej.joinValues(a),received:c.parsedType,code:w$.invalid_type}),w9}if(this._cache||(this._cache=new Set(Ej.getValidEnumValues(this._def.values))),!this._cache.has(a.data)){let a=Ej.objectValues(b);return w7(c,{received:c.data,code:w$.invalid_enum_value,options:a}),w9}return xb(a.data)}get enum(){return this._def.values}}x1.create=(a,b)=>new x1({values:a,typeName:Em.ZodNativeEnum,...xi(b)});class x2 extends xj{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==wY.promise&&!1===b.common.async?(w7(b,{code:w$.invalid_type,expected:wY.promise,received:b.parsedType}),w9):xb((b.parsedType===wY.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}x2.create=(a,b)=>new x2({type:a,typeName:Em.ZodPromise,...xi(b)});class x3 extends xj{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Em.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{w7(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return w9;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?w9:"dirty"===d.status||"dirty"===b.value?xa(d.value):d});{if("aborted"===b.value)return w9;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?w9:"dirty"===d.status||"dirty"===b.value?xa(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?w9:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?w9:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>xe(a)?Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})):w9);else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if(!xe(a))return w9;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}Ej.assertNever(d)}}x3.create=(a,b,c)=>new x3({schema:a,typeName:Em.ZodEffects,effect:b,...xi(c)}),x3.createWithPreprocess=(a,b,c)=>new x3({schema:b,effect:{type:"preprocess",transform:a},typeName:Em.ZodEffects,...xi(c)});class x4 extends xj{_parse(a){return this._getType(a)===wY.undefined?xb(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}x4.create=(a,b)=>new x4({innerType:a,typeName:Em.ZodOptional,...xi(b)});class x5 extends xj{_parse(a){return this._getType(a)===wY.null?xb(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}x5.create=(a,b)=>new x5({innerType:a,typeName:Em.ZodNullable,...xi(b)});class x6 extends xj{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===wY.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}x6.create=(a,b)=>new x6({innerType:a,typeName:Em.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...xi(b)});class x7 extends xj{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return xf(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new w0(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new w0(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}x7.create=(a,b)=>new x7({innerType:a,typeName:Em.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...xi(b)});class x8 extends xj{_parse(a){if(this._getType(a)!==wY.nan){let b=this._getOrReturnCtx(a);return w7(b,{code:w$.invalid_type,expected:wY.nan,received:b.parsedType}),w9}return{status:"valid",value:a.data}}}x8.create=a=>new x8({typeName:Em.ZodNaN,...xi(a)});let x9=Symbol("zod_brand");class ya extends xj{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class yb extends xj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?w9:"dirty"===a.status?(b.dirty(),xa(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?w9:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new yb({in:a,out:b,typeName:Em.ZodPipeline})}}class yc extends xj{_parse(a){let b=this._def.innerType._parse(a),c=a=>(xe(a)&&(a.value=Object.freeze(a.value)),a);return xf(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}function yd(a,b){let c="function"==typeof a?a(b):"string"==typeof a?{message:a}:a;return"string"==typeof c?{message:c}:c}function ye(a,b={},c){return a?xK.create().superRefine((d,e)=>{let f=a(d);if(f instanceof Promise)return f.then(a=>{if(!a){let a=yd(b,d),f=a.fatal??c??!0;e.addIssue({code:"custom",...a,fatal:f})}});if(!f){let a=yd(b,d),f=a.fatal??c??!0;e.addIssue({code:"custom",...a,fatal:f})}}):xK.create()}yc.create=(a,b)=>new yc({innerType:a,typeName:Em.ZodReadonly,...xi(b)});let yf={object:xP.lazycreate};(D5=Em||(Em={})).ZodString="ZodString",D5.ZodNumber="ZodNumber",D5.ZodNaN="ZodNaN",D5.ZodBigInt="ZodBigInt",D5.ZodBoolean="ZodBoolean",D5.ZodDate="ZodDate",D5.ZodSymbol="ZodSymbol",D5.ZodUndefined="ZodUndefined",D5.ZodNull="ZodNull",D5.ZodAny="ZodAny",D5.ZodUnknown="ZodUnknown",D5.ZodNever="ZodNever",D5.ZodVoid="ZodVoid",D5.ZodArray="ZodArray",D5.ZodObject="ZodObject",D5.ZodUnion="ZodUnion",D5.ZodDiscriminatedUnion="ZodDiscriminatedUnion",D5.ZodIntersection="ZodIntersection",D5.ZodTuple="ZodTuple",D5.ZodRecord="ZodRecord",D5.ZodMap="ZodMap",D5.ZodSet="ZodSet",D5.ZodFunction="ZodFunction",D5.ZodLazy="ZodLazy",D5.ZodLiteral="ZodLiteral",D5.ZodEnum="ZodEnum",D5.ZodEffects="ZodEffects",D5.ZodNativeEnum="ZodNativeEnum",D5.ZodOptional="ZodOptional",D5.ZodNullable="ZodNullable",D5.ZodDefault="ZodDefault",D5.ZodCatch="ZodCatch",D5.ZodPromise="ZodPromise",D5.ZodBranded="ZodBranded",D5.ZodPipeline="ZodPipeline",D5.ZodReadonly="ZodReadonly";let yg=(a,b={message:`Input not instance of ${a.name}`})=>ye(b=>b instanceof a,b),yh=xC.create,yi=xD.create,yj=x8.create,yk=xE.create,yl=xF.create,ym=xG.create,yn=xH.create,yo=xI.create,yp=xJ.create,yq=xK.create,yr=xL.create,ys=xM.create,yt=xN.create,yu=xO.create,yv=xP.create,yw=xP.strictCreate,yx=xQ.create,yy=xS.create,yz=xT.create,yA=xU.create,yB=xV.create,yC=xW.create,yD=xX.create,yE=xY.create,yF=xZ.create,yG=x$.create,yH=x0.create,yI=x1.create,yJ=x2.create,yK=x3.create,yL=x4.create,yM=x5.create,yN=x3.createWithPreprocess,yO=yb.create,yP=()=>yh().optional(),yQ=()=>yi().optional(),yR=()=>yl().optional(),yS={string:a=>xC.create({...a,coerce:!0}),number:a=>xD.create({...a,coerce:!0}),boolean:a=>xF.create({...a,coerce:!0}),bigint:a=>xE.create({...a,coerce:!0}),date:a=>xG.create({...a,coerce:!0})};a.s(["BRAND",0,x9,"NEVER",0,w9,"Schema",()=>xj,"ZodAny",()=>xK,"ZodArray",()=>xO,"ZodBigInt",()=>xE,"ZodBoolean",()=>xF,"ZodBranded",()=>ya,"ZodCatch",()=>x7,"ZodDate",()=>xG,"ZodDefault",()=>x6,"ZodDiscriminatedUnion",()=>xS,"ZodEffects",()=>x3,"ZodEnum",()=>x0,"ZodFirstPartyTypeKind",()=>Em,"ZodFunction",()=>xY,"ZodIntersection",()=>xT,"ZodLazy",()=>xZ,"ZodLiteral",()=>x$,"ZodMap",()=>xW,"ZodNaN",()=>x8,"ZodNativeEnum",()=>x1,"ZodNever",()=>xM,"ZodNull",()=>xJ,"ZodNullable",()=>x5,"ZodNumber",()=>xD,"ZodObject",()=>xP,"ZodOptional",()=>x4,"ZodPipeline",()=>yb,"ZodPromise",()=>x2,"ZodReadonly",()=>yc,"ZodRecord",()=>xV,"ZodSchema",()=>xj,"ZodSet",()=>xX,"ZodString",()=>xC,"ZodSymbol",()=>xH,"ZodTransformer",()=>x3,"ZodTuple",()=>xU,"ZodType",()=>xj,"ZodUndefined",()=>xI,"ZodUnion",()=>xQ,"ZodUnknown",()=>xL,"ZodVoid",()=>xN,"any",()=>yq,"array",()=>yu,"bigint",()=>yk,"boolean",()=>yl,"coerce",0,yS,"custom",()=>ye,"date",()=>ym,"datetimeRegex",()=>xB,"discriminatedUnion",()=>yy,"effect",()=>yK,"enum",()=>yH,"function",()=>yE,"instanceof",()=>yg,"intersection",()=>yz,"late",0,yf,"lazy",()=>yF,"literal",()=>yG,"map",()=>yC,"nan",()=>yj,"nativeEnum",()=>yI,"never",()=>ys,"null",()=>yp,"nullable",()=>yM,"number",()=>yi,"object",()=>yv,"oboolean",()=>yR,"onumber",()=>yQ,"optional",()=>yL,"ostring",()=>yP,"pipeline",()=>yO,"preprocess",()=>yN,"promise",()=>yJ,"record",()=>yB,"set",()=>yD,"strictObject",()=>yw,"string",()=>yh,"symbol",()=>yn,"transformer",()=>yK,"tuple",()=>yA,"undefined",()=>yo,"union",()=>yx,"unknown",()=>yr,"void",()=>yt],263563),a.i(263563),a.i(481440),a.s(["BRAND",0,x9,"DIRTY",0,xa,"EMPTY_PATH",0,w6,"INVALID",0,w9,"NEVER",0,w9,"OK",0,xb,"ParseStatus",()=>w8,"Schema",()=>xj,"ZodAny",()=>xK,"ZodArray",()=>xO,"ZodBigInt",()=>xE,"ZodBoolean",()=>xF,"ZodBranded",()=>ya,"ZodCatch",()=>x7,"ZodDate",()=>xG,"ZodDefault",()=>x6,"ZodDiscriminatedUnion",()=>xS,"ZodEffects",()=>x3,"ZodEnum",()=>x0,"ZodError",()=>w0,"ZodFirstPartyTypeKind",()=>Em,"ZodFunction",()=>xY,"ZodIntersection",()=>xT,"ZodIssueCode",0,w$,"ZodLazy",()=>xZ,"ZodLiteral",()=>x$,"ZodMap",()=>xW,"ZodNaN",()=>x8,"ZodNativeEnum",()=>x1,"ZodNever",()=>xM,"ZodNull",()=>xJ,"ZodNullable",()=>x5,"ZodNumber",()=>xD,"ZodObject",()=>xP,"ZodOptional",()=>x4,"ZodParsedType",0,wY,"ZodPipeline",()=>yb,"ZodPromise",()=>x2,"ZodReadonly",()=>yc,"ZodRecord",()=>xV,"ZodSchema",()=>xj,"ZodSet",()=>xX,"ZodString",()=>xC,"ZodSymbol",()=>xH,"ZodTransformer",()=>x3,"ZodTuple",()=>xU,"ZodType",()=>xj,"ZodUndefined",()=>xI,"ZodUnion",()=>xQ,"ZodUnknown",()=>xL,"ZodVoid",()=>xN,"addIssueToContext",()=>w7,"any",()=>yq,"array",()=>yu,"bigint",()=>yk,"boolean",()=>yl,"coerce",0,yS,"custom",()=>ye,"date",()=>ym,"datetimeRegex",()=>xB,"defaultErrorMap",0,w1,"discriminatedUnion",()=>yy,"effect",()=>yK,"enum",()=>yH,"function",()=>yE,"getErrorMap",()=>w4,"getParsedType",0,wZ,"instanceof",()=>yg,"intersection",()=>yz,"isAborted",0,xc,"isAsync",0,xf,"isDirty",0,xd,"isValid",0,xe,"late",0,yf,"lazy",()=>yF,"literal",()=>yG,"makeIssue",0,w5,"map",()=>yC,"nan",()=>yj,"nativeEnum",()=>yI,"never",()=>ys,"null",()=>yp,"nullable",()=>yM,"number",()=>yi,"object",()=>yv,"objectUtil",()=>Ek,"oboolean",()=>yR,"onumber",()=>yQ,"optional",()=>yL,"ostring",()=>yP,"pipeline",()=>yO,"preprocess",()=>yN,"promise",()=>yJ,"quotelessJson",0,w_,"record",()=>yB,"set",()=>yD,"setErrorMap",()=>w3,"strictObject",()=>yw,"string",()=>yh,"symbol",()=>yn,"transformer",()=>yK,"tuple",()=>yA,"undefined",()=>yo,"union",()=>yx,"unknown",()=>yr,"util",()=>Ej,"void",()=>yt],673950);var yT=a.i(673950),yT=yT,yU=a.i(155539),yV=a.i(28387),yW=a.i(796936),yX=a.i(90360),yY=a.i(484786),yZ=a.i(111755);let y$={block:(0,yX.defineBlock)({format:a=>({transactions:a.transactions?.map(a=>{if("string"==typeof a)return a;let b=(0,yY.formatTransaction)(a);return"0x7e"===b.typeHex&&(b.isSystemTx=a.isSystemTx,b.mint=a.mint?(0,yW.hexToBigInt)(a.mint):void 0,b.sourceHash=a.sourceHash,b.type="deposit"),b}),stateRoot:a.stateRoot})}),transaction:(0,yY.defineTransaction)({format(a){let b={};return"0x7e"===a.type&&(b.isSystemTx=a.isSystemTx,b.mint=a.mint?(0,yW.hexToBigInt)(a.mint):void 0,b.sourceHash=a.sourceHash,b.type="deposit"),b}}),transactionReceipt:(0,yZ.defineTransactionReceipt)({format:a=>({l1GasPrice:a.l1GasPrice?(0,yW.hexToBigInt)(a.l1GasPrice):null,l1GasUsed:a.l1GasUsed?(0,yW.hexToBigInt)(a.l1GasUsed):null,l1Fee:a.l1Fee?(0,yW.hexToBigInt)(a.l1Fee):null,l1FeeScalar:a.l1FeeScalar?Number(a.l1FeeScalar):null})})};var y_=a.i(476705),y0=a.i(429664),y1=a.i(521045),y2=a.i(372092);let y3={blockTime:2e3,contracts:{gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},formatters:y$,serializers:{transaction:function(a,b){var c;return"deposit"===(c=a).type||void 0!==c.sourceHash?function(a){!function(a){let{from:b,to:c}=a;if(b&&!(0,eE.isAddress)(b))throw new y_.InvalidAddressError({address:b});if(c&&!(0,eE.isAddress)(c))throw new y_.InvalidAddressError({address:c})}(a);let{sourceHash:b,data:c,from:d,gas:e,isSystemTx:f,mint:g,to:h,value:i}=a,j=[b,d,h??"0x",g?(0,eD.toHex)(g):"0x",i?(0,eD.toHex)(i):"0x",e?(0,eD.toHex)(e):"0x",f?"0x1":"0x",c??"0x"];return(0,y0.concatHex)(["0x7e",(0,y1.toRlp)(j)])}(a):(0,y2.serializeTransaction)(a,b)}}};var y4=a.i(927549);let y5=(0,y4.defineChain)({...y3,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...y3.contracts,disputeGameFactory:{0xaa36a7:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{0xaa36a7:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{0xaa36a7:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{0xaa36a7:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:0xaa36a7});({...y5,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://sepolia-preconf.base.org"]}}});let y6=(0,y4.defineChain)({id:43113,name:"Avalanche Fuji",nativeCurrency:{decimals:18,name:"Avalanche Fuji",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax-test.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://testnet.snowtrace.io",apiUrl:"https://api-testnet.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7096959}},testnet:!0}),y7=(0,y4.defineChain)({...y3,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...y3.contracts,disputeGameFactory:{1:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{1:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{1:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:0x10ac19f}},l1StandardBridge:{1:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:0x10ac19f}}},sourceId:1});({...y7,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://mainnet-preconf.base.org"]}}});let y8=(0,y4.defineChain)({id:1329,name:"Sei Network",nativeCurrency:{name:"Sei",symbol:"SEI",decimals:18},rpcUrls:{default:{http:["https://evm-rpc.sei-apis.com/"],webSocket:["wss://evm-ws.sei-apis.com/"]}},blockExplorers:{default:{name:"Seitrace",url:"https://seitrace.com",apiUrl:"https://seitrace.com/pacific-1/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11"}}}),y9=(0,y4.defineChain)({id:1328,name:"Sei Testnet",nativeCurrency:{name:"Sei",symbol:"SEI",decimals:18},rpcUrls:{default:{http:["https://evm-rpc-testnet.sei-apis.com"],webSocket:["wss://evm-ws-testnet.sei-apis.com"]}},blockExplorers:{default:{name:"Seitrace",url:"https://seitrace.com"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0x5e201b3}},testnet:!0}),za=(0,y4.defineChain)({id:137,name:"Polygon",blockTime:2e3,nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://polygon-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:0x18938b0}}}),zb=(0,y4.defineChain)({id:80002,name:"Polygon Amoy",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://rpc-amoy.polygon.technology"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://amoy.polygonscan.com",apiUrl:"https://api-amoy.polygonscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:3127388}},testnet:!0}),zc=(0,y4.defineChain)({id:3338,name:"Peaq",nativeCurrency:{decimals:18,name:"peaq",symbol:"PEAQ"},rpcUrls:{default:{http:["https://quicknode1.peaq.xyz","https://quicknode2.peaq.xyz","https://quicknode3.peaq.xyz"],webSocket:["wss://quicknode1.peaq.xyz","wss://quicknode2.peaq.xyz","wss://quicknode3.peaq.xyz"]}},blockExplorers:{default:{name:"Subscan",url:"https://peaq.subscan.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:3566354}}}),zd=(0,y4.defineChain)({id:43114,name:"Avalanche",blockTime:1700,nativeCurrency:{decimals:18,name:"Avalanche",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://snowtrace.io",apiUrl:"https://api.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:0xb5b35e}}}),ze=(0,y4.defineChain)({id:4690,name:"IoTeX Testnet",nativeCurrency:{decimals:18,name:"IoTeX",symbol:"IOTX"},rpcUrls:{default:{http:["https://babel-api.testnet.iotex.io"],webSocket:["wss://babel-api.testnet.iotex.io"]}},blockExplorers:{default:{name:"IoTeXScan",url:"https://testnet.iotexscan.io"}},contracts:{multicall3:{address:"0xb5cecD6894c6f473Ec726A176f1512399A2e355d",blockCreated:0x17383c8}},testnet:!0}),zf=(0,y4.defineChain)({id:4689,name:"IoTeX",nativeCurrency:{decimals:18,name:"IoTeX",symbol:"IOTX"},rpcUrls:{default:{http:["https://babel-api.mainnet.iotex.io"],webSocket:["wss://babel-api.mainnet.iotex.io"]}},blockExplorers:{default:{name:"IoTeXScan",url:"https://iotexscan.io"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0x15230d6}}});var zg=a.i(566167),zh=a.i(116508),zi=a.i(637998);let zj=32n*a.i(283678).maxUint16,zk={block:(0,yX.defineBlock)({format(a){let b=a.transactions?.map(a=>{if("string"==typeof a)return a;let b=zk.transaction?.format(a);return"0x71"===b.typeHex?b.type="eip712":"0xff"===b.typeHex&&(b.type="priority"),b});return{l1BatchNumber:a.l1BatchNumber?(0,yW.hexToBigInt)(a.l1BatchNumber):null,l1BatchTimestamp:a.l1BatchTimestamp?(0,yW.hexToBigInt)(a.l1BatchTimestamp):null,transactions:b}}}),transaction:(0,yY.defineTransaction)({format(a){let b={};return"0x71"===a.type?b.type="eip712":"0xff"===a.type&&(b.type="priority"),{...b,l1BatchNumber:a.l1BatchNumber?(0,yW.hexToBigInt)(a.l1BatchNumber):null,l1BatchTxIndex:a.l1BatchTxIndex?(0,yW.hexToBigInt)(a.l1BatchTxIndex):null}}}),transactionReceipt:(0,yZ.defineTransactionReceipt)({format:a=>({l1BatchNumber:a.l1BatchNumber?(0,yW.hexToBigInt)(a.l1BatchNumber):null,l1BatchTxIndex:a.l1BatchTxIndex?(0,yW.hexToBigInt)(a.l1BatchTxIndex):null,logs:a.logs.map(a=>({...(0,zh.formatLog)(a),l1BatchNumber:a.l1BatchNumber?(0,yW.hexToBigInt)(a.l1BatchNumber):null,transactionLogIndex:(0,yW.hexToNumber)(a.transactionLogIndex),logType:a.logType})),l2ToL1Logs:a.l2ToL1Logs.map(a=>({blockNumber:(0,yW.hexToBigInt)(a.blockHash),blockHash:a.blockHash,l1BatchNumber:a.l1BatchNumber?(0,yW.hexToBigInt)(a.l1BatchNumber):null,transactionIndex:(0,yW.hexToBigInt)(a.transactionIndex),shardId:(0,yW.hexToBigInt)(a.shardId),isService:a.isService,sender:a.sender,key:a.key,value:a.value,transactionHash:a.transactionHash,logIndex:(0,yW.hexToBigInt)(a.logIndex)}))})}),transactionRequest:(0,zi.defineTransactionRequest)({exclude:["customSignature","factoryDeps","gasPerPubdata","paymaster","paymasterInput"],format:a=>a.gasPerPubdata||a.paymaster&&a.paymasterInput||a.factoryDeps||a.customSignature?{eip712Meta:{...a.gasPerPubdata?{gasPerPubdata:(0,eD.toHex)(a.gasPerPubdata)}:{gasPerPubdata:(0,eD.toHex)(50000n)},...a.paymaster&&a.paymasterInput?{paymasterParams:{paymaster:a.paymaster,paymasterInput:Array.from((0,zg.hexToBytes)(a.paymasterInput))}}:{},...a.factoryDeps?{factoryDeps:a.factoryDeps.map(a=>Array.from((0,zg.hexToBytes)(a)))}:{},...a.customSignature?{customSignature:Array.from((0,zg.hexToBytes)(a.customSignature))}:{}},type:"0x71"}:{}})};var zl=a.i(185228),zm=a.i(407907),zn=zl;class zo extends zn.BaseError{constructor(){super('Transaction is not an EIP712 transaction.\n\nTransaction must:\n  - include `type: "eip712"`\n  - include one of the following: `customSignature`, `paymaster`, `paymasterInput`, `gasPerPubdata`, `factoryDeps`',{name:"InvalidEip712TransactionError"})}}function zp(a){return"eip712"===a.type||"customSignature"in a&&!!a.customSignature||"paymaster"in a&&!!a.paymaster||"paymasterInput"in a&&!!a.paymasterInput||"gasPerPubdata"in a&&"bigint"==typeof a.gasPerPubdata||"factoryDeps"in a&&!!a.factoryDeps||!1}function zq(a){let{chainId:b,to:c,from:d,paymaster:e,paymasterInput:f}=a;if(!zp(a))throw new zo;if(!b||b<=0)throw new zm.InvalidChainIdError({chainId:b});if(c&&!(0,eE.isAddress)(c))throw new y_.InvalidAddressError({address:c});if(d&&!(0,eE.isAddress)(d))throw new y_.InvalidAddressError({address:d});if(e&&!(0,eE.isAddress)(e))throw new y_.InvalidAddressError({address:e});if(e&&!f)throw new zl.BaseError("`paymasterInput` must be provided when `paymaster` is defined");if(!e&&f)throw new zl.BaseError("`paymaster` must be provided when `paymasterInput` is defined")}var zr=a.i(695313),zs=a.i(485516),zt=zl;class zu extends zt.BaseError{constructor({givenLength:a,maxBytecodeSize:b}){super(`Bytecode cannot be longer than ${b} bytes. Given length: ${a}`,{name:"BytecodeLengthExceedsMaxSizeError"})}}class zv extends zt.BaseError{constructor({givenLengthInWords:a}){super(`Bytecode length in 32-byte words must be odd. Given length in words: ${a}`,{name:"BytecodeLengthInWordsMustBeOddError"})}}class zw extends zt.BaseError{constructor({givenLength:a}){super(`The bytecode length in bytes must be divisible by 32. Given length: ${a}`,{name:"BytecodeLengthMustBeDivisibleBy32Error"})}}function zx(a){let b=(0,zg.toBytes)(a);if(b.length%32!=0)throw new zw({givenLength:b.length});if(b.length>zj)throw new zu({givenLength:b.length,maxBytecodeSize:zj});let c=(0,zs.sha256)(b),d=(0,zg.toBytes)(c),e=b.length/32;if(e%2==0)throw new zv({givenLengthInWords:e});let f=(0,zg.toBytes)(e),g=(0,zr.pad)(f,{size:2}),h=new Uint8Array([1,0]);return d.set(h,0),d.set(g,2),d}let zy={blockTime:1e3,formatters:zk,serializers:{transaction:function(a,b){return zp(a)?function(a){let{chainId:b,gas:c,nonce:d,to:e,from:f,value:g,maxFeePerGas:h,maxPriorityFeePerGas:i,customSignature:j,factoryDeps:k,paymaster:l,paymasterInput:m,gasPerPubdata:o,data:p}=a;zq(a);let q=[d?(0,eD.toHex)(d):"0x",i?(0,eD.toHex)(i):"0x",h?(0,eD.toHex)(h):"0x",c?(0,eD.toHex)(c):"0x",e??"0x",g?(0,eD.toHex)(g):"0x",p??"0x",(0,eD.toHex)(b),(0,eD.toHex)(""),(0,eD.toHex)(""),(0,eD.toHex)(b),f??"0x",o?(0,eD.toHex)(o):(0,eD.toHex)(50000n),k??[],j??"0x",l&&m?[l,m]:[]];return(0,y0.concatHex)(["0x71",(0,y1.toRlp)(q)])}(a):(0,y2.serializeTransaction)(a,b)}},custom:{getEip712Domain:a=>{zq(a);let b=function(a){let{gas:b,nonce:c,to:d,from:e,value:f,maxFeePerGas:g,maxPriorityFeePerGas:h,factoryDeps:i,paymaster:j,paymasterInput:k,gasPerPubdata:l,data:m}=a;return{txType:113n,from:BigInt(e),to:d?BigInt(d):0n,gasLimit:b??0n,gasPerPubdataByteLimit:l??50000n,maxFeePerGas:g??0n,maxPriorityFeePerGas:h??0n,paymaster:j?BigInt(j):0n,nonce:c?BigInt(c):0n,value:f??0n,data:m??"0x",factoryDeps:i?.map(a=>(0,eD.toHex)(zx(a)))??[],paymasterInput:k||"0x"}}(a);return{domain:{name:"zkSync",version:"2",chainId:a.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:b}}}},zz=(0,y4.defineChain)({...zy,blockTime:200,id:2741,name:"Abstract",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://api.mainnet.abs.xyz"],webSocket:["wss://api.mainnet.abs.xyz/ws"]}},blockExplorers:{default:{name:"Etherscan",url:"https://abscan.org"},native:{name:"Abstract Explorer",url:"https://explorer.mainnet.abs.xyz"}},contracts:{multicall3:{address:"0xAa4De41dba0Ca5dCBb288b7cC6b708F3aaC759E7",blockCreated:5288},erc6492Verifier:{address:"0xfB688330379976DA81eB64Fe4BF50d7401763B9C",blockCreated:5263}}}),zA=(0,y4.defineChain)({...zy,blockTime:200,id:11124,name:"Abstract Testnet",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://api.testnet.abs.xyz"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.abscan.org"},native:{name:"Abstract Explorer",url:"https://explorer.testnet.abs.xyz"}},testnet:!0,contracts:{multicall3:{address:"0xF9cda624FBC7e059355ce98a31693d299FACd963",blockCreated:358349},erc6492Verifier:{address:"0xfB688330379976DA81eB64Fe4BF50d7401763B9C",blockCreated:431682}}}),zB=(0,y4.defineChain)({id:1514,name:"Story",nativeCurrency:{decimals:18,name:"IP Token",symbol:"IP"},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:340998},ensRegistry:{address:"0x5dc881dda4e4a8d312be3544ad13118d1a04cb17",blockCreated:648924},ensUniversalResolver:{address:"0xddfb18888a9466688235887dec2a10c4f5effee9",blockCreated:649114}},rpcUrls:{default:{http:["https://mainnet.storyrpc.io"]}},blockExplorers:{default:{name:"Story explorer",url:"https://storyscan.io",apiUrl:"https://storyscan.io/api/v2"}},ensTlds:[".ip"],testnet:!1}),zC=(0,y4.defineChain)({id:41923,name:"EDU Chain",nativeCurrency:{decimals:18,name:"EDU",symbol:"EDU"},rpcUrls:{default:{http:["https://rpc.edu-chain.raas.gelato.cloud"]}},blockExplorers:{default:{name:"EDU Chain Explorer",url:"https://educhain.blockscout.com/"}},testnet:!1});var zD=a.i(792288),zE=a.i(218135),zF=a.i(316486);async function zG({hash:a,privateKey:b,to:c="object"}){let{r:d,s:e,recovery:f}=zD.secp256k1.sign(a.slice(2),b.slice(2),{lowS:!0,extraEntropy:!!(0,eG.isHex)(!1,{strict:!1})&&(0,zg.hexToBytes)(!1)}),g={r:(0,eD.numberToHex)(d,{size:32}),s:(0,eD.numberToHex)(e,{size:32}),v:f?28n:27n,yParity:f};return"bytes"===c||"hex"===c?(0,zF.serializeSignature)({...g,to:c}):g}async function zH(a){let{chainId:b,nonce:c,privateKey:d,to:e="object"}=a,f=a.contractAddress??a.address,g=await zG({hash:(0,eH.hashAuthorization)({address:f,chainId:b,nonce:c}),privateKey:d,to:e});return"object"===e?{address:f,chainId:b,nonce:c,...g}:g}var zI=a.i(145419);async function zJ({message:a,privateKey:b}){return await zG({hash:(0,zI.hashMessage)(a),privateKey:b,to:"hex"})}var zK=a.i(652868);async function zL(a){let{privateKey:b,transaction:c,serializer:d=y2.serializeTransaction}=a,e="eip4844"===c.type?{...c,sidecars:!1}:c,f=await zG({hash:(0,zK.keccak256)(await d(e)),privateKey:b});return await d(c,f)}var zM=a.i(408680);async function zN(a){let{privateKey:b,...c}=a;return await zG({hash:(0,zM.hashTypedData)(c),privateKey:b,to:"hex"})}var zO=a.i(854723),zP=a.i(369765),zQ=a.i(872694),zR=a.i(762029),zS=a.i(59854);let zT=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],name:"AccountNonceOrderingUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"aaVersion",type:"uint8"}],name:"AccountVersionUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"deployerAddress",type:"address"},{indexed:!0,internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"contractAddress",type:"address"}],name:"ContractDeployed",type:"event"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create2",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"create2Account",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"createAccount",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"extendedAccountVersion",outputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"_keccak256BytecodeHash",type:"bytes32"}],name:"forceDeployKeccak256",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment",name:"_deployment",type:"tuple"},{internalType:"address",name:"_sender",type:"address"}],name:"forceDeployOnAddress",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment[]",name:"_deployments",type:"tuple[]"}],name:"forceDeployOnAddresses",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"getAccountInfo",outputs:[{components:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"supportedAAVersion",type:"uint8"},{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],internalType:"struct IContractDeployer.AccountInfo",name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"uint256",name:"_senderNonce",type:"uint256"}],name:"getNewAddressCreate",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"getNewAddressCreate2",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_version",type:"uint8"}],name:"updateAccountVersion",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"_nonceOrdering",type:"uint8"}],name:"updateNonceOrdering",outputs:[],stateMutability:"nonpayable",type:"function"}],zU="/docs/contract/encodeDeployData";function zV(a,b,c,d){let e=[b,c,d];return({create:{functionName:"create",argsContractDeployer:e},create2:{functionName:"create2",argsContractDeployer:e},createAccount:{functionName:"createAccount",argsContractDeployer:[...e,1]},create2Account:{functionName:"create2Account",argsContractDeployer:[...e,1]}})[a||"create"]}var zW=a.i(134510),zX=a.i(600528),zY=a.i(366451),zZ=a.i(158413),z$=a.i(770548),z_=a.i(88963),z0=a.i(197693),z1=a.i(709987),z2=a.i(745914);function z3(a){if(!zp(a))throw new zo;(0,z2.assertRequest)(a)}var z4=a.i(843104),z5=a.i(622131);async function z6(a,b){let{account:c=a.account,chain:d=a.chain,...e}=b,f=c?(0,zW.parseAccount)(c):a.account;if(!f)throw new z$.AccountNotFoundError({docsPath:"/docs/actions/wallet/signTransaction"});if(z3({account:f,chain:d,...b}),!d?.custom?.getEip712Domain)throw new zl.BaseError("`getEip712Domain` not found on chain.");if(!d?.serializers?.transaction)throw new zl.BaseError("transaction serializer not found on chain.");let g=await (0,z1.getAction)(a,zX.getChainId,"getChainId")({});null!==d&&(0,z_.assertCurrentChain)({currentChainId:g,chain:d});let h=d?.custom.getEip712Domain({...e,chainId:g,from:f.address,type:"eip712"}),i=await (0,z5.signTypedData)(a,{...h,account:f});return d?.serializers?.transaction({chainId:g,...e,customSignature:i,type:"eip712"},{r:"0x0",s:"0x0",v:0n})}async function z7(a,b){return zp(b)?z6(a,b):await (0,z4.signTransaction)(a,b)}async function z8(a,b){let{account:c=a.account,chain:d=a.chain}=b,e=c?(0,zW.parseAccount)(c):a.account;if(!e)throw new z$.AccountNotFoundError({docsPath:"/docs/actions/wallet/sendTransaction"});try{let c;z3(b);let f=await (0,zY.prepareTransactionRequest)(a,{...b,nonceManager:e.nonceManager,parameters:["gas","nonce","fees"]});null!==d&&(c=await (0,z1.getAction)(a,zX.getChainId,"getChainId")({}),(0,z_.assertCurrentChain)({currentChainId:c,chain:d}));let g=await z7(a,{...f,chainId:c});return await (0,z1.getAction)(a,zZ.sendRawTransaction,"sendRawTransaction")({serializedTransaction:g})}catch(a){throw(0,z0.getTransactionError)(a,{...b,account:e,chain:d})}}var z9=a.i(567218);async function Aa(a,b){return zp(b)?z8(a,b):(0,z9.sendTransaction)(a,b)}var Ab=a.i(447213),Ac=a.i(626961);function Ad(a){return JSON.parse(function(a){let b=[],c=!1;for(let e=0;e<a.length;e++){let f=!1;if("\\"===a[e]&&(b.push(a[e++]),f=!f),'"'===a[e]){b.push(a[e]),f||(c=!c);continue}if(!c){let c=function(a,b){if(!a[b]?.match(/[-\d]/))return null;let c=a.slice(b).match(/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?/);return c?c[0]:null}(a,e);if(c?.length){var d;e+=c.length-1,c.match(/\.|[eE]-/)?b.push(c):b.push((d=c,`{"$n":"${d}"}`));continue}}b.push(a[e])}return b.join("")}(a),(a,b)=>{var c;return(c=b)&&"object"==typeof c&&"$n"in c&&"string"==typeof c.$n?function({$n:a}){if(a.match(/[eE]/)){let[b,c]=a.split(/[eE]/);return BigInt(b)*BigInt(10)**BigInt(c)}return BigInt(a)}(b):b})}var Ae=0n;function Af(a){let b;return{id:(b=Ae,Ae++,b.toString()),jsonrpc:"2.0",method:a.methodName,params:a.params}}function Ag(a,b){return JSON.stringify(a,(a,b)=>{var c;return"bigint"==typeof b?(c=b,{$n:`${c}`}):b},b).replace(/\{\s*"\$n"\s*:\s*"(-?\d+)"\s*\}/g,"$1")}function Ah(a){return!(null==a||"object"!=typeof a||Array.isArray(a))&&"jsonrpc"in a&&"2.0"===a.jsonrpc&&"method"in a&&"string"==typeof a.method&&"params"in a}var Ai=a.i(29943);function Aj(a){return"bigint"==typeof a?Number(a):a}var Ak={};function Al(a){return function b(c,d){if(Array.isArray(c))return c.map((a,c)=>b(a,{...d,keyPath:[...d.keyPath,c]}));if("object"!=typeof c||null===c)return a.reduce((a,b)=>b(a,d),c);{let a={};for(let e in c){if(!Object.prototype.hasOwnProperty.call(c,e))continue;let f={...d,keyPath:[...d.keyPath,e]};a[e]=b(c[e],f)}return a}}}function Am(a,b){return c=>{let d=Al(a);return Object.freeze({...c,params:d(c.params,b)})}}var An={accountNotifications:1,blockNotifications:1,getAccountInfo:1,getBalance:1,getBlock:1,getBlockHeight:0,getBlockProduction:0,getBlocks:2,getBlocksWithLimit:2,getEpochInfo:0,getFeeForMessage:1,getInflationGovernor:0,getInflationReward:1,getLargestAccounts:0,getLatestBlockhash:0,getLeaderSchedule:1,getMinimumBalanceForRentExemption:1,getMultipleAccounts:1,getProgramAccounts:1,getSignaturesForAddress:1,getSlot:0,getSlotLeader:0,getStakeMinimumDelegation:0,getSupply:0,getTokenAccountBalance:1,getTokenAccountsByDelegate:2,getTokenAccountsByOwner:2,getTokenLargestAccounts:1,getTokenSupply:1,getTransaction:1,getTransactionCount:0,getVoteAccounts:0,isBlockhashValid:1,logsNotifications:1,programNotifications:1,requestAirdrop:2,sendTransaction:1,signatureNotifications:1,simulateTransaction:1};function Ao(a){let b=a?.onIntegerOverflow;return c=>(0,Ai.pipe)(c,b?a=>{var c;return Am([(c=(...c)=>b(a,...c),(a,{keyPath:b})=>("bigint"==typeof a&&c&&(a>Number.MAX_SAFE_INTEGER||a<-Number.MAX_SAFE_INTEGER)&&c(b,a),a))],{keyPath:[]})(a)}:a=>a,Am([Aj],{keyPath:[]}),function({defaultCommitment:a,optionsObjectPositionByMethod:b}){return c=>{let{params:d,methodName:e}=c;if(!Array.isArray(d))return c;let f=b[e];return null==f?c:Object.freeze({methodName:e,params:function({commitmentPropertyName:a,params:b,optionsObjectPositionInParams:c,overrideCommitment:d}){let e=b[c];if(void 0===e||e&&"object"==typeof e&&!Array.isArray(e)){if(e&&a in e){if(!e[a]||"finalized"===e[a]){let d=[...b],{[a]:f,...g}=e;return Object.keys(g).length>0?d[c]=g:c===d.length-1?d.length--:d[c]=void 0,d}}else if("finalized"!==d){let f=[...b];return f[c]={...e,[a]:d},f}}return b}({commitmentPropertyName:"sendTransaction"===e?"preflightCommitment":"commitment",optionsObjectPositionInParams:f,overrideCommitment:a,params:d})})}}({defaultCommitment:a?.defaultCommitment,optionsObjectPositionByMethod:An}))}function Ap(a){var b,c;return b=[function(b,{keyPath:c}){var d;return"number"==typeof b&&Number.isInteger(b)||"bigint"==typeof b?(d=c,a.some(a=>{if(a.length!==d.length)return!1;for(let b=d.length-1;b>=0;b--){let c=d[b],e=a[b];if(e!==c&&(e!==Ak||"number"!=typeof c))return!1}return!0}))?Number(b):BigInt(b):b}],c={keyPath:[]},a=>Al(b)(a,c)}var Aq=[["data","parsed","info","tokenAmount","decimals"],["data","parsed","info","tokenAmount","uiAmount"],["data","parsed","info","rentExemptReserve","decimals"],["data","parsed","info","rentExemptReserve","uiAmount"],["data","parsed","info","delegatedAmount","decimals"],["data","parsed","info","delegatedAmount","uiAmount"],["data","parsed","info","extensions",Ak,"state","olderTransferFee","transferFeeBasisPoints"],["data","parsed","info","extensions",Ak,"state","newerTransferFee","transferFeeBasisPoints"],["data","parsed","info","extensions",Ak,"state","preUpdateAverageRate"],["data","parsed","info","extensions",Ak,"state","currentRate"]],Ar=[...Aq,["data","parsed","info","lastExtendedSlotStartIndex"],["data","parsed","info","slashPenalty"],["data","parsed","info","warmupCooldownRate"],["data","parsed","info","decimals"],["data","parsed","info","numRequiredSigners"],["data","parsed","info","numValidSigners"],["data","parsed","info","stake","delegation","warmupCooldownRate"],["data","parsed","info","exemptionThreshold"],["data","parsed","info","burnPercent"],["data","parsed","info","commission"],["data","parsed","info","votes",Ak,"confirmationCount"]],As=[["index"],["instructions",Ak,"accounts",Ak],["instructions",Ak,"programIdIndex"],["instructions",Ak,"stackHeight"]],At=[["addressTableLookups",Ak,"writableIndexes",Ak],["addressTableLookups",Ak,"readonlyIndexes",Ak],["header","numReadonlySignedAccounts"],["header","numReadonlyUnsignedAccounts"],["header","numRequiredSignatures"],["instructions",Ak,"accounts",Ak],["instructions",Ak,"programIdIndex"],["instructions",Ak,"stackHeight"]],Au=["getAccountInfo","getBalance","getBlock","getBlockCommitment","getBlockHeight","getBlockProduction","getBlocks","getBlocksWithLimit","getBlockTime","getClusterNodes","getEpochInfo","getEpochSchedule","getFeeForMessage","getFirstAvailableBlock","getGenesisHash","getHealth","getHighestSnapshotSlot","getIdentity","getInflationGovernor","getInflationRate","getInflationReward","getLargestAccounts","getLatestBlockhash","getLeaderSchedule","getMaxRetransmitSlot","getMaxShredInsertSlot","getMinimumBalanceForRentExemption","getMultipleAccounts","getProgramAccounts","getRecentPerformanceSamples","getRecentPrioritizationFees","getSignaturesForAddress","getSignatureStatuses","getSlot","getSlotLeader","getSlotLeaders","getStakeMinimumDelegation","getSupply","getTokenAccountBalance","getTokenAccountsByDelegate","getTokenAccountsByOwner","getTokenLargestAccounts","getTokenSupply","getTransaction","getTransactionCount","getVersion","getVoteAccounts","index","isBlockhashValid","minimumLedgerSlot","requestAirdrop","sendTransaction","simulateTransaction"];function Av(a){return Ah(a)&&Au.includes(a.method)}var Aw=Object.prototype.toString,Ax=Object.keys||function(a){let b=[];for(let c in a)b.push(c);return b};function Ay(a){let b=function a(b,c){let d,e,f,g,h,i,j;if(!0===b)return"true";if(!1===b)return"false";switch(typeof b){case"object":if(null===b)return null;if("toJSON"in b&&"function"==typeof b.toJSON)return a(b.toJSON(),c);if("[object Array]"===(j=Aw.call(b))){for(d=0,f="[",e=b.length-1;d<e;d++)f+=a(b[d],!0)+",";return e>-1&&(f+=a(b[d],!0)),f+"]"}if("[object Object]"!==j)return JSON.stringify(b);for(e=(g=Ax(b).sort()).length,f="",d=0;d<e;)void 0!==(i=a(b[h=g[d]],!1))&&(f&&(f+=","),f+=JSON.stringify(h)+":"+i),d++;return"{"+f+"}";case"function":case"undefined":return c?null:void 0;case"bigint":return`${b.toString()}n`;case"string":return JSON.stringify(b);default:return isFinite(b)?b:null}}(a,!1);if(void 0!==b)return""+b}var Az={defaultCommitment:"confirmed",onIntegerOverflow(a,b,c){throw function a(b,c,d){let e="";if("number"==typeof c[0]){let a=c[0]+1,b=a%10,d=a%100;e=1==b&&11!=d?a+"st":2==b&&12!=d?a+"nd":3==b&&13!=d?a+"rd":a+"th"}else e=`\`${c[0].toString()}\``;let f=c.length>1?c.slice(1).map(a=>"number"==typeof a?`[${a}]`:a).join("."):void 0,g=new Ac.SolanaError(Ac.SOLANA_ERROR__RPC__INTEGER_OVERFLOW,{argumentLabel:e,keyPath:c,methodName:b,optionalPathLabel:f?` at path \`${f}\``:"",value:d,...void 0!==f?{path:f}:void 0});return(0,Ac.safeCaptureStackTrace)(g,a),g}(a.methodName,b,c)}},AA=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cg.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}};function AB(a){return Ah(a)?Ay([a.method,a.params]):void 0}function AC(a,b){var c,d,e,f,g;return d=(c={url:a,...b},(0,Ai.pipe)(function(a){let b,{fromJson:c,headers:d,toJson:e,url:f}=a;"dispatcher_NODE_ONLY"in a&&(b={dispatcher:a.dispatcher_NODE_ONLY});let g=d&&function(a){let b={};for(let c in a)b[c.toLowerCase()]=a[c];return b}(d);return async function({payload:a,signal:d}){let h=e?e(a):JSON.stringify(a),i={...b,body:h,headers:{...g,accept:"application/json","content-length":h.length.toString(),"content-type":"application/json; charset=utf-8"},method:"POST",signal:d},j=await fetch(f,i);if(!j.ok)throw new Ac.SolanaError(Ac.SOLANA_ERROR__RPC__TRANSPORT_HTTP_ERROR,{headers:j.headers,message:j.statusText,statusCode:j.status});return c?c(await j.text(),a):await j.json()}}({...{...c,headers:{"accept-encoding":"br,gzip,deflate",...c.headers?function(a){let b={};for(let c in a)b[c.toLowerCase()]=a[c];return b}(c.headers):void 0,"solana-client":"js/5.0.0"}},fromJson:(a,b)=>Av(b)?Ad(a):JSON.parse(a),toJson:a=>Av(a)?Ag(a):JSON.stringify(a)}),a=>{let b;return async function(c){let{payload:d,signal:e}=c,f=AB(d);if(void 0===f)return await a(c);if(b||(queueMicrotask(()=>{b=void 0}),b={}),null==b[f]){let d=new AA,e=(async()=>{try{return await a({...c,signal:d.signal})}catch(a){if(a===(Eo||={}))return;throw a}})();b[f]={abortController:d,numConsumers:0,responsePromise:e}}let g=b[f];if(g.numConsumers++,!e)return await g.responsePromise;{let a=g.responsePromise;return await new Promise((b,c)=>{let d=a=>{e.removeEventListener("abort",d),g.numConsumers-=1,queueMicrotask(()=>{0===g.numConsumers&&g.abortController.abort(Eo||={})}),c(a.target.reason)};e.addEventListener("abort",d),a.then(b).catch(c).finally(()=>{e.removeEventListener("abort",d)})})}}})),g={api:(f={requestTransformer:Ao(Az),responseTransformer:(e={allowedNumericKeyPaths:(En||(En={getAccountInfo:Ar.map(a=>["value",...a]),getBlock:[["transactions",Ak,"meta","preTokenBalances",Ak,"accountIndex"],["transactions",Ak,"meta","preTokenBalances",Ak,"uiTokenAmount","decimals"],["transactions",Ak,"meta","postTokenBalances",Ak,"accountIndex"],["transactions",Ak,"meta","postTokenBalances",Ak,"uiTokenAmount","decimals"],["transactions",Ak,"meta","rewards",Ak,"commission"],...As.map(a=>["transactions",Ak,"meta","innerInstructions",Ak,...a]),...At.map(a=>["transactions",Ak,"transaction","message",...a]),["rewards",Ak,"commission"]],getClusterNodes:[[Ak,"featureSet"],[Ak,"shredVersion"]],getInflationGovernor:[["initial"],["foundation"],["foundationTerm"],["taper"],["terminal"]],getInflationRate:[["foundation"],["total"],["validator"]],getInflationReward:[[Ak,"commission"]],getMultipleAccounts:Ar.map(a=>["value",Ak,...a]),getProgramAccounts:Ar.flatMap(a=>[["value",Ak,"account",...a],[Ak,"account",...a]]),getRecentPerformanceSamples:[[Ak,"samplePeriodSecs"]],getTokenAccountBalance:[["value","decimals"],["value","uiAmount"]],getTokenAccountsByDelegate:Aq.map(a=>["value",Ak,"account",...a]),getTokenAccountsByOwner:Aq.map(a=>["value",Ak,"account",...a]),getTokenLargestAccounts:[["value",Ak,"decimals"],["value",Ak,"uiAmount"]],getTokenSupply:[["value","decimals"],["value","uiAmount"]],getTransaction:[["meta","preTokenBalances",Ak,"accountIndex"],["meta","preTokenBalances",Ak,"uiTokenAmount","decimals"],["meta","postTokenBalances",Ak,"accountIndex"],["meta","postTokenBalances",Ak,"uiTokenAmount","decimals"],["meta","rewards",Ak,"commission"],...As.map(a=>["meta","innerInstructions",Ak,...a]),...At.map(a=>["transaction","message",...a])],getVersion:[["feature-set"]],getVoteAccounts:[["current",Ak,"commission"],["delinquent",Ak,"commission"]],simulateTransaction:[["value","loadedAccountsDataSize"],...Ar.map(a=>["value","accounts",Ak,...a]),...As.map(a=>["value","innerInstructions",Ak,...a])]}),En)},(a,b)=>{let c=b.methodName,d=e?.allowedNumericKeyPaths&&c?e.allowedNumericKeyPaths[c]:void 0;return(0,Ai.pipe)(a,a=>(a=>{if("error"in a)throw(0,Ac.getSolanaErrorFromJsonRpcError)(a.error);return a})(a,b),a=>a.result,a=>Ap(d??[])(a,b))})},new Proxy({},{defineProperty:()=>!1,deleteProperty:()=>!1,get(...a){let[b,c]=a,d=c.toString();return function(...a){let b=Object.freeze({methodName:d,params:a}),c=f?.requestTransformer?f?.requestTransformer(b):b;return Object.freeze({execute:async({signal:a,transport:b})=>{let d=Af(c),e=await b({payload:d,signal:a});return f?.responseTransformer?f.responseTransformer(e,c):e}})}}})),transport:d},new Proxy(g.api,{defineProperty:()=>!1,deleteProperty:()=>!1,get(a,b,c){if("then"!==b)return function(...d){let e=b.toString(),f=Reflect.get(a,e,c);if(!f)throw new Ac.SolanaError(Ac.SOLANA_ERROR__RPC__API_PLAN_MISSING_FOR_RPC_METHOD,{method:e,params:d});return function({transport:a},b){return{send:async c=>await b.execute({signal:c?.abortSignal,transport:a})}}(g,f(...d))}}})}var AD=a.i(849470),AE=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cg.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}},AF=class extends globalThis.EventTarget{constructor(...a){super(...a),(0,cg.setMaxListeners)(Number.MAX_SAFE_INTEGER,this)}};function AG(){return Symbol(void 0)}var AH=Symbol();function AI(a){return{on(b,c,d){function e(a){a instanceof CustomEvent?c(a.detail):c()}return a.addEventListener(b,e,d),()=>{a.removeEventListener(b,e)}}}}var AJ=a.i(963001),AK=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cg.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}},AL=new WeakMap;function AM(a,b,c){let d;if(void 0===c)return;let e=((d=AL.get(b))||AL.set(b,d={}),d);!e[c]&&a>0&&(e[c]=0);let f=a+e[c];return f<=0?delete e[c]:e[c]=f,f}var AN=new WeakMap;async function AO({channel:a,responseTransformer:b,signal:c,subscribeRequest:d,unsubscribeMethodName:e}){var f;let g,h,i,j,k,l,m;a.on("error",()=>{g=void 0,AL.delete(a)},{signal:c});let o=new Promise((b,d)=>{function f(){if(0===AM(-1,a,g)){let b=Af({methodName:e,params:[g]});g=void 0,a.send(b).catch(()=>{})}d(this.reason)}c.aborted?f.call(c):c.addEventListener("abort",f)}),p=Af(d);await a.send(p);let q=new Promise((b,d)=>{let e=new AK;c.addEventListener("abort",e.abort.bind(e));let f={signal:e.signal};a.on("error",a=>{e.abort(),d(a)},f),a.on("message",a=>{a&&"object"==typeof a&&"id"in a&&a.id===p.id&&(e.abort(),"error"in a?d((0,Ac.getSolanaErrorFromJsonRpcError)(a.error)):b(a.result))},f)});if(null==(g=await (0,AJ.safeRace)([o,q])))throw new Ac.SolanaError(Ac.SOLANA_ERROR__RPC_SUBSCRIPTIONS__EXPECTED_SERVER_SUBSCRIPTION_ID);AM(1,a,g);let r=((h=AN.get(a))||AN.set(a,h=new WeakMap),i=b??a,(j=h.get(i))||h.set(i,(f=a=>{if(!("method"in a))return;let c=b?b(a.params.result,d):a.params.result;return[`notification:${a.params.subscription}`,c]},j={...m=AI(l=new AF),on(b,c,d){k||(k={dispose:a.on("message",a=>{let b=f(a);if(!b)return;let[c,d]=b;l.dispatchEvent(new CustomEvent(c,{detail:d}))}),numSubscribers:0}),k.numSubscribers++;let e=m.on(b,c,d),g=!0;function h(){g&&(g=!1,d?.signal.removeEventListener("abort",h),k.numSubscribers--,0===k.numSubscribers&&(k.dispose(),k=void 0),e())}return d?.signal.addEventListener("abort",h),h}})),j),s=`notification:${g}`;return{on(b,c,d){switch(b){case"notification":return r.on(s,c,d);case"error":return a.on("error",c,d);default:throw new Ac.SolanaError(Ac.SOLANA_ERROR__INVARIANT_VIOLATION__DATA_PUBLISHER_CHANNEL_UNIMPLEMENTED,{channelName:b,supportedChannelNames:["notification","error"]})}}}}a.i(567403),a.i(113058),a.i(407411);var AP=a.i(102587);a.i(894487);let AQ=AP.default;var AR=class extends globalThis.EventTarget{constructor(...a){super(...a),(0,cg.setMaxListeners)(Number.MAX_SAFE_INTEGER,this)}},AS=globalThis.WebSocket?globalThis.WebSocket:AQ,AT={defaultCommitment:"confirmed",onIntegerOverflow(a,b,c){throw function a(b,c,d){let e="";if("number"==typeof c[0]){let a=c[0]+1,b=a%10,d=a%100;e=1==b&&11!=d?a+"st":2==b&&12!=d?a+"nd":3==b&&13!=d?a+"rd":a+"th"}else e=`\`${c[0].toString()}\``;let f=c.length>1?c.slice(1).map(a=>"number"==typeof a?`[${a}]`:a).join("."):void 0,g=new Ac.SolanaError(Ac.SOLANA_ERROR__RPC__INTEGER_OVERFLOW,{argumentLabel:e,keyPath:c,methodName:b,optionalPathLabel:f?` at path \`${f}\``:"",value:d,...void 0!==f?{path:f}:void 0});return(0,Ac.safeCaptureStackTrace)(g,a),g}(a.methodName,b,c)}},AU=class extends globalThis.AbortController{constructor(...a){super(...a),(0,cg.setMaxListeners)(Number.MAX_SAFE_INTEGER,this.signal)}},AV={jsonrpc:"2.0",method:"ping"};function AW(a){return(0,Ai.pipe)(a,a=>Object.freeze({...a,on:(b,c,d)=>"message"!==b?a.on(b,c,d):a.on("message",a=>c(Ad(a)),d)}),a=>Object.freeze({...a,send:b=>a.send(Ag(b))}))}function AX(a,b){var c,d,e,f;let g,h;return c=function({createChannel:a}){var b;return(0,Ai.pipe)((b=a,async({execute:a,signal:c})=>{let d=await b({abortSignal:c});return await a({channel:d,signal:c})}),a=>{let b;return b=new Map,function(c){let{request:d,signal:e}=c,f=Ay([d.methodName,d.params]),g=b.get(f);if(!g){let d=new AU,e=a({...c,signal:d.signal});e.then(a=>{a.on("error",()=>{b.delete(f),d.abort()},{signal:d.signal})}).catch(()=>{}),b.set(f,g={abortController:d,dataPublisherPromise:e,numSubscribers:0})}return g.numSubscribers++,e.addEventListener("abort",()=>{g.numSubscribers--,0===g.numSubscribers&&queueMicrotask(()=>{0===g.numSubscribers&&(b.delete(f),g.abortController.abort())})},{signal:g.abortController.signal}),g.dataPublisherPromise}})}({createChannel:function(a){if(!1===/^wss?:/i.test(a.url)){let b=a.url.match(/^([^:]+):/);throw new DOMException(b?`Failed to construct 'WebSocket': The URL's scheme must be either 'ws' or 'wss'. '${b[1]}:' is not allowed.`:`Failed to construct 'WebSocket': The URL '${a.url}' is invalid.`)}let{intervalMs:b,...c}=a;return function(a,{maxSubscriptionsPerChannel:b,minChannels:c}){let d={entries:[],freeChannelIndex:-1};function e(){let a;if(d.entries.length<c){d.freeChannelIndex=-1;return}for(let c=0;c<d.entries.length;c++){let e=(d.freeChannelIndex+c+2)%d.entries.length,f=d.entries[e];f.subscriptionCount<b&&(!a||a.subscriptionCount>=f.subscriptionCount)&&(a={poolIndex:e,subscriptionCount:f.subscriptionCount})}d.freeChannelIndex=a?.poolIndex??-1}return function({abortSignal:b}){let c;function f(){let a=d.entries.findIndex(a=>a===c);d.entries.splice(a,1),c.dispose(),e()}if(-1===d.freeChannelIndex){let b=new AU,e=a({abortSignal:b.signal});e.then(a=>{a.on("error",f,{signal:b.signal})}).catch(f),c={channel:e,dispose(){b.abort()},subscriptionCount:0},d.entries.push(c)}else c=d.entries[d.freeChannelIndex];return c.subscriptionCount++,b.addEventListener("abort",function(){c.subscriptionCount--,0===c.subscriptionCount?f():-1!==d.freeChannelIndex&&(d.freeChannelIndex--,e())}),e(),c.channel}}(({abortSignal:d})=>(function({sendBufferHighWatermark:a,signal:b,url:c}){let d,e,f;if(b.aborted)return Promise.reject(b.reason);let g=!1,h=new Set;function i(){h.forEach(a=>{a()}),h.clear()}function j(){i(),g||e(b.reason),q.readyState!==AS.CLOSED&&q.readyState!==AS.CLOSING&&q.close(1e3)}function k(a){if(!b.aborted&&!g){let b=new Ac.SolanaError(Ac.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_FAILED_TO_CONNECT,{errorEvent:a});e(b),m.dispatchEvent(new CustomEvent("error",{detail:b}))}}function l(a){b.aborted||m.dispatchEvent(new CustomEvent("message",{detail:a.data}))}let m=new AR,o=AI(m);function p(){g=!0,f({...o,async send(b){if(q.readyState!==AS.OPEN)throw new Ac.SolanaError(Ac.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED);if(!d&&q.bufferedAmount>a){let b,c=new Promise((c,e)=>{let f=setInterval(()=>{q.readyState===AS.OPEN&&q.bufferedAmount>a||(clearInterval(f),d=void 0,c())},16);b=()=>{d=void 0,clearInterval(f),e(new Ac.SolanaError(Ac.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CLOSED_BEFORE_MESSAGE_BUFFERED))}});d={onCancel:b,promise:c}}d&&(!ArrayBuffer.isView(b)||b instanceof DataView||(b=new b.constructor(b)),await d.promise),q.send(b)}})}let q=new AS(c);return b.addEventListener("abort",j),q.addEventListener("close",function a(c){i(),d?.onCancel(),b.removeEventListener("abort",j),q.removeEventListener("close",a),q.removeEventListener("error",k),q.removeEventListener("message",l),q.removeEventListener("open",p),b.aborted||c.wasClean&&1e3===c.code||m.dispatchEvent(new CustomEvent("error",{detail:new Ac.SolanaError(Ac.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED,{cause:c})}))}),q.addEventListener("error",k),q.addEventListener("message",l),q.addEventListener("open",p),new Promise((a,b)=>{e=b,f=a})})({...c,sendBufferHighWatermark:a.sendBufferHighWatermark??131072,signal:d}).then(a.jsonSerializer).then(a=>(function({abortSignal:a,channel:b,intervalMs:c}){let d;function e(){b.send(AV).catch(a=>{(0,Ac.isSolanaError)(a,Ac.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CHANNEL_CONNECTION_CLOSED)&&g.abort()})}function f(){clearInterval(d),d=setInterval(e,c)}let g=new AU;return g.signal.addEventListener("abort",()=>{clearInterval(d)}),a.addEventListener("abort",()=>{g.abort()}),b.on("error",()=>{g.abort()},{signal:g.signal}),b.on("message",f,{signal:g.signal}),f(),{...b,send:(...a)=>(g.signal.aborted||f(),b.send(...a))}})({abortSignal:d,channel:a,intervalMs:b??5e3})),{maxSubscriptionsPerChannel:a.maxSubscriptionsPerChannel??100,minChannels:a.minChannels??1})}({...b,url:a,jsonSerializer:AW})}),d={api:(g=Ao(AT),e={allowedNumericKeyPaths:(Eq||(Eq={accountNotifications:Ar.map(a=>["value",...a]),blockNotifications:[["value","block","transactions",Ak,"meta","preTokenBalances",Ak,"accountIndex"],["value","block","transactions",Ak,"meta","preTokenBalances",Ak,"uiTokenAmount","decimals"],["value","block","transactions",Ak,"meta","postTokenBalances",Ak,"accountIndex"],["value","block","transactions",Ak,"meta","postTokenBalances",Ak,"uiTokenAmount","decimals"],["value","block","transactions",Ak,"meta","rewards",Ak,"commission"],["value","block","transactions",Ak,"meta","innerInstructions",Ak,"index"],["value","block","transactions",Ak,"meta","innerInstructions",Ak,"instructions",Ak,"programIdIndex"],["value","block","transactions",Ak,"meta","innerInstructions",Ak,"instructions",Ak,"accounts",Ak],["value","block","transactions",Ak,"transaction","message","addressTableLookups",Ak,"writableIndexes",Ak],["value","block","transactions",Ak,"transaction","message","addressTableLookups",Ak,"readonlyIndexes",Ak],["value","block","transactions",Ak,"transaction","message","instructions",Ak,"programIdIndex"],["value","block","transactions",Ak,"transaction","message","instructions",Ak,"accounts",Ak],["value","block","transactions",Ak,"transaction","message","header","numReadonlySignedAccounts"],["value","block","transactions",Ak,"transaction","message","header","numReadonlyUnsignedAccounts"],["value","block","transactions",Ak,"transaction","message","header","numRequiredSignatures"],["value","block","rewards",Ak,"commission"]],programNotifications:Ar.flatMap(a=>[["value",Ak,"account",...a],[Ak,"account",...a]])}),Eq)},h=(a,b)=>{let c=b.methodName,d=e?.allowedNumericKeyPaths&&c?e.allowedNumericKeyPaths[c]:void 0;return(0,Ai.pipe)(a,a=>Ap(d??[])(a,b))},f={planExecutor:({request:a,...b})=>AO({...b,responseTransformer:h,subscribeRequest:{...a,methodName:a.methodName.replace(/Notifications$/,"Subscribe")},unsubscribeMethodName:a.methodName.replace(/Notifications$/,"Unsubscribe")}),requestTransformer:g},new Proxy({},{defineProperty:()=>!1,deleteProperty:()=>!1,get(...a){let[b,c]=a,d=c.toString();return function(...a){let b={methodName:d,params:a},c=f.requestTransformer?f.requestTransformer(b):b;return{execute:a=>f.planExecutor({...a,request:c}),request:c}}}})),transport:c},new Proxy(d.api,{defineProperty:()=>!1,deleteProperty:()=>!1,get(a,b,c){if("then"!==b)return function(...e){var f,g;let h=b.toString(),i=Reflect.get(a,h,c);if(!i)throw new Ac.SolanaError(Ac.SOLANA_ERROR__RPC_SUBSCRIPTIONS__CANNOT_CREATE_SUBSCRIPTION_PLAN,{notificationName:h});let j=i(...e);return f=d.transport,g=j,{async subscribe({abortSignal:a}){let b=await f({signal:a,...g});return function({abortSignal:a,dataChannelName:b,dataPublisher:c,errorChannelName:d}){let e=new Map;function f(a){for(let[b,c]of e.entries())c.__hasPolled?(e.delete(b),c.onError(a)):c.publishQueue.push({__type:1,err:a})}let g=new AE;a.addEventListener("abort",()=>{g.abort(),f(Ep||=AG())});let h={signal:g.signal},i=AH;return c.on(d,a=>{i===AH&&(i=a,g.abort(),f(a))},h),c.on(b,a=>{e.forEach((b,c)=>{if(b.__hasPolled){let{onData:d}=b;e.set(c,{__hasPolled:!1,publishQueue:[]}),d(a)}else b.publishQueue.push({__type:0,data:a})})},h),{async *[Symbol.asyncIterator](){if(a.aborted)return;if(i!==AH)throw i;let b=Symbol();e.set(b,{__hasPolled:!1,publishQueue:[]});try{for(;;){let a=e.get(b);if(!a)throw new Ac.SolanaError(Ac.SOLANA_ERROR__INVARIANT_VIOLATION__SUBSCRIPTION_ITERATOR_STATE_MISSING);if(a.__hasPolled)throw new Ac.SolanaError(Ac.SOLANA_ERROR__INVARIANT_VIOLATION__SUBSCRIPTION_ITERATOR_MUST_NOT_POLL_BEFORE_RESOLVING_EXISTING_MESSAGE_PROMISE);let c=a.publishQueue;try{if(c.length)for(let b of(a.publishQueue=[],c))if(0===b.__type)yield b.data;else throw b.err;else yield await new Promise((a,c)=>{e.set(b,{__hasPolled:!0,onData:a,onError:c})})}catch(a){if(a===(Ep||=AG()))return;throw a}}}finally{e.delete(b)}}}}({abortSignal:a,dataChannelName:"notification",dataPublisher:b,errorChannelName:"error"})}}}}})}var AY=a.i(168617),AZ=a.i(527394),A$=a.i(587437),A_=a.i(895769);a.i(84235),a.i(941342),a.i(683402),a.i(727229),a.i(433289),a.i(847675),a.i(278475),a.i(865177);var A0=((D6=A0||{})[D6.Uninitialized=0]="Uninitialized",D6[D6.Initialized=1]="Initialized",D6[D6.Frozen=2]="Frozen",D6),A1=((D7=A1||{})[D7.MintTokens=0]="MintTokens",D7[D7.FreezeAccount=1]="FreezeAccount",D7[D7.AccountOwner=2]="AccountOwner",D7[D7.CloseAccount=3]="CloseAccount",D7[D7.TransferFeeConfig=4]="TransferFeeConfig",D7[D7.WithheldWithdraw=5]="WithheldWithdraw",D7[D7.CloseMint=6]="CloseMint",D7[D7.InterestRate=7]="InterestRate",D7[D7.PermanentDelegate=8]="PermanentDelegate",D7[D7.ConfidentialTransferMint=9]="ConfidentialTransferMint",D7[D7.TransferHookProgramId=10]="TransferHookProgramId",D7[D7.ConfidentialTransferFeeConfig=11]="ConfidentialTransferFeeConfig",D7[D7.MetadataPointer=12]="MetadataPointer",D7[D7.GroupPointer=13]="GroupPointer",D7[D7.GroupMemberPointer=14]="GroupMemberPointer",D7[D7.ScaledUiAmount=15]="ScaledUiAmount",D7[D7.Pause=16]="Pause",D7),A2=((D8=A2||{})[D8.Uninitialized=0]="Uninitialized",D8[D8.TransferFeeConfig=1]="TransferFeeConfig",D8[D8.TransferFeeAmount=2]="TransferFeeAmount",D8[D8.MintCloseAuthority=3]="MintCloseAuthority",D8[D8.ConfidentialTransferMint=4]="ConfidentialTransferMint",D8[D8.ConfidentialTransferAccount=5]="ConfidentialTransferAccount",D8[D8.DefaultAccountState=6]="DefaultAccountState",D8[D8.ImmutableOwner=7]="ImmutableOwner",D8[D8.MemoTransfer=8]="MemoTransfer",D8[D8.NonTransferable=9]="NonTransferable",D8[D8.InterestBearingConfig=10]="InterestBearingConfig",D8[D8.CpiGuard=11]="CpiGuard",D8[D8.PermanentDelegate=12]="PermanentDelegate",D8[D8.NonTransferableAccount=13]="NonTransferableAccount",D8[D8.TransferHook=14]="TransferHook",D8[D8.TransferHookAccount=15]="TransferHookAccount",D8[D8.ConfidentialTransferFee=16]="ConfidentialTransferFee",D8[D8.ConfidentialTransferFeeAmount=17]="ConfidentialTransferFeeAmount",D8[D8.ScaledUiAmountConfig=18]="ScaledUiAmountConfig",D8[D8.PausableConfig=19]="PausableConfig",D8[D8.PausableAccount=20]="PausableAccount",D8[D8.MetadataPointer=21]="MetadataPointer",D8[D8.TokenMetadata=22]="TokenMetadata",D8[D8.GroupPointer=23]="GroupPointer",D8[D8.TokenGroup=24]="TokenGroup",D8[D8.GroupMemberPointer=25]="GroupMemberPointer",D8[D8.TokenGroupMember=26]="TokenGroupMember",D8),A3=((D9=A3||{})[D9.CreateAssociatedToken=0]="CreateAssociatedToken",D9[D9.CreateAssociatedTokenIdempotent=1]="CreateAssociatedTokenIdempotent",D9[D9.RecoverNestedAssociatedToken=2]="RecoverNestedAssociatedToken",D9),A4=((Ea=A4||{})[Ea.Mint=0]="Mint",Ea[Ea.Token=1]="Token",Ea[Ea.Multisig=2]="Multisig",Ea),A5=((Eb=A5||{})[Eb.InitializeMint=0]="InitializeMint",Eb[Eb.InitializeAccount=1]="InitializeAccount",Eb[Eb.InitializeMultisig=2]="InitializeMultisig",Eb[Eb.Transfer=3]="Transfer",Eb[Eb.Approve=4]="Approve",Eb[Eb.Revoke=5]="Revoke",Eb[Eb.SetAuthority=6]="SetAuthority",Eb[Eb.MintTo=7]="MintTo",Eb[Eb.Burn=8]="Burn",Eb[Eb.CloseAccount=9]="CloseAccount",Eb[Eb.FreezeAccount=10]="FreezeAccount",Eb[Eb.ThawAccount=11]="ThawAccount",Eb[Eb.TransferChecked=12]="TransferChecked",Eb[Eb.ApproveChecked=13]="ApproveChecked",Eb[Eb.MintToChecked=14]="MintToChecked",Eb[Eb.BurnChecked=15]="BurnChecked",Eb[Eb.InitializeAccount2=16]="InitializeAccount2",Eb[Eb.SyncNative=17]="SyncNative",Eb[Eb.InitializeAccount3=18]="InitializeAccount3",Eb[Eb.InitializeMultisig2=19]="InitializeMultisig2",Eb[Eb.InitializeMint2=20]="InitializeMint2",Eb[Eb.GetAccountDataSize=21]="GetAccountDataSize",Eb[Eb.InitializeImmutableOwner=22]="InitializeImmutableOwner",Eb[Eb.AmountToUiAmount=23]="AmountToUiAmount",Eb[Eb.UiAmountToAmount=24]="UiAmountToAmount",Eb[Eb.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",Eb[Eb.InitializeTransferFeeConfig=26]="InitializeTransferFeeConfig",Eb[Eb.TransferCheckedWithFee=27]="TransferCheckedWithFee",Eb[Eb.WithdrawWithheldTokensFromMint=28]="WithdrawWithheldTokensFromMint",Eb[Eb.WithdrawWithheldTokensFromAccounts=29]="WithdrawWithheldTokensFromAccounts",Eb[Eb.HarvestWithheldTokensToMint=30]="HarvestWithheldTokensToMint",Eb[Eb.SetTransferFee=31]="SetTransferFee",Eb[Eb.InitializeConfidentialTransferMint=32]="InitializeConfidentialTransferMint",Eb[Eb.UpdateConfidentialTransferMint=33]="UpdateConfidentialTransferMint",Eb[Eb.ConfigureConfidentialTransferAccount=34]="ConfigureConfidentialTransferAccount",Eb[Eb.ApproveConfidentialTransferAccount=35]="ApproveConfidentialTransferAccount",Eb[Eb.EmptyConfidentialTransferAccount=36]="EmptyConfidentialTransferAccount",Eb[Eb.ConfidentialDeposit=37]="ConfidentialDeposit",Eb[Eb.ConfidentialWithdraw=38]="ConfidentialWithdraw",Eb[Eb.ConfidentialTransfer=39]="ConfidentialTransfer",Eb[Eb.ApplyConfidentialPendingBalance=40]="ApplyConfidentialPendingBalance",Eb[Eb.EnableConfidentialCredits=41]="EnableConfidentialCredits",Eb[Eb.DisableConfidentialCredits=42]="DisableConfidentialCredits",Eb[Eb.EnableNonConfidentialCredits=43]="EnableNonConfidentialCredits",Eb[Eb.DisableNonConfidentialCredits=44]="DisableNonConfidentialCredits",Eb[Eb.ConfidentialTransferWithFee=45]="ConfidentialTransferWithFee",Eb[Eb.InitializeDefaultAccountState=46]="InitializeDefaultAccountState",Eb[Eb.UpdateDefaultAccountState=47]="UpdateDefaultAccountState",Eb[Eb.Reallocate=48]="Reallocate",Eb[Eb.EnableMemoTransfers=49]="EnableMemoTransfers",Eb[Eb.DisableMemoTransfers=50]="DisableMemoTransfers",Eb[Eb.CreateNativeMint=51]="CreateNativeMint",Eb[Eb.InitializeNonTransferableMint=52]="InitializeNonTransferableMint",Eb[Eb.InitializeInterestBearingMint=53]="InitializeInterestBearingMint",Eb[Eb.UpdateRateInterestBearingMint=54]="UpdateRateInterestBearingMint",Eb[Eb.EnableCpiGuard=55]="EnableCpiGuard",Eb[Eb.DisableCpiGuard=56]="DisableCpiGuard",Eb[Eb.InitializePermanentDelegate=57]="InitializePermanentDelegate",Eb[Eb.InitializeTransferHook=58]="InitializeTransferHook",Eb[Eb.UpdateTransferHook=59]="UpdateTransferHook",Eb[Eb.InitializeConfidentialTransferFee=60]="InitializeConfidentialTransferFee",Eb[Eb.WithdrawWithheldTokensFromMintForConfidentialTransferFee=61]="WithdrawWithheldTokensFromMintForConfidentialTransferFee",Eb[Eb.WithdrawWithheldTokensFromAccountsForConfidentialTransferFee=62]="WithdrawWithheldTokensFromAccountsForConfidentialTransferFee",Eb[Eb.HarvestWithheldTokensToMintForConfidentialTransferFee=63]="HarvestWithheldTokensToMintForConfidentialTransferFee",Eb[Eb.EnableHarvestToMint=64]="EnableHarvestToMint",Eb[Eb.DisableHarvestToMint=65]="DisableHarvestToMint",Eb[Eb.WithdrawExcessLamports=66]="WithdrawExcessLamports",Eb[Eb.InitializeMetadataPointer=67]="InitializeMetadataPointer",Eb[Eb.UpdateMetadataPointer=68]="UpdateMetadataPointer",Eb[Eb.InitializeGroupPointer=69]="InitializeGroupPointer",Eb[Eb.UpdateGroupPointer=70]="UpdateGroupPointer",Eb[Eb.InitializeGroupMemberPointer=71]="InitializeGroupMemberPointer",Eb[Eb.UpdateGroupMemberPointer=72]="UpdateGroupMemberPointer",Eb[Eb.InitializeScaledUiAmountMint=73]="InitializeScaledUiAmountMint",Eb[Eb.UpdateMultiplierScaledUiMint=74]="UpdateMultiplierScaledUiMint",Eb[Eb.InitializePausableConfig=75]="InitializePausableConfig",Eb[Eb.Pause=76]="Pause",Eb[Eb.Resume=77]="Resume",Eb[Eb.InitializeTokenMetadata=78]="InitializeTokenMetadata",Eb[Eb.UpdateTokenMetadataField=79]="UpdateTokenMetadataField",Eb[Eb.RemoveTokenMetadataKey=80]="RemoveTokenMetadataKey",Eb[Eb.UpdateTokenMetadataUpdateAuthority=81]="UpdateTokenMetadataUpdateAuthority",Eb[Eb.EmitTokenMetadata=82]="EmitTokenMetadata",Eb[Eb.InitializeTokenGroup=83]="InitializeTokenGroup",Eb[Eb.UpdateTokenGroupMaxSize=84]="UpdateTokenGroupMaxSize",Eb[Eb.UpdateTokenGroupUpdateAuthority=85]="UpdateTokenGroupUpdateAuthority",Eb[Eb.InitializeTokenGroupMember=86]="InitializeTokenGroupMember",Eb);new Uint8Array([250,166,180,250,13,12,184,70]),new Uint8Array([121,113,108,39,54,51,0,4]),new Uint8Array([152,32,222,176,223,237,116,134]),new Uint8Array([210,225,30,162,88,184,77,141]),new Uint8Array([234,18,32,56,89,141,37,181]),new Uint8Array([108,37,171,143,248,30,18,110]),new Uint8Array([161,105,88,1,237,221,216,203]),new Uint8Array([221,233,49,45,181,202,220,200]),new Uint8Array([215,228,166,228,84,100,86,123]),yT.union([yT.string().transform(a=>a.replace(/[^0-9.-]+/g,"")),yT.number()]).pipe(yT.coerce.number().min(1e-4).max(0x3b9ac9ff));var A6=yT.enum(["abstract","abstract-testnet","base-sepolia","base","avalanche-fuji","avalanche","iotex","solana-devnet","solana","sei","sei-testnet","polygon","polygon-amoy","peaq","story","educhain","skale-base-sepolia"]),A7=new Map([["abstract",2741],["abstract-testnet",11124],["base-sepolia",84532],["base",8453],["avalanche-fuji",43113],["avalanche",43114],["iotex",4689],["sei",1329],["sei-testnet",1328],["polygon",137],["polygon-amoy",80002],["peaq",3338],["story",1514],["educhain",41923],["skale-base-sepolia",0x135a9d92]]),A8=["solana-devnet","solana"];Object.fromEntries(["abstract","abstract-testnet","base-sepolia","base","avalanche-fuji","avalanche","iotex","sei","sei-testnet","polygon","polygon-amoy","peaq","story","educhain","skale-base-sepolia",...A8].map(a=>[A7.get(a),a]));var A9={id:0x135a9d92,name:"SKALE Base Sepolia",nativeCurrency:{name:"Credits",symbol:"CREDITS",decimals:18},rpcUrls:{default:{http:["https://base-sepolia-testnet.skalenodes.com/v1/jubilant-horrible-ancha"]}},blockExplorers:{default:{name:"Blockscout",url:"https://base-sepolia-testnet-explorer.skalenodes.com",apiUrl:"https://base-sepolia-testnet-explorer.skalenodes.com/api"}}};function Ba(a){let b=Bi(a);return(0,yU.createPublicClient)({chain:b,transport:(0,wQ.http)()}).extend(yV.publicActions)}function Bb(){return Ba("base-sepolia")}function Bc(){return Ba("avalanche-fuji")}function Bd(a,b){let c=Bi(a),d=(0,wP.createWalletClient)({chain:c,transport:(0,wQ.http)(),account:function(a,b={}){let{nonceManager:c}=b,d=(0,eD.toHex)(zD.secp256k1.getPublicKey(a.slice(2),!1));return{...function(a){if("string"==typeof a){if(!(0,eE.isAddress)(a,{strict:!1}))throw new y_.InvalidAddressError({address:a});return{address:a,type:"json-rpc"}}if(!(0,eE.isAddress)(a.address,{strict:!1}))throw new y_.InvalidAddressError({address:a.address});return{address:a.address,nonceManager:a.nonceManager,sign:a.sign,signAuthorization:a.signAuthorization,signMessage:a.signMessage,signTransaction:a.signTransaction,signTypedData:a.signTypedData,source:"custom",type:"local"}}({address:(0,zE.publicKeyToAddress)(d),nonceManager:c,sign:async({hash:b})=>zG({hash:b,privateKey:a,to:"hex"}),signAuthorization:async b=>zH({...b,privateKey:a}),signMessage:async({message:b})=>zJ({message:b,privateKey:a}),signTransaction:async(b,{serializer:c}={})=>zL({privateKey:a,transaction:b,serializer:c}),signTypedData:async b=>zN({...b,privateKey:a})}),publicKey:d,source:"privateKey"}}(b)});return Bk(c)?d.extend(yV.publicActions).extend(a=>({sendTransaction:b=>Aa(a,b),signTransaction:b=>z7(a,b),deployContract:b=>(function(a,b){let{abi:c,args:d,bytecode:e,deploymentType:f,salt:g,...h}=b,i=function(a){let{abi:b,args:c,bytecode:d,deploymentType:e,salt:f}=a;if(!c||0===c.length){let{functionName:a,argsContractDeployer:b}=zV(e,f??zP.zeroHash,(0,eD.toHex)(zx(d)),"0x");return(0,zS.encodeFunctionData)({abi:zT,functionName:a,args:b})}let g=b.find(a=>"type"in a&&"constructor"===a.type);if(!g)throw new zQ.AbiConstructorNotFoundError({docsPath:zU});if(!("inputs"in g)||!g.inputs||0===g.inputs.length)throw new zQ.AbiConstructorParamsNotFoundError({docsPath:zU});let h=(0,zR.encodeAbiParameters)(g.inputs,c),{functionName:i,argsContractDeployer:j}=zV(e,f??zP.zeroHash,(0,eD.toHex)(zx(d)),h);return(0,zS.encodeFunctionData)({abi:zT,functionName:i,args:j})}({abi:c,args:d,bytecode:e,deploymentType:f,salt:g});return h.factoryDeps=h.factoryDeps||[],h.factoryDeps.includes(e)||h.factoryDeps.push(e),z8(a,{...h,data:i,to:"create2"===f||"create2Account"===f?"0x0000000000000000000000000000000000010000":"0x0000000000000000000000000000000000008006"})})(a,b),writeContract:b=>(0,zO.writeContract)(Object.assign(a,{sendTransaction:b=>Aa(a,b)}),b)})):d.extend(yV.publicActions)}function Be(a){return Bd("base-sepolia",a)}function Bf(a){return Bd("avalanche-fuji",a)}function Bg(a){return"object"==typeof a&&null!==a&&"chain"in a&&"transport"in a}function Bh(a){return"object"==typeof a&&null!==a&&"string"==typeof a.address&&"string"==typeof a.type&&"function"==typeof a.sign&&"function"==typeof a.signMessage&&"function"==typeof a.signTypedData&&"function"==typeof a.signTransaction}function Bi(a){if(!a)throw Error("NETWORK environment variable is not set");switch(a){case"abstract":return zz;case"abstract-testnet":return zA;case"base":return y7;case"base-sepolia":return y5;case"avalanche":return zd;case"avalanche-fuji":return y6;case"sei":return y8;case"sei-testnet":return y9;case"polygon":return za;case"polygon-amoy":return zb;case"peaq":return zc;case"story":return zB;case"educhain":return zC;case"iotex":return zf;case"iotex-testnet":return ze;case"skale-base-sepolia":return A9;default:throw Error(`Unsupported network: ${a}`)}}var Bj=new Set([2741,11124]);function Bk(a){return Bj.has(a.id)}function Bl(a){return AC(a?(0,AD.devnet)(a):(0,AD.devnet)("https://api.devnet.solana.com"))}function Bm(a){return AC(a?(0,AD.mainnet)(a):(0,AD.mainnet)("https://api.mainnet-beta.solana.com"))}function Bn(a,b){if("solana-devnet"===a)return Bl(b);if("solana"===a)return Bm(b);throw Error("Invalid network")}function Bo(a,b){if("solana-devnet"===a)return AX((0,AD.devnet)(b?Bp(b):"wss://api.devnet.solana.com"));if("solana"===a)return AX((0,AD.mainnet)(b?Bp(b):"wss://api.mainnet-beta.solana.com"));throw Error("Invalid network")}function Bp(a){return a.startsWith("http")?a.replace("http","ws"):a}function Bq(a){if(!A8.find(b=>b===a))throw Error(`Unsupported SVM network: ${a}`);return Bn(a)}async function Br(a){let b=fE.base58.decode(a);if(64===b.length)return await (0,Ab.createKeyPairSignerFromBytes)(b);if(32===b.length)return await (0,Ab.createKeyPairSignerFromPrivateKeyBytes)(b);throw Error(`Unexpected key length: ${b.length}. Expected 32 or 64 bytes.`)}function Bs(a){return"object"==typeof a&&null!==a&&(0,Ab.isTransactionSigner)(a)}wV({},{authorizationPrimaryType:()=>Bu,authorizationTypes:()=>Bt,config:()=>wW,createClientAvalancheFuji:()=>Bc,createClientSepolia:()=>Bb,createConnectedClient:()=>Ba,createSigner:()=>Bd,createSignerAvalancheFuji:()=>Bf,createSignerSepolia:()=>Be,getChainFromNetwork:()=>Bi,isAccount:()=>Bh,isSignerWallet:()=>Bg,isZkStackChain:()=>Bk,usdcABI:()=>wX});var Bt={TransferWithAuthorization:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"},{name:"validAfter",type:"uint256"},{name:"validBefore",type:"uint256"},{name:"nonce",type:"bytes32"}]},Bu="TransferWithAuthorization";wV({},{SvmAddressRegex:()=>Bv});var Bv=/^[1-9A-HJ-NP-Za-km-z]{32,44}$/,Bw=/^0x[0-9a-fA-F]{40}$/,Bx=/^0x[a-fA-F0-9]{40}|[A-Za-z0-9][A-Za-z0-9-]{0,34}[A-Za-z0-9]$/,By=["exact"],Bz=[1],BA=["insufficient_funds","invalid_exact_evm_payload_authorization_valid_after","invalid_exact_evm_payload_authorization_valid_before","invalid_exact_evm_payload_authorization_value","invalid_exact_evm_payload_signature","invalid_exact_evm_payload_undeployed_smart_wallet","invalid_exact_evm_payload_recipient_mismatch","invalid_exact_svm_payload_transaction","invalid_exact_svm_payload_transaction_amount_mismatch","invalid_exact_svm_payload_transaction_create_ata_instruction","invalid_exact_svm_payload_transaction_create_ata_instruction_incorrect_payee","invalid_exact_svm_payload_transaction_create_ata_instruction_incorrect_asset","invalid_exact_svm_payload_transaction_instructions","invalid_exact_svm_payload_transaction_instructions_length","invalid_exact_svm_payload_transaction_instructions_compute_limit_instruction","invalid_exact_svm_payload_transaction_instructions_compute_price_instruction","invalid_exact_svm_payload_transaction_instructions_compute_price_instruction_too_high","invalid_exact_svm_payload_transaction_instruction_not_spl_token_transfer_checked","invalid_exact_svm_payload_transaction_instruction_not_token_2022_transfer_checked","invalid_exact_svm_payload_transaction_fee_payer_included_in_instruction_accounts","invalid_exact_svm_payload_transaction_fee_payer_transferring_funds","invalid_exact_svm_payload_transaction_not_a_transfer_instruction","invalid_exact_svm_payload_transaction_receiver_ata_not_found","invalid_exact_svm_payload_transaction_sender_ata_not_found","invalid_exact_svm_payload_transaction_simulation_failed","invalid_exact_svm_payload_transaction_transfer_to_incorrect_ata","invalid_network","invalid_payload","invalid_payment_requirements","invalid_scheme","invalid_payment","payment_expired","unsupported_scheme","invalid_x402_version","invalid_transaction_state","invalid_x402_version","settle_exact_svm_block_height_exceeded","settle_exact_svm_transaction_confirmation_timed_out","unsupported_scheme","unexpected_settle_error","unexpected_verify_error"],BB=a=>Number.isInteger(Number(a))&&Number(a)>=0,BC=yT.string().regex(Bw).or(yT.string().regex(Bv)),BD=yT.string().regex(Bx).or(yT.string().regex(Bv)),BE=yT.object({scheme:yT.enum(By),network:A6,maxAmountRequired:yT.string().refine(BB),resource:yT.string().url(),description:yT.string(),mimeType:yT.string(),outputSchema:yT.record(yT.any()).optional(),payTo:BC,maxTimeoutSeconds:yT.number().int(),asset:BD,extra:yT.record(yT.any()).optional()}),BF=yT.object({from:yT.string().regex(Bw),to:yT.string().regex(Bw),value:yT.string().refine(BB).refine(a=>a.length<=18),validAfter:yT.string().refine(BB),validBefore:yT.string().refine(BB),nonce:yT.string().regex(/^0x[0-9a-fA-F]{64}$/)}),BG=yT.object({signature:yT.string().regex(/^0x[0-9a-fA-F]+$/),authorization:BF}),BH=yT.object({transaction:yT.string().regex(/^[A-Za-z0-9+/]*={0,2}$/)}),BI=yT.object({x402Version:yT.number().refine(a=>Bz.includes(a)),scheme:yT.enum(By),network:A6,payload:yT.union([BG,BH])});yT.object({x402Version:yT.number().refine(a=>Bz.includes(a)),error:yT.enum(BA).optional(),accepts:yT.array(BE).optional(),payer:yT.string().regex(Bx).optional()});var BJ=yT.enum(["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"]),BK=yT.object({type:yT.literal("http"),method:BJ,queryParams:yT.record(yT.string(),yT.string()).optional(),bodyType:yT.enum(["json","form-data","multipart-form-data","text","binary"]).optional(),bodyFields:yT.record(yT.string(),yT.any()).optional(),headerFields:yT.record(yT.string(),yT.any()).optional()});yT.discriminatedUnion("type",[BK]);var BL=yT.object({resource:yT.string(),type:yT.enum(["http"]),x402Version:yT.number().refine(a=>Bz.includes(a)),accepts:yT.array(BE),lastUpdated:yT.date(),metadata:yT.record(yT.any()).optional()});yT.object({paymentPayload:BI,paymentRequirements:BE}),yT.object({paymentPayload:BI,paymentRequirements:BE}),yT.object({isValid:yT.boolean(),invalidReason:yT.enum(BA).optional(),payer:BC.optional()}),yT.object({success:yT.boolean(),errorReason:yT.enum(BA).optional(),payer:BC.optional(),transaction:yT.string().regex(Bx),network:A6}),yT.object({type:yT.string().optional(),limit:yT.number().optional(),offset:yT.number().optional()}),yT.object({x402Version:yT.number().refine(a=>Bz.includes(a)),items:yT.array(BL),pagination:yT.object({limit:yT.number(),offset:yT.number(),total:yT.number()})});var BM=yT.object({x402Version:yT.number().refine(a=>Bz.includes(a)),scheme:yT.enum(By),network:A6,extra:yT.record(yT.any()).optional()});function BN(a){try{let b=(0,AZ.getBase64Encoder)().encode(a.transaction);return(0,AY.getTransactionDecoder)().decode(b)}catch(a){throw console.error("error",a),Error("invalid_exact_svm_payload_transaction")}}function BO(a){let b=(0,A$.getCompiledTransactionMessageDecoder)().decode(a.messageBytes),c=b.staticAccounts??[];for(let a of b.instructions??[]){let b=c[a.programAddressIndex].toString();if(b===A_.TOKEN_PROGRAM_ADDRESS.toString()||b==="TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb".toString()){let b=a.accountIndices??[];if(b.length>=4){let a=c[b[3]].toString();if(a)return a}}}return""}async function BP(a,b,c){let d=await BQ(a,b),e=(0,AY.getBase64EncodedWireTransaction)(d);return await c.simulateTransaction(e,{sigVerify:!0,replaceRecentBlockhash:!1,commitment:"confirmed",encoding:"base64",accounts:void 0,innerInstructions:void 0,minContextSlot:void 0}).send()}async function BQ(a,b){if((0,Ab.isTransactionModifyingSigner)(a)){let[c]=await a.modifyAndSignTransactions([b]);if(!c)throw Error("transaction_signer_failed_to_return_transaction");return c}if((0,Ab.isTransactionPartialSigner)(a)){var c,d;let[e]=await a.signTransactions([b]);if(!e)throw Error("transaction_signer_failed_to_return_signatures");return c=b,d=e,Object.freeze({...c,signatures:Object.freeze({...c.signatures,...d})})}throw Error("transaction_signer_must_support_offline_signing")}yT.object({kinds:yT.array(BM)}),wV({},{createDevnetRpcClient:()=>Bl,createMainnetRpcClient:()=>Bm,createSignerFromBase58:()=>Br,createSvmConnectedClient:()=>Bq,decodeTransactionFromPayload:()=>BN,getRpcClient:()=>Bn,getRpcSubscriptions:()=>Bo,getTokenPayerFromTransaction:()=>BO,isSignerWallet:()=>Bs,signAndSimulateTransaction:()=>BP,signTransactionWithSigner:()=>BQ}),yT.object({paymentHeader:yT.string(),paymentRequirements:BE});var BR=((Ec=BR||{})[Ec.RequestUnits=0]="RequestUnits",Ec[Ec.RequestHeapFrame=1]="RequestHeapFrame",Ec[Ec.SetComputeUnitLimit=2]="SetComputeUnitLimit",Ec[Ec.SetComputeUnitPrice=3]="SetComputeUnitPrice",Ec[Ec.SetLoadedAccountsDataSizeLimit=4]="SetLoadedAccountsDataSizeLimit",Ec);a.s([],781034),a.i(331852),a.i(238363);class BS{static parse(a){try{return new BS(a)}catch(a){return null}}static throwIfNotWellFormedJwt(a){return cn.decodeJwt(a),a}get subject(){return this._decoded.sub}get expiration(){return this._decoded.exp}get issuer(){return this._decoded.iss}get audience(){return this._decoded.aud}isExpired(a=0){return Date.now()>=1e3*(this.expiration-a)}constructor(a){this.value=a,this._decoded=cn.decodeJwt(a)}}class BT extends BS{static parse(a){try{return new BT(a)}catch(a){return null}}get appId(){return this._decoded.aid?this._decoded.aid:this.audience}}let BU=({style:a,...b})=>(0,T.jsxs)("svg",{viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{height:"28px",width:"28px",...a},...b,children:[(0,T.jsx)("rect",{width:"1024",height:"1024",fill:"#0052FF",rx:100,ry:100}),(0,T.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M152 512C152 710.823 313.177 872 512 872C710.823 872 872 710.823 872 512C872 313.177 710.823 152 512 152C313.177 152 152 313.177 152 512ZM420 396C406.745 396 396 406.745 396 420V604C396 617.255 406.745 628 420 628H604C617.255 628 628 617.255 628 604V420C628 406.745 617.255 396 604 396H420Z",fill:"white"})]}),BV="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PScwIDAgMTAyNCAxMDI0JyBmaWxsPSdub25lJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHN0eWxlPSdoZWlnaHQ6MjhweDt3aWR0aDoyOHB4Jz48cmVjdCB3aWR0aD0nMTAyNCcgaGVpZ2h0PScxMDI0JyBmaWxsPScjMDA1MkZGJyByeD0nMTAwJyByeT0nMTAwJz48L3JlY3Q+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00xNTIgNTEyQzE1MiA3MTAuODIzIDMxMy4xNzcgODcyIDUxMiA4NzJDNzEwLjgyMyA4NzIgODcyIDcxMC44MjMgODcyIDUxMkM4NzIgMzEzLjE3NyA3MTAuODIzIDE1MiA1MTIgMTUyQzMxMy4xNzcgMTUyIDE1MiAzMTMuMTc3IDE1MiA1MTJaTTQyMCAzOTZDNDA2Ljc0NSAzOTYgMzk2IDQwNi43NDUgMzk2IDQyMFY2MDRDMzk2IDYxNy4yNTUgNDA2Ljc0NSA2MjggNDIwIDYyOEg2MDRDNjE3LjI1NSA2MjggNjI4IDYxNy4yNTUgNjI4IDYwNFY0MjBDNjI4IDQwNi43NDUgNjE3LjI1NSAzOTYgNjA0IDM5Nkg0MjBaJyBmaWxsPSd3aGl0ZSc+PC9wYXRoPjwvc3ZnPg==",BW="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAALZJREFUaEPtmjEOhDAMBNc/O14GvOzys3CAKK6eAlmaVGl2Zc+kTOU685vkc9/bnD2prZK5/TZY24z9P+g4F5hNh7/GdoG37WlAA5CATwgCxHENYISwQAMQII5rACOEBRqAAHFcAxghLNAABIjjGsAIYYEGIEAc1wBGCAs0AAHiuAYwQligAQgQxzWAEcICDUCAOK4BjBAWaAACxHENYISwQAMQII6fBjr+VHkW3+u+tfyxMpJaDgYzYxb/ALZVAAAAAElFTkSuQmCC";class BX extends cw.E{async initialize(){await this.importPromise,await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}disconnect(){this.proxyProvider.walletProvider.disconnect(),this.onDisconnect()}get walletBranding(){return{name:this.displayName,icon:BW,id:"com.coinbase.wallet"}}async promptConnection(){try{await this.importPromise;let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cy.P("Unable to retrieve accounts");this.connected=!0,await this.syncAccounts([a[0]])}catch(a){throw(0,cz.f)(a)}}constructor(b,c,d,e,f){super("base_account",b,c,d),this.connectorType="base_account",this.walletClientType="base_account",this.displayName="Base",this.setBaseAccountSdk=f,this.proxyProvider=new cw.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.baseAccountConfig={...e,appChainIds:[c.id].concat(b.map(a=>a.id))},g?(this.proxyProvider.setWalletProvider(g.getProvider()),this.setBaseAccountSdk(g),console.log("Base Account SDK Initialized")):this.importPromise=a.A(823287).then(({createBaseAccountSDK:a})=>{g=a(this.baseAccountConfig),this.proxyProvider.setWalletProvider(g.getProvider()),this.setBaseAccountSdk(g),console.log("Base Account SDK Initialized")}).catch(console.error)}}let BY=[1,0xaa36a7,137,10,8453,84532,42161,7777777,43114,56];class BZ extends cw.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}disconnect(){this.proxyProvider.walletProvider.disconnect(),this.onDisconnect()}get walletBranding(){return{name:this.displayName,icon:BV,id:"com.coinbase.wallet"}}async promptConnection(){try{let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cy.P("Unable to retrieve accounts");this.connected=!0,await this.syncAccounts([a[0]])}catch(a){throw(0,cz.f)(a)}}updateConnectionPreference(a){this.coinbaseWalletConfig={...this.coinbaseWalletConfig,preference:{...this.coinbaseWalletConfig.preference,options:a}},this.walletClientType="smartWalletOnly"===a?"coinbase_smart_wallet":"coinbase_wallet",h=ez({...this.coinbaseWalletConfig}),this.proxyProvider.setWalletProvider(h.getProvider())}constructor(a,b,c,d){if(super("coinbase_wallet",a,b,c),this.connectorType="coinbase_wallet",this.displayName="Coinbase Wallet",this.proxyProvider=new cw.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.coinbaseWalletConfig={...d,appChainIds:[b.id].concat(a.map(a=>a.id))},this.walletClientType="smartWalletOnly"===this.coinbaseWalletConfig.preference?.options?"coinbase_smart_wallet":"coinbase_wallet","coinbase_smart_wallet"===this.walletClientType&&(this.displayName="Coinbase Smart Wallet"),!h){let a="eoaOnly"!==this.coinbaseWalletConfig.preference?.options?(this.coinbaseWalletConfig.appChainIds??[]).filter(a=>!BY.includes(a)):[];a.length>0&&!a.every(a=>W.DEFAULT_SUPPORTED_CHAIN_IDS.has(a))&&console.info(`The configured chains are not supported by Coinbase Smart Wallet: ${a.join(", ")}`),h=ez(this.coinbaseWalletConfig)}this.proxyProvider.setWalletProvider(h.getProvider())}}let B$=({...a})=>(0,T.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,T.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.37126 11.0323C2.37126 12.696 3.90598 13.4421 5.40654 13.4468C8.91753 13.4468 12.8021 11.2897 12.7819 7.67984C12.7673 5.07728 10.3748 2.86167 7.54357 2.88296C4.8495 2.88296 2.21821 4.6411 2.21803 7.03628C2.21803 7.67951 2.58722 8.30178 3.55231 8.37184C2.74763 9.16826 2.37126 10.1225 2.37126 11.0323ZM7.55283 8.68012C8.11562 8.68012 8.57186 8.13217 8.57186 7.45624C8.57186 6.78032 8.11562 6.23237 7.55283 6.23237C6.99003 6.23237 6.53379 6.78032 6.53379 7.45624C6.53379 8.13217 6.99003 8.68012 7.55283 8.68012ZM10.4747 8.68012C11.0375 8.68012 11.4937 8.13217 11.4937 7.45625C11.4937 6.78032 11.0375 6.23237 10.4747 6.23237C9.91186 6.23237 9.45562 6.78032 9.45562 7.45625C9.45562 8.13217 9.91186 8.68012 10.4747 8.68012Z",fill:a.color||"var(--privy-color-foreground-3)"})});class B_ extends cw.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return await this.isConnected()?(await this.proxyProvider.request({method:"wallet_switchEthereumChain",params:[(0,cw.t)(a?.chainId||"0x1")]}),this.getConnectedWallet()):null}get walletBranding(){return{name:"Privy Wallet",icon:B$,id:"io.privy.wallet"}}disconnect(){this.connected=!1}async promptConnection(){}constructor({provider:a,chains:b,defaultChain:c,rpcConfig:d,imported:e,walletIndex:f}){super("privy",b,c,d),this.connectorType="embedded",this.proxyProvider=a,this.walletIndex=f,e&&(this.connectorType="embedded_imported"),this.subscribeListeners()}}async function B0(){let a=Ez();return a?a.getAccessToken():Promise.resolve(cz.u.get(eB.P)||cz.u.get(eB.C)||null)}let B1=["eth_sign","eth_populateTransactionRequest","eth_signTransaction","personal_sign","eth_signTypedData_v4","csw_signUserOperation","secp256k1_sign"];function B2(a){return a?{"privy-ui":"t"}:void 0}class B3{async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode)throw new cy.a("Email and email code must be set prior to calling authenticate.");try{return await this.api.post(e1,{email:this.meta.email,code:this.meta.emailCode,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode)throw new cy.a("Email and email code must be set prior to calling authenticate.");try{return await this.api.post(e2,{email:this.meta.email,code:this.meta.emailCode})}catch(a){throw(0,cy.f)(a)}}async sendCodeEmail({email:a,captchaToken:b,withPrivyUi:c}){if(!this.api)throw new cy.a("Auth flow has no API instance");if(a&&(this.meta.email=a),b&&(this.meta.captchaToken=b),!this.meta.email)throw new cy.a("Email must be set when initialzing authentication.");let d=B2(c);try{return await this.api.post(e0,{email:this.meta.email,token:this.meta.captchaToken},{headers:{...d}})}catch(a){throw(0,cy.f)(a)}}constructor({email:a,captchaToken:b,disableSignup:c}){this.meta={email:a,captchaToken:b,disableSignup:c??!1}}}class B4 extends B3{async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.email||!this.meta.emailCode||!this.meta.oldAddress)throw new cy.a("Email, email code, and an old email address must be set prior to calling update.");try{return await this.api.post(e4,{oldAddress:this.meta.oldAddress,newAddress:this.meta.email,code:this.meta.emailCode})}catch(a){throw(0,cy.f)(a)}}constructor(a,b,c){super({email:b,captchaToken:c}),this.meta={email:b,captchaToken:c,oldAddress:a,disableSignup:!1}}}function B5(a){return{name:a.metadata?.shortName||a.name||"",universalLink:a.mobile.universal,deepLink:a.mobile.native}}function B6(a,b){let c=B5(b);if(c.universalLink)return Ca(c.universalLink,a)}let B7="WALLETCONNECT_DEEPLINK_CHOICE";function B8(a){return a.startsWith("http://")||a.startsWith("https://")}function B9(a,b){if(B8(a))return Ca(a,b);let c=a;return c.includes("://")||(c=a.replaceAll("/","").replaceAll(":",""),c=`${c}://`),c.endsWith("/")||(c=`${c}/`),{redirect:`${c}wc?uri=${encodeURIComponent(b)}`,href:c}}function Ca(a,b){if(!B8(a))return B9(a,b);let c=a;return c.endsWith("/")||(c=`${c}/`),{redirect:`${c}wc?uri=${encodeURIComponent(b)}`,href:c}}function Cb(a,b){window.open(a,b,"noreferrer noopener")}class Cc{execute(a){return null===this.promise&&(this.promise=(async()=>{try{return await this.fn(a)}finally{this.promise=null}})()),this.promise}constructor(a){this.promise=null,this.fn=a}}class Cd{get meta(){return this._meta}async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.channelToken)throw new cy.a("Auth flow must be initialized first");try{let a=await this.api.post(eX,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"});if(!a)throw new cy.a("No response from authentication");return a}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(eY,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid})}catch(a){throw(0,cy.f)(a)}}async _startChannelOnce(){if(!this.api)throw new cy.a("Auth flow has no API instance");let a=await this.api.post(eW,{token:this.captchaToken});eC.isMobile&&!eC.isIOS&&a.connect_uri&&Cb(a.connect_uri,"_blank"),this._meta={...this._meta,connectUri:a.connect_uri,channelToken:a.channel_token}}async initializeFarcasterConnect(){if(!this.api)throw new cy.a("Auth flow has no API instance");await this.startChannelOnce.execute()}async _pollForReady(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.channelToken)throw new cy.a("Auth flow must be initialized first");let a=await this.api.get(eZ,{headers:{"farcaster-channel-token":this.meta.channelToken}});return"completed"===a.state&&(this.message=a.message,this.signature=a.signature,this.fid=a.fid,!0)}constructor(a,b=!1){this._meta={disableSignup:!1},this.captchaToken=a,this.startChannelOnce=new Cc(this._startChannelOnce.bind(this)),this.pollForReady=new Cc(this._pollForReady.bind(this)),this._meta.disableSignup=b}}function Ce(){}async function Cf(a){return new Promise((a,b)=>{b(Error("Chrome identity API not available"))})}function Cg(a){return crypto.getRandomValues(new Uint8Array(a))}function Ch(){return ct.base64url.encode(Cg(36))}function Ci(){return Ch()}async function Cj(a,b="S256"){if("S256"!=b)return a;{let b=await async function(a){let b=(new TextEncoder).encode(a);return new Uint8Array(await crypto.subtle.digest("SHA-256",b))}(a);return ct.base64url.encode(b)}}class Ck{addCaptchaToken(a){this.meta.captchaToken=a}isActive(){return!!(this.meta.authorizationCode&&this.meta.stateCode&&this.meta.provider)}async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new cy.a("[OAuth AuthFlow] Authorization and state codes code must be set prior to calling authenticate.");if("undefined"===this.meta.authorizationCode)throw new cy.a("User denied confirmation during OAuth flow");let a=function(){let a=cz.u.get(eB.a);if(!a)throw new cy.a("Authentication error.");return a}();try{let b=await this.api.post(fd,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:a,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"});return cz.u.del(eB.a),cz.u.del(eB.H),cz.u.del(eB.O),b}catch(b){let a=(0,cy.f)(b);if(a.privyErrorCode)throw new cy.a(a.message||"Invalid code during OAuth flow.",void 0,a.privyErrorCode);if("User denied confirmation during OAuth flow"===a.message)throw new cy.a("Invalid code during oauth flow.",void 0,cy.b.OAUTH_USER_DENIED);throw new cy.a("Invalid code during OAuth flow.",void 0,cy.b.UNKNOWN_AUTH_ERROR)}}async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new cy.a("[OAuth AuthFlow] Authorization and state codes code must be set prior to calling link.");if("undefined"===this.meta.authorizationCode)throw new cy.a("User denied confirmation during OAuth flow");let a=cz.u.get(eB.a);if(!a)throw new cy.a("Authentication error.");try{let b=await this.api.post(fe,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:a});return cz.u.del(eB.a),b}catch(a){throw(0,cy.f)(a)}}async getAuthorizationUrl(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.provider)throw new cy.a("Provider must be set when initializing OAuth authentication.");let a=Ch();cz.u.put(eB.a,a);let b=Ci();cz.u.put(eB.S,b);let c=await Cj(a);this.meta.withPrivyUi||cz.u.put(eB.H,!0),this.meta.disableSignup?cz.u.put(eB.O,!0):cz.u.del(eB.O);let d=B2(this.meta.withPrivyUi),e=window.location.href,f=function(){let a=Ce();if(a)return`https://${a}.chromiumapp.org`}();f&&(e=f);try{return await this.api.post(fc,{provider:this.meta.provider,redirect_to:this.meta.customOAuthRedirectUrl||e,token:this.meta.captchaToken,code_challenge:c,state_code:b},{headers:{...d}})}catch(a){throw(0,cy.f)(a)}}constructor(a){this.meta=a}}function Cl(){let a=new URL(window.location.href);a.searchParams.delete("privy_oauth_code"),a.searchParams.delete("privy_oauth_provider"),a.searchParams.delete("privy_oauth_state"),cz.u.del(eB.S),window.history.replaceState({},"",a)}class Cm{async initRegisterFlow(a){if(!this.api)throw new cy.a("Auth flow has no API instance");this.authenticateForRegistration=!0,this.meta.initRegisterResponse=await this.initRegisterOnce.execute(a)}async initAuthenticationFlow(a){if(!this.api)throw new cy.a("Auth flow has no API instance");this.authenticateForRegistration=!1,this.meta.initAuthenticateResponse=await this.initAuthenticateOnce.execute(a)}async initLinkFlow(){if(!this.api)throw new cy.a("Auth flow has no API instance");this.meta.initLinkResponse=await this.initLinkOnce.execute()}async register(){let b=await a.A(577627);if(!this.api)throw new cy.a("Auth flow has no API instance");if(!b.browserSupportsWebAuthn())throw new cy.a("WebAuthn is not supported in this browser");this.meta.initRegisterResponse||(this.meta.initRegisterResponse=await this.initRegisterOnce.execute());try{let a=this.meta.initRegisterResponse.options,c=await b.startRegistration({optionsJSON:this._transformInitLinkOptionsToCamelCase(a)});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(fm,{relying_party:this.meta.initRegisterResponse.relying_party,authenticator_response:this._transformRegistrationResponseToSnakeCase(c)})}catch(a){if("NotAllowedError"===a.name)throw new cy.a("Passkey request timed out or rejected by user.",void 0,cy.b.PASSKEY_NOT_ALLOWED);throw(0,cy.f)(a)}}async authenticate(){if(this.authenticateForRegistration)return this.register();let b=await a.A(577627);if(!this.api)throw new cy.a("Auth flow has no API instance");if(!b.browserSupportsWebAuthn())throw new cy.a("WebAuthn is not supported in this browser");this.meta.initAuthenticateResponse||(this.meta.initAuthenticateResponse=await this.initAuthenticateOnce.execute());let c=this.meta.allowedCredentialsIds?.map(a=>({type:"public-key",id:a}))??this.meta.initAuthenticateResponse.options.allow_credentials;try{let a=await b.startAuthentication({optionsJSON:this._transformInitAuthenticateOptionsToCamelCase({...this.meta.initAuthenticateResponse.options,allow_credentials:c})});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(fl,{relying_party:this.meta.initAuthenticateResponse.relying_party,challenge:this.meta.initAuthenticateResponse.options.challenge,authenticator_response:this._transformAuthenticationResponseToSnakeCase(a)})}catch(a){if("NotAllowedError"===a.name)throw new cy.a("Passkey request timed out or rejected by user.",void 0,cy.b.PASSKEY_NOT_ALLOWED);throw(0,cy.f)(a)}}async link(){let b=await a.A(577627);if(!this.api)throw new cy.a("Auth flow has no API instance");if(!b.browserSupportsWebAuthn())throw new cy.a("WebAuthn is not supported in this browser");this.meta.initLinkResponse||(this.meta.initLinkResponse=await this.initLinkOnce.execute());try{let a=this.meta.initLinkResponse.options,c=await b.startRegistration({optionsJSON:this._transformInitLinkOptionsToCamelCase(a)});return this.meta.setPasskeyAuthState?.({status:"submitting-response"}),await this.api.post(fk,{relying_party:this.meta.initLinkResponse.relying_party,authenticator_response:this._transformRegistrationResponseToSnakeCase(c)})}catch(a){if("NotAllowedError"===a.name)throw new cy.a("Passkey request timed out or rejected by user.",void 0,cy.b.PASSKEY_NOT_ALLOWED);throw(0,cy.f)(a)}}async _initRegisterOnce(a){if(!this.api)throw new cy.a("Auth flow has no API instance");let b=B2(a);return await this.api.post(fj,{token:this.meta.captchaToken},{headers:{...b}})}async _initAuthenticateOnce(a){if(!this.api)throw new cy.a("Auth flow has no API instance");let b=B2(a);return await this.api.post(fi,{token:this.meta.captchaToken},{headers:{...b}})}async _initLinkOnce(){if(!this.api)throw new cy.a("Auth flow has no API instance");return await this.api.post(fh,{})}_transformInitLinkOptionsToCamelCase(a){return{rp:a.rp,user:{id:a.user.id,name:a.user.name,displayName:a.user.display_name},challenge:a.challenge,pubKeyCredParams:a.pub_key_cred_params.map(a=>({type:a.type,alg:a.alg})),timeout:a.timeout,excludeCredentials:a.exclude_credentials?.map(a=>({id:a.id,type:a.type,transports:a.transports})),authenticatorSelection:{authenticatorAttachment:a.authenticator_selection?.authenticator_attachment,requireResidentKey:a.authenticator_selection?.require_resident_key,residentKey:a.authenticator_selection?.resident_key,userVerification:a.authenticator_selection?.user_verification},attestation:a.attestation,extensions:{appid:a.extensions?.app_id,credProps:a.extensions?.cred_props?.rk,hmacCreateSecret:a.extensions?.hmac_create_secret},hints:this.meta.hints}}_transformRegistrationResponseToSnakeCase(a){return{id:a.id,raw_id:a.rawId,response:{client_data_json:a.response.clientDataJSON,attestation_object:a.response.attestationObject,authenticator_data:a.response.authenticatorData},authenticator_attachment:a.authenticatorAttachment,client_extension_results:{app_id:a.clientExtensionResults.appid,cred_props:a.clientExtensionResults.credProps,hmac_create_secret:a.clientExtensionResults.hmacCreateSecret},type:a.type}}_transformInitAuthenticateOptionsToCamelCase(a){return{rpId:a.rp_id,challenge:a.challenge,allowCredentials:a.allow_credentials?.map(a=>({id:a.id,type:a.type,transports:a.transports}))||[],timeout:a.timeout,extensions:{appid:a.extensions?.app_id,credProps:a.extensions?.cred_props,hmacCreateSecret:a.extensions?.hmac_create_secret},userVerification:a.user_verification}}_transformAuthenticationResponseToSnakeCase(a){return{id:a.id,raw_id:a.rawId,response:{client_data_json:a.response.clientDataJSON,authenticator_data:a.response.authenticatorData,signature:a.response.signature,user_handle:a.response.userHandle},authenticator_attachment:a.authenticatorAttachment,client_extension_results:{app_id:a.clientExtensionResults.appid,cred_props:a.clientExtensionResults.credProps,hmac_create_secret:a.clientExtensionResults.hmacCreateSecret},type:a.type}}constructor({captchaToken:a,setPasskeyAuthState:b,hints:c}){this.authenticateForRegistration=!1,this.initRegisterOnce=new Cc(this._initRegisterOnce.bind(this)),this.initAuthenticateOnce=new Cc(this._initAuthenticateOnce.bind(this)),this.initLinkOnce=new Cc(this._initLinkOnce.bind(this)),this.meta={captchaToken:a,setPasskeyAuthState:b,hints:c}}}let Cn=({address:a,chainId:b,nonce:c})=>`${window.location.host} wants you to sign in with your Ethereum account:
${a}

By signing, you are proving you own this wallet and logging in. This does not initiate a transaction or cost any fees.

URI: ${window.location.origin}
Version: 1
Chain ID: ${b}
Nonce: ${c}
Issued At: ${(new Date).toISOString()}
Resources:
- https://privy.io`;class Co{get meta(){return{connectorType:this.wallet?.connectorType,walletClientType:this.wallet?.walletClientType,chainId:this.wallet?.chainId,address:this.wallet?.address,disableSignup:this._meta.disableSignup}}async authenticate(){if(!this.client)throw new cy.a("SiweFlow has no client instance");try{if(this.preparedMessage&&this.signature)return await this.client.authenticateWithSiweInternal({message:this.preparedMessage,signature:this.signature,chainId:this.wallet?.chainId,walletClientType:this.walletClientType??this.wallet?.walletClientType,connectorType:this.connectorType??this.wallet?.connectorType,mode:this._meta.disableSignup?"no-signup":"login-or-sign-up"});if(!this.wallet)throw new cy.a("SiweFlow has no wallet instance");let{message:a,signature:b}=await this.sign();return await this.client.authenticateWithSiweInternal({message:a,signature:b,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.client)throw new cy.a("SiweFlow has no client instance");try{if(!this.wallet)throw new cy.a("SiweFlow has no wallet instance");let{message:a,signature:b}=await this.sign();return await this.client.linkWithSiweInternal({message:a,signature:b,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType})}catch(a){throw(0,cy.f)(a)}}async sign(){if(!this.client)throw new cy.a("SiweFlow has no client instance");if(await this.buildMessage(),!this.preparedMessage)throw new cy.a("Could not prepare SIWE message");if(!this.wallet)throw new cy.a("SiweFlow has no wallet instance");let a=await this.wallet.sign(this.preparedMessage);return{message:this.preparedMessage,signature:a}}async _getNonceOnce(){if(!this.client)throw new cy.a("SiweFlow has no client instance");if(!this.wallet)throw new cy.a("UI SiweFlow has no wallet instance");return await this.client.generateSiweNonce({address:this.wallet.address,captchaToken:this.captchaToken})}async buildMessage(){if(!this.client)throw new cy.a("SiweFlow has no client instance");if(!this.wallet)throw new cy.a("SiweFlow has no wallet instance");let a=this.wallet.address,b=this.wallet.chainId.replace("eip155:","");return this.nonce||(this.nonce=await this.getNonceOnce.execute()),this.preparedMessage=Cn({address:a,chainId:b,nonce:this.nonce}),this.preparedMessage}constructor(a,b,c,d=!1,e){this._meta={disableSignup:!1},this.getNonceOnce=new Cc(this._getNonceOnce.bind(this)),this.wallet=b,this.captchaToken=c,this.client=a,this._meta.disableSignup=d,this.preparedMessage=e?.message,this.signature=e?.signature,this.walletClientType=e?.walletClientType,this.connectorType=e?.connectorType}}class Cp{get meta(){return{connectorType:this.wallet.connectorType,walletClientType:this.wallet.walletClientType,disableSignup:this._meta.disableSignup,messageType:this._meta.messageType,address:this.wallet?.address}}set messageType(a){this._meta.messageType=a}async authenticate(){if(!this.client)throw new cy.a("SiwsFlow has no client instance");try{let{message:a,signature:b}=await this.sign();return await this.client.authenticateWithSiwsInternal({message:a,signature:b,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up",messageType:this.meta.messageType})}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.client)throw new cy.a("SiwsFlow has no client instance");try{let{message:a,signature:b}=await this.sign();return await this.client.linkWithSiwsInternal({message:a,signature:b,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,messageType:this.meta.messageType})}catch(a){throw(0,cy.f)(a)}}async sign(){let a,b;if(!this.client)throw new cy.a("SiwsFlow has no client instance");await this.buildMessage();let c="transaction"===this.meta.messageType;if(!this.preparedMessage)throw new cy.a("Could not prepare SIWS message");if(!c&&!this.wallet.provider.signMessage||c&&!this.wallet.provider.signTransaction)throw new cy.a("Wallet does not support the necessary signing methods");if(c&&this._plugin){let c=await this.wallet.provider.signTransaction({transaction:fE.base64.decode(this.preparedMessage)});a=fE.base64.encode(c.signedTransaction),b=this._plugin.getSignatureFromTransaction(c.signedTransaction,this.wallet.address)}else{a=this.preparedMessage;let c=await this.wallet.provider.signMessage({message:(new TextEncoder).encode(this.preparedMessage)});b=fE.base64.encode(c.signature)}return{message:a,signature:b}}async _getNonceOnce(){if(!this.client)throw new cy.a("SiwsFlow has no client instance");return await this.client.generateSiwsNonce({address:this.wallet.address,captchaToken:this.captchaToken})}async buildMessage(){if(!this.client)throw new cy.a("SiwsFlow has no client instance");let a=this.wallet.address;return this.nonce||(this.nonce=await this.getNonceOnce.execute()),"transaction"===this.meta.messageType&&this._plugin?this.preparedMessage=this._plugin.createSiwsMemoTransaction({address:a,nonce:this.nonce}):this.preparedMessage=(0,fF.p)({address:a,nonce:this.nonce}),this.preparedMessage}constructor(a,b,c,d=!1,e="plain",f){this._meta={disableSignup:!1,messageType:"plain"},this.getNonceOnce=new Cc(this._getNonceOnce.bind(this)),this.wallet=a,this.captchaToken=c,this.client=b,this._meta.disableSignup=d,this._meta.messageType=e,this._plugin=f}}class Cq{async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode)throw new cy.a("phone number and sms code must be set prior to calling authenticate.");try{return await this.api.post(e9,{phoneNumber:this.meta.phoneNumber,code:this.meta.smsCode,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode)throw new cy.a("phone number and sms code must be set prior to calling authenticate.");try{return await this.api.post(e7,{phoneNumber:this.meta.phoneNumber,code:this.meta.smsCode})}catch(a){throw(0,cy.f)(a)}}async sendSmsCode({phoneNumber:a,captchaToken:b,withPrivyUi:c}){if(!this.api)throw new cy.a("Auth flow has no API instance");if(a&&(this.meta.phoneNumber=a),b&&(this.meta.captchaToken=b),!this.meta.phoneNumber)throw new cy.a("phone nNumber must be set when initialzing authentication.");let d=B2(c);try{return await this.api.post(e6,{phoneNumber:this.meta.phoneNumber,token:this.meta.captchaToken},{headers:{...d}})}catch(a){throw(0,cy.f)(a)}}constructor({phoneNumber:a,captchaToken:b,disableSignup:c}){this.meta={phoneNumber:a,captchaToken:b,disableSignup:c??!1}}}class Cr extends Cq{async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");if(!this.meta.phoneNumber||!this.meta.smsCode||!this.meta.oldPhoneNumber)throw new cy.a("Phone number, sms code, and an old phone number must be set prior to calling update.");try{return await this.api.post(fa,{old_phone_number:this.meta.oldPhoneNumber,new_phone_number:this.meta.phoneNumber,code:this.meta.smsCode})}catch(a){throw(0,cy.f)(a)}}constructor(a,b,c){super({phoneNumber:b,captchaToken:c}),this.meta={phoneNumber:b,captchaToken:c,oldPhoneNumber:a,disableSignup:!1}}}let Cs=(0,U.createContext)({enabled:!1,siteKey:"",provider:void 0,appId:void 0,token:void 0,error:void 0,status:"disabled",setToken:cy.n,setError:cy.n,setExecuting:cy.n,waitForResult:()=>Promise.resolve(""),ref:{current:null},remove:cy.d,reset:cy.n,execute:cy.n});class Ct extends cy.c{constructor(a,b,c){super(a||"Captcha failed"),this.type="Captcha",b instanceof Error&&(this.cause=b),this.privyErrorCode=c}}let Cu=({children:a,appId:b,captchaSiteKey:c,captchaEnabled:d,captchaProvider:e})=>{let f=(0,U.useRef)(null),g=(0,U.useRef)(null),[h,i]=(0,U.useState)(),[j,k]=(0,U.useState)(),[l,m]=(0,U.useState)(!1),o=(0,U.useMemo)(()=>d?l||h||j?!l||h||j?h&&!j?{status:"success",token:h}:j?{status:"error",error:j}:{status:"ready"}:{status:"loading"}:{status:"ready"}:{status:"disabled"},[d,h,j,l]),p=(0,U.useMemo)(()=>d&&e?"turnstile"===e?{remove:()=>{f.current?.remove(),m(!1),k(void 0),i(void 0)},reset:()=>{f.current?.reset(),m(!1),k(void 0),i(void 0)},execute:()=>{m(!0),f.current?.execute()},waitForResult:async()=>{try{return await (0,cw.p)(()=>f.current?.getResponse(),{interval:200,timeout:2e4})}catch(a){throw new Ct("Captcha failed",null,cy.b.CAPTCHA_TIMEOUT)}}}:{remove:()=>{g.current?.removeCaptcha(),m(!1),k(void 0),i(void 0)},reset:()=>{g.current?.resetCaptcha(),m(!1),k(void 0),i(void 0)},execute:()=>{m(!0),g.current?.execute()},waitForResult:async()=>{try{return await (0,cw.p)(()=>g.current?.getResponse(),{interval:200,timeout:2e4})}catch(a){throw new Ct("Captcha failed",null,cy.b.CAPTCHA_TIMEOUT)}}}:null,[d,e]),q=(0,U.useMemo)(()=>{if(!d||!e||!p)return{...o,enabled:!1,siteKey:"",appId:b,setToken:cy.n,setError:cy.n,setExecuting:cy.n,waitForResult:()=>Promise.resolve(void 0),remove:cy.d,reset:cy.n,execute:cy.n,provider:void 0,ref:{current:null}};let a={...o,enabled:!0,appId:b,setToken:i,setError:k,setExecuting:m};return"turnstile"===e?{...a,provider:"turnstile",ref:f,siteKey:c.split("t:")[1]??"",...p}:{...a,provider:"hcaptcha",ref:g,siteKey:c.split("h:")[1]??"",...p}},[o,d,e,p,b,c]);return(0,T.jsx)(Cs.Provider,{value:q,children:a})},Cv=()=>(0,U.useContext)(Cs);class Cw{async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(fn,{captcha_token:this.meta.captchaToken,telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData,mode:this.meta.disableSignup?"no-signup":"login-or-sign-up"})}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(fo,{telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData})}catch(a){throw(0,cy.f)(a)}}constructor(a,b=!1){this.meta={disableSignup:!1},this.meta={captchaToken:a,disableSignup:!1},this.meta.disableSignup=b}}function Cx(a){let b={detail:"",retryable:!1};return a?.privyErrorCode===cy.b.LINKED_TO_ANOTHER_USER&&(b.detail="This account has already been linked to another user."),a?.privyErrorCode===cy.b.DISALLOWED_LOGIN_METHOD&&(b.detail="Login with Telegram not allowed."),a?.privyErrorCode===cy.b.INVALID_DATA&&(b.retryable=!0,b.detail="Something went wrong. Try again."),a?.privyErrorCode===cy.b.CANNOT_LINK_MORE_OF_TYPE&&(b.retryable=!0,b.detail="Something went wrong. Try again."),a?.privyErrorCode===cy.b.INVALID_CREDENTIALS&&(b.retryable=!0,b.detail="Something went wrong. Try again."),a?.privyErrorCode===cy.b.TOO_MANY_REQUESTS&&(b.detail="Too many requests. Please wait before trying again."),a?.privyErrorCode===cy.b.TOO_MANY_REQUESTS&&a.message.includes("rate limit")&&(b.detail="Request limit reached for Telegram. Please wait a moment and try again."),a instanceof Ct&&(b.retryable=!0,b.detail="Something went wrong. Try again."),b}function Cy(a){return Object.fromEntries(decodeURIComponent(a).split("&").map(a=>a.split("=").map(decodeURIComponent)))}function Cz(){let a=new URL(window.location.href);a.searchParams.delete("id"),a.searchParams.delete("hash"),a.searchParams.delete("auth_date"),a.searchParams.delete("first_name"),a.searchParams.delete("last_name"),a.searchParams.delete("username"),a.searchParams.delete("photo_url"),a.hash="",window.history.replaceState({},"",a)}let CA=(0,U.lazy)(()=>a.A(754945)),CB=(0,U.lazy)(()=>a.A(468956)),CC=a=>{let b=Cv();return(0,U.useEffect)(()=>b.remove,[b.remove]),b.enabled&&b.provider?(0,T.jsx)(U.Suspense,{fallback:null,children:(0,T.jsxs)("div",{className:"hidden h-0 w-0",children:["turnstile"===b.provider&&(0,T.jsx)(CA,{...a,captchaContext:b}),"hcaptcha"===b.provider&&(0,T.jsx)(CB,{...a,captchaContext:b})]})}):null};var CD=Object.freeze({__proto__:null,AccountNotFoundScreen:()=>a.A(253731),AffirmativeConsentScreen:()=>a.A(930467),AllowlistRejectionScreen:()=>a.A(959835),AuthenticateWithWalletScreen:()=>a.A(361063),AwaitingEvmToSolBridgingScreen:()=>a.A(813195),AwaitingExternalEthereumTransferScreen:()=>a.A(607279),AwaitingPasswordlessCodeScreen:()=>a.A(801281),AwaitingSolToEvmBridgingScreen:()=>a.A(927547),CaptchaScreen:()=>a.A(552073),CoinbaseOnrampStatusScreen:()=>a.A(470049),ConnectLedgerScreen:()=>a.A(600715),ConnectOnlyLandingScreen:()=>a.A(125065),ConnectOnlyStatusScreen:()=>a.A(515519),ConnectOrCreateScreen:()=>a.A(655218),ConnectionStatusScreen:()=>a.A(343132),CrossAppAuthScreen:()=>a.A(761163),DelegatedActionsConsentScreen:()=>a.A(414402),DelegatedActionsRevokeScreen:()=>a.A(140029),EmbeddedWalletConnectingScreen:()=>a.A(340594),EmbeddedWalletCreatedScreen:()=>a.A(775618),EmbeddedWalletKeyExportScreen:()=>a.A(646066),EmbeddedWalletOnAccountCreateScreen:()=>a.A(253940),EmbeddedWalletPasswordCreateScreen:()=>a.A(802109),EmbeddedWalletPasswordUpdateScreen:()=>a.A(754504),EmbeddedWalletPasswordUpdateSplashScreen:()=>a.A(104210),ErrorScreen:()=>a.A(987876),FarcasterConnectStatusScreen:()=>a.A(770299),FarcasterSignerStatusScreen:()=>a.A(730767),FundSolWalletWithExternalSolanaWallet:()=>a.A(117812),FundingAmountEditScreen:()=>a.A(344740),FundingMethodSelectionScreen:()=>a.A(989356),InAppBrowserLoginNotPossible:()=>a.A(266844),InstallWalletScreen:()=>a.A(808654),LandingScreen:()=>a.A(517310),LinkConflictScreen:()=>a.A(740130),LinkEmailScreen:()=>a.A(735567),LinkPasskeyScreen:()=>a.A(698454),LinkPhoneScreen:()=>a.A(149880),LoginFailedScreen:()=>a.A(210074),ManualTransferScreen:()=>a.A(738578),MfaAuthEnrollmentFlowScreen:()=>a.A(498094),MfaAuthVerifyFlowScreen:()=>a.A(644825),MfaEnrollmentFlowScreen:()=>a.A(622094),MoonpayStatusScreen:()=>a.A(804901),OAuthStatusScreen:()=>a.A(177799),PasskeySelectSignupOrLogin:()=>a.A(662814),PasskeyStatusScreen:()=>a.A(753954),PasswordRecoveryScreen:()=>a.A(842881),RecoveryOAuthScreen:()=>a.A(785328),RecoverySelectionScreen:()=>a.A(475086),SendTransactionScreen:()=>a.A(839977),SetAutomaticRecoveryScreen:()=>a.A(513740),SignRequestScreen:()=>a.A(847191),StandardSignAndSendTransactionScreen:()=>a.A(619351),TelegramAuthScreen:()=>a.A(263018),TransferFromWalletScreen:()=>a.A(835182),UpdateEmailScreen:()=>a.A(829680),UpdatePhoneScreen:()=>a.A(218881),UserLimitReachedScreen:()=>a.A(956112),WalletInterstitialScreen:()=>a.A(338134)});let CE=(0,fI.create)(()=>({inProgressMfaFlow:void 0})),CF=(0,fG.createGlobalStyle)([":root{","};"],a=>CG(a.palette)),CG=a=>(0,fG.css)(["",""],Object.entries({"--privy-color-background":a.background,"--privy-color-background-2":a.background2,"--privy-color-background-3":a.background3,"--privy-color-foreground":a.foreground,"--privy-color-foreground-2":a.foreground2,"--privy-color-foreground-3":a.foreground3,"--privy-color-foreground-4":a.foreground4,"--privy-color-foreground-accent":a.foregroundAccent,"--privy-color-accent":a.accent,"--privy-color-accent-light":a.accentLight,"--privy-color-accent-hover":a.accentHover,"--privy-color-accent-dark":a.accentDark,"--privy-color-accent-darkest":a.accentDarkest,"--privy-color-success":a.success,"--privy-color-success-dark":a.successDark,"--privy-color-success-light":a.successLight,"--privy-color-success-bg":a.successBg,"--privy-color-error":a.error,"--privy-color-error-light":a.errorLight,"--privy-color-error-bg":a.errorBg,"--privy-color-error-bg-hover":a.errorBgHover,"--privy-color-warn":a.warn,"--privy-color-warn-light":a.warnLight,"--privy-color-warn-bg":a.warnBg,"--privy-color-warning-dark":a.warningDark,"--privy-color-error-dark":a.errorDark,"--privy-color-info-bg":a.infoBg,"--privy-color-info-bg-hover":a.infoBgHover,"--privy-color-border-default":a.borderDefault,"--privy-color-border-hover":a.borderHover,"--privy-color-border-focus":a.borderFocus,"--privy-color-border-error":a.borderError,"--privy-color-border-success":a.borderSuccess,"--privy-color-border-warning":a.borderWarning,"--privy-color-border-info":a.borderInfo,"--privy-color-border-interactive":a.borderInteractive,"--privy-color-border-interactive-hover":a.borderInteractiveHover,"--privy-color-background-hover":a.backgroundHover,"--privy-color-background-clicked":a.backgroundClicked,"--privy-color-background-disabled":a.backgroundDisabled,"--privy-color-background-interactive":a.backgroundInteractive,"--privy-color-background-interactive-hover":a.backgroundInteractiveHover,"--privy-color-background-interactive-clicked":a.backgroundInteractiveClicked,"--privy-color-background-interactive-disabled":a.backgroundInteractiveDisabled,"--privy-color-foreground-hover":a.foregroundHover,"--privy-color-foreground-clicked":a.foregroundClicked,"--privy-color-foreground-disabled":a.foregroundDisabled,"--privy-color-foreground-interactive":a.foregroundInteractive,"--privy-color-foreground-interactive-hover":a.foregroundInteractiveHover,"--privy-link-navigation-color":a.linkNavigationColor,"--privy-link-navigation-decoration":a.linkNavigationDecoration,"--privy-accent-has-good-contrast":a.accentHasGoodContrast,"--privy-color-icon-default":a.iconDefault,"--privy-color-icon-muted":a.iconMuted,"--privy-color-icon-subtle":a.iconSubtle,"--privy-color-icon-inverse":a.iconInverse,"--privy-color-icon-success":a.iconSuccess,"--privy-color-icon-warning":a.iconWarning,"--privy-color-icon-error":a.iconError,"--privy-color-icon-interactive":a.iconInteractive,"--privy-color-icon-default-hover":a.iconDefaultHover,"--privy-color-icon-muted-hover":a.iconMutedHover,"--privy-color-icon-subtle-hover":a.iconSubtleHover,"--privy-color-icon-default-clicked":a.iconDefaultClicked,"--privy-color-icon-muted-clicked":a.iconMutedClicked,"--privy-color-icon-subtle-clicked":a.iconSubtleClicked,"--privy-color-icon-default-disabled":a.iconDefaultDisabled,"--privy-color-icon-muted-disabled":a.iconMutedDisabled,"--privy-color-icon-subtle-disabled":a.iconSubtleDisabled,"--privy-color-icon-error-hover":a.iconErrorHover,"--privy-color-icon-interactive-hover":a.iconInteractiveHover,"--privy-color-icon-error-clicked":a.iconErrorClicked,"--privy-color-icon-interactive-clicked":a.iconInteractiveClicked,"--privy-color-icon-muted-disabled-alt":a.iconMutedDisabledAlt,"--privy-color-icon-subtle-disabled-alt":a.iconSubtleDisabledAlt,"--privy-border-radius-xs":"6px","--privy-border-radius-sm":"8px","--privy-border-radius-md":"12px","--privy-border-radius-mdlg":"16px","--privy-border-radius-lg":"24px","--privy-border-radius-full":"9999px","--privy-height-modal-full":"620px","--privy-height-modal-compact":"480px"}).map(([a,b])=>`${a}: ${b};`).join("\n")),CH=fG.styled.div.withConfig({displayName:"StylesWrapper",componentId:"sc-188229e4-0"})([""," color:var(--privy-color-foreground-2);h3{font-size:16px;line-height:24px;font-weight:500;color:var(--privy-color-foreground-2);}h4{font-size:14px;line-height:20px;font-weight:500;color:var(--privy-color-foreground);}p{font-size:13px;line-height:20px;color:var(--privy-color-foreground-2);}button:focus,input:focus,optgroup:focus,select:focus,textarea:focus{outline:none;border-color:var(--privy-color-accent-light);box-shadow:0 0 0 3px var(--privy-color-border-focus);}.mobile-only{@media (min-width:441px){display:none;}}@keyframes fadein{0%{opacity:0;}100%{opacity:1;}}"],"\n  *,\n  ::before,\n  ::after {\n    box-sizing: border-box;\n    border-width: 0;\n    border-style: solid;\n  }\n\n  line-height: 1.15;\n  -webkit-text-size-adjust: 100%;\n  -moz-tab-size: 4;\n  tab-size: 4;\n  font-feature-settings: normal;\n\n  margin: 0;\n  font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji';\n\n  hr {\n    height: 0;\n    color: inherit;\n    border-top-width: 1px;\n  }\n\n  abbr:where([title]) {\n    text-decoration: underline dotted;\n  }\n\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    font-size: inherit;\n    font-weight: inherit;\n    font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji';\n    display: inline;\n  }\n\n  a {\n    color: inherit;\n    text-decoration: inherit;\n  }\n\n  b,\n  strong {\n    font-weight: bolder;\n  }\n\n  code,\n  kbd,\n  samp,\n  pre {\n    font-family: ui-monospace, SFMono-Regular, Consolas, 'Liberation Mono', Menlo, monospace;\n    font-size: 1em;\n  }\n\n  small {\n    font-size: 80%;\n  }\n\n  sub,\n  sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline;\n  }\n\n  sub {\n    bottom: -0.25em;\n  }\n\n  sup {\n    top: -0.5em;\n  }\n\n  table {\n    text-indent: 0;\n    border-color: inherit;\n    border-collapse: collapse;\n  }\n\n  button,\n  input,\n  optgroup,\n  select,\n  textarea {\n    font-family: inherit;\n    font-size: 100%;\n    font-weight: inherit;\n    line-height: inherit;\n    color: inherit;\n    margin: 0;\n    padding: 0;\n  }\n\n  button,\n  select {\n    text-transform: none;\n  }\n\n  button,\n  [type='button'],\n  [type='reset'],\n  [type='submit'] {\n    -webkit-appearance: button;\n    background-color: transparent;\n    background-image: none;\n  }\n\n  ::-moz-focus-inner {\n    border-style: none;\n    padding: 0;\n  }\n\n  :-moz-focusring {\n    outline: 1px dotted ButtonText;\n  }\n\n  :-moz-ui-invalid {\n    box-shadow: none;\n  }\n\n  legend {\n    padding: 0;\n  }\n\n  progress {\n    vertical-align: baseline;\n  }\n\n  ::-webkit-inner-spin-button,\n  ::-webkit-outer-spin-button {\n    height: auto;\n  }\n\n  [type='search'] {\n    -webkit-appearance: textfield;\n    outline-offset: -2px;\n  }\n\n  ::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n\n  ::-webkit-file-upload-button {\n    -webkit-appearance: button;\n    font: inherit;\n  }\n\n  summary {\n    display: list-item;\n  }\n\n  blockquote,\n  dl,\n  dd,\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6,\n  hr,\n  figure,\n  p,\n  pre {\n    margin: 0;\n  }\n\n  fieldset {\n    margin: 0;\n    padding: 0;\n  }\n\n  legend {\n    padding: 0;\n  }\n\n  ol,\n  ul,\n  menu {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n\n  textarea {\n    resize: vertical;\n  }\n\n  input::placeholder,\n  textarea::placeholder {\n    opacity: 1;\n    color: #9ca3af;\n  }\n\n  button,\n  [role='button'] {\n    cursor: pointer;\n  }\n\n  :disabled {\n    cursor: default;\n  }\n\n  img,\n  svg,\n  video,\n  canvas,\n  audio,\n  iframe,\n  embed,\n  object {\n    display: block;\n  }\n\n  img,\n  video {\n    max-width: 100%;\n    height: auto;\n  }\n\n  [hidden] {\n    display: none;\n  }\n"),CI=({children:a,open:b,onClick:c,...d})=>(0,T.jsx)(gr,{show:b,as:U.default.Fragment,children:(0,T.jsxs)(ia,{onClose:c,...d,as:CK,children:[(0,T.jsx)(gq,{as:U.default.Fragment,enterFrom:"entering",leaveTo:"leaving",children:(0,T.jsx)(CJ,{id:"privy-dialog-backdrop","aria-hidden":"true"})}),(0,T.jsx)(CL,{children:(0,T.jsx)(gq,{as:U.default.Fragment,enterFrom:"entering",leaveTo:"leaving",children:(0,T.jsx)(h9,{as:CM,children:a})})})]})}),CJ=fG.styled.div.withConfig({displayName:"Backdrop",componentId:"sc-3cfde0b5-0"})(["position:fixed;inset:0;transition:backdrop-filter 100ms ease;backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);&.entering,&.leaving{backdrop-filter:unset;-webkit-backdrop-filter:unset;}"]),CK=fG.styled.div.withConfig({displayName:"DialogWrapper",componentId:"sc-3cfde0b5-1"})(["position:relative;z-index:999999;"]),CL=fG.styled.div.withConfig({displayName:"DialogContainer",componentId:"sc-3cfde0b5-2"})(["position:fixed;inset:0;display:flex;align-items:center;justify-content:center;width:100vw;min-height:100vh;"]),CM=fG.styled.div.withConfig({displayName:"Panel",componentId:"sc-3cfde0b5-3"})(["padding:0;background:transparent;border:none;width:100%;pointer-events:auto;outline:none;display:block;@media (max-width:440px){opacity:1;transform:translate3d(0,0,0);transition:transform 200ms ease-in;position:fixed;bottom:0;&.entering,&.leaving{opacity:0;transform:translate3d(0,100%,0);transition:transform 150ms ease-in 0ms,opacity 0ms ease 150ms;}}@media (min-width:441px){opacity:1;transition:opacity 100ms ease-in;&.entering,&.leaving{opacity:0;transition-delay:5ms;}margin:auto;width:360px;box-shadow:0px 8px 36px rgba(55,65,81,0.15);border-radius:var(--privy-border-radius-lg);}"]),CN=(0,U.lazy)(()=>a.A(368581)),CO=(0,U.lazy)(()=>CD.MfaAuthVerifyFlowScreen().then(a=>({default:a.default.component}))),CP=()=>(0,T.jsx)(CV,{children:(0,T.jsx)(cw.L,{})}),CQ=()=>{let{currentScreen:a}=(0,cu.a)(),b=CE(a=>a.inProgressMfaFlow),c=()=>CE.setState({inProgressMfaFlow:void 0}),{component:d,isLoading:e}=(()=>{let{ready:a}=(0,cu.u)(),{currentScreen:b}=(0,cu.a)(),[c,d]=(0,U.useState)(null),[e,f]=(0,U.useState)(!1),g=function(a){let[b,c]=(0,U.useState)(!1),d=(0,U.useRef)(null),e=(0,U.useRef)(null),f=(0,U.useRef)(null);return(0,U.useEffect)(()=>{if(d.current&&(clearTimeout(d.current),d.current=null),e.current&&(clearTimeout(e.current),e.current=null),a)f.current=Date.now(),d.current=setTimeout(()=>{c(!0)},150);else if(null!==f.current){let a=Date.now()-f.current;a>=150?e.current=setTimeout(()=>{c(!1),f.current=null},Math.max(0,400-(a-150))):(d.current&&(clearTimeout(d.current),d.current=null),c(!1),f.current=null)}return()=>{d.current&&clearTimeout(d.current),e.current&&clearTimeout(e.current)}},[a]),b}(e);return(0,U.useEffect)(()=>{b?(f(!0),CD[b]().then(c=>{(!b||a||c.default.isShownBeforeReady)&&(d(()=>c.default.component),f(!1))}).catch(()=>{d(null),f(!1)})):(d(null),f(!1))},[b,a]),{component:c,isLoading:g}})();return function(){let{isModalOpen:a}=(0,cu.u)(),{headless:b}=(0,eB.u)(),{currentScreen:c}=(0,cu.a)(),{status:d,execute:e,reset:f,enabled:g}=Cv(),[h,i]=(0,U.useState)(!1);(0,U.useEffect)(()=>{!a&&g&&f()},[a,g,f]),(0,U.useEffect)(()=>{c?CD[c]().then(a=>{i(!!a.default.isCaptchaRequired)}).catch(()=>{i(!1)}):i(!1)},[c]),(0,U.useEffect)(()=>{a&&h&&!b&&"ready"===d&&g&&e()},[a,h,b,d,g,e])}(),a||"txn"!==b?e?(0,T.jsx)(CP,{}):d?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(cw.H,{$if:!!b,children:(0,T.jsx)(d,{})}),(0,T.jsxs)(U.Suspense,{children:["txn"===b&&(0,T.jsx)(CN,{onClose:c}),"auth"===b&&(0,T.jsx)(CO,{})]})]}):null:(0,T.jsx)(CN,{onClose:c})},CR=()=>{let a=(0,U.useRef)(null);return(0,T.jsx)(CU,{style:{height:(0,cw.u)(a)},id:"privy-modal-content",children:(0,T.jsx)("div",{ref:a,children:(0,T.jsx)(CQ,{})})})},CS=({open:a})=>{var b;let c=(0,eB.u)(),{gracefulClosePrivyModal:d}=(()=>{let{closePrivyModal:a}=(0,cy.u)(),{onUserCloseViaDialogOrKeybindRef:b}=(0,cu.a)();return{gracefulClosePrivyModal:(0,U.useCallback)(()=>{if(!b?.current)return a({shouldCallAuthOnSuccess:!1});b.current()},[a])}})(),e=CE(a=>a.inProgressMfaFlow);return b={onMfaRequired:()=>{c.mfa.noPromptOnMfaRequired||CE.setState({inProgressMfaFlow:"txn"})}},(0,fH.u)("configureMfa",b),c.render.standalone?(0,T.jsx)(CH,{children:(0,T.jsx)(CT,{id:"privy-modal-content",children:(0,T.jsx)(CQ,{})})}):(0,T.jsx)(CI,{open:!(!a&&!e),id:"privy-dialog","aria-label":"log in or sign up","aria-labelledby":"privy-dialog-title",onClick:()=>d(),children:(0,T.jsx)(CH,{children:(0,T.jsx)(CR,{})})})},CT=fG.styled.div.withConfig({displayName:"ContentWrapper",componentId:"sc-4759f1d5-0"})(["display:flex;flex-direction:column;text-align:center;font-size:14px;line-height:20px;width:100%;background:var(--privy-color-background);padding:0 16px;"]),CU=(0,fG.styled)(CT).withConfig({displayName:"BaseModal",componentId:"sc-4759f1d5-1"})(["transition:height 150ms ease-out;overflow-x:hidden;overflow-y:auto;scrollbar-width:none;max-height:calc(100svh - 32px);border-radius:var(--privy-border-radius-lg) var(--privy-border-radius-lg) 0 0;box-shadow:0px 0px 36px rgba(55,65,81,0.15);@media (min-width:441px){box-shadow:0px 8px 36px rgba(55,65,81,0.15);border-radius:var(--privy-border-radius-lg);}"]),CV=fG.styled.div.withConfig({displayName:"LoadingScreenContainer",componentId:"sc-4759f1d5-2"})(["display:flex;align-items:center;justify-content:center;min-height:300px;padding:2rem;"]);function CW(a){let b=(0,U.useRef)(null),c=(0,U.useRef)();return(0,U.useEffect)(()=>{c.current?.remove(),c.current=function({botUsername:a,scriptHost:b}){let c=document.createElement("script"),{origin:d}=new URL(b);return c.async=!0,c.src=`${d}/js/telegram-login.js`,c.setAttribute("data-telegram-login",a),c.setAttribute("data-request-access","write"),c.setAttribute("data-lang","en"),c}(a),b.current?.after(c.current)},[a]),(0,T.jsx)("div",{ref:b,hidden:!0})}let CX=()=>{let{ready:a}=(0,cx.u)(),{client:b}=(0,cy.u)();return(0,U.useEffect)(()=>{let c=()=>{if(!b.connectors||!a)return;let c=b.connectors.wallets.map(a=>({address:a.address,connectorType:a.connectorType,walletClientType:a.walletClientType,connectedAt:a.connectedAt,id:a.meta.id}));cz.u.put(eB.b,c)};return b.connectors?.on("walletsUpdated",c),()=>{b.connectors?.off("walletsUpdated",c)}},[a,b.connectors]),null};class CY extends cw.E{async initialize(){let a=await this.createProvider();this.provider=a,this.proxyProvider.setWalletProvider(a),this.subscribeListeners(),a.session&&(this.walletProvider?.session?.peer.metadata.url&&(this.walletEntry=(0,cw.g)(this.walletProvider?.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown"),this.connected=!0,await this.syncAccounts()),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),this.getConnectedWallet()}async isConnected(){return!!this.walletProvider?.connected}get walletBranding(){let a=this.walletProvider?.session?.peer.metadata.icons?.[0];return{name:(0,cw.s)(this.walletProvider?.session?.peer.metadata.name||"")||"WalletConnect",icon:"string"==typeof a?a:cz.W,id:this.walletProvider?.session?.peer.metadata.name.toLowerCase()||"wallet_connect_v2"}}async resetConnection(a){this.walletProvider&&this.walletProvider.connected&&(await this.walletProvider.disconnect(),this.walletProvider.signer.session=void 0,this.walletClientType=a,this.redirectUri=void 0,this.fallbackUniversalRedirectUri=void 0,function(){try{localStorage.removeItem(B7)}catch{}}(),this.onDisconnect())}async promptConnection(){if(this.provider)return new Promise((a,b)=>{(async()=>{let b="",c=await Promise.race([this.walletProvider?.enable(),this.proxyProvider.walletTimeout()]);if(c?.length&&(b=c[0]),!b||""===b)throw new cy.P("Unable to retrieve address");this.walletProvider?.session?.peer.metadata.url&&(this.walletEntry=(0,cw.g)(this.walletProvider?.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown",this.proxyProvider.rpcTimeoutDuration=(0,cw.c)(this.rpcConfig,this.walletClientType)),this.connected=!0,await this.syncAccounts(c),a()})().catch(a=>{b(a?(0,cz.f)(a):new cy.P("Unknown error during connection"))})})}disconnect(){this.walletProvider?.disconnect().then(()=>this.onDisconnect()).catch(()=>console.warn("Unable to disconnect WalletConnect provider"))}get walletProvider(){return this.proxyProvider.walletProvider}setWalletProvider(a){this.proxyProvider.setWalletProvider(a)}async createProvider(){let a={};for(let b of this.chains){let c=(0,cw.a)(b.id,this.chains,this.rpcConfig,this.privyAppId);c&&(a[b.id]=c)}let b=this.shouldEnforceDefaultChainOnConnect?[this.defaultChain.id]:[],c=this.chains.map(a=>a.id),d=await wC.init({projectId:this.walletConnectCloudProjectId,chains:b,optionalChains:c,optionalEvents:wp,optionalMethods:wn,rpcMap:a,showQrModal:!1,metadata:{description:this.privyAppName,name:this.privyAppName,url:window.location.origin,icons:[]}});return d.on("display_uri",a=>{if(d.signer.abortPairingAttempt(),function(){try{localStorage.removeItem(B7)}catch{}}(),!this.showPrivyQrModal)throw new cy.P("WalletConnect modal not available - Privy handles wallet connections through its own UI");if(eC.isMobile&&this.walletEntry){let{redirect:b,href:c}=function(a,b){let c=B5(b);if(c.deepLink)return B9(c.deepLink,a);if(c.universalLink)return Ca(c.universalLink,a);throw new cy.a(`Unsupported wallet ${b.id}`)}(a,this.walletEntry);Cb(b,"_self"),function({href:a,name:b}){try{localStorage.setItem(B7,JSON.stringify({href:a,name:b}))}catch{}}({href:c,name:this.walletEntry.metadata?.shortName||this.walletEntry.name});let d=B6(a,this.walletEntry);return this.redirectUri=b,this.fallbackUniversalRedirectUri=d?.redirect,this.showPrivyQrModal({native:b,universal:b})}if(this.redirectUri=void 0,this.walletEntry){let b=B6(a,this.walletEntry);this.fallbackUniversalRedirectUri=b?.redirect}this.showPrivyQrModal({native:a,universal:void 0})}),d.on("connect",()=>{d.session?.peer.metadata.url&&(this.walletEntry=(0,cw.g)(d.session?.peer.metadata.url),this.walletClientType=this.walletEntry?.slug||"unknown")}),d}async enableProvider(){return this.walletProvider?.connected?Promise.resolve(this.walletProvider.accounts):await this.walletProvider?.enable()}setWalletEntry(a,b){this.walletEntry=a,this.showPrivyQrModal=b}constructor({walletConnectCloudProjectId:a,rpcConfig:b,chains:c,defaultChain:d,shouldEnforceDefaultChainOnConnect:e,privyAppId:f,privyAppName:g,walletClientType:h}){super(h||"unknown",c,d,b),this.connectorType="wallet_connect_v2",this.privyAppId=f,this.privyAppName=g,this.walletConnectCloudProjectId=a,this.rpcConfig=b,this.shouldEnforceDefaultChainOnConnect=e,this.proxyProvider=new cw.P(void 0,this.rpcTimeoutDuration),h&&(this.walletEntry=(0,cw.b)(h),this.walletClientType=h)}}let CZ=["error","invalid_request_arguments","wallet_not_on_device","invalid_recovery_pin","insufficient_funds","missing_or_invalid_mfa","mfa_verification_max_attempts_reached","mfa_timeout","twilio_verification_failed"];class C$ extends Error{constructor(a,b){super(b),this.type=a}}function C_(a){let b=a.type;return"string"==typeof b&&CZ.includes(b)}function C0(a){return C_(a)&&"wallet_not_on_device"===a.type}function C1(a){return C_(a)&&("invalid_recovery_pin"===a.type||"invalid_request_arguments"===a.type)}function C2(a){return!!C_(a)&&"mfa_timeout"===a.type}function C3(a){return!!C_(a)&&"missing_or_invalid_mfa"===a.type}function C4(a){return!!C_(a)&&"mfa_verification_max_attempts_reached"===a.type}function C5(a){return!(!C_(a)||!a.message.includes("code 429"))}function C6(a){let b;return"string"==typeof(b=a.type)&&"client_error"===b&&"MFA canceled"===a.message}async function C7(a,b,c,d,e,f=!1){let g=f,h=async h=>{if(g&&b&&b.length>0){h===+!f?e("configureMfa","onMfaRequired",{mfaMethods:b}):d.current?.reject(new C$("missing_or_invalid_mfa","MFA verification failed, retry."));let g=await new Promise((a,b)=>{c.current={resolve:a,reject:b},setTimeout(()=>{let a=new C$("mfa_timeout","Timed out waiting for MFA code");d.current?.reject(a),b(a)},3e5)});return await a(g)}return await a()},i=null;for(let a=0;a<4;a++)try{i=await h(a),d.current?.resolve(void 0);break}catch(a){if("missing_or_invalid_mfa"!==a.type)throw d.current?.resolve(void 0),a;g=!0}if(null===i){let a=new C$("mfa_verification_max_attempts_reached","Max MFA verification attempts reached");throw d.current?.reject(a),a}return i}let C8=(Er=0,()=>"id-"+Er++);function C9(a){return void 0!==a.error}let Da=new class{enqueue(a,b){this.callbacks[a]=b}dequeue(a,b){let c=this.callbacks[b];if(!c)throw Error(`cannot dequeue ${a} event: no event found for id ${b}`);switch(delete this.callbacks[b],a){case"privy:iframe:ready":case"privy:user-signer:sign":case"privy:wallets:add":case"privy:wallets:import":case"privy:wallets:set-recovery":case"privy:wallets:connect":case"privy:wallets:recover":case"privy:wallets:rpc":case"privy:wallet:create":case"privy:mfa:verify":case"privy:mfa:init-enrollment":case"privy:mfa:submit-enrollment":case"privy:mfa:unenroll":case"privy:mfa:clear":case"privy:auth:unlink-passkey":case"privy:farcaster:init-signer":case"privy:farcaster:sign":case"privy:solana-wallet:create":case"privy:delegated-actions:consent":return c;default:throw Error(`invalid wallet event type ${a}`)}}constructor(){this.callbacks={}}},Db=new Map,Dc=(a,b)=>"bigint"==typeof b?b.toString():b;function Dd(a,b,c,d){let e=c.contentWindow;if(!e)throw Error("iframe not initialized");let f=`${a}${JSON.stringify(b,Dc)}`;if("privy:wallet:create"===a){let a=Db.get(f);if(a)return a}let g=new Promise((c,f)=>{let g=C8();Da.enqueue(g,{resolve:c,reject:f}),e.postMessage({id:g,event:a,data:b},d)}).finally(()=>{Db.delete(f)});return Db.set(f,g),g}function De(a){let b=(0,eB.c)(),c=(0,U.useRef)(null),d=(0,U.useRef)(a.mfaMethods),e=(0,fH.a)(),[f,g]=(0,U.useState)(!1);return(0,U.useEffect)(()=>{d.current=a.mfaMethods},[a.mfaMethods]),(0,U.useEffect)(()=>{if(!f)return;let b=c.current;if(!b)return;function g(b){var c;b&&b.origin===a.origin&&"string"==typeof(c=b.data).event&&/^privy:.+/.test(c.event)&&function(a){switch(a.event){case"privy:iframe:ready":let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data);case"privy:user-signer:sign":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:add":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:set-recovery":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:connect":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:recover":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallets:rpc":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:wallet:create":let c=Da.dequeue(a.event,a.id);return C9(a)?c.reject(new C$(a.error.type,a.error.message)):c.resolve(a.data);case"privy:wallets:import":let d=Da.dequeue(a.event,a.id);return C9(a)?d.reject(new C$(a.error.type,a.error.message)):d.resolve(a.data);case"privy:mfa:verify":let e=Da.dequeue(a.event,a.id);return C9(a)?e.reject(new C$(a.error.type,a.error.message)):e.resolve(a.data);case"privy:mfa:init-enrollment":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:mfa:submit-enrollment":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:mfa:unenroll":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:mfa:clear":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:auth:unlink-passkey":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:solana-wallet:create":let f=Da.dequeue(a.event,a.id);return C9(a)?f.reject(new C$(a.error.type,a.error.message)):f.resolve(a.data);case"privy:farcaster:init-signer":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:farcaster:sign":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}case"privy:delegated-actions:consent":{let b=Da.dequeue(a.event,a.id);return C9(a)?b.reject(new C$(a.error.type,a.error.message)):b.resolve(a.data)}default:console.warn("Unsupported wallet proxy method:",a)}}(b.data)}let h={signWithUserSigner:c=>C7(d=>Dd("privy:user-signer:sign",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),addWallet:c=>C7(d=>Dd("privy:wallets:add",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),setRecovery:c=>C7(d=>Dd("privy:wallets:set-recovery",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),connect:c=>C7(d=>Dd("privy:wallets:connect",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),recover:c=>C7(d=>Dd("privy:wallets:recover",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e,!c.recoveryAccessToken&&!c.recoveryPassword&&!c.recoverySecretOverride),rpc:c=>C7(d=>Dd("privy:wallets:rpc",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),create:c=>Dd("privy:wallet:create",c,b,a.origin),importWallet:c=>Dd("privy:wallets:import",c,b,a.origin),createSolana:c=>C7(d=>Dd("privy:solana-wallet:create",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),createDelegatedAction:c=>Dd("privy:delegated-actions:consent",c,b,a.origin),verifyMfa:c=>C7(d=>Dd("privy:mfa:verify",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e,!0),initEnrollMfa:c=>C7(d=>Dd("privy:mfa:init-enrollment",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),submitEnrollMfa:c=>C7(d=>Dd("privy:mfa:submit-enrollment",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),unenrollMfa:c=>C7(d=>Dd("privy:mfa:unenroll",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),clearMfa:c=>Dd("privy:mfa:clear",c,b,a.origin),unlinkPasskeyAccount:c=>C7(d=>Dd("privy:auth:unlink-passkey",{...c,...d},b,a.origin),d.current,a.mfaPromise,a.mfaSubmitPromise,e),initFarcasterSigner:c=>Dd("privy:farcaster:init-signer",c,b,a.origin),signFarcasterMessage:c=>Dd("privy:farcaster:sign",c,b,a.origin)};window.addEventListener("message",g);let i=new AbortController;return(0,cw.i)(()=>Dd("privy:iframe:ready",{},b,a.origin),{abortSignal:i.signal}).then(()=>a.onLoad(h),(...b)=>{console.warn("Privy iframe failed to load: ",...b),a.onLoadFailed()}),()=>{window.removeEventListener("message",g),i.abort()}},[f]),b?(0,T.jsx)("iframe",{ref:c,width:"0",height:"0",style:{display:"none",height:"0px",width:"0px"},onLoad:()=>g(!0),src:(0,wO.constructURL)({origin:a.origin,path:`/apps/${a.appId}/embedded-wallets`,query:{caid:a.clientAnalyticsId,client_id:a.appClientId}})}):null}let Df=a=>a.linkedAccounts.filter(a=>"wallet"===a.type&&"privy"===a.walletClientType&&a.delegated),Dg="popup-privy-oauth",Dh="PRIVY_OAUTH_USE_BROADCAST_CHANNEL";class Di{async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(fd,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:this.meta.codeVerifier,provider:this.meta.provider})}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(fe,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:this.meta.codeVerifier,provider:this.meta.provider})}catch(a){throw(0,cy.f)(a)}}constructor({authorizationCode:a,stateCode:b,codeVerifier:c,provider:d}){this.meta={authorizationCode:a,stateCode:b,codeVerifier:c,provider:d}}}async function Dj({api:a,requesterAppId:b,providerAppId:c}){let d=(await a.get(`/api/v1/apps/${b}/cross-app/connections`)).connections.find(a=>a.provider_app_id===c);if(!d)throw new cy.a("Invalid connected app");return{name:d.provider_app_name,logoUrl:d.provider_app_icon_url||void 0,apiUrl:d.provider_app_custom_api_url,readOnly:d.read_only,customAuthAuthorizeUrl:d.provider_app_custom_auth_authorize_url,customAuthTransactUrl:d.provider_app_custom_auth_transact_url}}let Dk=async({user:a,address:b,client:c,request:d,requesterAppId:e,reconnect:f})=>{c.createAnalyticsEvent({eventName:"cross_app_request_started",payload:{address:b,method:d.method}});let g=a?.linkedAccounts.find(a=>"cross_app"===a.type&&(a.embeddedWallets.some(a=>a.address===b)||a.smartWallets.some(a=>a.address===b)));if(!a||!g)throw c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Cannot request a signature with this wallet address",address:b}}),new cy.a("Cannot request a signature with this wallet address");let h=c.getProviderAccessToken(g.providerApp.id),i=await Dj({api:c.api,requesterAppId:e,providerAppId:g.providerApp.id});if(!h){if(i.readOnly)throw console.error("cannot transact against a read-only provider app"),new cy.a("Cannot transact against a read-only provider app");await f({appId:g.providerApp.id,action:"link"})&&(h=c.getProviderAccessToken(g.providerApp.id))}if(!h)throw c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Transactions require a valid token",address:b}}),new cy.a("Transactions require a valid token");let j=new URL(i.customAuthTransactUrl||`${i.apiUrl}/oauth/transact`);j.searchParams.set("token",h||""),j.searchParams.set("request",Dl(d));let k=(0,eI.trigger)({location:j.href});if(!k)throw c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Missing token",address:b}}),new cy.a("Failed to initialize signature request");return new Promise((a,e)=>{let f=setTimeout(()=>{j(),e(new cy.a("Request timeout")),c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"Request timeout",address:b}})},12e4),h=setInterval(()=>{k.closed&&(j(),e(new cy.a("User rejected request")),c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:"User rejected request",address:b}}))},300),i=f=>{f.data&&("set"===f.data.token?.action&&void 0!==f.data.token?.value?c.storeProviderAccessToken(g.providerApp.id,f.data.token.value):"clear"===f.data.token?.action&&c.storeProviderAccessToken(g.providerApp.id,null),"PRIVY_CROSS_APP_ACTION_RESPONSE"===f.data.type&&f.data.result&&(j(),a(f.data.result),c.createAnalyticsEvent({eventName:"cross_app_request_success",payload:{address:b,method:d.method}})),"PRIVY_CROSS_APP_ACTION_ERROR"===f.data.type&&f.data.error&&(j(),e(f.data.error),c.createAnalyticsEvent({eventName:"cross_app_request_error",payload:{error:f.data.error,address:b}})))};window.addEventListener("message",i);let j=()=>{k.close(),clearInterval(h),clearTimeout(f),window.removeEventListener("message",i)}})},Dl=a=>JSON.stringify({content:{request:{request:Dm(a,eD.toHex)}},timestamp:Date.now(),callbackUrl:window.origin}),Dm=(a,b)=>"bigint"==typeof a?b(a):Array.isArray(a)?a.map(a=>Dm(a,b)):a&&"object"==typeof a?Object.fromEntries(Object.entries(a).map(([a,c])=>[a,Dm(c,b)])):a;function Dn({isCreatingWallet:a,skipSplashScreen:b}){return a?"EmbeddedWalletPasswordCreateScreen":b?"EmbeddedWalletPasswordUpdateScreen":"EmbeddedWalletPasswordUpdateSplashScreen"}function Do({walletAction:a,availableRecoveryMethods:b,legacySetWalletPasswordFlow:c,isResettingPassword:d,showAutomaticRecovery:e}){return e?"SetAutomaticRecoveryScreen":c||1===b.length?Dn({isCreatingWallet:"create"===a,skipSplashScreen:d}):"RecoverySelectionScreen"}function Dp(a){switch(a){case"user-passcode":return"PasswordRecoveryScreen";case"google-drive":case"icloud":return"RecoveryOAuthScreen";default:throw Error("Recovery method not supported")}}function Dq(a,b,c,d,e,f,g){return{...a,funding:a?.funding?{...a.funding,fundingResult:{status:b,address:a.funding.address,fundingMethod:void 0,transactionHash:c,amount:a.funding.amount,assetType:e?f?.symbol||"ETH":g.nativeCurrency.symbol||"ETH",metadata:{walletClientType:d}}}:void 0,solanaFundingData:a?.solanaFundingData,sendTransaction:a?.sendTransaction}}let Dr=new Map([["FundingMethodSelectionScreen",null],["TransferFromWalletScreen","external"],["FundingAmountEditScreen","external"],["ConnectOnlyLandingScreen","external"],["ConnectOnlyStatusScreen","external"],["AwaitingExternalEthereumTransferScreen","external"],["AwaitingEvmToSolBridgingScreen","external"],["AwaitingSolToEvmBridgingScreen","external"],["ManualTransferScreen","manual"],["MoonpayStatusScreen","moonpay"]]);function Ds(a){let b=a.toLowerCase();return!!window?.webkit?.messageHandlers?.ReactNativeWebView||!!window?.ReactNativeWebView||["fbav","fban","instagram","snapchat","linkedinapp"].some(a=>b.includes(a))}async function Dt({rpc:a,address:b}){return(await a.getBalance(b,{commitment:"confirmed"}).send()).value??0n}let Du={apple_oauth:"apple",custom_auth:"custom",discord_oauth:"discord",email:"email",farcaster:"farcaster",github_oauth:"github",google_oauth:"google",instagram_oauth:"instagram",linkedin_oauth:"linkedin",passkey:"passkey",phone:"sms",spotify_oauth:"spotify",telegram:"telegram",tiktok_oauth:"tiktok",line_oauth:"line",twitch_oauth:"twitch",twitter_oauth:"twitter",wallet:"siwe",smart_wallet:"siwe",cross_app:"privy:"},Dv=a=>{if((0,cu.i)(a))return{displayName:a.replace("custom:",""),loginMethod:"custom"};let b=Du[a];return"wallet"===a||"phone"===a?{displayName:a,loginMethod:b}:{displayName:b,loginMethod:b}},Dw=(a,b)=>!(0,cu.b)(a)&&("all-users"===b||"users-without-wallets"===b&&!Dx(a).length),Dx=a=>a.linkedAccounts.filter(a=>"wallet"===a.type&&"ethereum"===a.chainType),Dy=(a,b)=>!(0,cu.c)(a)&&("all-users"===b||"users-without-wallets"===b&&!Dz(a).length),Dz=a=>a.linkedAccounts.filter(a=>"wallet"===a.type&&"solana"===a.chainType);async function DA(a,b,c,d){let e=(0,eA.toViemTransactionSerializable)(a),f=await (async()=>d?await d():await b.prepareTransactionRequest({...e,account:{address:c,type:"json-rpc"}}))();return{...f,type:eA.STRING_TO_NUMBER_TXN_TYPE[f.type]}}let DB=({disabled:a})=>{let{migrate:b}=(()=>{let a=(0,eB.u)(),{user:b}=(0,cu.u)(),{client:c,refreshSessionAndUser:d,walletProxy:e}=(0,cy.u)();return{migrate:(0,U.useCallback)(async()=>{if("legacy-embedded-wallets-only"===a.embeddedWallets.mode)return{success:!0};if(!b)throw new cy.a("User must be authenticated before migrating wallets",cy.b.MUST_BE_AUTHENTICATED);if(!e)throw new cy.a("Cannot connect to wallet proxy");let f=await c.getAccessToken();if(!f)throw new cy.a("User must be authenticated before migrating wallets",cy.b.MUST_BE_AUTHENTICATED);let g=b.linkedAccounts.filter(a=>"wallet"===a.type&&"privy"===a.walletClientType&&(0,cz.i)(a)&&!(0,cu.d)(a));if(0===g.length)return{success:!0};let h=g.filter(a=>a.imported),i=g.filter(a=>!a.imported);if(i.length>0){let a=i.find(a=>"ethereum"===a.chainType&&0===a.walletIndex)??i.find(a=>"solana"===a.chainType&&0===a.walletIndex)??null;if(!a)throw new cy.a("Primary wallet not found");let{entropyId:b,entropyIdVerifier:c}=(0,cx.t)(a);try{await e.connect({accessToken:f,entropyId:b,entropyIdVerifier:c})}catch(d){if(!C0(d)||"privy"!==a.recoveryMethod)throw d;await e.recover({accessToken:f,entropyId:b,entropyIdVerifier:c})}await e.createDelegatedAction({accessToken:f,rootWallet:{address:a.address,chainType:a.chainType,imported:!1},delegatedWallets:i.map(a=>({address:a.address,chainType:a.chainType,walletIndex:a.walletIndex??0}))})}for(let a of h){let{entropyId:b,entropyIdVerifier:c}=(0,cx.t)(a);try{await e.connect({accessToken:f,entropyId:b,entropyIdVerifier:c})}catch(d){if(!C0(d)||"privy"!==a.recoveryMethod)throw d;await e.recover({accessToken:f,entropyId:b,entropyIdVerifier:c})}await e.createDelegatedAction({accessToken:f,rootWallet:{address:a.address,chainType:a.chainType,imported:!0},delegatedWallets:[{address:a.address,chainType:a.chainType,walletIndex:a.walletIndex??0}]})}return await d(),{success:!0}},[a.embeddedWallets.mode,b,e,c,d])}})(),{user:c}=(0,cu.u)(),{walletProxy:d}=(0,cy.u)(),e=(0,U.useRef)(!1);return(0,U.useEffect)(()=>{!a&&!e.current&&c&&d&&(e.current=!0,b().catch(a=>{console.debug("Unable to migrate wallets: ",a)}).finally(()=>{e.current=!1}))},[c,d,a,b]),null},DC=(0,fI.create)(()=>({ethereum:[]}));class DD{async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(fv,{token:this.meta.token})}catch(a){throw(0,cy.f)(a)}}async link(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(fw,{token:this.meta.token})}catch(a){throw(0,cy.f)(a)}}constructor(a){this.meta={token:a}}}let DE=(0,fI.create)(()=>({jwtAuthFlowState:{status:"not-enabled"}}));function DF({customAuth:a}){let{jwtAuthFlowState:b}=function({customAuth:a}){let b=(0,fH.a)(),c=(0,U.useRef)(),d=(0,U.useCallback)(a=>(c.current=a,()=>{c.current=void 0}),[]),e=a?.getCustomAccessToken??(()=>Promise.resolve(void 0)),{state:f}=function({subscribe:a,getExternalJwt:b,enabled:c=!0,onAuthenticated:d,onUnauthenticated:e,onError:f}){let{client:g,onCustomAuthAuthenticated:h}=(0,cy.u)(),{logout:i,authenticated:j,ready:k}=(0,fF.u)();if(!g)throw new cy.a("`useSyncJwtBasedAuthState` must be used within a `PrivyProvider`");let[l,m]=(0,U.useState)({status:"initial"}),o=(0,U.useRef)(),p=(0,U.useRef)(!1),q=(0,U.useRef)(b);(0,U.useEffect)(()=>{q.current=b},[b]);let r=(0,U.useRef)(d);(0,U.useEffect)(()=>{r.current=d},[d]);let s=(0,U.useRef)(e);(0,U.useEffect)(()=>{s.current=e},[e]);let t=(0,U.useRef)(f);return(0,U.useEffect)(()=>{t.current=f},[f]),(0,U.useEffect)(()=>{if(!c||!k)return;let b=async()=>{if(!p.current){p.current=!0;try{m({status:"loading"});let a=await q.current();if(void 0!==o.current&&o.current===a)return void m({status:"done"});if(!a)return j&&(await i(),s.current?.()),o.current=a,void m({status:"done"});g.startAuthFlow(new DD(a));let{user:b,isNewUser:c=!1}=await g.authenticate();if(!b)throw new cy.a("Failed to sync with custom auth provider");r.current?.({user:b,isNewUser:c}),h(b,c),o.current=a,m({status:"done"})}catch(a){if(console.warn(a),await i().catch(()=>{}),s.current?.(),a instanceof cy.e&&a.privyErrorCode===cy.b.LINKED_TO_ANOTHER_USER)return m({status:"initial"}),void setTimeout(()=>{b()},0);t.current?.(a),m({status:"error",error:a})}finally{p.current=!1}}};return b(),a(b)},[a,g,h,j,i,c,k]),c?{state:l}:{state:{status:"not-enabled"}}}({enabled:!0===a?.enabled,subscribe:d,getExternalJwt:e,onAuthenticated:({user:a,isNewUser:c})=>{b("login","onComplete",{user:a,isNewUser:c,wasAlreadyAuthenticated:!1,loginMethod:"custom",loginAccount:null}),b("customAuth","onAuthenticated",{user:a})},onUnauthenticated:()=>{b("customAuth","onUnauthenticated")},onError:a=>{b("login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR)}});return(0,U.useEffect)(()=>{(async()=>{a&&!a.isLoading&&c.current?.()})()},[a?.enabled,a?.getCustomAccessToken,a?.isLoading]),{jwtAuthFlowState:f}}({customAuth:a});return(0,U.useEffect)(()=>{DE.setState({jwtAuthFlowState:b})},[b]),null}let DG=(0,U.createContext)(!1),DH=b=>{let c=b.client,d=b.privy,e=(0,fF.a)(),f=(0,eB.u)();(0,cw.d)((0,cw.e)(f?.appearance.walletList??[]));let[g,h]=(0,U.useState)(!1),o=CE(a=>a.inProgressMfaFlow),[p,q]=(0,U.useState)(!1),[r,s]=(0,U.useState)(null),t=DC(a=>a.ethereum),[u,v]=(0,U.useState)(void 0),[w,x]=(0,U.useState)(!1),[y,z]=(0,U.useState)(null),[A,B]=(0,U.useState)(!1),[C,D]=(0,U.useState)({status:"disconnected",connectedWallet:null,connectError:null,connector:null,connectRetry:cy.n}),[E,F]=(0,U.useState)({status:"initial"}),[G,H]=(0,U.useState)({status:"initial"}),[I,J]=(0,U.useState)({status:"initial"}),[K,L]=(0,U.useState)({status:"initial"}),[M,N]=(0,U.useState)({status:"initial"}),[O,P]=(0,U.useState)({status:"initial"}),[Q,R]=(0,U.useState)(null),S=(0,eB.c)(),[V,W]=(0,U.useState)({}),[Y,Z]=(0,U.useState)(null),$=(0,U.useRef)(null),[_,aa]=(0,U.useState)(!1),[ab,ac]=(0,U.useState)(!1),ad=(0,U.useRef)(null),ae=(0,U.useRef)(null),af=(0,U.useRef)(fH.p),[ag,ah]=(0,U.useState)(!1),[ai,aj]=(0,U.useState)(!1),ak=(0,U.useCallback)(a=>{aj(a),!a&&y&&CD[y]().then(a=>{a.default.isUnauthenticatedScreem&&z(null)})},[y]);c.onStoreCustomerAccessToken=a=>{a&&(0,fH.e)(af,"accessToken","onAccessTokenGranted",{accessToken:a})},c.onDeleteCustomerAccessToken=()=>{s(null),ak(!1),(0,fH.e)(af,"accessToken","onAccessTokenRemoved")};let al=(0,U.useRef)(null),am=(0,U.useRef)(null),an=(0,U.useRef)(!1),ao=({showWalletUIs:a})=>an.current?an.current:void 0!==a?!a:!f.embeddedWallets.showWalletUIs,ap=a=>{z(a),setTimeout(()=>{h(!0)},15)};(0,U.useEffect)(()=>{if(!r)return void c.connectors?.removeEmbeddedWalletConnectors();let a=(0,cu.b)(r),e=(0,cu.e)(r),g=(0,cu.f)(r);a&&e.length||c.connectors?.removeEmbeddedWalletConnectors(),g.length||c.connectors?.removeImportedWalletConnectors(),c.connectors?Q?(a&&c.connectors.addEmbeddedWalletConnectors({walletProxy:Q,user:r,embeddedWallets:e,defaultChain:f.defaultChain,appId:b.appId,privyClient:d}),g.forEach(a=>c.connectors?.addImportedWalletConnector(Q,a.address,f.defaultChain,b.appId))):console.debug("Failed to add embedded wallet connector: Wallet proxy not initialized"):console.debug("Failed to add embedded wallet connector: Client connectors not initialized")},[Q,r]),(0,U.useEffect)(()=>{Q&&$.current?.(Q)},[Q]);let aq=(0,U.useCallback)((a,b)=>{s(a),x(b),ak(!0),ac(!0)},[]);(0,U.useEffect)(()=>{ab&&Q&&r&&(async()=>{let a=Dw(r,f.embeddedWallets.ethereum.createOnLogin),b=Dy(r,f.embeddedWallets.solana.createOnLogin),c=await B0();if(c){if(a&&b){let a=await Q.create({accessToken:c});return await Q.createSolana({accessToken:c,ethereumAddress:a?.address}),void ac(!1)}if(b)return await Q.createSolana({accessToken:c,ethereumAddress:(0,cu.b)(r)?.address}),await aH.refreshSessionAndUser(),void ac(!1);if(a)return await Q.create({accessToken:c}),void ac(!1)}})().catch(console.error)},[ab&&Q&&r]),(0,U.useEffect)(()=>{if(f.externalWallets.solana.connectors)return f.externalWallets.solana.connectors.onMount(),()=>f.externalWallets.solana.connectors?.onUnmount()},[f.externalWallets.solana.connectors]),(0,U.useEffect)(()=>{!p&&S&&async function(){let a,b,d,e,g,h=ar(),i=as(),j=(a=new Set,b=[],e=(d=()=>{})(),{_listeners:()=>a,clear(){a.forEach(a=>a([],{removed:[...b]})),b=[]},destroy(){this.clear(),a.clear(),e?.()},findProvider:({rdns:a})=>b.find(b=>b.info.rdns===a),getProviders:()=>b,reset(){this.clear(),e?.(),e=d()},subscribe:(c,{emitImmediately:d}={})=>(a.add(c),d&&c(b,{added:b}),()=>a.delete(c))});c.initializeConnectorManager({walletConnectCloudProjectId:f.walletConnectCloudProjectId,rpcConfig:f.rpcConfig,chains:f.chains,defaultChain:f.defaultChain,store:j,walletList:f.appearance.walletList,shouldEnforceDefaultChainOnConnect:f.shouldEnforceDefaultChainOnConnect,externalWalletConfig:f.externalWallets,appName:f.name??"Privy",walletChainType:f.appearance.walletChainType,setBaseAccountSdk:v}),c.connectors?.on("connectorInitialized",()=>{g&&clearTimeout(g);let a=c.connectors.walletConnectors.length,b=c.connectors.walletConnectors.reduce((a,b)=>a+ +!!b.initialized,0);b===a?ah(!0):g=setTimeout(()=>{console.debug({message:"Unable to initialize all expected connectors before timeout",initialized:b,expected:a}),ah(!0)},1500)}),c.connectors?.initialize().then(()=>{ax()});let k=await c.getAuthenticatedUser(),l=!!k;f.legal.requireUsersAcceptTerms&&k&&!k.hasAcceptedTerms?(await c.logout(),aH.setReadyToTrue(!0),(0,fH.e)(af,"logout","onSuccess")):(f.customAuth?.enabled||(ak(!!k),k&&(0,fH.e)(af,"login","onComplete",{user:k,isNewUser:!1,wasAlreadyAuthenticated:!0,loginMethod:null,loginAccount:null}),s(k)),h?am.current=l?"link":"login":i&&!l?(am.current="login",W({telegramAuthModalData:{seamlessAuth:!0}}),ap("TelegramAuthScreen")):aH.setReadyToTrue(!!k))}()},[c,Y,p,S]),(0,U.useEffect)(()=>{if(p){if(!r||!r.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType))return void aa(!!Q);if([...t].some(a=>"privy"===a.walletClientType))return void aa(!0);aa(!!Q)}},[p,r,t,Q]),(0,U.useEffect)(()=>{c.connectors?.setWalletList(f.appearance.walletList)},[f.appearance.walletList.join()]);let ar=()=>{let a=function(){let a=new URLSearchParams(window.location.search),b=a.get("privy_oauth_code"),c=a.get("privy_oauth_state"),d=a.get("privy_oauth_provider");if(!b||!c||!d)return{inProgress:!1};let e=!1;try{e=!!window.opener.location.origin}catch{}return{inProgress:!0,authorizationCode:b,stateCode:c,provider:d,withPrivyUi:!cz.u.get(eB.H),popupFlow:null!==window.opener&&e,disableSignup:!!cz.u.get(eB.O)}}();return a.inProgress&&a.popupFlow?window.opener.location.origin!==window.location.origin?void window.opener.postMessage({type:"PRIVY_OAUTH_ERROR",error:"Origins between parent and child windows do not match."}):"error"===a.authorizationCode?void window.opener.postMessage({type:"PRIVY_OAUTH_ERROR",error:"Something went wrong. Try again."}):void window.opener.postMessage({type:"PRIVY_OAUTH_RESPONSE",stateCode:a.stateCode,authorizationCode:a.authorizationCode}):(a.inProgress&&a.provider.startsWith("privy:")&&!a.popupFlow&&(new BroadcastChannel(Dg).postMessage({type:"PRIVY_OAUTH_RESPONSE",stateCode:a.stateCode,authorizationCode:a.authorizationCode}),window.close()),!!a.inProgress&&!!a.withPrivyUi&&(c.startAuthFlow(new Ck({...a,customOAuthRedirectUrl:f.customOAuthRedirectUrl})),ap("OAuthStatusScreen"),!0))},as=()=>{let a,b=(a=function(){let a=new URLSearchParams(window.location.search),b=Number(a.get("id")||""),c=a.get("hash"),d=Number(a.get("auth_date")||""),e=a.get("first_name");if(b&&e&&d&&c)return Object.fromEntries(a.entries())}())?(Cz(),{flowType:"login-url",authData:a}):(a=function(){let a=window.location.hash;if(!a||!a.startsWith("#tgWebAppData"))return;let b=Cy(a.replace("#tgWebAppData=","")),{user:c,auth_date:d,hash:e}=b;return c&&d&&e?b:void 0}())?(Cz(),{flowType:"web-app",authData:a}):void 0;if(!b||!f.loginMethods.telegram||!f.loginConfig.telegramAuthConfiguration?.seamlessAuthEnabled)return;let d=new Cw;return c.startAuthFlow(d),"login-url"===b.flowType&&(d.meta.telegramWebAppData=void 0,d.meta.telegramAuthResult=b.authData),"web-app"===b.flowType&&(d.meta.telegramAuthResult=void 0,d.meta.telegramWebAppData=b.authData),!0},at=async(a,b,d,e)=>{if("solana_adapter"!==a)au(await c.connectors?.createEthereumWalletConnector({connectorType:a,walletClientType:b})||null,b,d,e);else{let a=c.connectors?.findSolanaWalletConnector(b);if(!a)return;au(a,b,d,e)}};async function au(a,b,c,d){if(!a)return D({status:"disconnected",connectedWallet:null,connectError:new cy.P("Unable to connect to wallet."),connector:null,connectRetry:cy.n}),d?.(null,c);D({status:"disconnected",connectedWallet:null,connectError:null,connector:a,connectRetry:cy.n}),a instanceof CY&&b&&await a.resetConnection(b),D({connector:a,status:"connecting",connectedWallet:null,connectError:null,connectRetry:()=>au(a,b,c,d)});try{let b=await a.connect({showPrompt:!0});if((!b||(0,cw.f)(b))&&f.shouldEnforceDefaultChainOnConnect&&!f.chains.find(a=>a.id===Number(b?.chainId.replace("eip155:","")))&&("wallet_connect_v2"!==b?.connectorType||"metamask"!==b?.walletClientType)){D(b=>({...b,connector:a,status:"switching_to_supported_chain",connectedWallet:null,connectError:null,connectRetry:cy.n}));try{await b?.switchChain(f.defaultChain.id),b&&(b.chainId=(0,cw.h)((0,eD.toHex)(f.defaultChain.id)))}catch{console.warn(`Unable to switch to default chain: ${f.defaultChain.id}`)}}return D(a=>({...a,status:"connected",connectedWallet:b,connectError:null,connectRetry:cy.n})),b&&(0,fH.e)(af,"connectWallet","onSuccess",{wallet:b}),d?.(b,c)}catch(a){return a instanceof cy.c?(console.warn(a.cause?a.cause:a.message),(0,fH.e)(af,"connectWallet","onError",a.privyErrorCode||cy.b.GENERIC_CONNECT_WALLET_ERROR)):(console.warn(a),(0,fH.e)(af,"connectWallet","onError",cy.b.UNKNOWN_CONNECT_WALLET_ERROR)),D(b=>({...b,status:"disconnected",connectedWallet:null,connectError:a})),d?.(null,c)}}let av=async(a,b,d)=>{if(null===a||!(0,cw.f)(a))return;let e=new Co(c,a,b,d);c.startAuthFlow(e)},aw=async(a,b,d,f="plain")=>{let g=e(fF.b);if("transaction"===f&&!g)throw new cy.a("useSolanaLedger plugin hook must be mounted");if(null===a||!(0,cw.l)(a))return;let h=new Cp(a,c,b,d,f,g);c.startAuthFlow(h)},ax=async()=>{let a=new URLSearchParams(window.location.search),b=a.get("privy_connector"),d=a.get("privy_wallet_client"),e="true"===a.get("privy_connect_only");if(!b||!d)return;let f=(0,cw.n)({connectorType:b,walletClientType:d});if(!f||!f.isInstalled)return ap("LoginFailedScreen");if(!c.connectors)throw new cy.a("Connector not initialized");await ap(e?"ConnectOnlyStatusScreen":"ConnectionStatusScreen");let g=new URL(window.location.href);g.searchParams.delete("privy_connector"),g.searchParams.delete("privy_wallet_client"),g.searchParams.delete("privy_connect_only"),window.history.pushState({},"",g),at(b,d,void 0,e?void 0:"solana_adapter"===b?aw:av)};(0,U.useEffect)(()=>{p&&ai&&null===r&&c.getAuthenticatedUser().then(s)},[p,ai,r,c]);let ay=a=>{if(!ai)throw(0,fH.e)(af,"linkAccount","onError",cy.b.MUST_BE_AUTHENTICATED,{linkMethod:a}),new cy.a("User must be authenticated before linking an account.")},az=()=>{DC.setState(a=>{let b=c.connectors?.wallets.filter(cw.f).map(a=>({...a,linked:(a=>{if(!ai||!r)return!1;if("privy"===a.walletClientType)return!0;for(let b of r.linkedAccounts)if("wallet"===b.type&&b.address===a.address&&"privy"!==b.walletClientType)return!0;return!1})(a),loginOrLink:async()=>{if(!await a.isConnected())throw new cy.a("Wallet is not connected");if("embedded"===a.connectorType&&"privy"===a.walletClientType)throw new cy.a("Cannot link or login with embedded wallet");(async a=>{let b;if(!c.connectors)throw new cy.a("Connector not initialized");b="ethereum"===a.type?c.connectors.findWalletConnector(a.connectorType,a.walletClientType)||null:c.connectors.findSolanaWalletConnector(a.walletClientType)||null,D(c=>({...c,connector:b,status:"connected",connectedWallet:a,connectError:null,connectRetry:cy.n})),f.captcha.enabled&&!ai?(W({captchaModalData:{callback:b=>(0,cw.f)(a)?av(a,b):aw(a,b),userIntentRequired:!1,onSuccessNavigateTo:"ConnectionStatusScreen",onErrorNavigateTo:"ErrorScreen"}}),await ap("CaptchaScreen")):((0,cw.f)(a)?await av(a):await aw(a),await ap("ConnectionStatusScreen"))})(a)},fund:async b=>{await aH.fundWallet(a.address,b)},unlink:async()=>{if(!ai)throw new cy.a("User is not authenticated.");if("embedded"===a.connectorType&&"privy"===a.walletClientType)throw new cy.a("Cannot unlink an embedded wallet");s(await c.unlinkEthereumWallet(a.address))}}))||[];return(0,cw.j)(a.ethereum,b)?{}:{ethereum:b}})};(0,U.useEffect)(()=>{az()},[r?.linkedAccounts,ai,p]),(0,U.useEffect)(()=>{if(p){if(!c.connectors)throw new cy.a("Connector not initialized");az(),c.connectors.on("walletsUpdated",az)}},[p]),(0,U.useEffect)(()=>{[...f.loginMethodsAndOrder?.primary??[],...f.loginMethodsAndOrder?.overflow??[]].filter(a=>a.startsWith("privy:")).forEach(a=>c.getCrossAppProviderDetails(a.replace("privy:","")))},[!!c]);let aA=({transaction:a,sponsor:e,uiOptions:g,fundWalletConfig:h,address:i,signOnly:j})=>new Promise(async(k,l)=>{let{requesterAppId:m}=g||{},o=j?"signTransaction":"sendTransaction",p=i?(0,cu.h)(r,i):(0,cu.b)(r);if(!p&&i){let b=(0,cu.k)(DC.getState().ethereum,i);if(b){if(e)throw new cy.a("Cannot sponsor transactions for externally connected wallet.");try{let c=await b.getEthereumProvider(),d={...a,from:i,chainId:a.chainId||Number(b.chainId.replace("eip155:","")),value:void 0!==a.value?(0,eD.toHex)(a.value):void 0},e=await c.request({method:"sendTransaction"===o?"eth_sendTransaction":"eth_signTransaction",params:[d]});return(0,fH.e)(af,o,"onSuccess",{hash:e}),void k({hash:e})}catch(a){return(0,fH.e)(af,o,"onError",cy.b.TRANSACTION_FAILURE),void l(a??new cz.P("Unable to "+o+a))}}}if(!p)return(0,fH.e)(af,o,"onError",cy.b.EMBEDDED_WALLET_NOT_FOUND),void l(new cy.a("No embedded or connected wallet found for address."));if(!ai||!r)return(0,fH.e)(af,o,"onError",cy.b.MUST_BE_AUTHENTICATED),void l(Error("User must be authenticated before signing with a Privy wallet"));let q=p.address,s=p.walletIndex??0,{entropyId:t,entropyIdVerifier:u}=(0,cx.g)(r,p),v=aI.wallets.find(a=>"privy"===a.walletClientType&&(0,eF.getAddress)(a.address)===(0,eF.getAddress)(q));if(!v)return(0,fH.e)(af,o,"onError",cy.b.EMBEDDED_WALLET_NOT_FOUND),void l(Error("Must have a Privy wallet before signing"));let w=await v.getEthereumProvider(),x=await w.request({method:"eth_chainId"}),y=a.chainId?Number(a.chainId):(0,cz.b)(x);if(!f.chains.map(a=>a.id).includes(y))throw new cy.P(`Chain ID ${y} is not supported. It must be added to the config.supportedChains property of the PrivyProvider.`,cy.b.UNSUPPORTED_CHAIN_ID);let z={...a,from:a.from??q,chainId:y},A=await B0();if(!A||!Q)return(0,fH.e)(af,o,"onError",cy.b.EMBEDDED_WALLET_NOT_FOUND),void l(Error("Must have valid access token and Privy wallet to send transaction"));let B=(0,wR.g)(z.chainId,f.chains,f.rpcConfig,{appId:b.appId}),C=(0,cu.d)(p),D=async({transactionRequest:a})=>{try{let b;if(!await aH.recoverEmbeddedWallet({address:q}))throw(0,fH.e)(af,o,"onError",cy.b.UNKNOWN_CONNECT_WALLET_ERROR),l(Error("Unable to connect to wallet")),Error("Unable to connect to wallet");if(e){let b=await (async({transactionRequest:a})=>{if(!C)throw new cy.a("Sponsoring is only supported for wallets on the TEE stack");if(j)throw new cy.a("Cannot sponsor a sign transaction request");let b=a=>null==a?void 0:(0,eD.toHex)(a),c=await (0,X.rpc)(d,async({message:a})=>await Q.signWithUserSigner({accessToken:A,requesterAppId:m,message:a}),{chain_type:"ethereum",method:"eth_sendTransaction",caip2:(0,cw.h)((0,eD.toHex)(a.chainId)),sponsor:!0,params:{transaction:{from:a.from,to:a.to,chain_id:b(a.chainId),data:(0,eG.isHex)(a.data)?a.data?a.data:(0,eD.toHex)(Uint8Array.from(a.data)):void 0,value:b(a.value)}},wallet_id:p.id});if(c.data&&"hash"in c.data)return c.data.hash;throw new cz.P("Unable to sign transaction")})({transactionRequest:a});return(0,fH.e)(af,"sendTransaction","onSuccess",{hash:b}),b}if(C){let c=a=>null==a?void 0:(0,eD.toHex)(a),e=await (0,X.rpc)(d,async({message:a})=>await Q.signWithUserSigner({accessToken:A,requesterAppId:m,message:a}),{chain_type:"ethereum",method:"eth_signTransaction",params:{transaction:{from:a.from,to:a.to,nonce:c(a.nonce),chain_id:c(a.chainId),data:(0,eG.isHex)(a.data)?a.data?a.data:(0,eD.toHex)(Uint8Array.from(a.data)):void 0,value:c(a.value),type:a.type,gas_limit:c(a.gasLimit??a.gas),gas_price:c(a.gasPrice??a.gas),max_fee_per_gas:c(a.maxFeePerGas),max_priority_fee_per_gas:c(a.maxPriorityFeePerGas)}},wallet_id:p.id});if(!e.data||!("signed_transaction"in e.data))throw new cz.P("Unable to sign transaction");b=e.data.signed_transaction}else b=await async function({accessToken:a,entropyId:b,entropyIdVerifier:c,transactingWalletIndex:d,walletProxy:e,transactionRequest:f,requesterAppId:g}){return(await e.rpc({entropyId:b,entropyIdVerifier:c,hdWalletIndex:d??0,chainType:"ethereum",accessToken:a,requesterAppId:g,request:{method:"eth_signTransaction",params:[f]}})).response.data}({accessToken:A,entropyId:t,entropyIdVerifier:u,transactingWalletIndex:s,walletProxy:Q,transactionRequest:a,requesterAppId:m});if(j)return(0,fH.e)(af,"signTransaction","onSuccess",{signature:b}),b;{let a=await B.sendRawTransaction({serializedTransaction:b});return(0,fH.e)(af,"sendTransaction","onSuccess",{hash:a}),a}}catch(a){throw(0,fH.e)(af,o,"onError",cy.b.TRANSACTION_FAILURE),a}};if(ao({showWalletUIs:g?.showWalletUIs})){let a=j||e?z:await DA(z,B,z.from);try{let b=await D({transactionRequest:a});j?(0,fH.e)(af,"signTransaction","onSuccess",{signature:b}):(0,fH.e)(af,"sendTransaction","onSuccess",{hash:b}),k({hash:b})}catch(a){(0,fH.e)(af,o,"onError",cy.b.TRANSACTION_FAILURE),l(a)}}else{let a={connectingWalletAddress:q,recoveryMethod:p.recoveryMethod,entropyId:t,entropyIdVerifier:u,onCompleteNavigateTo:"SendTransactionScreen",isUnifiedWallet:C,onFailure:a=>{(0,fH.e)(af,o,"onError",cy.b.UNKNOWN_CONNECT_WALLET_ERROR),l(a)}},b=f.fundingConfig&&(0,cz.a)(f.fundingConfig.options).length>=1?(0,cz.p)({address:q,appConfig:f,fundWalletConfig:h,methodScreen:"FundingMethodSelectionScreen",chainIdOverride:z.chainId,comingFromSendTransactionScreen:!0}):void 0;W({connectWallet:a,sendTransaction:{transactionRequest:z,transactingWalletIndex:s,transactingWalletAddress:q,entropyId:t,entropyIdVerifier:u,signOnly:j,scanTransaction:async()=>{let a=await DA(z,B,z.from);return await c.scanTransaction({metadata:{domain:f.embeddedWallets.transactionScanning.domain},chain_id:a.chainId.toString(),request:{method:"eth_sendTransaction",params:[{from:a.from,to:a.to,value:a.value?.toString(),gas:a.gas?.toString(),gasPrice:a.gasPrice?.toString(),nonce:a.nonce?.toString(),data:a.data}]}})},getIsSponsored:async()=>!!e,onConfirm:({transactionRequest:a})=>D({transactionRequest:a}),onSuccess:a=>{j?(0,fH.e)(af,"signTransaction","onSuccess",{signature:a.hash}):(0,fH.e)(af,"sendTransaction","onSuccess",{hash:a.hash}),k(a)},onFailure:a=>{(0,fH.e)(af,o,"onError",cy.b.TRANSACTION_FAILURE),l(a)},uiOptions:g||{},fundWalletConfig:h,requesterAppId:m},funding:b}),ap("EmbeddedWalletConnectingScreen")}});function aB(){return new Promise(async(a,b)=>{let c=await B0();if(!c||!Q)throw Error("Must have valid access token to enroll in MFA");try{await Q.verifyMfa({accessToken:c}),a()}catch(a){b(a)}})}let aC=a=>a?.linkedAccounts.filter(a=>null!==a.latestVerifiedAt&&("wallet"!==a.type||"privy"!==a.walletClientType)).sort((a,b)=>b.latestVerifiedAt.getTime()-a.latestVerifiedAt.getTime())[0],aD=a=>{let b=r?.linkedAccounts.filter(b=>b.type===a).length??0,{displayName:c,loginMethod:d}=Dv(a);if("passkey"===a&&b>=5||"passkey"!==a&&b>=1)throw(0,fH.e)(af,"linkAccount","onError",cy.b.CANNOT_LINK_MORE_OF_TYPE,{linkMethod:d}),new cy.a(`User already has an account of type ${c} linked.`)};async function aE({showAutomaticRecovery:a=!1,legacySetWalletPasswordFlow:b=!1}){z(null);let c=b?"setWalletPassword":"setWalletRecovery";if(!ai||!r)throw(0,fH.e)(af,c,"onError",cy.b.MUST_BE_AUTHENTICATED),Error("User must be authenticated before adding recovery method to Privy wallet");let d=(0,cu.g)(r);if(!d||!Q)throw(0,fH.e)(af,c,"onError",cy.b.EMBEDDED_WALLET_NOT_FOUND),Error("Must have a Privy wallet to add a recovery method");let e=(0,cu.d)(d);if(e)throw(0,fH.e)(af,c,"onError",cy.b.UNSUPPORTED_WALLET_TYPE),new cy.a("User owned wallet recovery is only supported for on-device execution and this app uses TEE execution. Learn more https://docs.privy.io/recipes/tee-wallet-migration-guide");try{await aB()}catch(a){throw(0,fH.e)(af,c,"onError",cy.b.MISSING_MFA_CREDENTIALS),a}return new Promise((g,h)=>{let i="user-passcode"===d.recoveryMethod,j=Do({walletAction:"update",availableRecoveryMethods:f.embeddedWallets.userOwnedRecoveryOptions,legacySetWalletPasswordFlow:b,isResettingPassword:i,showAutomaticRecovery:a}),{entropyId:k,entropyIdVerifier:l}=(0,cx.g)(r),m={recoveryMethod:d.recoveryMethod,connectingWalletAddress:d.address,onCompleteNavigateTo:j,shouldForceMFA:!1,entropyId:k,isUnifiedWallet:e,entropyIdVerifier:l,onFailure:a=>{(0,fH.e)(af,c,"onError",cy.b.UNKNOWN_CONNECT_WALLET_ERROR),h(a)}};W({setWalletPassword:{onSuccess:a=>{(0,fH.e)(af,c,"onSuccess",{method:"user-passcode",wallet:a}),g(a)},onFailure:a=>{(0,fH.e)(af,c,"onError",cy.b.USER_EXITED_SET_PASSWORD_FLOW),h(a)},callAuthOnSuccessOnClose:!1},recoverWallet:{entropyId:k,entropyIdVerifier:l,onFailure:h},connectWallet:m,recoverySelection:{isInAccountCreateFlow:!1,isResettingPassword:i,shouldCreateEth:!1,shouldCreateSol:!1}}),ap("EmbeddedWalletConnectingScreen")})}async function aF({appId:a,action:b}){let d=await B0();if("link"===b&&!d)throw(0,fH.e)(af,"linkAccount","onError",cy.b.MUST_BE_AUTHENTICATED,{linkMethod:`privy:${a}`}),new cy.a("User must be authenticated before linking an account.");if("login"===b&&d)throw(0,fH.e)(af,"login","onError",cy.b.UNKNOWN_AUTH_ERROR),new cy.a("Attempted to log in, but user is already logged in. Use a `link` helper instead.");al.current=`privy:${a}`,am.current=b;let e=(0,eI.trigger)();return c.createAnalyticsEvent({eventName:"cross_app_auth_started",payload:{providerAppId:a}}),new Promise(async(d,g)=>{let{name:h,logoUrl:i}=await Dj({api:c.api,providerAppId:a,requesterAppId:f.id});W({crossAppAuth:{appId:a,name:h,logoUrl:i,action:b,popup:e,onSuccess:d,onError:g}}),ap("CrossAppAuthScreen")})}let aG={ready:p,authenticated:ai,user:r,walletConnectors:c.connectors||null,connectWallet:a=>{a&&"target"in a&&a&&(a=void 0),W({externalConnectWallet:{walletList:a?.walletList&&a?.walletList.length>0?a.walletList:void 0,walletChainType:a?.walletChainType,description:a?.description,hideHeader:a?.hideHeader}}),ap("ConnectOnlyLandingScreen")},linkWallet:a=>(a&&"target"in a&&a&&(a=void 0),ay("siwe"),al.current="siwe",am.current="link",W({...V,externalConnectWallet:{...V.externalConnectWallet,walletList:a?.walletList,walletChainType:a?.walletChainType,description:a?.description||`Link a wallet to your ${f?.name} account`}}),ap("AuthenticateWithWalletScreen")),startCrossAppAuthFlow:aF,linkEmail:()=>{ay("email"),aD("email"),al.current="email",am.current="link",ap("LinkEmailScreen")},linkPhone:()=>{ay("sms"),aD("phone"),al.current="sms",am.current="link",ap("LinkPhoneScreen")},linkGoogle:async()=>{ay("google"),aD("google_oauth"),am.current="link",await aH.initLoginWithOAuth("google")},linkTwitter:async()=>{ay("twitter"),aD("twitter_oauth"),am.current="link",await aH.initLoginWithOAuth("twitter")},linkTwitch:async()=>{ay("twitch"),aD("twitch_oauth"),am.current="link",await aH.initLoginWithOAuth("twitch")},linkDiscord:async()=>{ay("discord"),aD("discord_oauth"),am.current="link",await aH.initLoginWithOAuth("discord")},linkGithub:async()=>{ay("github"),aD("github_oauth"),am.current="link",await aH.initLoginWithOAuth("github")},linkSpotify:async()=>{ay("spotify"),aD("spotify_oauth"),am.current="link",await aH.initLoginWithOAuth("spotify")},linkInstagram:async()=>{ay("instagram"),aD("instagram_oauth"),am.current="link",await aH.initLoginWithOAuth("instagram")},linkTiktok:async()=>{ay("tiktok"),aD("tiktok_oauth"),am.current="link",await aH.initLoginWithOAuth("tiktok")},linkLine:async()=>{ay("line"),aD("line_oauth"),am.current="link",await aH.initLoginWithOAuth("line")},linkLinkedIn:async()=>{ay("linkedin"),aD("linkedin_oauth"),am.current="link",await aH.initLoginWithOAuth("linkedin")},linkApple:async()=>{ay("apple"),aD("apple_oauth"),am.current="link",await aH.initLoginWithOAuth("apple")},linkPasskey:async()=>{ay("passkey"),aD("passkey"),await aH.initLinkWithPasskey(),ap("LinkPasskeyScreen")},linkTelegram:async a=>{if(ay("telegram"),aD("telegram"),am.current="link",al.current="telegram",a?.launchParams)if(a.launchParams.initDataRaw){let b=new Cw;c.startAuthFlow(b),b.meta.telegramAuthResult=void 0,b.meta.telegramWebAppData=Cy(a.launchParams.initDataRaw),W({telegramAuthModalData:{seamlessAuth:!0}}),ap("TelegramAuthScreen")}else(0,fH.e)(af,"linkAccount","onError",cy.b.INVALID_DATA,{linkMethod:"telegram"});else await aH.initLoginWithTelegram();ap("TelegramAuthScreen")},linkFarcaster:async()=>{ay("farcaster"),aD("farcaster"),await aH.initLoginWithFarcaster(),am.current="link",al.current="farcaster",ap("FarcasterConnectStatusScreen")},updateEmail:()=>{if(ay("email"),!r?.email)throw new cy.a("User does not have an email linked to their account.");am.current="update",al.current="email",ap("UpdateEmailScreen")},updatePhone:()=>{if(ay("sms"),!r?.phone)throw new cy.a("User does not have a phone number linked to their account.");am.current="update",al.current="sms",ap("UpdatePhoneScreen")},login:async a=>{a&&"target"in a&&a&&(a=void 0);let b="Attempted to log in, but user is already logged in. Use a `link` helper instead.";if(!p){let a=await new Promise(a=>{Z(b=>a.bind(b))});if(Z(null),a)return void console.warn(b)}!r||r.isGuest?(am.current="login",W({login:a}),ap("LandingScreen")):console.warn(b)},connectOrCreateWallet:async()=>{p||(await new Promise(a=>{Z(()=>a)}),Z(null)),ai?console.warn("User must be unauthenticated to `connectOrCreateWallet`"):(am.current="connect-or-create",ap("ConnectOrCreateScreen"))},logout:async()=>{if(am.current=null,al.current=null,r&&c.clearProviderAcccessTokens(r),z(null),await c.logout(),r&&Q)try{await Q.clearMfa({userId:r.id})}catch(a){}s(null),ak(!1),H({status:"initial"}),J({status:"initial"}),F({status:"initial"}),L({status:"initial"}),N({status:"initial"}),P({status:"initial"}),(0,fH.e)(af,"logout","onSuccess"),h(!1),cz.u.del(eB.d),cz.u.del((0,eB.g)(f.id))},getAccessToken:(0,U.useCallback)(async()=>{let a=await c.getCustomerAccessToken();return a&&!ai&&ak(!0),a},[c,ai]),unlinkWallet:async a=>{let b;return s(b=a.startsWith("0x")?await c.unlinkEthereumWallet(a):await c.unlinkSolanaWallet(a)),b},unlinkEmail:async a=>{let b=await c.unlinkEmail(a);return s(b),b},unlinkPhone:async a=>{let b=await c.unlinkPhone(a);return s(b),b},unlinkGoogle:async a=>{let b=await c.unlinkOAuth("google",a);return s(b),b},unlinkTwitter:async a=>{let b=await c.unlinkOAuth("twitter",a);return s(b),b},unlinkTwitch:async a=>{let b=await c.unlinkOAuth("twitch",a);return s(b),b},unlinkDiscord:async a=>{let b=await c.unlinkOAuth("discord",a);return s(b),b},unlinkGithub:async a=>{let b=await c.unlinkOAuth("github",a);return s(b),b},unlinkSpotify:async a=>{let b=await c.unlinkOAuth("spotify",a);return s(b),b},unlinkInstagram:async a=>{let b=await c.unlinkOAuth("instagram",a);return s(b),b},unlinkTiktok:async a=>{let b=await c.unlinkOAuth("tiktok",a);return s(b),b},unlinkLine:async a=>{let b=await c.unlinkOAuth("line",a);return s(b),b},unlinkLinkedIn:async a=>{let b=await c.unlinkOAuth("linkedin",a);return s(b),b},unlinkApple:async a=>{let b=await c.unlinkOAuth("apple",a);return s(b),b},unlinkFarcaster:async a=>{let b=await c.unlinkFarcaster(a);return s(b),b},unlinkTelegram:async a=>{let b=await c.unlinkTelegram(a);return s(b),b},unlinkPasskey:async a=>{let b=await B0();if(!b)throw Error("Must have valid access token to enroll in MFA");if(!Q)throw Error("Wallet proxy not initialized.");let d=f.passkeys.shouldUnenrollMfaOnUnlink;await Q.unlinkPasskeyAccount({credentialId:a,accessToken:b,removeAsMfa:d});let e=await c.getAuthenticatedUser();return s(e),e},unlinkCrossAppAccount:async({subject:a})=>{let b=r?.linkedAccounts.find(b=>"cross_app"===b.type&&b.subject===a)?.providerApp;if(!b)throw new cy.a("Invalid subject");c.storeProviderAccessToken(b.id,null);let d=await c.unlinkOAuth(`privy:${b.id}`,a);return s(d),d},setWalletRecovery:async a=>aE({legacySetWalletPasswordFlow:!1,showAutomaticRecovery:a?.showAutomaticRecovery??!1}),setWalletPassword:async()=>aE({legacySetWalletPasswordFlow:!0,showAutomaticRecovery:!1}),signMessage:(a,b)=>new Promise(async(e,f)=>{let{requesterAppId:g}=b?.uiOptions||{},h=a.message,i=b?.address?(0,cu.h)(r,b.address):(0,cu.b)(r);if(!i&&void 0!==b?.address){let a=(0,cu.k)(DC.getState().ethereum,b.address);if(a)try{let b=await a.getEthereumProvider(),c=await b.request({method:"personal_sign",params:[h,a.address]});return(0,fH.e)(af,"signMessage","onSuccess",{signature:c}),void e({signature:c})}catch(a){return(0,fH.e)(af,"signMessage","onError",cy.b.UNABLE_TO_SIGN),void f(a??new cz.P("Unable to sign message"))}}if(!i)throw new cy.a("No embedded or connected wallet found for address.");if(!ai||!r)return(0,fH.e)(af,"signMessage","onError",cy.b.MUST_BE_AUTHENTICATED),void f(Error("User must be authenticated before signing with a Privy wallet"));let j=i.address,k=i.walletIndex??0,{entropyId:l,entropyIdVerifier:m}=(0,cx.g)(r,i),o=(0,cu.d)(i);if("string"!=typeof h||h.length<1)return(0,fH.e)(af,"signMessage","onError",cy.b.INVALID_MESSAGE),void f(Error("Message must be a non-empty string"));let p=async()=>{let b;if(!ai)throw Error("User must be authenticated before signing with a Privy wallet");let e=await B0();if(!Q||!e||!await aH.recoverEmbeddedWallet({address:j}))throw Error("Unable to connect to wallet");if(c.createAnalyticsEvent({eventName:"embedded_wallet_sign_message_started",payload:{walletAddress:j,requesterAppId:g}}),o){let c=(0,eG.isHex)(a.message,{strict:!0}),f=await (0,X.rpc)(d,async({message:a})=>await Q.signWithUserSigner({accessToken:e,requesterAppId:g,message:a}),{chain_type:"ethereum",method:"personal_sign",params:c?{message:h.slice(2),encoding:"hex"}:{message:h,encoding:"utf-8"},wallet_id:i.id});if(!f.data||!("signature"in f.data))throw new cz.P("Unable to sign message");b=f.data.signature}else{let{response:a}=await Q.rpc({accessToken:e,entropyId:l,entropyIdVerifier:m,chainType:"ethereum",hdWalletIndex:k,requesterAppId:g,request:{method:"personal_sign",params:[h,j]}});b=a.data}return c.createAnalyticsEvent({eventName:"embedded_wallet_sign_message_completed",payload:{walletAddress:j,requesterAppId:g}}),b};if(ao({showWalletUIs:b?.uiOptions?.showWalletUIs}))try{let a=await p();(0,fH.e)(af,"signMessage","onSuccess",{signature:a}),e({signature:a})}catch(a){(0,fH.e)(af,"signMessage","onError",cy.b.UNABLE_TO_SIGN),f(a??new cz.P("Unable to sign message"))}else W({signMessage:{method:"personal_sign",data:h,confirmAndSign:p,onSuccess:a=>{(0,fH.e)(af,"signMessage","onSuccess",{signature:a}),e({signature:a})},onFailure:a=>{(0,fH.e)(af,"signMessage","onError",cy.b.UNABLE_TO_SIGN),f(a)},uiOptions:b?.uiOptions||{}},connectWallet:{recoveryMethod:i.recoveryMethod,connectingWalletAddress:j,entropyId:l,entropyIdVerifier:m,onCompleteNavigateTo:"SignRequestScreen",isUnifiedWallet:o,onFailure:a=>{(0,fH.e)(af,"signMessage","onError",cy.b.UNKNOWN_CONNECT_WALLET_ERROR),f(a)}}}),ap("EmbeddedWalletConnectingScreen")}),signTypedData:(a,b)=>new Promise(async(e,f)=>{let{requesterAppId:g}=b?.uiOptions||{},h=b?.address?(0,cu.h)(r,b.address):(0,cu.b)(r);if(!h&&b?.address){let c=(0,cu.k)(DC.getState().ethereum,b.address);if(c)try{let b=await c.getEthereumProvider(),d=(0,cw.m)(a),f=await b.request({method:"eth_signTypedData_v4",params:[c.address,d]});return(0,fH.e)(af,"signTypedData","onSuccess",{signature:f}),void e({signature:f})}catch(a){return(0,fH.e)(af,"signTypedData","onError",cy.b.UNABLE_TO_SIGN),void f(a??new cz.P("Unable to sign typed data "+a))}}if(!h)throw new cy.a("No embedded or connected wallet found for address.");if(!ai||!r)return(0,fH.e)(af,"signTypedData","onError",cy.b.MUST_BE_AUTHENTICATED),void f(Error("User must be authenticated before signing with a Privy wallet"));let i=h.address,j=h.walletIndex??0,{entropyId:k,entropyIdVerifier:l}=(0,cx.g)(r,h),m=(0,cu.d)(h),o=(0,cw.m)(a),p=async()=>{let a;if(!ai)throw Error("User must be authenticated before signing with a Privy wallet");let b=await B0();if(!Q||!b||!await aH.recoverEmbeddedWallet({address:i}))throw Error("Unable to connect to wallet");if(c.createAnalyticsEvent({eventName:"embedded_wallet_sign_typed_data_started",payload:{walletAddress:i,requesterAppId:g}}),m){let{domain:c,types:e,primaryType:f,message:i}=o,j=await (0,X.rpc)(d,async({message:a})=>await Q.signWithUserSigner({accessToken:b,requesterAppId:g,message:a}),{chain_type:"ethereum",method:"eth_signTypedData_v4",params:{typed_data:{domain:c,types:e,primary_type:f,message:i}},wallet_id:h.id});if(!j.data||!("signature"in j.data))throw new cz.P("Unable to sign message");a=j.data.signature}else{let{response:c}=await Q.rpc({accessToken:b,entropyId:k,entropyIdVerifier:l,chainType:"ethereum",hdWalletIndex:j,requesterAppId:g,request:{method:"eth_signTypedData_v4",params:[i,o]}});a=c.data}return c.createAnalyticsEvent({eventName:"embedded_wallet_sign_typed_data_completed",payload:{walletAddress:i,requesterAppId:g}}),a};if(ao({showWalletUIs:b?.uiOptions?.showWalletUIs}))try{let a=await p();(0,fH.e)(af,"signTypedData","onSuccess",{signature:a}),e({signature:a})}catch(a){(0,fH.e)(af,"signTypedData","onError",cy.b.UNABLE_TO_SIGN),f(a??new cz.P("Unable to sign message"))}else W({signMessage:{method:"eth_signTypedData_v4",data:o,confirmAndSign:p,onSuccess:a=>{(0,fH.e)(af,"signTypedData","onSuccess",{signature:a}),e({signature:a})},onFailure:a=>{(0,fH.e)(af,"signTypedData","onError",cy.b.UNABLE_TO_SIGN),f(a)},uiOptions:b?.uiOptions||{}},connectWallet:{recoveryMethod:h.recoveryMethod,connectingWalletAddress:h.address,entropyId:k,isUnifiedWallet:m,entropyIdVerifier:l,onCompleteNavigateTo:"SignRequestScreen",onFailure:a=>{(0,fH.e)(af,"signMessage","onError",cy.b.UNKNOWN_CONNECT_WALLET_ERROR),f(a)}}}),ap("EmbeddedWalletConnectingScreen")}),sendTransaction:async(a,b)=>await aA({transaction:a,sponsor:b?.sponsor,uiOptions:b?.uiOptions,fundWalletConfig:b?.fundWalletConfig,address:b?.address,signOnly:!1}),signTransaction:async(a,b)=>({signature:(await aA({transaction:a,uiOptions:b?.uiOptions,address:b?.address,signOnly:!0})).hash}),exportWallet:a=>new Promise(async(d,e)=>{if(!ai||!r)return void e(Error("User must be authenticated before exporting their Privy wallet"));a&&"target"in a&&a&&(a=void 0);let f=a?.address?(0,cu.h)(r,a.address):(0,cu.b)(r);if(!f)return void e(new cy.a("User must have an embedded wallet."));let g=f.address,{entropyId:h,entropyIdVerifier:i}=(0,cx.g)(r,f),j=(0,cu.d)(f);if(!g)return void e(Error("User does not have an HD Ethereum wallet. To export an imported wallet, pass the `address` of the wallet to `exportWallet`."));if(!(0,eE.isAddress)(g))return void e(Error("Must provide a valid Ethereum address."));let k={recoveryMethod:f.recoveryMethod,connectingWalletAddress:f.address,isUnifiedWallet:j,entropyId:h,entropyIdVerifier:i,onCompleteNavigateTo:"EmbeddedWalletKeyExportScreen",onFailure:e,shouldForceMFA:!0};W(V),await B0()&&Q?Q?(0,cz.i)(f)?(W({keyExport:{appId:b.appId,appClientId:b.clientId,origin:c.apiUrl,address:f.address,entropyId:h,entropyIdVerifier:i,hdWalletIndex:f.walletIndex,chainType:f.chainType,walletId:f.id,isUnifiedWallet:j,imported:f.imported,onSuccess:d,onFailure:e},connectWallet:k}),ap("EmbeddedWalletConnectingScreen")):e(Error(`Export is not supported for ${f.chainType} wallets`)):e(Error("Must have a Privy wallet before exporting")):e(Error("Must have valid access token to enroll in MFA"))}),promptMfa:aB,async init(a){switch(a){case"sms":return void await c.initMfaSmsVerification();case"passkey":return await c.initMfaPasskeyVerification();case"totp":return;default:throw Error(`Unsupported MFA method: ${a}`)}},async submit(b,c){switch(b){case"totp":case"sms":if("string"!=typeof c)throw new cy.a("Invalid MFA code");ad.current?.resolve({mfaMethod:b,mfaCode:c,relyingParty:window.origin}),await new Promise((a,b)=>{ae.current={resolve:a,reject:b}});break;case"passkey":let d;if("string"==typeof c)throw new cy.a("Invalid authenticator response");let e=await a.A(577627),f={id:(d=await e.startAuthentication({optionsJSON:c})).id,raw_id:d.rawId,response:{client_data_json:d.response.clientDataJSON,authenticator_data:d.response.authenticatorData,signature:d.response.signature,user_handle:d.response.userHandle},authenticator_attachment:d.authenticatorAttachment,client_extension_results:{app_id:d.clientExtensionResults.appid,cred_props:d.clientExtensionResults.credProps,hmac_create_secret:d.clientExtensionResults.hmacCreateSecret},type:d.type};ad.current?.resolve({mfaMethod:b,mfaCode:f,relyingParty:window.origin}),await new Promise((a,b)=>{ae.current={resolve:a,reject:b}});break;default:throw ad.current?.reject(new cy.a("Unsupported MFA method")),new cy.a(`Unsupported MFA method: ${b}`)}},cancel(){ad.current?.reject(new cy.a("MFA canceled"))},async initEnrollmentWithSms(a){let b=await B0();if(!b||!Q)throw Error("Must have valid access token to enroll in MFA");await Q.initEnrollMfa({method:"sms",accessToken:b,phoneNumber:a.phoneNumber})},enrollInMfa:a=>new Promise((b,c)=>{a?(f.mfa.noPromptOnMfaRequired&&console.warn("[Privy Warning] Triggering the 'showMfaEnrollmentModal' function when 'noPromptOnMfaRequired' is set to true is unexpected. If this is intentional, ensure that you are building custom UIs for MFA verification."),W({mfaEnrollmentFlow:{mfaMethods:f.mfa.methods,shouldUnlinkOnUnenrollMfa:f.passkeys.shouldUnlinkOnUnenrollMfa,onSuccess:b,onFailure:c}}),ap("MfaEnrollmentFlowScreen")):(aH.closePrivyModal(),b())}),async initEnrollmentWithTotp(){let a=await B0();if(!a||!Q)throw Error("Must have valid access token to enroll in MFA");let b=await Q.initEnrollMfa({method:"totp",accessToken:a});return{secret:b.secret,authUrl:b.authUrl}},async submitEnrollmentWithSms(a){let b=await B0();if(!b||!Q)throw Error("Must have valid access token to enroll in MFA");await Q.submitEnrollMfa({method:"sms",accessToken:b,phoneNumber:a.phoneNumber,code:a.mfaCode}),s(await c.getAuthenticatedUser())},async submitEnrollmentWithTotp(a){let b=await B0();if(!b||!Q)throw Error("Must have valid access token to enroll in MFA");await Q.submitEnrollMfa({method:"totp",accessToken:b,code:a.mfaCode}),s(await c.getAuthenticatedUser())},async initEnrollmentWithPasskey(){},async submitEnrollmentWithPasskey({credentialIds:a},b={}){let d=await B0();if(!d||!Q)throw Error("Must have valid access token to enroll in MFA");await Q.submitEnrollMfa({method:"passkey",accessToken:d,credentialIds:a,removeForLogin:b.removeForLogin}),s(await c.getAuthenticatedUser())},async unenroll(a,b={}){let d=await B0();if(!d||!Q)throw Error("Must have valid access token to remove MFA");"passkey"===a?await Q.submitEnrollMfa({method:"passkey",accessToken:d,credentialIds:[],removeForLogin:b.removeForLogin}):await Q.unenrollMfa({method:a,accessToken:d}),s(await c.getAuthenticatedUser())},requestFarcasterSignerFromWarpcast:async()=>{let a=await B0(),b=r?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!a)throw Error("Must have valid access token to connect with Farcaster");if(!Q||!b)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,cu.d)(b))throw new cy.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!r?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await aH.recoverEmbeddedWallet({address:b.address}))throw Error("Unable to connect to wallet");let d=await Q.initFarcasterSigner({address:b.address,hdWalletIndex:null,accessToken:a,mfaCode:null,mfaMethod:null,relyingParty:window.origin});"approved"===d.status&&s(await c.getAuthenticatedUser()||r||null),W({farcasterSigner:d}),ap("FarcasterSignerStatusScreen")},getFarcasterSignerPublicKey:async()=>{let a,b=await B0(),c=r?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!b)throw Error("Must have valid access token to connect with Farcaster");if(!Q||!c)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,cu.d)(c))throw new cy.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!r?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await aH.recoverEmbeddedWallet({address:c.address}))throw Error("Unable to connect to wallet");if(!r.farcaster?.signerPublicKey)throw Error("Must have a Farcaster signer public key to sign");return a=r.farcaster.signerPublicKey.slice(2),Uint8Array.from(a.match(/.{1,2}/g).map(a=>parseInt(a,16)))},signFarcasterMessage:async b=>{let c=await B0(),d=r?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!c)throw Error("Must have valid access token to connect with Farcaster");if(!Q||!d)throw Error("Must have an embedded wallet to use Farcaster signers");if((0,cu.d)(d))throw new cy.a("Farcaster signers are only supported for on-device execution and this app uses TEE execution. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");if(!r?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");if(!await aH.recoverEmbeddedWallet({address:d.address}))throw Error("Unable to connect to wallet");if(!r.farcaster?.signerPublicKey)throw Error("Must have a Farcaster signer public key to sign");let e=await a.A(577627),f=await Q.signFarcasterMessage({address:d.address,hdWalletIndex:null,accessToken:c,mfaCode:null,mfaMethod:null,payload:{hash:e.bufferToBase64URLString(b)},fid:BigInt(r.farcaster.fid),relyingParty:window.origin});return new Uint8Array(e.base64URLStringToBuffer(f.signature))},signMessageWithCrossAppWallet(a,{address:b,chainId:d}){let e=r?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b));return Dk({user:r,client:c,address:b,requesterAppId:f.id,request:{method:e?"privy_signSmartWalletMessage":"personal_sign",params:[a,b],chainId:d},reconnect:aF})},signTypedDataWithCrossAppWallet(a,{address:b,chainId:d}){let e=r?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b)),g=(0,cw.m)(a);return Dk({user:r,client:c,address:b,requesterAppId:f.id,request:{method:e?"privy_signSmartWalletTypedData":"eth_signTypedData_v4",params:[b,g],chainId:d},reconnect:aF})},sendTransactionWithCrossAppWallet(a,{address:b}){let d=r?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b));return Dk({user:r,client:c,address:b,requesterAppId:f.id,request:{method:d?"privy_sendSmartWalletTx":"eth_sendTransaction",params:[a],chainId:a.chainId},reconnect:aF})},signTransactionWithCrossAppWallet(a,{address:b}){let d=r?.linkedAccounts.some(a=>"cross_app"===a.type&&a.smartWallets.some(a=>a.address===b));return Dk({user:r,client:c,address:b,requesterAppId:f.id,request:{method:d?"privy_signSmartWalletTx":"eth_signTransaction",params:[a],chainId:a.chainId},reconnect:aF})},isModalOpen:g||!!o,mfaMethods:f.mfa.methods};i=aG.signMessage,j=aG.signTypedData,l=async(a,b)=>await aA({transaction:a,...b,signOnly:!1}),k=async(a,b)=>({signature:(await aA({transaction:a,...b,signOnly:!0})).hash});let aH={privy:d,setAuthenticated:ak,setUser:s,setIsNewUser:x,isNewUserThisSession:w,pendingTransaction:null,walletConnectionStatus:C,setWalletConnectionStatus:D,connectors:c.connectors?.walletConnectors??[],rpcConfig:f.rpcConfig,chains:f.chains,appId:b.appId,showFiatPrices:"native-token"!==f.embeddedWallets.priceDisplay.primary,clientAnalyticsId:c.clientAnalyticsId,onCustomAuthAuthenticated:aq,hideWalletUIs:an,isHeadlessSigning:(0,U.useCallback)(ao,[f.embeddedWallets.showWalletUIs]),emailOtpState:G,setEmailOtpState:H,smsOtpState:I,setSmsOtpState:J,oAuthState:M,setOAuthState:N,telegramAuthState:O,setTelegramAuthState:P,siweState:K,setSiweState:L,isHeadlessOAuthLoading:A,baseAccountSdk:u,setBaseAccountSdk:v,nativeTokenSymbolForChainId:a=>f.chains.find(b=>b.id===Number(a))?.nativeCurrency.symbol,initializeWalletProxy:async a=>{if(Q)return Q;let b=new Promise(a=>{$.current=a}),c=new Promise(b=>setTimeout(()=>b(null),a)),d=await Promise.race([b,c]);return $.current=null,d},getAuthFlow:()=>c.authFlow,getAuthMeta:()=>c.authFlow?.meta,client:c,closePrivyModal:async(a={shouldCallAuthOnSuccess:!0,isSuccess:!1})=>{let d,g=p&&ai&&r;if(g&&al.current&&(d=aC(r)),"login"===am.current)a.shouldCallAuthOnSuccess&&g&&al.current?(0,fH.e)(af,"login","onComplete",{user:r,isNewUser:w,wasAlreadyAuthenticated:!1,loginMethod:al.current,loginAccount:d??null}):(0,fH.e)(af,"login","onError",cy.b.USER_EXITED_AUTH_FLOW);else if("link"===am.current&&d)a.isSuccess&&g&&al.current?(0,fH.e)(af,"linkAccount","onSuccess",{user:r,linkMethod:al.current,linkedAccount:d}):al.current&&(0,fH.e)(af,"linkAccount","onError",cy.b.USER_EXITED_LINK_FLOW,{linkMethod:al.current});else if("update"===am.current&&d)a.isSuccess&&g&&al.current?(0,fH.e)(af,"update","onSuccess",{user:r,updateMethod:al.current,updatedAccount:d}):al.current&&(0,fH.e)(af,"update","onError",cy.b.USER_EXITED_UPDATE_FLOW,{linkMethod:al.current});else if("connect-or-create"===am.current){let a=DC.getState().ethereum;a[0]?(0,fH.e)(af,"connectOrCreateWallet","onSuccess",{wallet:a[0]}):(0,fH.e)(af,"connectOrCreateWallet","onError",cy.b.USER_EXITED_AUTH_FLOW)}let i=y&&Dr.has(y),j="ErrorScreen"===y&&V.errorModalData&&Dr.has(V.errorModalData.previousScreen);if((i||j)&&V.funding){let a,c=Dr.get(y)??null;if(j&&V.funding?.onError){let a=V.errorModalData?.error,b=a?.privyErrorCode||cy.b.UNKNOWN_FUNDING_ERROR,c=new cy.a(a?.message||"Funding failed",a,b);V.funding?.onError?.(c)}if("solana"===V.funding.chainType){let b=f.solanaRpcs[V.funding.chain];if(!b)return void console.warn("Unable to load solana rpc, skipping balance");if(e(fF.S))try{a=await Dt({rpc:b.rpc,address:V.funding.address})}catch{console.error("Unable to pull wallet balance")}else console.warn("Unable to load solana plugin, skipping balance");(0,fH.e)(af,"fundSolanaWallet","onUserExited",{address:V.funding.address,fundingMethod:c,chain:V.funding.chain,balance:a})}else{let d=(0,wR.g)(V.funding.chain.id,f.chains,f.rpcConfig,{appId:b.appId});try{a=await d.getBalance({address:V.funding.address})}catch{console.error("Unable to pull wallet balance")}(0,fH.e)(af,"fundWallet","onUserExited",{address:V.funding.address,chain:V.funding.chain,fundingMethod:c,balance:a}),function(a,b){if(a.onComplete)switch(b){case"external":a.fundingResult?a.onComplete({...a.fundingResult,fundingMethod:b}):a.onComplete({status:"cancelled",address:a.address,fundingMethod:b,amount:a.amount});break;case null:a.onComplete({status:"cancelled",address:a.address,fundingMethod:void 0,amount:a.amount});break;default:a.onComplete({status:"completed",address:a.address,fundingMethod:b,amount:a.amount})}}(V.funding,c)}}W(a=>({...a,externalConnectWallet:{}})),am.current=null,al.current=null,x(!1),h(!1),D({status:"disconnected",connectedWallet:null,connector:null,connectError:null,connectRetry:()=>{}}),setTimeout(()=>{c.authFlow=void 0},200)},openPrivyModal:ap,connectWallet:au,initLoginWithWallet:async(a,b,c,d)=>{(0,cw.f)(a)?(al.current="siwe",av(a,b,c)):(al.current="siws",aw(a,b,c,d))},loginWithWallet:async()=>{let a,b,d;if(!p)throw new cy.g;if(c.authFlow instanceof Co?a="siwe":c.authFlow instanceof Cp&&(a="siws"),!a)throw new cy.a("Must initialize SIWE/SIWS flow first.");if(null!==await c.getAccessToken())try{({user:b}=await c.link()),al.current=a}catch(b){throw(0,fH.e)(af,"linkAccount","onError",b.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a}),b}else try{({user:b,isNewUser:d}=await c.authenticate()),al.current=a}catch(a){throw(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.GENERIC_CONNECT_WALLET_ERROR),a}s(b||r||null),x(d||!1),ak(!0)},delegateWallet:async({address:a,chainType:b,showDelegationUIs:c})=>new Promise(async(d,e)=>{let f=await B0();if(!ai||!r||!f)throw new cy.a("User must be authenticated and have an embedded wallet to delegate actions.");if("solana"!==b&&"ethereum"!==b)throw new cy.a("Only Solana and Ethereum embedded wallets are supported for delegation and revocation.");let g=aH.walletProxy??await aH.initializeWalletProxy(15e3);if(!g)throw new cy.a("Wallet proxy not initialized.");if((({address:a,user:b})=>!!Df(b).find(b=>b.address===a))({address:a,user:r}))return d();let h=(0,cu.h)(r,a);if(!h)throw new cy.a("Address to delegate is not associated with current user.");if((0,cu.d)(h))throw new cy.a("useDelegatedActions is only supported for on-device execution and this app uses TEE execution. Use the useSessionSigners hook to provision server side access on behalf of your users. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");let i=(({address:a,user:b})=>{let c=b.linkedAccounts.find(b=>"wallet"===b.type&&"privy"===b.walletClientType&&b.address===a);if(!c)throw new cy.a("Address to delegate is not associated with current user.");if(!(0,cz.i)(c))throw new cy.a(`useDelegatedActions is not supported for ${c.chainType} wallets. Use the useSessionSigners hook to provision server side access on behalf of your users.`);return{address:c.address,chainType:c.chainType,walletIndex:c.walletIndex??0}})({address:a,user:r}),j=(({address:a,user:b})=>{let c=b.linkedAccounts.find(b=>"wallet"===b.type&&"privy"===b.walletClientType&&b.address===a);if(!c)throw new cy.a("Address to delegate is not associated with current user.");let d=c.imported?c:(0,cu.g)(b);if(!d)throw new cy.a("Unable to determine root address for delegated address.");if(!(0,cz.i)(d))throw new cy.a(`useDelegatedActions is not supported for ${d.chainType} wallets. Use the useSessionSigners hook to provision server side access on behalf of your users.`);return{address:d.address,chainType:d.chainType,imported:d.imported}})({address:a,user:r}),k=async()=>{await g.createDelegatedAction({accessToken:f,rootWallet:j,delegatedWallets:[i]}),await aH.refreshSessionAndUser()};if(await aH.recoverEmbeddedWallet({address:a}),c)W({delegatedActions:{consent:{address:a,onDelegate:k,onSuccess:async()=>{d()},onError:async a=>{e(a)}}}}),ap("DelegatedActionsConsentScreen");else try{await k(),d()}catch(a){e(a)}}),revokeDelegatedWallets:async({showDelegationUIs:a})=>new Promise(async(b,d)=>{if(!ai||!r)throw new cy.a("User must be authenticated and have an embedded wallet to revoke a delegated wallet.");let e=Df(r);if(0===e.length)throw new cy.a("User has no delegated wallets to revoke.");if(e.some(cu.d))throw new cy.a("useDelegatedActions is only supported for on-device execution and this app uses TEE execution. Use the useSessionSigners hook to provision server side access on behalf of your users. Learn more at https://docs.privy.io/recipes/tee-wallet-migration-guide");let f=async()=>{await c.revokeDelegatedWallet(),await aH.refreshSessionAndUser()};if(a)W({delegatedActions:{revoke:{onRevoke:f,onSuccess:async()=>{b()},onError:async a=>{d(a)}}}}),ap("DelegatedActionsRevokeScreen");else try{await f(),b()}catch(a){d(a)}}),initLoginWithFarcaster:async(a,b)=>{let d=new Cd(a,b);c.startAuthFlow(d);try{al.current="farcaster",await d.initializeFarcasterConnect()}catch(a){throw"login"===am.current?(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR):"link"===am.current&&(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR,{linkMethod:"farcaster"}),a}},loginWithFarcaster:async()=>{let a,b;if(!p)throw new cy.g;if(!(c.authFlow instanceof Cd))throw new cy.a("Must initialize Farcaster flow first.");if(null!==await c.getAccessToken())try{({user:a}=await c.link()),al.current="farcaster"}catch(a){throw(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"farcaster"}),a}else try{({user:a,isNewUser:b}=await c.authenticate()),al.current="farcaster"}catch(a){throw(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}s(a||null),x(b||!1),ak(!0)},async crossAppAuthFlow({appId:a,popup:b,action:d}){let e=`privy:${a}`;al.current=e;let{url:f,stateCode:g,codeVerifier:h}=await async function({api:a,appId:b}){let c=Ch(),d=Ci(),e=await Cj(c);try{let{url:f}=await a.post(fc,{provider:`privy:${b}`,redirect_to:window.location.href,code_challenge:e,state_code:d});return{url:f,stateCode:d,codeVerifier:c}}catch(a){throw(0,cy.f)(a)}}({api:c.api,appId:a});if(!f)throw c.createAnalyticsEvent({eventName:"cross_app_auth_error",payload:{error:"Unable to open cross-app auth popup",appId:a}}),new cy.a("No authorization URL returned for cross-app auth.");try{let i=await async function({url:a,popup:b}){return b.location=a,new Promise((a,c)=>{let d,e=setTimeout(()=>{c(new cy.a("Authorization request timed out after 2 minutes.")),f()},12e4);function f(){b?.close(),window.removeEventListener("message",h)}let g=setInterval(()=>{b?.closed&&!d&&(f(),clearInterval(g),clearTimeout(e),c(new cy.a("User rejected request")))},300);function h(b){b.data&&("PRIVY_OAUTH_RESPONSE"===b.data.type&&b.data.stateCode&&b.data.authorizationCode&&(clearTimeout(e),a(b.data),f()),"PRIVY_OAUTH_ERROR"===b.data.type&&(clearTimeout(e),c(new cy.a(b.data.error)),f()),b.data.type===Dh&&((d=new BroadcastChannel(Dg)).onmessage=h))}window.addEventListener("message",h)})}({url:f,popup:b,provider:e}),j=i.stateCode,k=i.authorizationCode;if(j!==g)throw c.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:e,storedStateCode:g??"",returnedStateCode:j??""}}),new cy.a("Unexpected auth flow. This may be a phishing attempt.",void 0,cy.b.OAUTH_UNEXPECTED);let l=await async function({appId:a,stateCode:b,codeVerifier:c,authorizationCode:d,action:e,client:f}){if(!d||!b)throw new cy.a("[Cross-App AuthFlow] Authorization and state codes code must be set prior to calling authenicate.");if("undefined"===d)throw new cy.a("User denied confirmation during cross-app auth flow");try{let g=new Di({authorizationCode:d,stateCode:b,codeVerifier:c,provider:`privy:${a}`});f.startAuthFlow(g);let h="link"===e?await f.link():await f.authenticate(),i=h.oAuthTokens?.accessToken;return console.debug(),i}catch(b){let a=(0,cy.f)(b);if(a.privyErrorCode===cy.b.ACCOUNT_TRANSFER_REQUIRED)throw a;if(a.privyErrorCode)throw new cy.a(a.message||"Invalid code during cross-app auth flow.",void 0,a.privyErrorCode);if("User denied confirmation during cross-app auth flow"===a.message)throw new cy.a("Invalid code during cross-app auth flow.",void 0,cy.b.OAUTH_USER_DENIED);throw new cy.a("Invalid code during cross-app auth flow.",void 0,cy.b.UNKNOWN_AUTH_ERROR)}}({appId:a,codeVerifier:h,stateCode:j,authorizationCode:k,action:d,client:c});l&&c.storeProviderAccessToken(a,l);let m=await aH.refreshSessionAndUser();if(!m)throw new cy.a("Unable to update user");return c.createAnalyticsEvent({eventName:"cross_app_auth_completed",payload:{providerAppId:a}}),m}catch(a){throw c.createAnalyticsEvent({eventName:"cross_app_auth_error",payload:{error:a.toString(),provider:e}}),a}},async initLoginWithOAuth(a,b,d){if(al.current=a,!(0,cz.e)()||"google"===a&&!f.allowOAuthInEmbeddedBrowsers&&Ds(window.navigator.userAgent))return void ap("InAppBrowserLoginNotPossible");"twitter"===a&&window.opener&&window.opener.postMessage({type:Dh},"*"),cz.u.del(eB.H),cz.u.del(eB.O);let e=new Ck({provider:a,disableSignup:!!d,withPrivyUi:!0,customOAuthRedirectUrl:f.customOAuthRedirectUrl});b&&e.addCaptchaToken(b),c.startAuthFlow(e);let g=await c.authFlow.getAuthorizationUrl();if(g&&g.url)if("twitter"===a&&eC.isAndroid&&(g.url=g.url.replace("x.com","twitter.com")),"chrome-extension:"!==window.location.protocol||1)window.location.assign(g.url);else try{let{privyOAuthCode:a,privyOAuthState:b}=await Cf(g.url);ap("OAuthStatusScreen"),e.meta.stateCode=b,e.meta.authorizationCode=a}catch(a){throw console.error("OAuth in chrome extension flow failed:",a),a}},async initLoginWithTelegram(a,b){if(!p)throw new cy.g;al.current="telegram";let d=new Cw(a,b);c.startAuthFlow(d),P({status:"loading"}),d.meta.telegramWebAppData=void 0,d.meta.telegramAuthResult=await new Promise((a,b)=>f.loginConfig.telegramAuthConfiguration?window.Telegram?void window.Telegram.Login.auth({bot_id:f.loginConfig.telegramAuthConfiguration.botId,request_access:!0},c=>c?a(c):("link"===am.current?(0,fH.e)(af,"linkAccount","onError",cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"telegram"}):"login"===am.current?(0,fH.e)(af,"login","onError",cy.b.INVALID_CREDENTIALS):"update"===am.current&&(0,fH.e)(af,"login","onError",cy.b.FAILED_TO_UPDATE_ACCOUNT),b(new cy.a("Telegram auth failed or was canceled by the client")))):b(new cy.a("Telegram was not initialized")):b(new cy.a("Telegram Auth configuration is not loaded")))},async loginWithTelegram(a){let b,d;if(!(c.authFlow instanceof Cw))throw new cy.a("Must initialize Telegram flow before calling loginWithTelegram");c.authFlow.meta.captchaToken||=a?.captchaToken;let e=await B0(),f=a?.intent||am.current;if("login"===f)try{let a=await c.authenticate();b=a.user,d=a.isNewUser,al.current="telegram"}catch(a){throw(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}else{if("link"!==f)throw new cy.a("Unknown auth intent");try{b=(await c.link()).user,al.current="telegram"}catch(a){throw(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"telegram"}),a}}s(b),x(d||!1),ak(!0),P({status:"done"});let g=b?.linkedAccounts.find(({type:a})=>"telegram"===a)||null;return{user:b,isNewUser:d||!1,wasAlreadyAuthenticated:!!e,loginAccount:g}},async loginWithOAuth(a){let b,d,e;if(!(c.authFlow instanceof Ck))throw new cy.a("Must initialize OAuth flow before calling loginWithOAuth");let f=cz.u.get(eB.S),g=c.authFlow.meta.stateCode;if(f!==g)throw c.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:a,storedStateCode:f??"",returnedStateCode:g??""}}),new cy.a("Unexpected auth flow. This may be a phishing attempt.",void 0,cy.b.OAUTH_UNEXPECTED);if(null!==await c.getAccessToken())try{let d=await c.link();b=d.user,e=d.oAuthTokens,al.current=a}catch(b){throw(0,fH.e)(af,"linkAccount","onError",b.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a}),b}else try{let f=await c.authenticate();b=f.user,d=f.isNewUser,e=f.oAuthTokens,al.current=a}catch(b){throw"login"===am.current?(0,fH.e)(af,"login","onError",b.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR):"link"===am.current&&(0,fH.e)(af,"linkAccount","onError",b.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a}),b}return s(b),x(d||!1),ak(!0),e&&b&&(0,fH.e)(af,"oAuthAuthorization","onOAuthTokenGrant",{oAuthTokens:e,user:b}),e},passkeyAuthState:E,setPasskeyAuthState:F,async initSignupWithPasskey({captchaToken:a,withPrivyUi:b}){let d=new Cm({captchaToken:a,setPasskeyAuthState:F,hints:f.passkeys.registration?.hints});c.startAuthFlow(d),am.current="login";try{al.current="passkey",F({status:"generating-challenge"}),await d.initRegisterFlow(b),F({status:"awaiting-passkey"})}catch(a){throw F({status:"error",error:a}),(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}},async signupWithPasskey(){let a,b;if(!p)throw new cy.g;if(!(c.authFlow instanceof Cm))throw new cy.a("Must initialize Passkey flow first.");if("passkey"!==al.current){let a=new cy.a("Must init login with Passkey flow first.");throw F({status:"error",error:a}),a}let d=await B0();try{al.current="passkey",F({status:"awaiting-passkey"}),{user:a,isNewUser:b}=await c.authenticate()}catch(a){throw F({status:"error",error:a}),(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}s(a),x(b||!1),ak(!0),F({status:"done"});let e=a?.linkedAccounts.find(({type:a})=>"passkey"===a)||null;return{user:a,isNewUser:b||!1,wasAlreadyAuthenticated:!!d,loginAccount:e}},async initLoginWithPasskey({captchaToken:a,withPrivyUi:b}){let d=new Cm({captchaToken:a,setPasskeyAuthState:F,hints:void 0});c.startAuthFlow(d),am.current="login";try{al.current="passkey",F({status:"generating-challenge"}),await d.initAuthenticationFlow(b),F({status:"awaiting-passkey"})}catch(a){throw F({status:"error",error:a}),(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}},async loginWithPasskey(a){let b,d;if(!p)throw new cy.g;if(!(c.authFlow instanceof Cm))throw new cy.a("Must initialize Passkey flow first.");if(a?.credentialIds&&(c.authFlow.meta.allowedCredentialsIds=a.credentialIds),"passkey"!==al.current){let a=new cy.a("Must init login with Passkey flow first.");throw F({status:"error",error:a}),a}let e=await B0();try{al.current="passkey",F({status:"awaiting-passkey"}),{user:b,isNewUser:d}=await c.authenticate()}catch(a){throw F({status:"error",error:a}),(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}s(b),x(d||!1),ak(!0),F({status:"done"});let f=b?.linkedAccounts.find(({type:a})=>"passkey"===a)||null;return{user:b,isNewUser:d||!1,wasAlreadyAuthenticated:!!e,loginAccount:f}},async initLinkWithPasskey(a){let b=new Cm({captchaToken:a,hints:f.passkeys.registration?.hints});c.startAuthFlow(b),am.current="link",al.current="passkey",F({status:"generating-challenge"});try{await b.initLinkFlow(),F({status:"awaiting-passkey"})}catch(a){throw(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR,{linkMethod:"passkey"}),F({status:"error",error:a}),a}},async linkWithPasskey(){let a;if(!p)throw new cy.g;if(!(c.authFlow instanceof Cm))throw new cy.a("Must initialize Passkey flow first.");if("passkey"!==al.current)throw new cy.a("Must init login with Passkey flow first.");try{al.current="passkey",{user:a}=await c.link()}catch(a){throw(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"passkey"}),a}return s(a||r||null),F({status:"done"}),a},async initLoginWithHeadlessOAuth(a,b,d){if(!(0,cz.e)()||"google"===a&&!f.allowOAuthInEmbeddedBrowsers&&Ds(window.navigator.userAgent))throw Error("It looks like you're using an in-app browser.  To log in, please try again using an external browser.");let e=new Ck({provider:a,withPrivyUi:!1,disableSignup:d??!1,customOAuthRedirectUrl:f.customOAuthRedirectUrl});b&&e.addCaptchaToken(b),N({status:"loading"});let g=await c.startAuthFlow(e).getAuthorizationUrl();if(g?.url)if("chrome-extension:"!==window.location.protocol||1)window.location.assign(g.url);else try{let{privyOAuthCode:a,privyOAuthState:b}=await Cf(g.url);e.meta.stateCode=b,e.meta.authorizationCode=a,await this.loginWithHeadlessOAuth(e.meta)}catch(a){throw N({status:"error",error:a}),a}},async loginWithHeadlessOAuth(a){let b,d,e;B(!0),N({status:"loading"}),c.startAuthFlow(new Ck({...a,customOAuthRedirectUrl:f.customOAuthRedirectUrl}));let g=cz.u.get(eB.S),h=a.stateCode;if(g!==h)throw c.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:a.provider,storedStateCode:g??"",returnedStateCode:h??""}}),B(!1),new cy.a("Unexpected auth flow. This may be a phishing attempt.",void 0,cy.b.OAUTH_UNEXPECTED);if(null!==await c.getAccessToken())try{({user:b,oAuthTokens:e}=await c.link()),al.current=a.provider;let d=aC(b);b&&d&&(0,fH.e)(af,"linkAccount","onSuccess",{user:b,linkMethod:al.current,linkedAccount:d})}catch(b){throw B(!1),(0,fH.e)(af,"linkAccount","onError",b.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:a.provider}),b}else try{({user:b,isNewUser:d,oAuthTokens:e}=await c.authenticate()),al.current=a.provider;let f=aC(b);b&&f&&void 0!==d&&(0,fH.e)(af,"login","onComplete",{user:b,isNewUser:d,wasAlreadyAuthenticated:!1,loginMethod:al.current,loginAccount:f})}catch(a){throw B(!1),N({status:"error",error:a}),(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}return s(b),x(d||!1),ak(!0),B(!1),N({status:"done"}),e&&b&&(0,fH.e)(af,"oAuthAuthorization","onOAuthTokenGrant",{oAuthTokens:e,user:b}),b??void 0},initLoginWithEmail:async({email:a,captchaToken:b,disableSignup:d,withPrivyUi:e})=>{let f=new B3({email:a,captchaToken:b,disableSignup:d});c.startAuthFlow(f);try{al.current="email",H({status:"sending-code"});let a=await f.sendCodeEmail({withPrivyUi:e});if(a?.ssoRedirectUrl)return window.location.href=a.ssoRedirectUrl,void await (0,cw.k)(1e4);H({status:"awaiting-code-input"})}catch(a){throw H({status:"error",error:a}),"login"===am.current?(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR):"link"===am.current&&(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"email"}),a}},initUpdateEmail:async({oldAddress:a,newAddress:b,captchaToken:d})=>{let e=new B4(a,b,d);c.startAuthFlow(e);try{await e.sendCodeEmail({withPrivyUi:!0})}catch(a){throw(0,fH.e)(af,"update","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR,{linkMethod:al.current}),a}},initUpdatePhone:async(a,b,d)=>{let e=new Cr(a,b,d);c.startAuthFlow(e);try{await e.sendSmsCode({withPrivyUi:!0})}catch(a){(0,fH.e)(af,"update","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR,{linkMethod:al.current})}},initLoginWithSms:async({phoneNumber:a,captchaToken:b,disableSignup:d,withPrivyUi:e})=>{J({status:"sending-code"});let f=new Cq({phoneNumber:a,captchaToken:b,disableSignup:d});c.startAuthFlow(f);try{al.current="sms",await f.sendSmsCode({withPrivyUi:e}),J({status:"awaiting-code-input"})}catch(a){throw J({status:"error",error:a}),"login"===am.current?(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR):"link"===am.current&&(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"sms"}),a}},resendEmailCode:async()=>{await c.authFlow?.sendCodeEmail({withPrivyUi:!0})},resendSmsCode:async()=>{await c.authFlow?.sendSmsCode({withPrivyUi:!0})},loginWithCode:async a=>{let b,d;function e(a){c.authFlow instanceof B3?H(a):c.authFlow instanceof Cq&&J(a)}if(e({status:"submitting-code"}),!p){let a=new cy.g;throw e({status:"error",error:a}),a}if(c.authFlow instanceof B3)c.authFlow.meta.emailCode=a.trim();else{if(!(c.authFlow instanceof Cq)){let a=new cy.a("Must initialize a passwordless code flow first");throw e({status:"error",error:a}),a}c.authFlow.meta.smsCode=a.trim()}let f=await B0();if("link"===am.current)try{({user:b}=await c.link())}catch(a){throw e({status:"error",error:a}),(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:al.current}),a}else if("update"===am.current)try{({user:b}=await c.link())}catch(a){throw e({status:"error",error:a}),(0,fH.e)(af,"update","onError",a.privyErrorCode||cy.b.FAILED_TO_UPDATE_ACCOUNT,{linkMethod:al.current}),a}else try{({user:b,isNewUser:d}=await c.authenticate())}catch(a){throw e({status:"error",error:a}),(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),a}let g=b||r;s(g||null),x(d||!1),ak(!0),e({status:"done"});let h=null;return c.authFlow instanceof B3?h=g?.linkedAccounts.find(({type:a})=>"email"===a)||null:c.authFlow instanceof Cq&&(h=g?.linkedAccounts.find(({type:a})=>"phone"===a)||null),{user:g,isNewUser:d||!1,wasAlreadyAuthenticated:!!f,linkedAccount:h}},generateSiweMessage:async({address:a,chainId:b,captchaToken:d})=>{am.current=ai?"link":"login",al.current="siwe",L({status:"generating-message"});let e=await c.generateSiweNonce({address:a,captchaToken:d});return L({status:"awaiting-signature"}),Cn({address:a,chainId:b.replace("eip155:",""),nonce:e})},generateSiweMessageForSmartWallet:async({address:a,chainId:b})=>{let d=await c.generateSiweNonce({address:a});return Cn({address:a,chainId:b.replace("eip155:",""),nonce:d})},linkSmartWallet:async({message:a,signature:b,smartWalletType:d,smartWalletVersion:e})=>{let f;f=await c.linkSmartWallet({message:a,signature:b,smartWalletType:d,smartWalletVersion:e}),s((f=await aH.refreshSessionAndUser()??f)||r||null)},loginWithSiwe:async({message:a,signature:b,captchaToken:d,disableSignup:e,walletClientType:f,connectorType:g})=>{let h,i=null;try{if(r)throw Error("User already authenticated");let j=new Co(c,void 0,d,e,{message:a,signature:b,walletClientType:f,connectorType:g});c.startAuthFlow(j),al.current="siwe",am.current="login",L({status:"submitting-signature"});let k=await c.authenticate();if({user:i,isNewUser:h}=k,!i)throw Error("Authentication failed - no user returned")}catch(a){throw(0,fH.e)(af,"login","onError",a.privyErrorCode||cy.b.UNKNOWN_AUTH_ERROR),L({status:"error",error:a}),a}return s(i),x(h||!1),ak(!0),L({status:"done"}),am.current=null,al.current=null,{user:i,isNewUser:h||!1}},linkWithSiwe:async({message:a,signature:b,chainId:d,walletClientType:e,connectorType:f})=>{let g;ay("siwe");let h=null;try{L({status:"submitting-signature"}),g=await c.linkWithSiwe({message:a,signature:b,chainId:d,walletClientType:e,connectorType:f}),g=await aH.refreshSessionAndUser()??g,L({status:"done"}),(h=aC(g)||null)&&(0,fH.e)(af,"linkAccount","onSuccess",{user:g,linkMethod:"siwe",linkedAccount:h})}catch(a){throw(0,fH.e)(af,"linkAccount","onError",a.privyErrorCode||cy.b.FAILED_TO_LINK_ACCOUNT,{linkMethod:"siwe"}),am.current=null,al.current=null,L({status:"error",error:a}),a}let i=g||r;return s(i||null),am.current=null,al.current=null,{user:i,linkedAccount:h}},refreshSessionAndUser:async()=>{let a=await c.getAuthenticatedUser();return ak(!!a),s(a),a},walletProxy:Q,createAnalyticsEvent:({eventName:a,payload:b,timestamp:d})=>c.createAnalyticsEvent({eventName:a,payload:b,timestamp:d}),acceptTerms:async()=>{let a=await c.acceptTerms();return s(a),a},getUsdTokenPrice:a=>c.getUsdTokenPrice(a),getUsdPriceForSol:()=>c.getUsdPriceForSol(),getSplTokenMetadata:a=>c.getSplTokenMetadata(a),recoverEmbeddedWallet:async a=>new Promise(async(b,d)=>{if(!r)return void b(!0);let e=a?.address?(0,cu.h)(r,a.address):(0,cu.g)(r)||(0,cu.f)(r).at(0)||(0,cu.j)(r).at(0);if(!e||(0,cu.d)(e))return void b(!0);let f=await B0();if(!f||!Q||!e)return void d(Error("Must have valid access token and Privy wallet to recover wallet"));let{entropyId:g,entropyIdVerifier:h}=(0,cx.g)(r,e);try{await Q.connect({accessToken:f,entropyId:g,entropyIdVerifier:h}),b(!0)}catch(a){if(C0(a)&&"privy"===e.recoveryMethod){let a;c.createAnalyticsEvent({eventName:"embedded_wallet_pinless_recovery_started",payload:{walletAddress:e.address}});try{a=await Q.recover({entropyId:g,entropyIdVerifier:h,accessToken:f})}catch(a){return void d(a)}a.entropyId||d(Error("Unable to recover wallet")),c.createAnalyticsEvent({eventName:"embedded_wallet_recovery_completed",payload:{walletAddress:e.address}}),b(!0)}else C0(a)&&"privy"!==e.recoveryMethod&&"privy-v2"!==e.recoveryMethod?(W({recoverWallet:{entropyId:g,entropyIdVerifier:h,onFailure:d,onSuccess:()=>b(!0)},recoveryOAuthStatus:{provider:e.recoveryMethod,action:"recover",shouldCreateEth:!1,shouldCreateSol:!1}}),ap(Dp(e.recoveryMethod))):d(a)}}),setReadyToTrue:a=>{q(!0),Y?.(a)},updateWallets:()=>az(),fundWallet:async(a,b)=>{let c="FundingMethodSelectionScreen";return new Promise((d,e)=>{W({funding:{...(0,cz.p)({address:a,appConfig:f,fundWalletConfig:b,methodScreen:c,onComplete:d,onError:e})}}),ap(c)})},openModal:ap,requestFarcasterSignerStatus:async a=>{let b=await B0(),d=r?.linkedAccounts.find(a=>"wallet"===a.type&&"privy"===a.walletClientType);if(!b)throw Error("Must have valid access token to connect with Farcaster");if(!Q||!d)throw Error("Must have an embedded wallet to use Farcaster signers");if(!r?.farcaster?.fid)throw Error("Must have Farcaster account to use Farcaster signers");let e=await c.requestFarcasterSignerStatus(a);return"approved"===e.status&&s(await c.getAuthenticatedUser()||r||null),e},connectCoinbaseSmartWallet:async()=>{f.externalWallets.coinbaseWallet.config.preference={...f.externalWallets.coinbaseWallet.config.preference,options:"smartWalletOnly"};let a=c.connectors?.findWalletConnector("coinbase_wallet","coinbase_smart_wallet")||c.connectors?.findWalletConnector("coinbase_wallet","coinbase_wallet");if(a)return a.updateConnectionPreference("smartWalletOnly"),au(a);await at("coinbase_wallet","coinbase_smart_wallet")},connectBaseAccount:async()=>{let a=c.connectors?.findWalletConnector("base_account","base_account");if(a)return au(a);await at("base_account","base_account")},initiateAccountTransfer:async({nonce:a,account:b,accountType:d,externalWalletMetadata:e,telegramAuthResult:f,telegramWebAppData:g,farcasterEmbeddedAddress:h,oAuthUserInfo:i})=>{let j=await c.sendAccountTransferRequest({nonce:a,account:b,accountType:d,externalWalletMetadata:e,telegramAuthResult:f,telegramWebAppData:g,farcasterEmbeddedAddress:h,oAuthUserInfo:i});return s(j),j},inProgressAuthFlowRef:am,inProgressLoginOrLinkMethodRef:al};m=aH.recoverEmbeddedWallet,aH.recoverEmbeddedWallet;let aI=(0,U.useMemo)(()=>({wallets:t,ready:_&&ag}),[t,_,ag]),aJ=c.authFlow instanceof Cw,{enabled:aK,siteKey:aL,provider:aM}=f.captcha,aN=!f.headless&&aK&&!ai&&(p||aJ);return(0,T.jsx)(DG.Provider,{value:!0,children:(0,T.jsx)(cu.P.Provider,{value:aG,children:(0,T.jsx)(fH.P.Provider,{value:af,children:(0,T.jsx)(cx.U.Provider,{value:aI,children:(0,T.jsx)(Cu,{appId:f.id,captchaEnabled:aK,captchaSiteKey:aL,captchaProvider:aM,children:(0,T.jsxs)(cy.I.Provider,{value:aH,children:[(0,T.jsx)(cw.R,{children:(0,T.jsxs)(cu.M,{data:V,setModalData:W,setInitialScreen:z,initialScreen:y,authenticated:ai,open:g,children:[b.children,(0,T.jsx)(DF,{customAuth:f.customAuth}),aN&&(0,T.jsx)(CC,{delayedExecution:!1}),(0,T.jsx)(CX,{}),(0,T.jsx)(DB,{disabled:f.embeddedWallets.disableAutomaticMigration}),(0,T.jsx)(CF,{palette:f.appearance.palette||{}}),!f.render.standalone&&(0,T.jsx)(CS,{open:g})]})}),(0,T.jsx)(De,{appId:b.appId,appClientId:b.clientId,clientAnalyticsId:c.clientAnalyticsId,origin:c.apiUrl,mfaMethods:r?.mfaMethods,mfaPromise:ad,mfaSubmitPromise:ae,onLoad:R,onLoadFailed:()=>null}),f.loginConfig.telegramAuthConfiguration&&(0,T.jsx)(cw.H,{$if:!0,children:(0,T.jsx)(CW,{scriptHost:b.apiUrl||eB.D,botUsername:f.loginConfig.telegramAuthConfiguration.botName})})]})})})})})})};class DI extends Error{constructor(a,b,c){super(a),this.code=b,this.data=c}}class DJ extends cv.default{async handleSendTransaction(a){let b;if(!a.params||!Array.isArray(a.params))throw new DI(`Invalid params for ${a.method}`,4200);let c=a.params[0];if(!await B0()||!this.address)throw new DI("Disconnected",4900);let{hash:d}=await (b={address:this.address},l(c,b));return d}async handleSignTransaction(a){let b;if(!a.params||!Array.isArray(a.params))throw new DI(`Invalid params for ${a.method}`,4200);let c=a.params[0];if(!await B0()||!this.address)throw new DI("Disconnected",4900);let{signature:d}=await (b={address:this.address},k(c,b));return d}handleSwitchEthereumChain(a){let b;if(!a.params||!Array.isArray(a.params))throw new DI(`Invalid params for ${a.method}`,4200);if("string"==typeof a.params[0])b=a.params[0];else{if(!("chainId"in a.params[0])||"string"!=typeof a.params[0].chainId)throw new DI(`Invalid params for ${a.method}`,4200);b=a.params[0].chainId}this.chainId=Number(b),this.publicClient=(0,wR.g)(this.chainId,this.chains,this.rpcConfig,{appId:this.appId}),this.emit("chainChanged",b)}async handlePersonalSign(a){if(!a.params||!Array.isArray(a.params))throw Error("Invalid params for personal_sign");let b=a.params[0],c=a.params[1],{signature:d}=await i({message:b},{address:c});return d}async handleSignedTypedData(a){let b;if(!a.params||!Array.isArray(a.params))throw Error("Invalid params for eth_signTypedData_v4");let c=a.params[0],d="string"==typeof a.params[1]?JSON.parse(a.params[1]):a.params[1],{signature:e}=await (b=(0,cw.m)(d),j(b,{address:c}));return e}async handleEstimateGas(a){if(!a.params||!Array.isArray(a.params))throw Error("Invalid params for eth_estimateGas");delete a.params[0].gasPrice,delete a.params[0].maxFeePerGas,delete a.params[0].maxPriorityFeePerGas;let b={...a.params[0],chainId:(0,cw.t)(this.chainId)};return await this.publicClient.estimateGas({account:b.from??this.address,...(0,eA.toViemTransactionSerializable)(b)})}async request(a){let b;switch(console.debug("Embedded1193Provider.request() called with args",a),a.method){case"eth_accounts":case"eth_requestAccounts":return this.address?[this.address]:[];case"eth_chainId":return(0,cw.t)(this.chainId);case"eth_estimateGas":return this.handleEstimateGas(a);case"eth_sendTransaction":return this.handleSendTransaction(a);case"eth_signTransaction":return this.handleSignTransaction(a);case"wallet_switchEthereumChain":return this.handleSwitchEthereumChain(a);case"personal_sign":return this.handlePersonalSign(a);case"eth_signTypedData_v4":return this.handleSignedTypedData(a)}if(b=a.method,!B1.includes(b))return this.publicClient.request({method:a.method,params:a.params});{let b,c=await B0();if(await (b={address:this.address},m(b)),!c||!this.address)throw new DI("Disconnected",4900);try{let b={method:a.method,params:a.params},d=this.walletAccount;return d&&(0,cu.d)(d)?this.handleWalletApiRequest(b,d,c):(await this.walletProxy.rpc({accessToken:c,entropyId:this.entropyId,entropyIdVerifier:this.entropyIdVerifier,chainType:"ethereum",hdWalletIndex:this.walletIndex,request:b})).response.data}catch(a){throw console.error(a),new DI("Disconnected",4900)}}}async handleWalletApiRequest(a,b,c){let d=this.privyClient;if(!d)throw new DI("Disconnected",4900);if("secp256k1_sign"===a.method){let e=await (0,X.rpc)(d,async({message:a})=>this.walletProxy.signWithUserSigner({accessToken:c,message:a}),{chain_type:"ethereum",method:"secp256k1_sign",wallet_id:b.id,params:{hash:a.params[0]}});if("secp256k1_sign"!==e.method)throw new DI(`Invalid params for ${a.method}`,4200);return e.data.signature}throw new DI(`Method not supported: ${a.method}`,4200)}constructor({walletProxy:a,address:b,entropyId:c,entropyIdVerifier:d,rpcConfig:e,chains:f,appId:g,chainId:h=1,walletIndex:i,privyClient:j,walletAccount:k}){super(),this.walletProxy=a,this.address=b,this.entropyId=c,this.entropyIdVerifier=d,this.chainId=h,this.rpcConfig=e,this.chains=f,this.publicClient=(0,wR.g)(h,this.chains,e,{appId:g}),this.rpcTimeoutDuration=(0,cw.c)(e,"privy"),this.appId=g,this.walletIndex=i,this.privyClient=j,this.walletAccount=k}}let DK=({style:a,...b})=>(0,T.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",style:{...a},...b,children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"})}),DL=({style:a,...b})=>(0,T.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"108",height:"108",viewBox:"0 0 108 108",fill:"none",style:{height:"28px",width:"28px",...a},...b,children:[(0,T.jsx)("rect",{width:"108",height:"108",rx:"23",fill:"#AB9FF2"}),(0,T.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M46.5267 69.9229C42.0054 76.8509 34.4292 85.6182 24.348 85.6182C19.5824 85.6182 15 83.6563 15 75.1342C15 53.4305 44.6326 19.8327 72.1268 19.8327C87.768 19.8327 94 30.6846 94 43.0079C94 58.8258 83.7355 76.9122 73.5321 76.9122C70.2939 76.9122 68.7053 75.1342 68.7053 72.314C68.7053 71.5783 68.8275 70.7812 69.0719 69.9229C65.5893 75.8699 58.8685 81.3878 52.5754 81.3878C47.993 81.3878 45.6713 78.5063 45.6713 74.4598C45.6713 72.9884 45.9768 71.4556 46.5267 69.9229ZM83.6761 42.5794C83.6761 46.1704 81.5575 47.9658 79.1875 47.9658C76.7816 47.9658 74.6989 46.1704 74.6989 42.5794C74.6989 38.9885 76.7816 37.1931 79.1875 37.1931C81.5575 37.1931 83.6761 38.9885 83.6761 42.5794ZM70.2103 42.5795C70.2103 46.1704 68.0916 47.9658 65.7216 47.9658C63.3157 47.9658 61.233 46.1704 61.233 42.5795C61.233 38.9885 63.3157 37.1931 65.7216 37.1931C68.0916 37.1931 70.2103 38.9885 70.2103 42.5795Z",fill:"#FFFDF8"})]});function DM(a,b){if(!Object.prototype.hasOwnProperty.call(a,b))throw TypeError("attempted to use private field on non-instance");return a}var DN=0;class DO extends cw.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}get walletBranding(){return{name:this.providerDetail.info.name,icon:this.providerDetail.info.icon,id:this.providerDetail.info.rdns}}disconnect(){console.warn(`Programmatic disconnect with ${this.providerDetail.info.name} is not yet supported.`)}async promptConnection(){try{let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cy.P("Unable to retrieve accounts");await this.syncAccounts([a[0]])}catch(a){throw(0,cz.f)(a)}}constructor(a,b,c,d,e){super(e||"unknown",a,b,c),this.connectorType="injected",this.proxyProvider=new cw.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.providerDetail=d;let f=d.provider;this.proxyProvider.setWalletProvider(f)}}var DP="__private_"+DN+++"__walletBranding";class DQ extends cw.E{async initialize(){await this.syncAccounts(),this.initialized=!0,this.emit("initialized")}async connect(a){return a.showPrompt&&await this.promptConnection(),await this.isConnected()?this.getConnectedWallet():null}get walletBranding(){return DM(this,DP)[DP]??{name:"Browser Extension",icon:DK,id:"extension"}}disconnect(){console.warn("Programmatic disconnect with browser wallets is not yet supported.")}async promptConnection(){try{let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cy.P("Unable to retrieve accounts");await this.syncAccounts([a[0]])}catch(a){throw(0,cz.f)(a)}}constructor(a,b,c,d,e){super(e??"unknown",a,b,c),Object.defineProperty(this,DP,{writable:!0,value:void 0}),this.connectorType="injected",this.proxyProvider=new cw.P(void 0,this.rpcTimeoutDuration),this.subscribeListeners(),this.proxyProvider.setWalletProvider(d),"metamask"===e?DM(this,DP)[DP]={name:"MetaMask",icon:cw.M,id:"io.metamask"}:"phantom"===e&&(DM(this,DP)[DP]={name:"Phantom",icon:DL,id:"phantom"})}}class DR extends DO{disconnect(){console.warn("MetaMask does not support programmatic disconnect.")}async promptConnection(){try{eC.isMobile||await this.proxyProvider.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]});let a=await this.proxyProvider.request({method:"eth_requestAccounts"});if(!a||0===a.length||!a[0])throw new cy.P("Unable to retrieve accounts");await this.syncAccounts([a[0]])}catch(a){throw(0,cz.f)(a)}}}class DS extends cv.default{get wallets(){let a=new Set;return this.walletConnectors.flatMap(a=>a.wallets).sort((a,b)=>a.connectedAt&&b.connectedAt?b.connectedAt-a.connectedAt:0).filter(b=>{let c=`${b.address}${b.walletClientType}${b.connectorType}${b.meta.id}`;return!a.has(c)&&(a.add(c),!0)})}async initialize(a){if(this.initialized&&!a||(a&&this.removeAllConnectors(),this.externalWalletConfig.disableAllExternalWallets))return;let b=(0,cw.o)({store:this.store,walletList:this.walletList,externalWalletConfig:this.externalWalletConfig,walletChainType:this.walletChainType}).then(a=>{a.forEach(({type:a,eip6963InjectedProvider:b,legacyInjectedProvider:c})=>{this.createEthereumWalletConnector({connectorType:"injected",walletClientType:a,providers:{eip6963InjectedProvider:b,legacyInjectedProvider:c}})})});for(let a of(this.walletList.includes("coinbase_wallet")&&this.createEthereumWalletConnector({connectorType:"coinbase_wallet",walletClientType:"coinbase_wallet"}),this.walletList.includes("base_account")&&this.createEthereumWalletConnector({connectorType:"base_account",walletClientType:"base_account"}),Object.values(cw.q)))!a.isInstalled&&this.walletList.includes(a.client)&&(["ethereum-only","ethereum-and-solana"].includes(this.walletChainType)&&a.chainTypes.includes("ethereum")&&this.createEthereumWalletConnector({connectorType:"null",walletClientType:a.client,walletConfig:a}),["ethereum-and-solana","solana-only"].includes(this.walletChainType)&&a.chainTypes.includes("solana")&&this.addSolanaWalletConnector(new cw.S({id:a.client,name:a.name})));this.externalWalletConfig.walletConnect.enabled&&(this.walletList.includes("wallet_connect_qr")||(0,cw.e)(this.walletList))&&"solana-only"!==this.walletChainType&&this.createEthereumWalletConnector({connectorType:"wallet_connect_v2",walletClientType:"unknown"});let c=this.walletList.includes("wallet_connect_qr_solana"),d=this.externalWalletConfig.solana.connectors?.get()||[],e=async a=>{if(!c)return;let b=a.find(a=>"walletconnect_solana"===a.walletBranding?.id);b&&b.wallet&&await b.wallet.initialize({walletConnectCloudProjectId:this.walletConnectCloudProjectId,privyAppName:this.privyAppName})};e(d),d.filter(a=>c||"walletconnect_solana"!==a.walletBranding?.id).forEach(this.addSolanaWalletConnector),this.externalWalletConfig.solana.connectors?._setOnConnectorsUpdated?.(a=>{e(a),a?.filter(a=>c||"walletconnect_solana"!==a.walletBranding?.id).forEach(this.addSolanaWalletConnector)}),await b,this.initialized=!0}findWalletConnector(a,b,c){return"wallet_connect_v2"===a?this.walletConnectors.filter(cw.r).find(b=>b.connectorType===a&&(!c||b.wallets.some(a=>a.address===c)))??null:this.walletConnectors.filter(cw.r).find(d=>d.connectorType===a&&d.walletClientType===b&&(!c||d.wallets.some(a=>a.address===c)))??null}findSolanaWalletConnector(a){return this.walletConnectors.filter(cw.v).find(b=>"unknown"===b.walletClientType?b.walletBranding.id===a:b.walletClientType===a)??null}findEmbeddedWalletConnectors(){return this.walletConnectors.filter(a=>"embedded"===a.connectorType)}findImportedWalletConnectors(){return this.walletConnectors.filter(a=>"embedded_imported"===a.connectorType)}onInitialized(a){a.wallets.forEach(a=>{let b=this.storedConnections.find(b=>b.address===a.address&&b.connectorType===a.connectorType&&("solana"===a.type&&"unknown"===b.walletClientType&&"unknown"===a.walletClientType?a.meta.id===b.id:b.walletClientType===a.walletClientType));b&&(a.connectedAt=b.connectedAt)}),this.emit("walletsUpdated"),this.emit("connectorInitialized")}onWalletsUpdated(a){a.initialized&&this.emit("walletsUpdated")}addEmbeddedWalletConnectors({walletProxy:a,user:b,embeddedWallets:c,defaultChain:d,appId:e,privyClient:f}){let{entropyId:g,entropyIdVerifier:h}=(0,cx.g)(b);for(let b of c){let c=this.findEmbeddedWalletConnectors().find(a=>a.walletIndex===b.walletIndex);if(c&&(0,cw.r)(c))c.proxyProvider.walletProxy=a;else{let c=new B_({provider:new DJ({walletProxy:a,address:b.address,entropyId:g,entropyIdVerifier:h,rpcConfig:this.rpcConfig,chains:this.chains,appId:e,chainId:d.id,walletIndex:b.walletIndex,privyClient:f,walletAccount:b}),chains:this.chains,defaultChain:d,rpcConfig:this.rpcConfig,imported:!1,walletIndex:b.walletIndex});this.addWalletConnector(c)}}}addImportedWalletConnector(a,b,c,d){let e=this.findWalletConnector("embedded_imported","privy",b);if(e&&(0,cw.r)(e))e.proxyProvider.walletProxy=a;else{let e=new B_({provider:new DJ({walletProxy:a,address:b,entropyId:b,entropyIdVerifier:"ethereum-address-verifier",walletIndex:0,rpcConfig:this.rpcConfig,chains:this.chains,appId:d,chainId:c.id}),chains:this.chains,walletIndex:0,defaultChain:c,rpcConfig:this.rpcConfig,imported:!0});this.addWalletConnector(e)}}removeEmbeddedWalletConnectors(){this.walletConnectors=this.walletConnectors.filter(a=>"embedded"!==a.connectorType),this.storedConnections=(0,cz.l)(),this.emit("walletsUpdated")}removeImportedWalletConnectors(){let a=this.findImportedWalletConnectors();a.length&&(a.forEach(a=>{let b=this.walletConnectors.indexOf(a);this.walletConnectors.splice(b,1)}),this.storedConnections=(0,cz.l)(),this.emit("walletsUpdated"))}async createEthereumWalletConnector({connectorType:a,walletClientType:b,providers:c,walletConfig:d}){let e=this.findWalletConnector(a,b);if(e&&(0,cw.r)(e))return e instanceof CY&&e.resetConnection(b),e;let f="injected"!==a?"coinbase_wallet"===a?new BZ(this.chains,this.defaultChain,this.rpcConfig,this.externalWalletConfig.coinbaseWallet.config):"base_account"===a?new BX(this.chains,this.defaultChain,this.rpcConfig,this.externalWalletConfig.baseAccount.config,this.setBaseAccountSdk):"null"!==a?new CY({walletConnectCloudProjectId:this.walletConnectCloudProjectId,rpcConfig:this.rpcConfig,chains:this.chains,defaultChain:this.defaultChain,shouldEnforceDefaultChainOnConnect:this.shouldEnforceDefaultChainOnConnect,privyAppId:this.privyAppId,privyAppName:this.privyAppName,walletClientType:b}):d?new cw.w({id:d.client,name:d.name,defaultChain:this.defaultChain,walletClientType:d.client}):null:"metamask"===b&&c?.eip6963InjectedProvider?new DR(this.chains,this.defaultChain,this.rpcConfig,c?.eip6963InjectedProvider,"metamask"):"metamask"===b&&c?.legacyInjectedProvider?new DQ(this.chains,this.defaultChain,this.rpcConfig,c?.legacyInjectedProvider,"metamask"):"phantom"===b&&c?.legacyInjectedProvider?new DQ(this.chains,this.defaultChain,this.rpcConfig,c?.legacyInjectedProvider,"phantom"):c?.legacyInjectedProvider&&"unknown_browser_extension"===b?new DQ(this.chains,this.defaultChain,this.rpcConfig,c?.legacyInjectedProvider):c?.eip6963InjectedProvider?new DO(this.chains,this.defaultChain,this.rpcConfig,c?.eip6963InjectedProvider,b):void 0;return f&&this.addWalletConnector(f),f||null}addWalletConnector(a){this.walletConnectors.push(a),a.on("initialized",()=>this.onInitialized(a)),a.on("walletsUpdated",()=>this.onWalletsUpdated(a)),a.initialize().catch(a=>{console.debug("Failed to initialize connector",a)})}setWalletList(a){this.walletList=a,this.initialized&&this.initialize(!0).catch(console.error)}removeAllConnectors(){for(let a of this.walletConnectors)a.removeAllListeners();this.walletConnectors=[]}constructor(a,b,c,d,e,f,g,h,i,j,k,l){super(),this.addSolanaWalletConnector=async a=>{let b=this.findSolanaWalletConnector(a.walletClientType);if(!b||"null"===b.connectorType){if("null"===b?.connectorType){let a=this.walletConnectors.indexOf(b);this.walletConnectors.splice(a,1)}this.addWalletConnector(a)}},this.privyAppId=a,this.walletConnectCloudProjectId=b,this.rpcConfig=c,this.chains=d,this.defaultChain=e,this.walletConnectors=[],this.initialized=!1,this.store=f,this.walletList=g,this.shouldEnforceDefaultChainOnConnect=h,this.externalWalletConfig=i,this.privyAppName=j,this.walletChainType=l||"ethereum-only",this.setBaseAccountSdk=k,this.storedConnections=(0,cz.l)()}}let DT=(0,fI.create)(()=>({identityToken:null})),DU=[eJ,eK,fu];class DV{async get(a,b){try{return await this.baseFetch(a,b)}catch(a){throw(0,cy.f)(a)}}async post(a,b,c){try{return await this.baseFetch(a,{method:"POST",...b?{body:b}:{},...c})}catch(a){throw(0,cy.f)(a)}}async delete(a,b){try{return await this.baseFetch(a,{method:"DELETE",...b})}catch(a){throw(0,cy.f)(a)}}constructor({appId:a,appClientId:b,client:c,defaults:d}){this.appId=a,this.appClientId=b,this.clientAnalyticsId=c.clientAnalyticsId,this.sdkVersion=eB.V,this.client=c,this.defaults=d,this.fallbackApiUrl=c.fallbackApiUrl,this.baseFetch=wS.ofetch.create({baseURL:this.defaults.baseURL,timeout:this.defaults.timeout,retry:3,retryDelay:500,retryStatusCodes:[408,409,425,500,502,503,504],credentials:"include",onRequest:async({request:a,options:b})=>{let c=new Headers(b.headers);c.set("privy-app-id",this.appId),this.appClientId&&c.set("privy-client-id",this.appClientId),c.set("privy-ca-id",this.clientAnalyticsId||""),c.set("privy-client",`react-auth:${this.sdkVersion}`);let d=DU.includes(a.toString());if(!c.has("authorization")){let a=await this.client.getAccessToken({disableAutoRefresh:d});null!==a&&c.set("authorization",`Bearer ${a}`)}b.headers=c,b.retryDelay&&"number"==typeof b.retryDelay&&(b.retryDelay=3*b.retryDelay)},onRequestError:({error:a})=>{if(a instanceof DOMException&&"AbortError"===a.name)throw new cy.h}})}}class DW{getOrCreateGuestCredential(a){let b=(0,eB.g)(a);if((0,cz.e)()){if(cz.u.get(b))return cz.u.get(b);{let a=ct.base64url.encode(Cg(32));return cz.u.put(b,a),a}}return ct.base64url.encode(Cg(32))}async authenticate(){if(!this.api)throw new cy.a("Auth flow has no API instance");try{return await this.api.post(fx,{guest_credential:this.meta.guestCredential})}catch(a){throw(0,cy.f)(a)}}async link(){throw Error("Linking is not supported for the guest flow")}constructor(a){this.meta={guestCredential:this.getOrCreateGuestCredential(a)}}}function DX(){return!(eC.isSafari&&window.location.origin.startsWith("http://localhost"))}var DY,DZ,D$,D_,D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ei,Ej,Ek,El,Em,En,Eo,Ep,Eq,Er,Es,Et=((Es={}).PRIVY="privy_access_token",Es.CUSTOMER="customer_access_token",Es);class Eu{get token(){return this.privyAccessToken||this.customerAccessToken}getToken(a){return"privy_access_token"===a?this.privyAccessToken:this.customerAccessToken}get customerAccessToken(){return this._getToken(eB.C)}get privyAccessToken(){return this._getToken(eB.P)}_getToken(a){try{let b=cz.u.get(a);return"string"==typeof b?BS.throwIfNotWellFormedJwt(b):null}catch(a){return console.error(a),this.destroyLocalState(),null}}get refreshToken(){try{let a=cz.u.get(eB.R);return"string"==typeof a?a:null}catch(a){return console.error(a),this.destroyLocalState(),null}}getProviderAccessToken(a){try{let b=cz.u.get((0,eB.e)(a));if("string"!=typeof b)return null;{let c=new BS(b);return c.isExpired()?(cz.u.del((0,eB.e)(a)),null):c.value}}catch(a){return console.error(a),null}}get mightHaveServerCookies(){try{let a=wT.default.get(eB.f);return void 0!==a&&a.length>0}catch(a){console.error(a)}return!1}hasRefreshCredentials(a="privy_access_token"){let b="string"==typeof this.getToken(a),c="string"==typeof this.refreshToken&&this.refreshToken!==eB.h;return this.mightHaveServerCookies||b&&c}hasActiveAccessToken(a){let b=BS.parse(this.getToken(a));return null!==b&&!b.isExpired(30)}authenticate(a){return this.authenticateOnce.execute(a)}link(a){return this.linkOnce.execute(a)}refresh(){return this.refreshOnce.execute()}destroy(){return this.destroyOnce.execute()}storeProviderAccessToken(a,b){"string"==typeof b?cz.u.put((0,eB.e)(a),b):cz.u.del((0,eB.e)(a))}updateIdentityToken(a){"string"==typeof a?this.storeIdentityToken(a):this.clearIdentityToken()}async _authenticate(a){try{let b=await a.authenticate(),{user:c,is_new_user:d,oauth_tokens:e}=b;this.handleTokenResponse(b);let f=e?{provider:e.provider,accessToken:e.access_token,accessTokenExpiresInSeconds:e.access_token_expires_in_seconds,refreshToken:e.refresh_token,refreshTokenExpiresInSeconds:e.refresh_token_expires_in_seconds,scopes:e.scopes}:void 0;return this._trackAuthenticateEvents(a,d),{user:(0,cu.l)(c),isNewUser:d,oAuthTokens:f}}catch(a){throw console.warn("Error authenticating session"),(0,cy.i)(a)}}_trackAuthenticateEvents(a,b){let c=a instanceof B3?"email":a instanceof Cq?"sms":a instanceof Co?"siwe":a instanceof DW?"guest":a instanceof DD?"custom_auth":a instanceof Ck?a.meta.provider:null;c&&this.client&&this.client.createAnalyticsEvent({eventName:"sdk_authenticate",payload:{method:c,isNewUser:b}}),"siwe"===c&&this.client&&this.client.createAnalyticsEvent({eventName:"sdk_authenticate_siwe",payload:{connectorType:a.meta.connectorType,walletClientType:a.meta.walletClientType}})}async _link(a){try{let b=await a.link(),c=b.oauth_tokens,d=c?{provider:c.provider,accessToken:c.access_token,accessTokenExpiresInSeconds:c.access_token_expires_in_seconds,refreshToken:c.refresh_token,refreshTokenExpiresInSeconds:c.refresh_token_expires_in_seconds,scopes:c.scopes}:void 0;return{user:(0,cu.l)(b),oAuthTokens:d}}catch(a){throw console.warn("Error linking account"),(0,cy.i)(a)}}async _refresh(){if(!this.api)throw new cy.a("Session has no API instance");if(!this.client)throw new cy.a("Session has no PrivyClient instance");await this.client.getAccessToken({disableAutoRefresh:!0});let a=this.token,b=this.refreshToken;if(this.client.useServerCookies&&!this.mightHaveServerCookies&&this.token&&window.location.origin===this.client.apiUrl)return this.destroyLocalState(),null;try{let c;if(!(a&&b||this.mightHaveServerCookies))return null;{let d={};a&&(d.authorization=`Bearer ${a}`),c=await this.api.post(eJ,b?{refresh_token:b}:{},{headers:d})}return this.handleTokenResponse(c),(0,cu.l)(c.user)}catch(a){if(a instanceof cy.e&&a.privyErrorCode===cy.b.MISSING_OR_INVALID_TOKEN)return console.warn("Unable to refresh tokens - token is missing or no longer valid"),this.destroyLocalState(),null;throw(0,cy.i)(a)}}handleTokenResponse(a){a.session_update_action&&"set"!==a.session_update_action?"clear"===a.session_update_action?this.destroyLocalState():"ignore"===a.session_update_action&&(a.token&&(this.storeCustomerAccessToken(a.token),this.storePrivyAccessToken(a.privy_access_token)),a.identity_token&&this.storeIdentityToken(a.identity_token)):this._storeAllTokens(a)}_storeAllTokens(a){this.storeRefreshToken(a.refresh_token),this.storeCustomerAccessToken(a.token),this.storePrivyAccessToken(a.privy_access_token),a.identity_token&&this.storeIdentityToken(a.identity_token)}async _destroy(){try{await this.api?.post(eK,{refresh_token:this.refreshToken})}catch(a){console.warn("Error destroying session")}this.destroyLocalState()}destroyLocalState(){this.storeRefreshToken(null),this.storeCustomerAccessToken(null),this.storePrivyAccessToken(null),this.clearIdentityToken()}storeCustomerAccessToken(a){if("string"==typeof a){let b=cz.u.get(eB.C);if(cz.u.put(eB.C,a),!this.client?.useServerCookies){let b=BS.parse(a)?.expiration;wT.default.set(eB.i,a,{sameSite:"Strict",secure:DX(),expires:b?new Date(1e3*b):void 0})}b!==a&&this.client?.onStoreCustomerAccessToken?.(a)}else cz.u.del(eB.C),wT.default.remove(eB.i),this.client?.onDeleteCustomerAccessToken?.()}storeRefreshToken(a){"string"==typeof a?(cz.u.put(eB.R,a),this.client?.useServerCookies||wT.default.set(eB.f,"t",{sameSite:"Strict",secure:DX(),expires:30})):(cz.u.del(eB.R),wT.default.remove(eB.j),wT.default.remove(eB.f))}storePrivyAccessToken(a){"string"==typeof a?cz.u.put(eB.P,a):cz.u.del(eB.P)}storeIdentityToken(a){if(DT.setState({identityToken:a}),this.client?.useServerCookies)return;cz.u.put(eB.I,a);let b=BS.parse(a)?.expiration;wT.default.set(eB.k,a,{sameSite:"Strict",secure:DX(),expires:b?new Date(1e3*b):void 0})}clearIdentityToken(){cz.u.del(eB.I),DT.setState({identityToken:null}),wT.default.remove(eB.k)}constructor(){this.authenticateOnce=new Cc(async a=>this._authenticate(a)),this.linkOnce=new Cc(async a=>this._link(a)),this.refreshOnce=new Cc(this._refresh.bind(this)),this.destroyOnce=new Cc(this._destroy.bind(this))}}var Ev=0,Ew="__private_"+Ev+++"__getOrGenerateClientAnalyticsId";class Ex{getAppId(){return this.appId}initializeConnectorManager({walletConnectCloudProjectId:a,rpcConfig:b,chains:c,defaultChain:d,store:e,walletList:f,shouldEnforceDefaultChainOnConnect:g,externalWalletConfig:h,appName:i,walletChainType:j,setBaseAccountSdk:k}){this.connectors||(this.connectors=new DS(this.appId,a,b,c,d,e,f,g,h,i,k,j))}generateApi(){let a=new DV({appId:this.appId,appClientId:this.appClientId,client:this,defaults:{baseURL:this.apiUrl,timeout:this.timeout}});return this.session.api=a,a}updateApiUrl(a){this.apiUrl=a||this.fallbackApiUrl,this.api=this.generateApi(),a&&(this.useServerCookies=!0)}authenticate(){if(!this.authFlow)throw new cy.a("No auth flow in progress.");return this.session.authenticate(this.authFlow)}async link(){if(!this.authFlow)throw new cy.a("No auth flow in progress.");let{oAuthTokens:a}=await this.session.link(this.authFlow);return{user:await this.getAuthenticatedUser(),oAuthTokens:a}}storeProviderAccessToken(a,b){this.session.storeProviderAccessToken(a,b)}getProviderAccessToken(a){return this.session.getProviderAccessToken(a)}async logout(){await this.session.destroy(),this.authFlow=void 0}clearProviderAcccessTokens(a){a.linkedAccounts.filter(a=>"cross_app"===a.type).forEach(a=>{this.storeProviderAccessToken(a.providerApp.id,null)})}startAuthFlow(a){return a.api=this.api,this.authFlow=a,this.authFlow}async initMfaSmsVerification(){try{await this.api.post(fr,{action:"verify"})}catch(a){throw(0,cy.f)(a)}}async initMfaPasskeyVerification(){try{let a,b=await this.api.post(fs,{});return{rpId:(a=b.options).rp_id,challenge:a.challenge,allowCredentials:a.allow_credentials?.map(a=>({id:a.id,type:a.type,transports:a.transports}))||[],timeout:a.timeout,extensions:{appid:a.extensions?.app_id,credProps:a.extensions?.cred_props,hmacCreateSecret:a.extensions?.hmac_create_secret},userVerification:a.user_verification}}catch(a){throw(0,cy.f)(a)}}async getCrossAppProviderDetails(a){try{return this._cachedProviderAppDetails[a]||(this._cachedProviderAppDetails[a]=await this.api.get(`/api/v1/apps/${a}/cross-app/details`)),this._cachedProviderAppDetails[a]}catch(a){console.error("Error fetching cross app provider details",a)}}async acceptTerms(){try{let a=await this.api.post(ft,{});return(0,cu.l)(a)}catch(a){throw(0,cy.i)(a)}}async unlinkEmail(a){try{let b=await this.api.post(e3,{address:a});return await this.getAuthenticatedUser()??(0,cu.l)(b)}catch(a){throw(0,cy.i)(a)}}async unlinkPhone(a){try{let b=await this.api.post(e8,{phoneNumber:a});return await this.getAuthenticatedUser()??(0,cu.l)(b)}catch(a){throw(0,cy.i)(a)}}async unlinkEthereumWallet(a){try{let b=await this.api.post(eP,{address:a});return await this.getAuthenticatedUser()??(0,cu.l)(b)}catch(a){throw(0,cy.i)(a)}}async unlinkSolanaWallet(a){try{let b=await this.api.post(eU,{address:a});return await this.getAuthenticatedUser()??(0,cu.l)(b)}catch(a){throw(0,cy.i)(a)}}async unlinkOAuth(a,b){try{let c=await this.api.post(ff,{provider:a,subject:b});return await this.getAuthenticatedUser()??(0,cu.l)(c)}catch(a){throw(0,cy.i)(a)}}async unlinkFarcaster(a){try{let b=await this.api.post(e$,{fid:a});return await this.getAuthenticatedUser()??(0,cu.l)(b)}catch(a){throw(0,cy.i)(a)}}async unlinkTelegram(a){try{let b=await this.api.post(fp,{telegram_user_id:a});return await this.getAuthenticatedUser()??(0,cu.l)(b)}catch(a){throw(0,cy.i)(a)}}async revokeDelegatedWallet(){try{await this.api.post(fB,{})}catch(a){throw(0,cy.i)(a)}}async createAnalyticsEvent({eventName:a,payload:b,timestamp:c,options:d}){}async signMoonpayOnRampUrl(a){try{return this.api.post(fy,a)}catch(a){throw(0,cy.i)(a)}}async initCoinbaseOnRamp(a){try{return this.api.post(fz,a)}catch(a){throw(0,cy.i)(a)}}async getCoinbaseOnRampStatus({partnerUserId:a}){try{return this.api.get(`${fA}?partnerUserId=${a}`)}catch(a){throw(0,cy.i)(a)}}async getAuthenticatedUser(){return this.session.hasRefreshCredentials()?this.session.refresh():null}async getAccessToken(a){return await this.getPrivyAccessToken(a)||await this.getCustomerAccessToken(a)}async getCustomerAccessToken(a){return await this._getToken(Et.CUSTOMER,a)}async getPrivyAccessToken(a){return await this._getToken(Et.PRIVY,a)}async _getToken(a,b){return this.session.getToken(a)?this.session.hasActiveAccessToken(a)?this.session.hasRefreshCredentials(a)?BT.parse(this.session.getToken(a))?.appId!==this.appId?(await this.logout(),null):this.session.getToken(a):(this.session.destroyLocalState(),null):!b?.disableAutoRefresh&&this.session.hasRefreshCredentials(a)?(await this.session.refresh(),this.session.getToken(a)):null:null}async getUsdTokenPrice(a){try{return(await this.api.get(`/api/v1/token_price?chainId=${a.id}&tokenSymbol=${a.nativeCurrency.symbol}`)).usd}catch(b){return void console.error(`Unable to fetch token price for chain with id ${a.id}`)}}async getUsdPriceForSol(){try{return(await this.api.get("/api/v1/token_price?chainId=0&tokenSymbol=SOL")).usd}catch(a){return void console.error("Unable to fetch token price for SOL")}}async getSplTokenMetadata({mintAddress:a,cluster:b}){try{return await this.api.get(`/api/v1/spl_token_info?mint_address=${a}&cluster=${b}`)}catch(c){return void console.error(`Unable to fetch token metadata for ${b}:${a}`)}}async requestFarcasterSignerStatus(a){try{return await this.api.post("/api/v1/farcaster/signer/status",{ed25519_public_key:a})}catch(a){throw console.error("Unable to fetch Farcaster signer status"),a}}async generateSiweNonce({address:a,captchaToken:b}){try{return(await this.api.post(eL,{address:a,token:b})).nonce}catch(a){throw(0,cy.i)(a)}}async authenticateWithSiweInternal({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e,mode:f}){return await this.api.post(eM,{message:a,signature:b,chainId:c,walletClientType:d,connectorType:e,mode:f})}async linkWithSiweInternal({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e}){return await this.api.post(eN,{message:a,signature:b,chainId:c,walletClientType:d,connectorType:e})}async linkSmartWallet({message:a,signature:b,smartWalletType:c,smartWalletVersion:d}){try{let e=await this.api.post(eO,{message:a,signature:b,smart_wallet_type:c,smart_wallet_version:d});return(0,cu.l)(e)}catch(a){throw(0,cy.i)(a)}}async linkWithSiwe({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e}){try{let f=await this.linkWithSiweInternal({message:a,signature:b,chainId:c,walletClientType:d,connectorType:e});return(0,cu.l)(f)}catch(a){throw(0,cy.i)(a)}}async generateSiwsNonce({address:a,captchaToken:b}){try{return(await this.api.post(eR,{address:a,token:b})).nonce}catch(a){throw(0,cy.i)(a)}}async authenticateWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,mode:e,messageType:f="plain"}){return await this.api.post(eS,{message:a,signature:b,walletClientType:c,connectorType:d,mode:e,message_type:f})}async authenticateWithSiws({message:a,signature:b,walletClientType:c,connectorType:d,mode:e,messageType:f="plain"}){let g=await this.authenticateWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,mode:e,messageType:f});this.session.handleTokenResponse(g);let h=(0,cu.l)(g.user);if(!h)throw Error("Authentication failed - no user returned");return{user:h,isNewUser:g.is_new_user||!1}}async sendAccountTransferRequest({nonce:a,account:b,accountType:c,externalWalletMetadata:d,telegramAuthResult:e,telegramWebAppData:f,farcasterEmbeddedAddress:g,oAuthUserInfo:h}){try{let i,j;switch(c){case"email":i=e5,j={nonce:a,email:b};break;case"sms":i=fb,j={nonce:a,phoneNumber:b};break;case"siwe":if(i=eQ,!d)throw Error("Wallet parameters must be defined");j={nonce:a,address:b,...d};break;case"farcaster":i=e_,j={nonce:a,farcaster_id:b,farcaster_embedded_address:g};break;case"telegram":i=fq,j={nonce:a,telegram_auth_result:e,telegram_web_app_data:f};break;case"siws":i=eV,j={nonce:a,address:b,...d};break;case"custom":case"guest":case"passkey":throw Error("Invalid transfer account type");default:i=fg,j={nonce:a,userInfo:h}}let k=await this.api.post(i,j);return await this.getAuthenticatedUser()??(0,cu.l)(k)}catch(a){throw(0,cy.i)(a)}}async linkWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,messageType:e="plain"}){return await this.api.post(eT,{message:a,signature:b,walletClientType:c,connectorType:d,message_type:e})}async linkWithSiws({message:a,signature:b,walletClientType:c,connectorType:d,messageType:e="plain"}){try{let f=await this.linkWithSiwsInternal({message:a,signature:b,walletClientType:c,connectorType:d,messageType:e});return(0,cu.l)(f)}catch(a){throw(0,cy.i)(a)}}async updateUserAndIdToken(){try{let a=await this.api.get(fC);return this.session.updateIdentityToken(a.identity_token),(0,cu.l)(a.user)}catch(a){throw(0,cy.i)(a)}}async scanTransaction(a){try{return await this.api.post(fD,a)}catch(a){throw(0,cy.i)(a)}}constructor({apiUrl:a=eB.D,appId:b,appClientId:c,timeout:d=eB.l}){Object.defineProperty(this,Ew,{value:Ey}),this._cachedProviderAppDetails={},this.apiUrl=a,this.fallbackApiUrl=this.apiUrl,this.useServerCookies=a!==eB.D&&a.startsWith("https://privy."),this.timeout=d,this.appId=b,this.appClientId=c,this.clientAnalyticsId=(function(a,b){if(!Object.prototype.hasOwnProperty.call(a,b))throw TypeError("attempted to use private field on non-instance");return a})(this,Ew)[Ew](),o||(o=new Eu),this.session=o,this.api=this.generateApi(),this.session.client=this}}function Ey(){return null}function Ez(){if(!p)throw new cy.a("No global PrivyClient instance found. Please ensure you have initialized the PrivyProvider.");return p}let EA=({config:a,...b})=>{(()=>{if((0,U.useContext)(DG))throw new cy.a("Multiple PrivyProvider instances found","Found multiple instances of PrivyProvider, ensure there is only one mounted in your application tree.")})(),function(a){if("string"!=typeof a||25!==a.length)throw new cy.a("Cannot initialize the Privy provider with an invalid Privy app ID")}(b.appId),p||(p=new Ex({appId:b.appId,appClientId:b.clientId,apiUrl:b.apiUrl}));let c=(0,U.useMemo)(()=>new V.default({appId:b.appId,clientId:b.clientId,storage:cz.u,baseUrl:b.apiUrl,sdkVersion:"react-auth:3.8.1"}),[]),d=Ez(),e=Object.assign({},a);return(0,T.jsx)(eB.m,{client:c,legacyClient:d,appClientId:b.clientId,clientConfig:e,children:(0,T.jsx)(fF.P,{children:(0,T.jsx)(DH,{...b,client:d,privy:c})})})};function EB(){let{promptMfa:a,init:b,submit:c,cancel:d,mfaMethods:e}=(0,U.useContext)(cu.P);return{promptMfa:a,init:b,submit:c,cancel:d,mfaMethods:e}}function EC(){let{initEnrollmentWithSms:a,initEnrollmentWithTotp:b,initEnrollmentWithPasskey:c,submitEnrollmentWithSms:d,submitEnrollmentWithTotp:e,submitEnrollmentWithPasskey:f,unenroll:g,enrollInMfa:h}=(0,U.useContext)(cu.P);return{initEnrollmentWithSms:a,initEnrollmentWithTotp:b,initEnrollmentWithPasskey:c,submitEnrollmentWithSms:d,submitEnrollmentWithTotp:e,submitEnrollmentWithPasskey:f,unenrollWithSms:()=>g("sms"),unenrollWithTotp:()=>g("totp"),unenrollWithPasskey:a=>g("passkey",a),showMfaEnrollmentModal:()=>h(!0),closeMfaEnrollmentModal:()=>h(!1)}}a.s(["A",()=>Dq,"B",()=>DK,"C",()=>Ct,"D",()=>B$,"E",()=>Do,"F",()=>DL,"G",()=>BU,"H",()=>EA,"P",()=>C$,"R",()=>Cc,"S",()=>Cp,"W",()=>CY,"a",()=>Cv,"b",()=>Co,"c",()=>Dp,"d",()=>EC,"e",()=>C0,"f",()=>C5,"g",()=>C3,"h",()=>C2,"i",()=>C6,"j",()=>C4,"k",()=>Dy,"l",()=>Ds,"m",()=>BV,"n",()=>BW,"o",()=>Cl,"p",()=>DA,"q",()=>Cx,"r",()=>C1,"s",()=>Dw,"t",()=>Dv,"u",()=>EB,"v",()=>Ch,"w",()=>Ci,"x",()=>Cj,"y",()=>Dn,"z",()=>Dt],803760)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__f38219fd._.js.map